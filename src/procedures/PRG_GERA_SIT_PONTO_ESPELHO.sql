
  CREATE OR REPLACE EDITIONABLE PROCEDURE "PONTO_ELETRONICO"."PRG_GERA_SIT_PONTO_ESPELHO" 
AS
BEGIN

declare  
vCONTADOR NUMBER; 
vNUMERO NUMBER  ;
vSTRING VARCHAR2(100 BYTE);

begin
dbms_output.enable(null);
vCONTADOR :=0;
vNUMERO := 0;
vSTRING := NULL;

FOR C1 IN (
SELECT 
X5.SITUACAO_FUNCIONAL, X5.COD_SIT_FUNCIONAL, X5.DATA_INIC_SITUACAO, X5.CONTROLE_FOLHA, X5.SIT_FUNC_IFPONTO,
X5.DATA_RESCISAO,
X5.ERRO_IFPONTO_OCORREN_ESPELHO,
X5.PREVISTO_F,
X5.PREVISTO_N,
X5.H_NORMAIS, 
X5.H_NORMAIS_F,
X5.H_NORMAIS_N,
X5.H_EXCEDIDAS,  X5.EXTRA_DIA_INFO_SEM_MENSAL_F,  X5.H_DIFERENCIADAS,  X5.DESCONTO_DIA_INFO_SEM_MENSAL_F,  X5.PREV_TRAT,  X5.DESC_ABONADO,  X5.HORAS_ABONAD,  X5.HORAS_ABONADA_F,  X5.HORAS_MARCACOES_F,  X5.COMPENSAD,  X5.FALTA_COMPENSAR_,  X5.JUSTIF_GERA_HORAS_NORMAIS,  X5.CODIGO_REG_OCORRENCIA,  X5.O_QUE_FAZER,  X5.COD_VINCULO,  X5.VINCULO,  X5.COD_RG_TRAB,  X5.RG_TRAB,  X5.COD_RG_PREV,  X5.RG_PREV,  X5.COD_TIPO_TRAB,  X5.TIPO_TRAB,  X5.FOLHA_ESPECIAL,  X5.REGISTRO_PONTO,  X5.TIPO_REFERENCIA,  X5.TEM_SIT_PONTO,  X5.TEM_PREVISTO,  X5.TEM_PREVISTO_TRATADO,  X5.TEM_H_NORMAIS,  X5.TEM_DESCONTO_ABONADO,  X5.TEM_HORAS_ABONADA,  X5.TEM_DESCONTO,  X5.TEM_H_EXTRA,  X5.TEM_H_EXTRA_FERIADO,  X5.TEM_H_NOTURNA,  X5.TEM_COMPENSADO,  X5.TEM_FALTA_COMPENSAR,  X5.TEM_ATRASO,  X5.TEM_SAIDA_ANTECIPADA,  X5.TEM_H_EXTRA_NOTURNA,  X5.TEM_H_INTRA_JORNADA,  X5.TEM_DESCONTO_AUX,  X5.TEM_INTERJORNADA,  X5.TEM_BH_CREDITO,  X5.TEM_BH_DEBITO,  X5.TEM_DESCONTO_TOLERADO,  X5.TEM_INTERVALO_A_MENOR,  X5.TEM_ENTRADA_ANTECIPADA,  X5.TEM_MULTA_INTERJORNADA,  X5.TEM_EXTRA_DIA_INFO_SEM_MENSAL,  X5.TEM_DESC_DIA_INFO_SEM_MENSAL,  X5.EMPRESA,  X5.TIPO_CONTRATO,  X5.MATRICULA,  X5.CODIGO,  X5.DATA,  X5.SITUACAO,  X5.SITUACAO_TRATADA,  X5.TIPO_FOLGA,  X5.ENTRADA,  X5.MARCACAO_E1,  X5.ACEITO,  X5.SIT_PONTO,  
X5.DESCONTO_ABONADO,  X5.HORAS_ABONADA,  X5.HORAS_MARCACOES,  X5.DESCONTO,  X5.H_EXTRA,  X5.H_EXTRA_FERIADO,  X5.H_NOTURNA,  X5.COMPENSADO,  X5.FALTA_COMPENSAR,  X5.ATRASO,  X5.SAIDA_ANTECIPADA,  X5.H_EXTRA_NOTURNA,  X5.H_INTRA_JORNADA,  X5.DESCONTO_AUX,  X5.INTERJORNADA,  X5.BH_CREDITO,  X5.BH_DEBITO,  X5.DESCONTO_TOLERADO,  X5.INTERVALO_A_MENOR,  X5.ENTRADA_ANTECIPADA,  X5.MULTA_INTERJORNADA,  X5.EXTRA_DIA_INFO_SEM_MENSAL,  X5.DESCONTO_DIA_INFO_SEM_MENSAL,  X5.DTCADASTRO,  X5.COD_PESSOA,  X5.COD_JUSTIFICATIVA_PONTO,  X5.COD_PONTO_FECHAMENTO,  X5.COD_BANCO_HORAS,  X5.COD_CARGO,  X5.COD_UNIDADE,  X5.COD_HORARIO,  X5.COD_ESCALA_PADRAO,  X5.CAMPO_LIVRE,  X5.MARCACAO1,  X5.MARCACAO2,  X5.MARCACAO3,  X5.MARCACAO4,  X5.MARCACAO5,  X5.MARCACAO6,  X5.MARCACAO7,  X5.MARCACAO8,  X5.MARCACAO9,  X5.MARCACAO10,  X5.MARCACAO11,  X5.MARCACAO12,  X5.MARCACAO_E2,  X5.MARCACAO_E3,  X5.MARCACAO_E4,  X5.MARCACAO_E5,  X5.MARCACAO_E6,  X5.MARCACAO_E7,  X5.MARCACAO_E8,  X5.MARCACAO_E9,  X5.MARCACAO_E10,  X5.MARCACAO_E11,  X5.MARCACAO_E12,  X5.MARCACAO1_ALTERADA,  X5.MARCACAO2_ALTERADA,  X5.MARCACAO3_ALTERADA,  X5.MARCACAO4_ALTERADA,  X5.MARCACAO5_ALTERADA,  X5.MARCACAO6_ALTERADA,  X5.MARCACAO7_ALTERADA,  X5.MARCACAO8_ALTERADA,  X5.MARCACAO9_ALTERADA,  X5.MARCACAO10_ALTERADA,  X5.MARCACAO11_ALTERADA,  X5.MARCACAO12_ALTERADA,  X5.OBS_MARCACAO_ALTERADA,  X5.BANCO_HORAS,  X5.TIPO_BANCO_HORAS,  X5.OBS,  X5.BIT_DIVERGENCIA,  X5.COD_COMPENSACAO,  X5.MULTIPLICADOR_BANCO_HORAS,  X5.NA009,  X5.DTJUSTIFICATIVA,  X5.LOGIN_JUSTIFICATIVA,  X5.DTAVALIADOR,  X5.LOGIN_AVALIADOR,  X5.DTALTERACAO,  X5.LOGIN_ALTERACAO,  X5.FOTO,  X5.SOBREAVISO_DOBRA,  X5.COD_JUSTIFICATIVA_BANCO_HORAS,  X5.DESCRICAO_BANCO_HORAS,  X5.COMPROVANTE_JUSTIFICATIVA,  X5.RELATORIO_RH_VALIDADO,  X5.TOTAIS
,X5.AGRUPADOR
FROM (
SELECT 
X4.SITUACAO_FUNCIONAL,  X4.COD_SIT_FUNCIONAL, X4.DATA_INIC_SITUACAO, X4.CONTROLE_FOLHA,  X4.SIT_FUNC_IFPONTO,
X4.DATA_RESCISAO,
X4.PREVISTO_F AS PREVISTO_N, 
X4.H_NORMAIS_F AS H_NORMAIS_N,
CASE WHEN X4.CODIGO_REG_OCORRENCIA IS NOT NULL AND X4.SITUACAO IN ('TRABALHANDO','FOLGA') AND X4.COD_JUSTIFICATIVA_PONTO IS NULL THEN 'SIM' ELSE 'NAO' 
END ERRO_IFPONTO_OCORREN_ESPELHO,
X4.H_NORMAIS H_NORMAL, 
X4.H_NORMAIS_F,
X4.PREVISTO PREVISTO_F,
X4.EXTRA_DIA_INFO_SEM_MENSAL H_EXCEDIDAS, 
X4.EXTRA_DIA_INFO_SEM_MENSAL EXTRA_DIA_INFO_SEM_MENSAL_F,
X4.DESCONTO_DIA_INFO_SEM_MENSAL H_DIFERENCIADAS, 
X4.DESCONTO_DIA_INFO_SEM_MENSAL DESCONTO_DIA_INFO_SEM_MENSAL_F,
X4.PREVISTO_TRATADO PREV_TRAT, 
X4.DESCONTO_ABONADO DESC_ABONADO, 
X4.HORAS_ABONADA HORAS_ABONAD,
X4.HORAS_ABONADA_F,
X4.HORAS_MARCACOES HORAS_MARCACOES_F,
X4.COMPENSADO COMPENSAD, 
X4.FALTA_COMPENSAR FALTA_COMPENSAR_, 
X4.JUSTIF_GERA_HORAS_NORMAIS,  X4.CODIGO_REG_OCORRENCIA,  X4.O_QUE_FAZER,  X4.COD_VINCULO,  X4.VINCULO,  X4.COD_RG_TRAB,  X4.RG_TRAB,  X4.COD_RG_PREV,  X4.RG_PREV,  X4.COD_TIPO_TRAB,  X4.TIPO_TRAB,  X4.FOLHA_ESPECIAL,  X4.REGISTRO_PONTO,  X4.TIPO_REFERENCIA,  X4.TEM_SIT_PONTO,  X4.TEM_PREVISTO,  X4.TEM_PREVISTO_TRATADO,  X4.TEM_H_NORMAIS,  X4.TEM_DESCONTO_ABONADO,  X4.TEM_HORAS_ABONADA,  X4.TEM_DESCONTO,  X4.TEM_H_EXTRA,  X4.TEM_H_EXTRA_FERIADO,  X4.TEM_H_NOTURNA,  X4.TEM_COMPENSADO,  X4.TEM_FALTA_COMPENSAR,  X4.TEM_ATRASO,  X4.TEM_SAIDA_ANTECIPADA,  X4.TEM_H_EXTRA_NOTURNA,  X4.TEM_H_INTRA_JORNADA,  X4.TEM_DESCONTO_AUX,  X4.TEM_INTERJORNADA,  X4.TEM_BH_CREDITO,  X4.TEM_BH_DEBITO,  X4.TEM_DESCONTO_TOLERADO,  X4.TEM_INTERVALO_A_MENOR,  X4.TEM_ENTRADA_ANTECIPADA,  X4.TEM_MULTA_INTERJORNADA,  X4.TEM_EXTRA_DIA_INFO_SEM_MENSAL,  X4.TEM_DESC_DIA_INFO_SEM_MENSAL,  
X4.EMPRESA,  X4.TIPO_CONTRATO,  X4.MATRICULA,  X4.CODIGO,  X4.DATA,  X4.SITUACAO,  X4.SITUACAO_TRATADA,  X4.TIPO_FOLGA,  X4.ENTRADA,  X4.MARCACAO_E1,  X4.ACEITO,  X4.SIT_PONTO,  X4.PREVISTO,  X4.PREVISTO_TRATADO,  X4.H_NORMAIS,  X4.DESCONTO_ABONADO,  X4.HORAS_ABONADA,  X4.HORAS_MARCACOES,  X4.DESCONTO,  X4.H_EXTRA,  X4.H_EXTRA_FERIADO,  X4.H_NOTURNA,  X4.COMPENSADO,  X4.FALTA_COMPENSAR,  X4.ATRASO,  X4.SAIDA_ANTECIPADA,  X4.H_EXTRA_NOTURNA,  X4.H_INTRA_JORNADA,  X4.DESCONTO_AUX,  X4.INTERJORNADA,  X4.BH_CREDITO,  X4.BH_DEBITO,  X4.DESCONTO_TOLERADO,  X4.INTERVALO_A_MENOR,  X4.ENTRADA_ANTECIPADA,  X4.MULTA_INTERJORNADA,  X4.EXTRA_DIA_INFO_SEM_MENSAL,  X4.DESCONTO_DIA_INFO_SEM_MENSAL,  X4.DTCADASTRO,  X4.COD_PESSOA,  X4.COD_JUSTIFICATIVA_PONTO,  X4.COD_PONTO_FECHAMENTO,  X4.COD_BANCO_HORAS,  X4.COD_CARGO,  X4.COD_UNIDADE,  X4.COD_HORARIO,  X4.COD_ESCALA_PADRAO,  X4.CAMPO_LIVRE,  X4.MARCACAO1,  X4.MARCACAO2,  X4.MARCACAO3,  X4.MARCACAO4,  X4.MARCACAO5,  X4.MARCACAO6,  X4.MARCACAO7,  X4.MARCACAO8,  X4.MARCACAO9,  X4.MARCACAO10,  X4.MARCACAO11,  X4.MARCACAO12,  X4.MARCACAO_E2,  X4.MARCACAO_E3,  X4.MARCACAO_E4,  X4.MARCACAO_E5,  X4.MARCACAO_E6,  X4.MARCACAO_E7,  X4.MARCACAO_E8,  X4.MARCACAO_E9,  X4.MARCACAO_E10,  X4.MARCACAO_E11,  X4.MARCACAO_E12,  X4.MARCACAO1_ALTERADA,  X4.MARCACAO2_ALTERADA,  X4.MARCACAO3_ALTERADA,  X4.MARCACAO4_ALTERADA,  X4.MARCACAO5_ALTERADA,  X4.MARCACAO6_ALTERADA,  X4.MARCACAO7_ALTERADA,  X4.MARCACAO8_ALTERADA,  X4.MARCACAO9_ALTERADA,  X4.MARCACAO10_ALTERADA,  X4.MARCACAO11_ALTERADA,  X4.MARCACAO12_ALTERADA,  X4.OBS_MARCACAO_ALTERADA,  X4.BANCO_HORAS,  X4.TIPO_BANCO_HORAS,  X4.OBS,  X4.BIT_DIVERGENCIA,  X4.COD_COMPENSACAO,  X4.MULTIPLICADOR_BANCO_HORAS,  X4.NA009,  X4.DTJUSTIFICATIVA,  X4.LOGIN_JUSTIFICATIVA,  X4.DTAVALIADOR,  X4.LOGIN_AVALIADOR,  X4.DTALTERACAO,  X4.LOGIN_ALTERACAO,  X4.FOTO,  X4.SOBREAVISO_DOBRA,  X4.COD_JUSTIFICATIVA_BANCO_HORAS,  X4.DESCRICAO_BANCO_HORAS,  X4.COMPROVANTE_JUSTIFICATIVA,  X4.RELATORIO_RH_VALIDADO,  X4.TOTAIS
,X4.AGRUPADOR
FROM (
SELECT 
C.SITUACAO_FUNCIONAL,ASF.COD_SIT_FUNCIONAL, ASF.DATA_INIC_SITUACAO, SF.CONTROLE_FOLHA, POST.SIT_FUNC_IFPONTO,
C.DATA_RESCISAO,
CASE WHEN IFP1.DADO_ORIGEM IS NOT NULL THEN 'SIM' ELSE 'NAO' END JUSTIF_GERA_HORAS_NORMAIS,
OC.CODIGO CODIGO_REG_OCORRENCIA,
CASE
WHEN /* V.CODIGO <> '0009' AND*/  X3.SITUACAO_TRATADA = 'OCORRENCIA' AND X3.TIPO_FOLGA IS NULL AND X3.TEM_PREVISTO = 'SIM'  
THEN 'A.27 - Gravado como ocorrencia as permitidas e aprovadas'
WHEN /* V.CODIGO <> '0009' AND*/  X3.SITUACAO_TRATADA = 'FOLGA' AND X3.TIPO_FOLGA = 'FOLGA' AND X3.ENTRADA = 0 AND X3.MARCACAO_E1 = 0 AND X3.ACEITO = 'NAO AVALIADO'
AND X3.TEM_SIT_PONTO = 'NAO' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'NAO' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO'
THEN 'A.1-GRAVAR: 1003-FOLGA'
WHEN /* V.CODIGO <> '0009' AND*/  X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA = 'FERIADO' AND X3.ENTRADA = 0 AND X3.MARCACAO_E1 = 0 AND X3.ACEITO = 'NAO AVALIADO' 
AND X3.TEM_SIT_PONTO = 'NAO' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'NAO' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.3-GRAVAR: 0068-FERIADO'
WHEN /* V.CODIGO <> '0009' AND*/  X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA = 'PONTO_FACULTATIVO' AND X3.ENTRADA = 0 AND X3.MARCACAO_E1 = 0 AND X3.ACEITO = 'NAO AVALIADO' 
AND X3.TEM_SIT_PONTO = 'NAO' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'NAO' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.2-GRAVAR: 1012-PONTO FACULTATIVO'
--SO COM JUSTIFICATIVA ABONADA
WHEN /* V.CODIGO <> '0009' AND*/                                         X3.TIPO_FOLGA IN ('FOLGA','FERIADO','PONTO_FACULTATIVO') AND X3.ENTRADA = 0 AND X3.MARCACAO_E1 = 0 AND X3.ACEITO = 'ABONADO' 
AND X3.TEM_SIT_PONTO = 'SIM' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'SIM' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.32-DIA DESCANSO SO COM JUSTIFICATIVA ABONADA GRAVAR: 1000-HORAS NORMAIS'
WHEN /* V.CODIGO <> '0009' */                                            X3.TIPO_FOLGA IN ('FOLGA','FERIADO','PONTO_FACULTATIVO') AND X3.ENTRADA = 0 AND X3.MARCACAO_E1 = 0 AND X3.ACEITO = 'ABONADO' 
AND X3.TEM_SIT_PONTO = 'SIM' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'SIM' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'SIM' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.33-DIA DESCANSO SO COM JUSTIFICATIVA ABONADA GRAVAR: 1000-HORAS NORMAIS E 1002-HORAS EXCEDENTES'
--SO COM JUSTIFICATIVA NAO ABONADA
WHEN /* V.CODIGO <> '0009' AND*/  X3.TIPO_FOLGA = 'FOLGA' AND X3.ENTRADA = 0 AND X3.MARCACAO_E1 = 0 AND X3.ACEITO = 'NAO ABONADO' 
AND X3.TEM_SIT_PONTO = 'SIM' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'NAO' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.38-DIA DESCANSO SO COM JUSTIFICATIVA NAO ABONADA GRAVAR: 1003-FOLGA'
WHEN /* V.CODIGO <> '0009' AND*/  X3.TIPO_FOLGA = 'FERIADO' AND X3.ENTRADA = 0 AND X3.MARCACAO_E1 = 0 AND X3.ACEITO = 'NAO ABONADO' 
AND X3.TEM_SIT_PONTO = 'SIM' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'NAO' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.39-DIA DESCANSO SO COM JUSTIFICATIVA NAO ABONADA GRAVAR: 0068-FERIADO'
WHEN /* V.CODIGO <> '0009' AND*/  X3.TIPO_FOLGA = 'PONTO_FACULTATIVO' AND X3.ENTRADA = 0 AND X3.MARCACAO_E1 = 0 AND X3.ACEITO = 'NAO ABONADO' 
AND X3.TEM_SIT_PONTO = 'SIM' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'NAO' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.40-DIA DESCANSO SO COM JUSTIFICATIVA NAO ABONADA GRAVAR: 1012-PONTO FACULTATIVO'
--SO COM MARCACAO E SEM JUSTIFICATIVA
WHEN /* V.CODIGO <> '0009' AND*/   X3.TIPO_FOLGA IN ('FOLGA','FERIADO','PONTO_FACULTATIVO') AND X3.ENTRADA = 1 AND X3.MARCACAO_E1 = 1 AND X3.ACEITO = 'NAO AVALIADO'
AND X3.TEM_SIT_PONTO = 'NAO' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'SIM' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.34-DIA DESCANSO SO COM MARCACAO E SEM JUSTIFICATIVA GRAVAR: 1000-HORAS NORMAIS'
WHEN /* V.CODIGO <> '0009' AND*/    X3.TIPO_FOLGA IN ('FOLGA','FERIADO','PONTO_FACULTATIVO') AND X3.ENTRADA = 1 AND X3.MARCACAO_E1 = 1 AND X3.ACEITO = 'NAO AVALIADO' 
AND X3.TEM_SIT_PONTO = 'NAO' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'SIM' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'SIM' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.35-DIA DESCANSO SO COM MARCACAO E SEM JUSTIFICATIVA GRAVAR: 1000-HORAS NORMAIS E 1002-HORAS EXCEDENTES'
--COM MARCACAO E JUSTIFICATIVA ABONADA
WHEN /* V.CODIGO <> '0009' AND*/    X3.TIPO_FOLGA IN ('FOLGA','FERIADO','PONTO_FACULTATIVO') AND X3.ENTRADA = 1 AND X3.MARCACAO_E1 = 1 AND X3.ACEITO = 'ABONADO'
AND X3.TEM_SIT_PONTO = 'SIM' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'SIM' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.36-DIA DESCANSO COM MARCACAO E JUSTIFICATIVA ABONADA GRAVAR: 1000-HORAS NORMAIS'
WHEN /* V.CODIGO <> '0009' AND*/    X3.TIPO_FOLGA IN ('FOLGA','FERIADO','PONTO_FACULTATIVO') AND X3.ENTRADA = 1 AND X3.MARCACAO_E1 = 1 AND X3.ACEITO = 'ABONADO'
AND X3.TEM_SIT_PONTO = 'SIM' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'SIM' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'SIM' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.37-DIA DESCANSO COM MARCACAO E JUSTIFICATIVA ABONADA GRAVAR: 1000-HORAS NORMAIS E 1002-HORAS EXCEDENTES'

WHEN /* V.CODIGO <> '0009' AND */X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA IN ('PONTO_FACULTATIVO') AND X3.ENTRADA = 0 AND X3.MARCACAO_E1 = 0 AND X3.ACEITO = 'NAO AVALIADO'
AND X3.TEM_SIT_PONTO = 'SIM' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'NAO' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.45-GRAVAR: 1012-PONTO FACULTATIVO'
WHEN /* V.CODIGO <> '0009' AND */X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA IN ('PONTO_FACULTATIVO') AND X3.ENTRADA = 1 AND X3.MARCACAO_E1 = 1 AND X3.ACEITO = 'NAO AVALIADO'
AND X3.TEM_SIT_PONTO = 'SIM' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'SIM' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'SIM' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.46-PONTO FACULTATIVO GRAVAR: 1000-HORAS NORMAIS'
WHEN /* V.CODIGO <> '0009' AND */X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA IN ('FERIADO') AND X3.ENTRADA = 0 AND X3.MARCACAO_E1 = 0 AND X3.ACEITO = 'NAO AVALIADO'
AND X3.TEM_SIT_PONTO = 'SIM' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'NAO' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.47-GRAVAR: 0068-FERIADO'
WHEN /* V.CODIGO <> '0009' AND */X3.SITUACAO_TRATADA = 'FOLGA' AND X3.TIPO_FOLGA IN ('FOLGA') AND X3.ENTRADA = 0 AND X3.MARCACAO_E1 = 0 AND X3.ACEITO = 'NAO AVALIADO'
AND X3.TEM_SIT_PONTO = 'SIM' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'NAO' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.48-GRAVAR: 1003-FOLGA'
WHEN /* V.CODIGO <> '0009' AND */X3.SITUACAO_TRATADA = 'FOLGA' AND X3.TIPO_FOLGA IN ('FOLGA') AND X3.ENTRADA = 1 AND X3.MARCACAO_E1 = 1 AND X3.ACEITO = 'NAO AVALIADO'
AND X3.TEM_SIT_PONTO = 'NAO' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'NAO' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.49-GRAVAR: 1003-FOLGA'
WHEN /* V.CODIGO <> '0009' AND */X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA IN ('PONTO_FACULTATIVO') AND X3.ENTRADA = 1 AND X3.MARCACAO_E1 = 1 AND X3.ACEITO = 'NAO AVALIADO'
AND X3.TEM_SIT_PONTO = 'NAO' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'NAO' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.50-GRAVAR: 1012-PONTO FACULTATIVO'
WHEN /* V.CODIGO <> '0009' AND */X3.SITUACAO_TRATADA = 'FOLGA' AND X3.TIPO_FOLGA IN ('FERIADO') AND X3.ENTRADA = 0 AND X3.MARCACAO_E1 = 0 AND X3.ACEITO = 'NAO AVALIADO'
AND X3.TEM_SIT_PONTO = 'NAO' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'NAO' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.51-GRAVAR: 1003-FOLGA'
WHEN /* V.CODIGO <> '0009' AND */X3.SITUACAO_TRATADA = 'FOLGA' AND X3.TIPO_FOLGA IN ('FERIADO') AND X3.ENTRADA = 1 AND X3.MARCACAO_E1 = 1 AND X3.ACEITO = 'NAO AVALIADO'
AND X3.TEM_SIT_PONTO = 'NAO' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'NAO' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.52-GRAVAR: 1003-FOLGA'
WHEN /* V.CODIGO <> '0009' AND */X3.SITUACAO_TRATADA = 'FOLGA' AND X3.TIPO_FOLGA IN ('PONTO_FACULTATIVO') AND X3.ENTRADA = 0 AND X3.MARCACAO_E1 = 0 AND X3.ACEITO = 'NAO AVALIADO'
AND X3.TEM_SIT_PONTO = 'NAO' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'NAO' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.53-GRAVAR: 1003-FOLGA'
WHEN /* V.CODIGO <> '0009' AND */X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA IN ('TRABALHANDO') AND X3.ENTRADA = 1 AND X3.MARCACAO_E1 = 1 AND X3.ACEITO = 'NAO ABONADO'
AND X3.TEM_SIT_PONTO = 'SIM' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'NAO' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'SIM' 
THEN 'A.54-GRAVAR: 1001 HORAS DIFERENCIADAS'

WHEN /* V.CODIGO <> '0009' AND */X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA IN ('PONTO_FACULTATIVO') AND X3.ENTRADA = 0 AND X3.MARCACAO_E1 = 0 AND X3.ACEITO = 'ABONADO'
AND X3.TEM_SIT_PONTO = 'SIM' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'NAO' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.55-PONTO FACULTATIVO COM JUSTIFICATIVA ABONADA GRAVAR: 1000-HORAS NORMAIS'
WHEN /* V.CODIGO <> '0009' AND */X3.SITUACAO_TRATADA = 'FOLGA' AND X3.TIPO_FOLGA IN ('FOLGA') AND X3.ENTRADA = 0 AND X3.MARCACAO_E1 = 0 AND X3.ACEITO = 'ABONADO'
AND X3.TEM_SIT_PONTO = 'SIM' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'NAO' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.56-DIA DESCANSO COM MARCACAO E JUSTIFICATIVA ABONADA GRAVAR: 1000-HORAS NORMAIS'
WHEN /* V.CODIGO <> '0009' AND */X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA IN ('FERIADO') AND X3.ENTRADA = 0 AND X3.MARCACAO_E1 = 0 AND X3.ACEITO = 'ABONADO'
AND X3.TEM_SIT_PONTO = 'SIM' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'NAO' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.57-FERIADO COM JUSTIFICATIVA ABONADA GRAVAR: 1000-HORAS NORMAIS'
WHEN /* V.CODIGO <> '0009' AND */X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA IN ('FERIADO') AND X3.ENTRADA = 0 AND X3.MARCACAO_E1 = 0 AND X3.ACEITO = 'ABONADO'
AND X3.TEM_SIT_PONTO = 'SIM' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'NAO' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.57-FERIADO COM JUSTIFICATIVA ABONADA GRAVAR: 1000-HORAS NORMAIS'
WHEN /* V.CODIGO <> '0009' AND */X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA IN ('PONTO_FACULTATIVO') AND X3.ENTRADA = 1 AND X3.MARCACAO_E1 = 1 AND X3.ACEITO = 'NAO AVALIADO'
AND X3.TEM_SIT_PONTO = 'NAO' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'NAO' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.58-PONTO FACULTATIVO COM MARCACAO GRAVAR: 1000-HORAS NORMAIS'

WHEN /* V.CODIGO <> '0009' AND */X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA IN ('TRABALHANDO') AND X3.ENTRADA = 0 AND X3.MARCACAO_E1 = 0 AND X3.ACEITO = 'NAO ABONADO'
AND X3.TEM_SIT_PONTO = 'SIM' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'NAO' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'SIM' 
THEN 'A.59-GRAVAR: 0020-FALTA'

WHEN /* V.CODIGO <> '0009' AND */X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA IN ('TRABALHANDO') AND X3.ENTRADA = 1 AND X3.MARCACAO_E1 = 1 AND X3.ACEITO = 'NAO ABONADO'
AND X3.TEM_SIT_PONTO = 'SIM' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'SIM' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'SIM' 
THEN 'A.60-GRAVAR: 1000-HORAS NORMAIS E 1001-HORAS DIFERENCIADAS'
WHEN /* V.CODIGO <> '0009' AND */X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA IN ('TRABALHANDO') AND X3.ENTRADA = 0 AND X3.MARCACAO_E1 = 0 AND X3.ACEITO = 'NAO ABONADO'
AND X3.TEM_SIT_PONTO = 'SIM' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'NAO' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.61-GRAVAR: 0020-FALTA ULTIMO DIA PERIODO'
WHEN /* V.CODIGO <> '0009' AND */X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA IN ('FERIADO') AND X3.ENTRADA = 0 AND X3.MARCACAO_E1 = 0 AND X3.ACEITO = 'NAO AVALIADO'
AND X3.TEM_SIT_PONTO = 'NAO' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'NAO' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'SIM' 
THEN 'A.62-GRAVAR FALTA'
WHEN /* V.CODIGO <> '0009' AND */X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA IN ('FERIADO') AND X3.ENTRADA = 0 AND X3.MARCACAO_E1 = 0 AND X3.ACEITO = 'NAO AVALIADO'
AND X3.TEM_SIT_PONTO = 'SIM' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'NAO' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'SIM' 
THEN 'A.63-GRAVA FALTA'
WHEN /* V.CODIGO <> '0009' AND */X3.SITUACAO_TRATADA = 'FOLGA' AND X3.TIPO_FOLGA IN ('FERIADO') AND X3.ENTRADA = 0 AND X3.MARCACAO_E1 = 0 AND X3.ACEITO = 'NAO AVALIADO'
AND X3.TEM_SIT_PONTO = 'SIM' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'NAO' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.64-GRAVA FERIADO'
WHEN /* V.CODIGO <> '0009' AND */X3.SITUACAO_TRATADA = 'FOLGA' AND X3.TIPO_FOLGA IN ('FOLGA') AND X3.ENTRADA = 0 AND X3.MARCACAO_E1 = 0 AND X3.ACEITO = 'ABONADO'
AND X3.TEM_SIT_PONTO = 'NAO' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'NAO' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.65-GRAVA FOLGA'
WHEN /* V.CODIGO <> '0009' AND */X3.SITUACAO_TRATADA = 'FOLGA' AND X3.TIPO_FOLGA IN ('FERIADO') AND X3.ENTRADA = 0 AND X3.MARCACAO_E1 = 0 AND X3.ACEITO = 'ABONADO'
AND X3.TEM_SIT_PONTO = 'SIM' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'NAO' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.66-HORAS NORMAIS E HORAS EXCEDIDAS'

WHEN /* V.CODIGO <> '0009' AND*/  X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA = 'TRABALHANDO' AND X3.ENTRADA = 1 AND X3.MARCACAO_E1 = 1 AND X3.ACEITO = 'NAO AVALIADO' AND X3.TEM_SIT_PONTO = 'NAO' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'SIM' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.6.1-GRAVAR: 1000-HORAS NORMAIS'
WHEN /* V.CODIGO <> '0009' AND*/  X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA = 'TRABALHANDO' AND X3.ENTRADA = 1 AND X3.MARCACAO_E1 = 1 AND X3.ACEITO = 'NAO AVALIADO' AND X3.TEM_SIT_PONTO = 'NAO' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'SIM' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'SIM' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.7.1-GRAVAR: 1000-HORAS NORMAIS E 1002-HORAS EXCEDENTES'
WHEN /* V.CODIGO <> '0009' AND*/  X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA = 'TRABALHANDO' AND X3.ENTRADA = 1 AND X3.MARCACAO_E1 = 1 AND X3.ACEITO = 'NAO AVALIADO' AND X3.TEM_SIT_PONTO = 'NAO' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'SIM' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'SIM' 
THEN 'A.8.1-GRAVAR: 1000-HORAS NORMAIS E 1001-HORAS DIFERENCIADAS'
WHEN /* V.CODIGO <> '0009' AND*/  X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA = 'TRABALHANDO' AND X3.ENTRADA = 0 AND X3.MARCACAO_E1 = 0 AND X3.ACEITO = 'NAO AVALIADO' AND X3.TEM_SIT_PONTO = 'NAO' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'NAO' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'SIM' 
THEN 'A.9.1-GRAVAR: 0020-FALTA PODE VIRAR FALTA COMPENSADA'
WHEN /* V.CODIGO <> '0009' AND*/  X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA = 'TRABALHANDO' AND X3.ENTRADA = 0 AND X3.MARCACAO_E1 = 0 AND X3.ACEITO = 'NAO AVALIADO' AND X3.TEM_SIT_PONTO = 'NAO' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'NAO' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.9.2-GRAVAR: 0020-FALTA'
WHEN /* V.CODIGO <> '0009' AND*/  X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA = 'TRABALHANDO' AND X3.ENTRADA = 1 AND X3.MARCACAO_E1 = 1 AND X3.ACEITO = 'NAO AVALIADO' AND X3.TEM_SIT_PONTO = 'NAO' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'NAO' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.10.1-POSSIVEL FALTA VIRAR FALTA COMPENSADA'
WHEN /* V.CODIGO <> '0009' AND*/  X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA = 'TRABALHANDO' AND X3.ENTRADA = 1 AND X3.MARCACAO_E1 = 1 AND X3.ACEITO = 'NAO AVALIADO' AND X3.TEM_SIT_PONTO = 'NAO' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'NAO' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'SIM' 
THEN 'A.10.2-POSSIVEL FALTA'
WHEN /* V.CODIGO <> '0009' AND*/  X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA = 'TRABALHANDO' AND X3.ENTRADA = 0 AND X3.MARCACAO_E1 = 0 AND X3.ACEITO = 'ABONADO' AND X3.TEM_SIT_PONTO = 'SIM' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'SIM' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.11-GRAVAR: Situação de Ponto da Justificativa'
WHEN /* V.CODIGO <> '0009' AND*/  X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA = 'TRABALHANDO' AND X3.ENTRADA = 0 AND X3.MARCACAO_E1 = 0 AND X3.ACEITO = 'ABONADO' AND X3.TEM_SIT_PONTO = 'SIM' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'SIM' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'SIM'
THEN 'A.12-GRAVAR: 1000-HORAS NORMAIS E 1001-HORAS DIFERENCIADAS'
WHEN /* V.CODIGO <> '0009' AND*/  X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA = 'TRABALHANDO' AND X3.ENTRADA = 0 AND X3.MARCACAO_E1 = 0 AND X3.ACEITO = 'ABONADO' AND X3.TEM_SIT_PONTO = 'SIM' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'SIM' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'SIM' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.13-GRAVAR: 1000-HORAS NORMAIS E 1002-HORAS EXCEDENTES'
WHEN /* V.CODIGO <> '0009' AND*/  X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA = 'TRABALHANDO' AND X3.ENTRADA = 1 AND X3.MARCACAO_E1 = 1 AND X3.ACEITO = 'ABONADO' AND X3.TEM_SIT_PONTO = 'SIM' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'SIM' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO'
THEN 'A.14-?Gravar no dia a Situação de Ponto da Justificativa?'
--WHEN  /* V.CODIGO <> '0009' AND*/  X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA = 'TRABALHANDO' AND X3.ENTRADA = 1 AND X3.MARCACAO_E1 = 1 AND X3.ACEITO = 'ABONADO' AND X3.TEM_SIT_PONTO = 'SIM' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'SIM' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO'
--THEN  '17-1.2-Avaliar trabalhou tem marcação mas total impar e dá alerta no espelho e possui uma JUSTIFICATIVA ABONADA apenas com HORAS NORMAIS'
WHEN /* V.CODIGO <> '0009' AND*/  X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA = 'TRABALHANDO' AND X3.ENTRADA = 1 AND X3.MARCACAO_E1 = 1 AND X3.ACEITO = 'ABONADO' AND X3.TEM_SIT_PONTO = 'SIM' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'SIM' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'SIM' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.15-?Gravar no dia a Situação de Ponto da Justificativa + horas excedidas?'
WHEN /* V.CODIGO <> '0009' AND*/  X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA = 'TRABALHANDO' AND X3.ENTRADA = 1 AND X3.MARCACAO_E1 = 1 AND X3.ACEITO = 'ABONADO' AND X3.TEM_SIT_PONTO = 'SIM' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'SIM' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'SIM' 
THEN 'A.16-?Gravar no dia a Situação de Ponto da Justificativa + horas diferenciadas?'
WHEN /* V.CODIGO <> '0009' AND*/  X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA = 'TRABALHANDO' AND X3.ENTRADA = 1 AND X3.MARCACAO_E1 = 1 AND X3.ACEITO = 'ABONADO' AND X3.TEM_SIT_PONTO = 'NAO' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'SIM' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'NAO LOCALIZADO SIT PONTO 13-GRAVAR: 1000-HORAS NORMAIS E 1002-HORAS EXCEDENTES'
WHEN /* V.CODIGO <> '0009' AND*/  X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA = 'TRABALHANDO' AND X3.ENTRADA = 1 AND X3.MARCACAO_E1 = 1 AND X3.ACEITO = 'ABONADO' AND X3.TEM_SIT_PONTO = 'NAO' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'SIM' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'SIM' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'NAO LOCALIZADO SIT PONTO 14-?Gravar no dia a Situação de Ponto da Justificativa?'
WHEN /* V.CODIGO <> '0009' AND*/  X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA = 'TRABALHANDO' AND X3.ENTRADA = 0 AND X3.MARCACAO_E1 = 0 AND X3.ACEITO = 'NAO AVALIADO' AND X3.TEM_SIT_PONTO = 'SIM' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'NAO' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.17-GRAVAR: 0020 FALTA'
WHEN /* V.CODIGO <> '0009' AND*/  X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA = 'TRABALHANDO' AND X3.ENTRADA = 0 AND X3.MARCACAO_E1 = 0 AND X3.ACEITO = 'NAO AVALIADO' AND X3.TEM_SIT_PONTO = 'SIM' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'NAO' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'SIM' 
THEN 'A.18-GRAVAR: 0020 FALTA PODE VIRAR FALTA COMPENSADA'
WHEN /* V.CODIGO <> '0009' AND*/  X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA = 'TRABALHANDO' AND X3.ENTRADA = 1 AND X3.MARCACAO_E1 = 1 AND X3.ACEITO = 'NAO AVALIADO' AND X3.TEM_SIT_PONTO = 'SIM' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'SIM' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'SIM' 
THEN 'A.19.1-GRAVAR: 1001 HORAS DIFERENCIADAS e 1000 HORAS NORMAIS'
--inicio --NOVO EM 6/11/20
WHEN /* V.CODIGO <> '0009' AND */X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA = 'TRABALHANDO' AND X3.ENTRADA = 1 AND X3.MARCACAO_E1 = 1 AND X3.ACEITO = 'NAO AVALIADO' AND X3.TEM_SIT_PONTO = 'SIM' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'SIM' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.19.2-GRAVAR: 1001 HORAS DIFERENCIADAS E 1000-HORAS NORMAIS ULTIMO DIA PERIODO'
--fim--NOVO EM 6/11/20
WHEN /* V.CODIGO <> '0009' AND*/  X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA = 'TRABALHANDO' AND X3.ENTRADA = 1 AND X3.MARCACAO_E1 = 1 AND X3.ACEITO = 'NAO AVALIADO' AND X3.TEM_SIT_PONTO = 'SIM' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'NAO' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.20-GRAVAR: 0020 FALTA'
WHEN /* V.CODIGO <> '0009' AND*/  X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA = 'TRABALHANDO' AND X3.ENTRADA = 1 AND X3.MARCACAO_E1 = 1 AND X3.ACEITO = 'NAO AVALIADO' AND X3.TEM_SIT_PONTO = 'SIM' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'SIM' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'SIM' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.21-GRAVAR: 1002 HORAS EXCEDIDAS'
WHEN /* V.CODIGO <> '0009' AND*/  X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA = 'TRABALHANDO' AND X3.ENTRADA = 1 AND X3.MARCACAO_E1 = 1 AND X3.ACEITO = 'NAO AVALIADO' AND X3.TEM_SIT_PONTO = 'SIM' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'NAO' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'SIM' 
THEN 'A.22-GRAVAR: 1001 HORAS DIFERENCIADAS'
--WHEN  /* V.CODIGO <> '0009' AND*/  X3.SITUACAO_TRATADA = 'FOLGA' AND X3.TIPO_FOLGA = 'FOLGA' AND X3.ENTRADA = 1 AND X3.MARCACAO_E1 = 1 AND X3.ACEITO = 'NAO AVALIADO' AND X3.TEM_SIT_PONTO = 'NAO' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'SIM' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 

WHEN /*V.CODIGO <> '0009' AND*/ X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA = 'TRABALHANDO' AND X3.ENTRADA = 1 AND X3.MARCACAO_E1 = 1 AND X3.ACEITO = 'NAO ABONADO' AND X3.TEM_SIT_PONTO = 'SIM' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'NAO' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.54.2-GRAVAR: 1001 HORAS DIFERENCIADAS'
WHEN /*V.CODIGO <> '0009' AND*/ X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA = 'TRABALHANDO' AND X3.ENTRADA = 1 AND X3.MARCACAO_E1 = 1 AND X3.ACEITO = 'NAO ABONADO' AND X3.TEM_SIT_PONTO = 'SIM' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'SIM' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.60.2-GRAVAR: 1000-HORAS NORMAIS E 1001-HORAS DIFERENCIADAS'
WHEN /*V.CODIGO <> '0009' AND*/ X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA = 'TRABALHANDO' AND X3.ENTRADA = 1 AND X3.MARCACAO_E1 = 1 AND X3.ACEITO = 'NAO ABONADO' AND X3.TEM_SIT_PONTO = 'SIM' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'SIM' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'SIM' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.87-GRAVAR: 1000-HORAS NORMAIS E 1002-HORAS EXCEDENTES'
WHEN /*V.CODIGO <> '0009' AND*/ X3.SITUACAO_TRATADA = 'FOLGA' AND X3.TIPO_FOLGA = 'FOLGA' AND X3.ENTRADA = 1 AND X3.MARCACAO_E1 = 1 AND X3.ACEITO = 'NAO ABONADO' AND X3.TEM_SIT_PONTO = 'SIM' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'SIM' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'SIM' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.70-FOLGA GRAVAR: 1002-HORAS EXCEDENTES'
WHEN /*V.CODIGO <> '0009' AND*/ X3.SITUACAO_TRATADA = 'FOLGA' AND X3.TIPO_FOLGA = 'FOLGA' AND X3.ENTRADA = 1 AND X3.MARCACAO_E1 = 1 AND X3.ACEITO = 'NAO ABONADO' AND X3.TEM_SIT_PONTO = 'SIM' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'NAO' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.71-GRAVAR: 1003-FOLGA'
WHEN /*V.CODIGO <> '0009' AND*/ X3.SITUACAO_TRATADA = 'FOLGA' AND X3.TIPO_FOLGA = 'FOLGA' AND X3.ENTRADA = 1 AND X3.MARCACAO_E1 = 1 AND X3.ACEITO = 'NAO AVALIADO' AND X3.TEM_SIT_PONTO = 'SIM' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'SIM' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'SIM' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.72-GRAVAR: 1002-HORAS EXCEDENTES'
WHEN /*V.CODIGO <> '0009' AND*/ X3.SITUACAO_TRATADA = 'FOLGA' AND X3.TIPO_FOLGA = 'FOLGA' AND X3.ENTRADA = 1 AND X3.MARCACAO_E1 = 1 AND X3.ACEITO = 'NAO AVALIADO' AND X3.TEM_SIT_PONTO = 'SIM' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'SIM' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.73-GRAVAR: 1002-HORAS EXCEDENTES'
WHEN /*V.CODIGO <> '0009' AND*/ X3.SITUACAO_TRATADA = 'FOLGA' AND X3.TIPO_FOLGA = 'FOLGA' AND X3.ENTRADA = 1 AND X3.MARCACAO_E1 = 1 AND X3.ACEITO = 'NAO AVALIADO' AND X3.TEM_SIT_PONTO = 'SIM' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'NAO' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.74-GRAVAR: 1003-FOLGA'
WHEN /*V.CODIGO <> '0009' AND*/ X3.SITUACAO_TRATADA = 'FOLGA' AND X3.TIPO_FOLGA = 'FOLGA' AND X3.ENTRADA = 1 AND X3.MARCACAO_E1 = 0 AND X3.ACEITO = 'ABONADO' AND X3.TEM_SIT_PONTO = 'SIM' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'SIM' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'SIM' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.75-GRAVAR: 1002-HORAS EXCEDENTES'
WHEN /*V.CODIGO <> '0009' AND*/ X3.SITUACAO_TRATADA = 'FOLGA' AND X3.TIPO_FOLGA = 'FOLGA' AND X3.ENTRADA = 1 AND X3.MARCACAO_E1 = 0 AND X3.ACEITO = 'NAO AVALIADO' AND X3.TEM_SIT_PONTO = 'NAO' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'NAO' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.76-GRAVAR: 1003-FOLGA'
WHEN /*V.CODIGO <> '0009' AND*/ X3.SITUACAO_TRATADA = 'FOLGA' AND X3.TIPO_FOLGA = 'FOLGA' AND X3.ENTRADA = 1 AND X3.MARCACAO_E1 = 0 AND X3.ACEITO = 'NAO AVALIADO' AND X3.TEM_SIT_PONTO = 'SIM' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'NAO' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.77-GRAVAR: 1003-FOLGA'
WHEN /*V.CODIGO <> '0009' AND*/ X3.SITUACAO_TRATADA = 'FOLGA' AND X3.TIPO_FOLGA = 'FERIADO' AND X3.ENTRADA = 1 AND X3.MARCACAO_E1 = 1 AND X3.ACEITO = 'NAO AVALIADO' AND X3.TEM_SIT_PONTO = 'SIM' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'NAO' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.78-GRAVAR: 1003-FOLGA'
WHEN /*V.CODIGO <> '0009' AND*/ X3.SITUACAO_TRATADA = 'FOLGA' AND X3.TIPO_FOLGA = 'FERIADO' AND X3.ENTRADA = 1 AND X3.MARCACAO_E1 = 1 AND X3.ACEITO = 'NAO AVALIADO' AND X3.TEM_SIT_PONTO = 'SIM' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'SIM' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'SIM' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.79-GRAVAR: 1002-HORAS EXCEDENTES'
WHEN /*V.CODIGO <> '0009' AND*/ X3.SITUACAO_TRATADA = 'FOLGA' AND X3.TIPO_FOLGA = 'FERIADO' AND X3.ENTRADA = 1 AND X3.MARCACAO_E1 = 1 AND X3.ACEITO = 'NAO ABONADO' AND X3.TEM_SIT_PONTO = 'SIM' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'NAO' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.80-GRAVAR: 1003-FOLGA'
WHEN /*V.CODIGO <> '0009' AND*/ X3.SITUACAO_TRATADA = 'FOLGA' AND X3.TIPO_FOLGA = 'FERIADO' AND X3.ENTRADA = 1 AND X3.MARCACAO_E1 = 1 AND X3.ACEITO = 'NAO ABONADO' AND X3.TEM_SIT_PONTO = 'SIM' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'SIM' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'SIM' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.81-GRAVAR: 1002-HORAS EXCEDENTES'
WHEN /*V.CODIGO <> '0009' AND*/ X3.SITUACAO_TRATADA = 'FOLGA' AND X3.TIPO_FOLGA = 'FERIADO' AND X3.ENTRADA = 1 AND X3.MARCACAO_E1 = 0 AND X3.ACEITO = 'NAO AVALIADO' AND X3.TEM_SIT_PONTO = 'SIM' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'NAO' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.82-GRAVAR: 1003-FOLGA'
WHEN /*V.CODIGO <> '0009' AND*/ X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA = 'FERIADO' AND X3.ENTRADA = 0 AND X3.MARCACAO_E1 = 0 AND X3.ACEITO = 'NAO ABONADO' AND X3.TEM_SIT_PONTO = 'SIM' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'NAO' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'SIM' 
THEN 'A.83-GRAVAR: 0020-FALTA'
WHEN /*V.CODIGO <> '0009' AND*/ X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA = 'FERIADO' AND X3.ENTRADA = 1 AND X3.MARCACAO_E1 = 1 AND X3.ACEITO = 'NAO AVALIADO' AND X3.TEM_SIT_PONTO = 'NAO' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'NAO' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'SIM' 
THEN 'A.84-GRAVAR: 1001-HORAS DIFERENCIADAS'
WHEN /*V.CODIGO <> '0009' AND*/ X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA = 'FERIADO' AND X3.ENTRADA = 1 AND X3.MARCACAO_E1 = 1 AND X3.ACEITO = 'NAO AVALIADO' AND X3.TEM_SIT_PONTO = 'NAO' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'SIM' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'SIM' 
THEN 'A.85-FERIADO GRAVAR: 1000-HORAS NORMAIS E 1001-HORAS DIFERENCIADAS'
WHEN /*V.CODIGO <> '0009' AND*/ X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA = 'FERIADO' AND X3.ENTRADA = 1 AND X3.MARCACAO_E1 = 0 AND X3.ACEITO = 'ABONADO' AND X3.TEM_SIT_PONTO = 'SIM' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'SIM' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'SIM' 
THEN 'A.86-FERIADO GRAVAR: JUSTIFICATIVA E 1001- HORAS DIFERENCIADAS'
WHEN /*V.CODIGO <> '0009' AND*/ X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA = 'TRABALHANDO' AND X3.ENTRADA = 0 AND X3.MARCACAO_E1 = 1 AND X3.ACEITO = 'ABONADO' AND X3.TEM_SIT_PONTO = 'SIM' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'SIM' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.113-GRAVAR: 1000-HORAS NORMAIS'-- '********A.88- ERRO IFRACTAL AVISAR ASTIN E FAZER AJUSTE MANUAL'
WHEN /*V.CODIGO <> '0009' AND*/ X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA = 'FERIADO' AND X3.ENTRADA = 1 AND X3.MARCACAO_E1 = 1 AND X3.ACEITO = 'NAO AVALIADO' AND X3.TEM_SIT_PONTO = 'SIM' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'SIM' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'SIM' 
THEN 'A.89-FERIADO GRAVAR: 1000-HORAS NORMAIS E 1001-HORAS DIFERENCIADAS'
WHEN /*V.CODIGO <> '0009' AND*/ X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA = 'TRABALHANDO' AND X3.ENTRADA = 1 AND X3.MARCACAO_E1 = 0 AND X3.ACEITO = 'NAO AVALIADO' AND X3.TEM_SIT_PONTO = 'SIM' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'NAO' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'SIM' 
THEN 'A.90-GRAVAR: 0020 FALTA'  
WHEN /*V.CODIGO <> '0009' AND*/ X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA = 'TRABALHANDO' AND X3.ENTRADA = 1 AND X3.MARCACAO_E1 = 0 AND X3.ACEITO = 'ABONADO' AND X3.TEM_SIT_PONTO = 'SIM' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'SIM' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'SIM' 
THEN 'A.11-GRAVAR: Situação de Ponto da Justificativa'--'A.91-GRAVAR: 1000-HORAS NORMAIS E 1001-HORAS DIFERENCIADAS'  
WHEN /*V.CODIGO <> '0009' AND*/ X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA = 'TRABALHANDO' AND X3.ENTRADA = 1 AND X3.MARCACAO_E1 = 0 AND X3.ACEITO = 'ABONADO' AND X3.TEM_SIT_PONTO = 'SIM' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'SIM' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.11-GRAVAR: Situação de Ponto da Justificativa'--'A.92-GRAVAR: JUSTIFICATIVA' 
WHEN /*V.CODIGO <> '0009' AND*/ X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA = 'TRABALHANDO' AND X3.ENTRADA = 1 AND X3.MARCACAO_E1 = 0 AND X3.ACEITO = 'NAO AVALIADO' AND X3.TEM_SIT_PONTO = 'NAO' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'NAO' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.93-GRAVAR: 0020 FALTA'
WHEN /*V.CODIGO <> '0009' AND*/ X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA = 'TRABALHANDO' AND X3.ENTRADA = 1 AND X3.MARCACAO_E1 = 0 AND X3.ACEITO = 'NAO AVALIADO' AND X3.TEM_SIT_PONTO = 'NAO' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'NAO' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'SIM' 
THEN 'A.94-GRAVAR: 0020 FALTA' 

WHEN /*V.CODIGO <> '0009' AND*/ X3.SITUACAO_TRATADA = 'FOLGA' AND X3.TIPO_FOLGA = 'FERIADO' AND X3.ENTRADA = 1 AND X3.MARCACAO_E1 = 0 AND X3.ACEITO = 'NAO AVALIADO' AND X3.TEM_SIT_PONTO = 'NAO' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'NAO' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'SIM' 
THEN 'A.95-GRAVAR: 1003-FOLGA' 
WHEN /*V.CODIGO <> '0009' AND*/ X3.SITUACAO_TRATADA = 'FOLGA' AND X3.TIPO_FOLGA = 'FOLGA' AND X3.ENTRADA = 0 AND X3.MARCACAO_E1 = 0 AND X3.ACEITO = 'NAO AVALIADO' AND X3.TEM_SIT_PONTO = 'NAO' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'NAO' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.96-GRAVAR: 1003-FOLGA' 
WHEN /*V.CODIGO <> '0009' AND*/ X3.SITUACAO_TRATADA = 'FOLGA' AND X3.TIPO_FOLGA = 'FOLGA' AND X3.ENTRADA = 0 AND X3.MARCACAO_E1 = 1 AND X3.ACEITO = 'ABONADO' AND X3.TEM_SIT_PONTO = 'NAO' AND X3.TEM_PREVISTO = 'NAO' AND X3.TEM_H_NORMAIS = 'NAO' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.97-GRAVAR: 1002-HORAS EXCEDENTES' 
WHEN /*V.CODIGO <> '0009' AND*/ X3.SITUACAO_TRATADA = 'FOLGA' AND X3.TIPO_FOLGA = 'FOLGA' AND X3.ENTRADA = 0 AND X3.MARCACAO_E1 = 1 AND X3.ACEITO = 'ABONADO' AND X3.TEM_SIT_PONTO = 'SIM' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'SIM' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'SIM' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.98-GRAVAR: 1002-HORAS EXCEDENTES' 
WHEN /*V.CODIGO <> '0009' AND*/ X3.SITUACAO_TRATADA = 'FOLGA' AND X3.TIPO_FOLGA = 'FOLGA' AND X3.ENTRADA = 0 AND X3.MARCACAO_E1 = 1 AND X3.ACEITO = 'NAO AVALIADO' AND X3.TEM_SIT_PONTO = 'NAO' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'SIM' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'SIM' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.99-GRAVAR: 1002-HORAS EXCEDENTES'
WHEN /*V.CODIGO <> '0009' AND*/ X3.SITUACAO_TRATADA = 'FOLGA' AND X3.TIPO_FOLGA = 'FOLGA' AND X3.ENTRADA = 1 AND X3.MARCACAO_E1 = 0 AND X3.ACEITO = 'NAO ABONADO' AND X3.TEM_SIT_PONTO = 'SIM' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'NAO' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.100-GRAVAR: 1003-FOLGA'
WHEN /*V.CODIGO <> '0009' AND*/ X3.SITUACAO_TRATADA = 'FOLGA' AND X3.TIPO_FOLGA = 'FOLGA' AND X3.ENTRADA = 1 AND X3.MARCACAO_E1 = 1 AND X3.ACEITO = 'NAO ABONADO' AND X3.TEM_SIT_PONTO = 'SIM' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'SIM' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.101-GRAVAR: 1002-HORAS EXCEDENTES'
WHEN /*V.CODIGO <> '0009' AND*/ X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA = 'FERIADO' AND X3.ENTRADA = 0 AND X3.MARCACAO_E1 = 0 AND X3.ACEITO = 'ABONADO' AND X3.TEM_SIT_PONTO = 'SIM' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'SIM' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'SIM' 
THEN 'A.11-GRAVAR: Situação de Ponto da Justificativa'--'A.102-FERIADO COM JUSTIFICATIVA ABONADA GRAVAR: 1000-HORAS NORMAIS e 1001-HORAS DIFERENCIADAS'
WHEN /*V.CODIGO <> '0009' AND*/ X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA = 'FERIADO' AND X3.ENTRADA = 1 AND X3.MARCACAO_E1 = 0 AND X3.ACEITO = 'ABONADO' AND X3.TEM_SIT_PONTO = 'SIM' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'SIM' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.11-GRAVAR: Situação de Ponto da Justificativa'--'A.103-FERIADO GRAVAR: JUSTIFICATIVA E 1002- HORAS EXCEDENTES'
WHEN /*V.CODIGO <> '0009' AND*/ X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA = 'FERIADO' AND X3.ENTRADA = 1 AND X3.MARCACAO_E1 = 0 AND X3.ACEITO = 'NAO AVALIADO' AND X3.TEM_SIT_PONTO = 'NAO' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'NAO' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'SIM' 
THEN 'A.109-GRAVAR: 0020 FALTA'
WHEN /*V.CODIGO <> '0009' AND*/ X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA = 'FERIADO' AND X3.ENTRADA = 1 AND X3.MARCACAO_E1 = 1 AND X3.ACEITO = 'ABONADO' AND X3.TEM_SIT_PONTO = 'SIM' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'SIM' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'SIM' 
THEN 'A.11-GRAVAR: Situação de Ponto da Justificativa'--'A.104-FERIADO COM JUSTIFICATIVA ABONADA GRAVAR: 1000-HORAS NORMAIS e 1001-HORAS DIFERENCIADAS'
WHEN /*V.CODIGO <> '0009' AND*/ X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA = 'FERIADO' AND X3.ENTRADA = 1 AND X3.MARCACAO_E1 = 1 AND X3.ACEITO = 'NAO ABONADO' AND X3.TEM_SIT_PONTO = 'SIM' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'SIM' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.11-GRAVAR: Situação de Ponto da Justificativa'--'A.105-FERIADO COM JUSTIFICATIVA ABONADA GRAVAR: 1000-HORAS NORMAIS'
WHEN /*V.CODIGO <> '0009' AND*/ X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA = 'FERIADO' AND X3.ENTRADA = 1 AND X3.MARCACAO_E1 = 1 AND X3.ACEITO = 'NAO AVALIADO' AND X3.TEM_SIT_PONTO = 'NAO' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'NAO' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.106-GRAVAR: 1003-FOLGA'
WHEN /*V.CODIGO <> '0009' AND*/ X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA = 'FERIADO' AND X3.ENTRADA = 1 AND X3.MARCACAO_E1 = 1 AND X3.ACEITO = 'NAO ABONADO' AND X3.TEM_SIT_PONTO = 'SIM' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'SIM' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'SIM' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.11-GRAVAR: Situação de Ponto da Justificativa'--'A.107-FERIADO COM JUSTIFICATIVA ABONADA GRAVAR: 1000-HORAS NORMAIS+1002-EXEDIDAS'
WHEN /*V.CODIGO <> '0009' AND*/ X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA = 'FERIADO' AND X3.ENTRADA = 1 AND X3.MARCACAO_E1 = 1 AND X3.ACEITO = 'NAO AVALIADO' AND X3.TEM_SIT_PONTO = 'SIM' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'SIM' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'SIM' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.108-FERIADO GRAVAR: 1000-HORAS NORMAIS E 1002-HORAS EXCEDIDAS'
WHEN /*V.CODIGO <> '0009' AND*/ X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA = 'TRABALHANDO' AND X3.ENTRADA = 0 AND X3.MARCACAO_E1 = 1 AND X3.ACEITO = 'NAO AVALIADO' AND X3.TEM_SIT_PONTO = 'NAO' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'SIM' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'SIM' 
THEN 'A.110- GRAVAR: 1000-HORAS NORMAIS + 1001-HORAS DIFERENCIADAS'
WHEN /*V.CODIGO <> '0009' AND*/ X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA = 'TRABALHANDO' AND X3.ENTRADA = 1 AND X3.MARCACAO_E1 = 0 AND X3.ACEITO = 'NAO ABONADO' AND X3.TEM_SIT_PONTO = 'SIM' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'NAO' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'SIM' 
THEN 'A.111-GRAVAR: 0020 FALTA'

WHEN /*V.CODIGO <> '0009' AND*/ X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA = 'TRABALHANDO' AND X3.ENTRADA = 0 AND X3.MARCACAO_E1 = 1 AND X3.ACEITO = 'NAO AVALIADO' AND X3.TEM_SIT_PONTO = 'NAO' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'SIM' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'SIM' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.112-FERIADO GRAVAR: 1000-HORAS NORMAIS E 1002-HORAS EXCEDIDAS'
WHEN /*V.CODIGO <> '0009' AND*/ X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA = 'FERIADO' AND X3.ENTRADA = 0 AND X3.MARCACAO_E1 = 1 AND X3.ACEITO = 'NAO AVALIADO' AND X3.TEM_SIT_PONTO = 'NAO' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'NAO' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.115-GRAVAR: 1001-HORAS DIFERENCIADAS'

WHEN /* V.CODIGO <> '0009' AND */X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA = 'TRABALHANDO' AND X3.ENTRADA = 0 AND X3.MARCACAO_E1 = 1 AND X3.ACEITO = 'ABONADO' AND X3.TEM_SIT_PONTO = 'SIM' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'SIM' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'SIM' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.15-?Gravar no dia a Situacao de Ponto da Justificativa + horas excedidas?'

WHEN /*V.CODIGO <> '0009' AND*/ X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA = 'TRABALHANDO' AND X3.ENTRADA = 0 AND X3.MARCACAO_E1 = 1 AND X3.ACEITO = 'NAO AVALIADO' AND X3.TEM_SIT_PONTO = 'NAO' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'NAO' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'SIM' 
THEN 'A.114-GRAVAR: 1001-HORAS DIFERENCIADAS'
WHEN /* V.CODIGO <> '0009' AND */X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA = 'TRABALHANDO' AND X3.ENTRADA = 0 AND X3.MARCACAO_E1 = 1 AND X3.ACEITO = 'NAO AVALIADO' AND X3.TEM_SIT_PONTO = 'NAO' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'SIM' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.116-GRAVAR: 1000-HORAS NORMAIS'
WHEN /*V.CODIGO <> '0009' AND*/ X3.SITUACAO_TRATADA = 'FOLGA' AND X3.TIPO_FOLGA = 'FOLGA' AND X3.ENTRADA = 0 AND X3.MARCACAO_E1 = 1 AND X3.ACEITO = 'NAO AVALIADO' AND X3.TEM_SIT_PONTO = 'NAO' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'NAO' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.117-GRAVAR: 1003-FOLGA'
WHEN /*V.CODIGO <> '0009' AND*/ X3.SITUACAO_TRATADA = 'FOLGA' AND X3.TIPO_FOLGA = 'FERIADO' AND X3.ENTRADA = 1 AND X3.MARCACAO_E1 = 1 AND X3.ACEITO = 'ABONADO' AND X3.TEM_SIT_PONTO = 'SIM' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'NAO' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.118-DIA DESCANSO COM MARCACAO E JUSTIFICATIVA ABONADA GRAVAR: 1002-HORAS EXCEDIDAS'

WHEN /*V.CODIGO <> '0009' AND*/ X3.SITUACAO_TRATADA = 'FOLGA' AND X3.TIPO_FOLGA = 'FERIADO' AND X3.ENTRADA = 0 AND X3.MARCACAO_E1 = 1 AND X3.ACEITO = 'ABONADO' AND X3.TEM_SIT_PONTO = 'SIM' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'SIM' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'SIM' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.119-GRAVAR: 1002-HORAS EXCEDENTES'
WHEN /*V.CODIGO <> '0009' AND*/ X3.SITUACAO_TRATADA = 'FOLGA' AND X3.TIPO_FOLGA = 'FERIADO' AND X3.ENTRADA = 1 AND X3.MARCACAO_E1 = 0 AND X3.ACEITO = 'ABONADO' AND X3.TEM_SIT_PONTO = 'SIM' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'SIM' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'SIM' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.120-GRAVAR: 1002-HORAS EXCEDENTES'
WHEN /*V.CODIGO <> '0009' AND*/ X3.SITUACAO_TRATADA = 'FOLGA' AND X3.TIPO_FOLGA = 'FERIADO' AND X3.ENTRADA = 1 AND X3.MARCACAO_E1 = 0 AND X3.ACEITO = 'NAO AVALIADO' AND X3.TEM_SIT_PONTO = 'NAO' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'NAO' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.121-GRAVAR: 1003-FOLGA'
WHEN /*V.CODIGO <> '0009' AND*/ X3.SITUACAO_TRATADA = 'FOLGA' AND X3.TIPO_FOLGA = 'FOLGA' AND X3.ENTRADA = 0 AND X3.MARCACAO_E1 = 0 AND X3.ACEITO = 'ABONADO' AND X3.TEM_SIT_PONTO = 'SIM' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'NAO' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'SIM' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.122-GRAVAR: 1002-HORAS EXCEDENTES'
WHEN /*V.CODIGO <> '0009' AND*/ X3.SITUACAO_TRATADA = 'FOLGA' AND X3.TIPO_FOLGA = 'FOLGA' AND X3.ENTRADA = 0 AND X3.MARCACAO_E1 = 1 AND X3.ACEITO = 'NAO ABONADO' AND X3.TEM_SIT_PONTO = 'SIM' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'NAO' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.123-GRAVAR: 1003-FOLGA'
WHEN /*V.CODIGO <> '0009' AND*/ X3.SITUACAO_TRATADA = 'FOLGA' AND X3.TIPO_FOLGA = 'FOLGA' AND X3.ENTRADA = 1 AND X3.MARCACAO_E1 = 0 AND X3.ACEITO = 'ABONADO' AND X3.TEM_SIT_PONTO = 'SIM' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'SIM' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.124-GRAVAR: 1002-HORAS EXCEDENTES'
WHEN /*V.CODIGO <> '0009' AND*/ X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA = 'FERIADO' AND X3.ENTRADA = 0 AND X3.MARCACAO_E1 = 0 AND X3.ACEITO = 'ABONADO' AND X3.TEM_SIT_PONTO = 'NAO' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'SIM' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.125-GRAVAR: 0020-FALTA'
WHEN /*V.CODIGO <> '0009' AND*/ X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA = 'FERIADO' AND X3.ENTRADA = 0 AND X3.MARCACAO_E1 = 0 AND X3.ACEITO = 'ABONADO' AND X3.TEM_SIT_PONTO = 'NAO' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'SIM' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'SIM' 
THEN 'A.126-GRAVAR: 0020-FALTA'
WHEN /*V.CODIGO <> '0009' AND*/ X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA = 'FERIADO' AND X3.ENTRADA = 0 AND X3.MARCACAO_E1 = 1 AND X3.ACEITO = 'NAO AVALIADO' AND X3.TEM_SIT_PONTO = 'NAO' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'SIM' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.127-GRAVAR: 1000-HORAS NORMAIS'
WHEN /*V.CODIGO <> '0009' AND*/ X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA = 'FERIADO' AND X3.ENTRADA = 0 AND X3.MARCACAO_E1 = 1 AND X3.ACEITO = 'NAO AVALIADO' AND X3.TEM_SIT_PONTO = 'NAO' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'SIM' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'SIM' 
THEN 'A.128-FERIADO GRAVAR: 1000-HORAS NORMAIS E 1001-HORAS DIFERENCIADAS'
WHEN /*V.CODIGO <> '0009' AND*/ X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA = 'FERIADO' AND X3.ENTRADA = 0 AND X3.MARCACAO_E1 = 1 AND X3.ACEITO = 'NAO AVALIADO' AND X3.TEM_SIT_PONTO = 'NAO' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'SIM' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'SIM' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.129-FERIADO GRAVAR: 1000-HORAS NORMAIS E 1002-HORAS EXCEDIDAS'
WHEN /*V.CODIGO <> '0009' AND*/ X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA = 'FERIADO' AND X3.ENTRADA = 1 AND X3.MARCACAO_E1 = 1 AND X3.ACEITO = 'NAO ABONADO' AND X3.TEM_SIT_PONTO = 'SIM' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'NAO' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'SIM' 
THEN 'A.130-GRAVAR: 1001-HORAS DIFERENCIADAS'
WHEN /*V.CODIGO <> '0009' AND*/ X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA = 'FERIADO' AND X3.ENTRADA = 1 AND X3.MARCACAO_E1 = 1 AND X3.ACEITO = 'NAO AVALIADO' AND X3.TEM_SIT_PONTO = 'SIM' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'NAO' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'SIM' 
THEN 'A.131-GRAVAR: 1001-HORAS DIFERENCIADAS'

WHEN /* V.CODIGO <> '0009' AND */X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA = 'TRABALHANDO' AND X3.ENTRADA = 1 AND X3.MARCACAO_E1 = 0 AND X3.ACEITO = 'ABONADO' AND X3.TEM_SIT_PONTO = 'SIM' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'SIM' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'SIM' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.15-?Gravar no dia a Situacao de Ponto da Justificativa + horas excedidas?'

WHEN /*V.CODIGO <> '0009' AND*/ X3.SITUACAO_TRATADA = 'FOLGA' AND X3.TIPO_FOLGA = 'FOLGA' AND X3.ENTRADA = 1 AND X3.MARCACAO_E1 = 1 AND X3.ACEITO = 'ABONADO' AND X3.TEM_SIT_PONTO = 'NAO' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'SIM' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'SIM' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.132-GRAVAR: 1002-HORAS EXCEDENTES'
WHEN /*V.CODIGO <> '0009' AND*/ X3.SITUACAO_TRATADA = 'FOLGA' AND X3.TIPO_FOLGA = 'PONTO_FACULTATIVO' AND X3.ENTRADA = 1 AND X3.MARCACAO_E1 = 0 AND X3.ACEITO = 'NAO AVALIADO' AND X3.TEM_SIT_PONTO = 'NAO' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'NAO' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.133-GRAVAR: 1003-FOLGA'
WHEN /*V.CODIGO <> '0009' AND*/ X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA = 'PONTO_FACULTATIVO' AND X3.ENTRADA = 0 AND X3.MARCACAO_E1 = 0 AND X3.ACEITO = 'ABONADO' AND X3.TEM_SIT_PONTO = 'SIM' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'SIM' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'SIM' 
THEN 'A.134-PONTO_FACULTATIVO GRAVAR: 1000-HORAS NORMAIS E 1001-HORAS DIFERENCIADAS'
WHEN /*V.CODIGO <> '0009' AND*/ X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA = 'PONTO_FACULTATIVO' AND X3.ENTRADA = 0 AND X3.MARCACAO_E1 = 0 AND X3.ACEITO = 'NAO AVALIADO' AND X3.TEM_SIT_PONTO = 'NAO' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'NAO' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'SIM' 
THEN 'A.135-GRAVAR: 0020-FALTA'
WHEN /*V.CODIGO <> '0009' AND*/ X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA = 'PONTO_FACULTATIVO' AND X3.ENTRADA = 0 AND X3.MARCACAO_E1 = 0 AND X3.ACEITO = 'NAO AVALIADO' AND X3.TEM_SIT_PONTO = 'SIM' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'NAO' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'SIM' 
THEN 'A.136-GRAVAR: 0020-FALTA'
WHEN /*V.CODIGO <> '0009' AND*/ X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA = 'PONTO_FACULTATIVO' AND X3.ENTRADA = 1 AND X3.MARCACAO_E1 = 1 AND X3.ACEITO = 'NAO AVALIADO' AND X3.TEM_SIT_PONTO = 'NAO' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'SIM' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'SIM' 
THEN 'A.137-PONTO_FACULTATIVO GRAVAR: 1000-HORAS NORMAIS E 1002-HORAS EXCEDIDAS'--ESTRANHO O VALOR ESTA COMO DESCONTO MAS NO ESPELHO SER EXECEDIDAS

WHEN /*V.CODIGO <> '0009' AND*/ X3.SITUACAO_TRATADA = 'FOLGA' AND X3.TIPO_FOLGA = 'FOLGA' AND X3.ENTRADA = 0 AND X3.MARCACAO_E1 = 0 AND X3.ACEITO = 'ABONADO' AND X3.TEM_SIT_PONTO = 'NAO' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'SIM' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'SIM' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.138-GRAVAR: 1002-HORAS EXCEDENTES'
WHEN /*V.CODIGO <> '0009' AND*/ X3.SITUACAO_TRATADA = 'FOLGA' AND X3.TIPO_FOLGA = 'FOLGA' AND X3.ENTRADA = 0 AND X3.MARCACAO_E1 = 1 AND X3.ACEITO = 'ABONADO' AND X3.TEM_SIT_PONTO = 'NAO' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'SIM' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'SIM' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.139-GRAVAR: 1002-HORAS EXCEDENTES'
WHEN /*V.CODIGO <> '0009' AND*/ X3.SITUACAO_TRATADA = 'FOLGA' AND X3.TIPO_FOLGA = 'FOLGA' AND X3.ENTRADA = 1 AND X3.MARCACAO_E1 = 0 AND X3.ACEITO = 'ABONADO' AND X3.TEM_SIT_PONTO = 'NAO' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'NAO' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.140-GRAVA FOLGA'
WHEN /*V.CODIGO <> '0009' AND*/ X3.SITUACAO_TRATADA = 'FOLGA' AND X3.TIPO_FOLGA = 'FOLGA' AND X3.ENTRADA = 1 AND X3.MARCACAO_E1 = 1 AND X3.ACEITO = 'ABONADO' AND X3.TEM_SIT_PONTO = 'NAO' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'SIM' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.141-GRAVAR: 1002-HORAS EXCEDENTES'
WHEN /*V.CODIGO <> '0009' AND*/ X3.SITUACAO_TRATADA = 'FOLGA' AND X3.TIPO_FOLGA = 'FOLGA' AND X3.ENTRADA = 1 AND X3.MARCACAO_E1 = 0 AND X3.ACEITO = 'ABONADO' AND X3.TEM_SIT_PONTO = 'SIM' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'NAO' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.142-GRAVA FOLGA'
WHEN /*V.CODIGO <> '0009' AND*/ X3.SITUACAO_TRATADA = 'FOLGA' AND X3.TIPO_FOLGA = 'PONTO_FACULTATIVO' AND X3.ENTRADA = 0 AND X3.MARCACAO_E1 = 0 AND X3.ACEITO = 'NAO AVALIADO' AND X3.TEM_SIT_PONTO = 'SIM' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'NAO' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.143-GRAVAR: 1003-FOLGA'
WHEN /*V.CODIGO <> '0009' AND*/ X3.SITUACAO_TRATADA = 'FOLGA' AND X3.TIPO_FOLGA = 'PONTO_FACULTATIVO' AND X3.ENTRADA = 1 AND X3.MARCACAO_E1 = 1 AND X3.ACEITO = 'NAO ABONADO' AND X3.TEM_SIT_PONTO = 'SIM' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'SIM' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'SIM' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.144-GRAVAR: 1002-HORAS EXCEDENTES'
WHEN /*V.CODIGO <> '0009' AND*/ X3.SITUACAO_TRATADA = 'FOLGA' AND X3.TIPO_FOLGA = 'PONTO_FACULTATIVO' AND X3.ENTRADA = 1 AND X3.MARCACAO_E1 = 1 AND X3.ACEITO = 'NAO AVALIADO' AND X3.TEM_SIT_PONTO = 'NAO' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'NAO' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.145-GRAVAR: 1003-FOLGA'
WHEN /*V.CODIGO <> '0009' AND*/ X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA = 'FERIADO' AND X3.ENTRADA = 0 AND X3.MARCACAO_E1 = 1 AND X3.ACEITO = 'ABONADO' AND X3.TEM_SIT_PONTO = 'SIM' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'SIM' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'SIM' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.11-GRAVAR: Situação de Ponto da Justificativa'--'A.146-FERIADO GRAVAR: 1000-HORAS NORMAIS E 1002-HORAS EXCEDIDAS'
WHEN /*V.CODIGO <> '0009' AND*/ X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA = 'FERIADO' AND X3.ENTRADA = 1 AND X3.MARCACAO_E1 = 1 AND X3.ACEITO = 'ABONADO' AND X3.TEM_SIT_PONTO = 'NAO' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'SIM' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.147-GRAVAR: 1000-HORAS NORMAIS'
WHEN /*V.CODIGO <> '0009' AND*/ X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA = 'PONTO_FACULTATIVO' AND X3.ENTRADA = 0 AND X3.MARCACAO_E1 = 0 AND X3.ACEITO = 'NAO ABONADO' AND X3.TEM_SIT_PONTO = 'SIM' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'NAO' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'SIM' 
THEN 'A.148-GRAVAR: 0020-FALTA'
WHEN /*V.CODIGO <> '0009' AND*/ X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA = 'PONTO_FACULTATIVO' AND X3.ENTRADA = 0 AND X3.MARCACAO_E1 = 1 AND X3.ACEITO = 'NAO AVALIADO' AND X3.TEM_SIT_PONTO = 'NAO' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'SIM' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'SIM' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.149-PONTO_FACULTATIVO GRAVAR: 1000-HORAS NORMAIS E 1002-HORAS EXCEDIDAS'
WHEN /*V.CODIGO <> '0009' AND*/ X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA = 'PONTO_FACULTATIVO' AND X3.ENTRADA = 1 AND X3.MARCACAO_E1 = 0 AND X3.ACEITO = 'ABONADO' AND X3.TEM_SIT_PONTO = 'SIM' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'SIM' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.11-GRAVAR: Situação de Ponto da Justificativa'--A.150-GRAVAR: JUSTIFICATIVA'
WHEN /*V.CODIGO <> '0009' AND*/ X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA = 'PONTO_FACULTATIVO' AND X3.ENTRADA = 1 AND X3.MARCACAO_E1 = 0 AND X3.ACEITO = 'NAO AVALIADO' AND X3.TEM_SIT_PONTO = 'NAO' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'NAO' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'SIM' 
THEN 'A.151-GRAVAR: 0020-FALTA'
WHEN /*V.CODIGO <> '0009' AND*/ X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA = 'PONTO_FACULTATIVO' AND X3.ENTRADA = 1 AND X3.MARCACAO_E1 = 1 AND X3.ACEITO = 'NAO AVALIADO' AND X3.TEM_SIT_PONTO = 'NAO' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'NAO' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'SIM' 
THEN 'A.152-GRAVAR: 0020-FALTA'
WHEN /*V.CODIGO <> '0009' AND*/ X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA = 'TRABALHANDO' AND X3.ENTRADA = 1 AND X3.MARCACAO_E1 = 1 AND X3.ACEITO = 'ABONADO' AND X3.TEM_SIT_PONTO = 'NAO' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'NAO' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'SIM' 
THEN 'A.153-GRAVAR: 0020-FALTA'
WHEN /*V.CODIGO <> '0009' AND*/ X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA = 'TRABALHANDO' AND X3.ENTRADA = 0 AND X3.MARCACAO_E1 = 0 AND X3.ACEITO = 'ABONADO' AND X3.TEM_SIT_PONTO = 'NAO' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'SIM' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.154-GRAVAR: 1000-HORAS NORMAIS'
WHEN /*V.CODIGO <> '0009' AND*/ X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA = 'TRABALHANDO' AND X3.ENTRADA = 0 AND X3.MARCACAO_E1 = 0 AND X3.ACEITO = 'ABONADO' AND X3.TEM_SIT_PONTO = 'NAO' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'SIM' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'SIM' 
THEN 'A.155-GRAVAR: 1000-HORAS NORMAIS E 1001-HORAS DIFERENCIADAS'
WHEN /*V.CODIGO <> '0009' AND*/ X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA = 'TRABALHANDO' AND X3.ENTRADA = 0 AND X3.MARCACAO_E1 = 0 AND X3.ACEITO = 'ABONADO' AND X3.TEM_SIT_PONTO = 'NAO' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'SIM' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'SIM' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'NAO' 
THEN 'A.156-GRAVAR: 1000-HORAS NORMAIS E 1002-HORAS EXCEDENTES'
WHEN /*V.CODIGO <> '0009' AND*/ X3.SITUACAO_TRATADA = 'TRABALHANDO' AND X3.TIPO_FOLGA = 'TRABALHANDO' AND X3.ENTRADA = 1 AND X3.MARCACAO_E1 = 1 AND X3.ACEITO = 'ABONADO' AND X3.TEM_SIT_PONTO = 'NAO' AND X3.TEM_PREVISTO = 'SIM' AND X3.TEM_H_NORMAIS = 'SIM' AND X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL = 'NAO' AND X3.TEM_DESC_DIA_INFO_SEM_MENSAL = 'SIM' 
THEN 'A.157-GRAVAR: 1000-HORAS NORMAIS E 1001-HORAS DIFERENCIADAS'

ELSE '**********************NÃO MAPEADO AINDA'
END O_QUE_FAZER,
V.CODIGO COD_VINCULO, V.DESCRICAO VINCULO,
RG_TRAB.CONTEUDO_INICIAL COD_RG_TRAB, RG_TRAB.DESCR_IT_DOMINIO RG_TRAB,
RG_PREV.CONTEUDO_INICIAL COD_RG_PREV, RG_PREV.DESCR_IT_DOMINIO RG_PREV,
COD_CATEG.CONTEUDO_INICIAL COD_TIPO_TRAB, COD_CATEG.DESCR_IT_DOMINIO TIPO_TRAB,
c.cod_cargo_efetivo,
CASE WHEN CC.c_livre_selec01 = 0 THEN 'NAO' ELSE 'SIM' END FOLHA_ESPECIAL, C.registro_ponto, SP.tipo_referencia,
X3.PREVISTO_F,
CASE WHEN X3.H_NORMAIS_F IS NOT NULL AND X3.H_NORMAIS_F <> 0 AND X3.H_NORMAIS_F > 24 AND X3.PREVISTO_F IS NOT NULL THEN X3.PREVISTO_F
WHEN X3.H_NORMAIS_F IS NULL THEN 0
ELSE X3.H_NORMAIS_F END H_NORMAIS_F, --NOVO 17/7/20 CORRIGI EXCESSOS NO ULTIMO DIA
CASE WHEN X3.HORAS_ABONADA_F IS NOT NULL AND X3.HORAS_ABONADA_F <> 0 AND X3.HORAS_ABONADA_F > 24 AND X3.PREVISTO_F IS NOT NULL THEN X3.PREVISTO_F 
WHEN X3.HORAS_ABONADA_F IS NULL THEN 0 
ELSE X3.HORAS_ABONADA_F END HORAS_ABONADA_F, --NOVO 17/7/20 CORRIGI EXCESSOS NO ULTIMO DIA
X3.TEM_SIT_PONTO,  X3.TEM_PREVISTO,  X3.TEM_PREVISTO_TRATADO,  X3.TEM_H_NORMAIS,  X3.TEM_DESCONTO_ABONADO,  X3.TEM_HORAS_ABONADA,  X3.TEM_DESCONTO,  X3.TEM_H_EXTRA,  X3.TEM_H_EXTRA_FERIADO,  X3.TEM_H_NOTURNA,  X3.TEM_COMPENSADO,  X3.TEM_FALTA_COMPENSAR,  X3.TEM_ATRASO,  X3.TEM_SAIDA_ANTECIPADA,  X3.TEM_H_EXTRA_NOTURNA,  X3.TEM_H_INTRA_JORNADA,  X3.TEM_DESCONTO_AUX,  X3.TEM_INTERJORNADA,  X3.TEM_BH_CREDITO,  X3.TEM_BH_DEBITO,  X3.TEM_DESCONTO_TOLERADO,  X3.TEM_INTERVALO_A_MENOR,  X3.TEM_ENTRADA_ANTECIPADA,  X3.TEM_MULTA_INTERJORNADA,  X3.TEM_EXTRA_DIA_INFO_SEM_MENSAL,  X3.TEM_DESC_DIA_INFO_SEM_MENSAL,  
X3.EMPRESA,  X3.TIPO_CONTRATO,  X3.MATRICULA,  X3.CODIGO,  X3.DATA,  X3.SITUACAO,  X3.SITUACAO_TRATADA,  X3.TIPO_FOLGA,  X3.ENTRADA,  X3.MARCACAO_E1,  X3.ACEITO,  X3.SIT_PONTO,  X3.PREVISTO,  X3.PREVISTO_TRATADO,  X3.H_NORMAIS,  X3.DESCONTO_ABONADO,  X3.HORAS_ABONADA,  X3.HORAS_MARCACOES,  X3.DESCONTO,  X3.H_EXTRA,  X3.H_EXTRA_FERIADO,  X3.H_NOTURNA,  X3.COMPENSADO,  X3.FALTA_COMPENSAR,  X3.ATRASO,  X3.SAIDA_ANTECIPADA,  X3.H_EXTRA_NOTURNA,  X3.H_INTRA_JORNADA,  X3.DESCONTO_AUX,  X3.INTERJORNADA,  X3.BH_CREDITO,  X3.BH_DEBITO,  X3.DESCONTO_TOLERADO,  X3.INTERVALO_A_MENOR,  X3.ENTRADA_ANTECIPADA,  X3.MULTA_INTERJORNADA,  X3.EXTRA_DIA_INFO_SEM_MENSAL,  X3.DESCONTO_DIA_INFO_SEM_MENSAL,  X3.DTCADASTRO,  X3.COD_PESSOA,  X3.COD_JUSTIFICATIVA_PONTO,  X3.COD_PONTO_FECHAMENTO,  X3.COD_BANCO_HORAS,  X3.COD_CARGO,  X3.COD_UNIDADE,  X3.COD_HORARIO,  X3.COD_ESCALA_PADRAO,  X3.CAMPO_LIVRE,  X3.MARCACAO1,  X3.MARCACAO2,  X3.MARCACAO3,  X3.MARCACAO4,  X3.MARCACAO5,  X3.MARCACAO6,  X3.MARCACAO7,  X3.MARCACAO8,  X3.MARCACAO9,  X3.MARCACAO10,  X3.MARCACAO11,  X3.MARCACAO12,  X3.MARCACAO_E2,  X3.MARCACAO_E3,  X3.MARCACAO_E4,  X3.MARCACAO_E5,  X3.MARCACAO_E6,  X3.MARCACAO_E7,  X3.MARCACAO_E8,  X3.MARCACAO_E9,  X3.MARCACAO_E10,  X3.MARCACAO_E11,  X3.MARCACAO_E12,  X3.MARCACAO1_ALTERADA,  X3.MARCACAO2_ALTERADA,  X3.MARCACAO3_ALTERADA,  X3.MARCACAO4_ALTERADA,  X3.MARCACAO5_ALTERADA,  X3.MARCACAO6_ALTERADA,  X3.MARCACAO7_ALTERADA,  X3.MARCACAO8_ALTERADA,  X3.MARCACAO9_ALTERADA,  X3.MARCACAO10_ALTERADA,  X3.MARCACAO11_ALTERADA,  X3.MARCACAO12_ALTERADA,  X3.OBS_MARCACAO_ALTERADA,  X3.BANCO_HORAS,  X3.TIPO_BANCO_HORAS,  X3.OBS,  X3.BIT_DIVERGENCIA,  X3.COD_COMPENSACAO,  X3.MULTIPLICADOR_BANCO_HORAS,  X3.NA009,  X3.DTJUSTIFICATIVA,  X3.LOGIN_JUSTIFICATIVA,  X3.DTAVALIADOR,  X3.LOGIN_AVALIADOR,  X3.DTALTERACAO,  X3.LOGIN_ALTERACAO,  X3.FOTO,  X3.SOBREAVISO_DOBRA,  X3.COD_JUSTIFICATIVA_BANCO_HORAS,  X3.DESCRICAO_BANCO_HORAS,  X3.COMPROVANTE_JUSTIFICATIVA,  X3.RELATORIO_RH_VALIDADO,  X3.TOTAIS
,X3.AGRUPADOR
FROM (
SELECT 
CASE WHEN X2.SIT_PONTO IS NULL OR X2.SIT_PONTO = '0' THEN 'NAO' ELSE 'SIM' END TEM_SIT_PONTO
,CASE WHEN X2.PREVISTO IS NULL OR X2.PREVISTO  = 0 THEN 'NAO' ELSE 'SIM' END TEM_PREVISTO
,CASE WHEN X2.PREVISTO_TRATADO IS NULL OR X2.PREVISTO_TRATADO = 0 THEN 'NAO' ELSE 'SIM' END TEM_PREVISTO_TRATADO
,CASE WHEN X2.H_NORMAIS IS NULL OR X2.H_NORMAIS  = 0 THEN 'NAO' ELSE 'SIM' END TEM_H_NORMAIS
,CASE WHEN X2.DESCONTO_ABONADO IS NULL OR X2.DESCONTO_ABONADO = 0 THEN 'NAO' ELSE 'SIM' END TEM_DESCONTO_ABONADO
,CASE WHEN X2.HORAS_ABONADA IS NULL OR X2.HORAS_ABONADA = 0 THEN 'NAO' ELSE 'SIM' END TEM_HORAS_ABONADA
,CASE WHEN X2.DESCONTO IS NULL OR X2.DESCONTO = 0 THEN 'NAO' ELSE 'SIM' END TEM_DESCONTO
,CASE WHEN X2.H_EXTRA IS NULL OR X2.H_EXTRA = 0 THEN 'NAO' ELSE 'SIM' END TEM_H_EXTRA
,CASE WHEN X2.H_EXTRA_FERIADO IS NULL OR X2.H_EXTRA_FERIADO = 0 THEN 'NAO' ELSE 'SIM' END TEM_H_EXTRA_FERIADO
,CASE WHEN X2.H_NOTURNA IS NULL OR X2.H_NOTURNA = 0 THEN 'NAO' ELSE 'SIM' END TEM_H_NOTURNA
,CASE WHEN X2.COMPENSADO IS NULL OR X2.COMPENSADO = 0 THEN 'NAO' ELSE 'SIM' END TEM_COMPENSADO
,CASE WHEN X2.FALTA_COMPENSAR IS NULL OR X2.FALTA_COMPENSAR = 0 THEN 'NAO' ELSE 'SIM' END TEM_FALTA_COMPENSAR
,CASE WHEN X2.ATRASO IS NULL OR X2.ATRASO = 0 THEN 'NAO' ELSE 'SIM' END TEM_ATRASO
,CASE WHEN X2.SAIDA_ANTECIPADA IS NULL OR X2.SAIDA_ANTECIPADA = 0 THEN 'NAO' ELSE 'SIM' END TEM_SAIDA_ANTECIPADA
,CASE WHEN X2.H_EXTRA_NOTURNA IS NULL OR X2.H_EXTRA_NOTURNA = 0 THEN 'NAO' ELSE 'SIM' END TEM_H_EXTRA_NOTURNA
,CASE WHEN X2.H_INTRA_JORNADA IS NULL OR X2.H_INTRA_JORNADA = 0 THEN 'NAO' ELSE 'SIM' END TEM_H_INTRA_JORNADA
,CASE WHEN X2.DESCONTO_AUX IS NULL OR X2.DESCONTO_AUX = 0 THEN 'NAO' ELSE 'SIM' END TEM_DESCONTO_AUX
,CASE WHEN X2.INTERJORNADA IS NULL OR X2.INTERJORNADA = 0 THEN 'NAO' ELSE 'SIM' END TEM_INTERJORNADA
,CASE WHEN X2.BH_CREDITO IS NULL OR X2.BH_CREDITO = 0 THEN 'NAO' ELSE 'SIM' END TEM_BH_CREDITO
,CASE WHEN X2.BH_DEBITO IS NULL OR X2.BH_DEBITO = 0 THEN 'NAO' ELSE 'SIM' END TEM_BH_DEBITO
,CASE WHEN X2.DESCONTO_TOLERADO IS NULL OR X2.DESCONTO_TOLERADO = 0 THEN 'NAO' ELSE 'SIM' END TEM_DESCONTO_TOLERADO
,CASE WHEN X2.INTERVALO_A_MENOR IS NULL OR X2.INTERVALO_A_MENOR = 0 THEN 'NAO' ELSE 'SIM' END TEM_INTERVALO_A_MENOR
,CASE WHEN X2.ENTRADA_ANTECIPADA IS NULL OR X2.ENTRADA_ANTECIPADA  = 0 THEN 'NAO' ELSE 'SIM' END TEM_ENTRADA_ANTECIPADA
,CASE WHEN X2.MULTA_INTERJORNADA IS NULL OR X2.MULTA_INTERJORNADA = 0 THEN 'NAO' ELSE 'SIM' END TEM_MULTA_INTERJORNADA
,CASE WHEN X2.EXTRA_DIA_INFO_SEM_MENSAL IS NULL OR X2.EXTRA_DIA_INFO_SEM_MENSAL = 0 THEN 'NAO' ELSE 'SIM' END TEM_EXTRA_DIA_INFO_SEM_MENSAL
,CASE WHEN X2.DESCONTO_DIA_INFO_SEM_MENSAL IS NULL OR X2.DESCONTO_DIA_INFO_SEM_MENSAL = 0 THEN 'NAO' ELSE 'SIM' END TEM_DESC_DIA_INFO_SEM_MENSAL
,X2.H_NORMAIS_F,  X2.HORAS_ABONADA_F,  X2.PREVISTO_F,  
X2.EMPRESA,  X2.TIPO_CONTRATO,  X2.MATRICULA,  X2.CODIGO,  X2.DATA,  X2.SITUACAO,  X2.SITUACAO_TRATADA,  X2.TIPO_FOLGA,  X2.ENTRADA,  X2.MARCACAO_E1,  X2.ACEITO,  X2.SIT_PONTO,  X2.PREVISTO,  X2.PREVISTO_TRATADO,  X2.H_NORMAIS,  X2.DESCONTO_ABONADO,  X2.HORAS_ABONADA,  X2.HORAS_MARCACOES,  X2.DESCONTO,  X2.H_EXTRA,  X2.H_EXTRA_FERIADO,  X2.H_NOTURNA,  X2.COMPENSADO,  X2.FALTA_COMPENSAR,  X2.ATRASO,  X2.SAIDA_ANTECIPADA,  X2.H_EXTRA_NOTURNA,  X2.H_INTRA_JORNADA,  X2.DESCONTO_AUX,  X2.INTERJORNADA,  X2.BH_CREDITO,  X2.BH_DEBITO,  X2.DESCONTO_TOLERADO,  X2.INTERVALO_A_MENOR,  X2.ENTRADA_ANTECIPADA,  X2.MULTA_INTERJORNADA,  X2.EXTRA_DIA_INFO_SEM_MENSAL,  X2.DESCONTO_DIA_INFO_SEM_MENSAL,  X2.DTCADASTRO,  X2.COD_PESSOA,  X2.COD_JUSTIFICATIVA_PONTO,  X2.COD_PONTO_FECHAMENTO,  X2.COD_BANCO_HORAS,  X2.COD_CARGO,  X2.COD_UNIDADE,  X2.COD_HORARIO,  X2.COD_ESCALA_PADRAO,  X2.CAMPO_LIVRE,  X2.MARCACAO1,  X2.MARCACAO2,  X2.MARCACAO3,  X2.MARCACAO4,  X2.MARCACAO5,  X2.MARCACAO6,  X2.MARCACAO7,  X2.MARCACAO8,  X2.MARCACAO9,  X2.MARCACAO10,  X2.MARCACAO11,  X2.MARCACAO12,  X2.MARCACAO_E2,  X2.MARCACAO_E3,  X2.MARCACAO_E4,  X2.MARCACAO_E5,  X2.MARCACAO_E6,  X2.MARCACAO_E7,  X2.MARCACAO_E8,  X2.MARCACAO_E9,  X2.MARCACAO_E10,  X2.MARCACAO_E11,  X2.MARCACAO_E12,  X2.MARCACAO1_ALTERADA,  X2.MARCACAO2_ALTERADA,  X2.MARCACAO3_ALTERADA,  X2.MARCACAO4_ALTERADA,  X2.MARCACAO5_ALTERADA,  X2.MARCACAO6_ALTERADA,  X2.MARCACAO7_ALTERADA,  X2.MARCACAO8_ALTERADA,  X2.MARCACAO9_ALTERADA,  X2.MARCACAO10_ALTERADA,  X2.MARCACAO11_ALTERADA,  X2.MARCACAO12_ALTERADA,  X2.OBS_MARCACAO_ALTERADA,  X2.BANCO_HORAS,  X2.TIPO_BANCO_HORAS,  X2.OBS,  X2.BIT_DIVERGENCIA,  X2.COD_COMPENSACAO,  X2.MULTIPLICADOR_BANCO_HORAS,  X2.NA009,  X2.DTJUSTIFICATIVA,  X2.LOGIN_JUSTIFICATIVA,  X2.DTAVALIADOR,  X2.LOGIN_AVALIADOR,  X2.DTALTERACAO,  X2.LOGIN_ALTERACAO,  X2.FOTO,  X2.SOBREAVISO_DOBRA,  X2.COD_JUSTIFICATIVA_BANCO_HORAS,  X2.DESCRICAO_BANCO_HORAS,  X2.COMPROVANTE_JUSTIFICATIVA,  X2.RELATORIO_RH_VALIDADO,  X2.TOTAIS
,X2.AGRUPADOR
FROM (
SELECT 
X.PREVISTO
,case when x.entrada = 1 then X.PREVISTO else 0 end PREVISTO_TRATADO 
,CASE WHEN X.PREVISTO IS NULL THEN 0 ELSE X.PREVISTO 
END PREVISTO_F ,
X.H_NORMAIS, 
CASE WHEN X.H_NORMAIS IS NOT NULL AND X.H_NORMAIS <> 0 AND X.H_NORMAIS > 24 AND X.PREVISTO IS NOT NULL THEN X.PREVISTO
WHEN X.H_NORMAIS IS NULL THEN 0
ELSE X.H_NORMAIS END H_NORMAIS_F, --NOVO 17/7/20 CORRIGI EXCESSOS NO ULTIMO DIA
CASE WHEN X.HORAS_ABONADA IS NOT NULL AND X.HORAS_ABONADA <> 0 AND X.HORAS_ABONADA > 24 AND X.PREVISTO IS NOT NULL THEN X.PREVISTO 
WHEN X.HORAS_ABONADA IS NULL THEN 0 
ELSE X.HORAS_ABONADA END HORAS_ABONADA_F, 
X.EMPRESA ,X.TIPO_CONTRATO ,X.MATRICULA ,X.CODIGO, X.DATA 
,X.SITUACAO
,case when X.SITUACAO = 'TRABALHANDO' THEN 'TRABALHANDO' when X.SITUACAO = 'FOLGA' THEN 'FOLGA' WHEN X.SITUACAO IS NULL THEN 'NULO' ELSE 'OCORRENCIA' END SITUACAO_TRATADA, 
X.TIPO_FOLGA, X.ENTRADA ,X.MARCACAO_E1, X.ACEITO
,X.SIT_PONTO 
,X.DESCONTO_ABONADO ,X.HORAS_ABONADA
,X.H_NORMAIS-X.HORAS_ABONADA HORAS_MARCACOES
,X.DESCONTO ,X.H_EXTRA ,X.H_EXTRA_FERIADO ,X.H_NOTURNA ,X.COMPENSADO ,X.FALTA_COMPENSAR  ,X.ATRASO ,X.SAIDA_ANTECIPADA ,X.H_EXTRA_NOTURNA ,X.H_INTRA_JORNADA ,X.DESCONTO_AUX ,X.INTERJORNADA ,X.BH_CREDITO ,X.BH_DEBITO
,X.DESCONTO_TOLERADO ,X.INTERVALO_A_MENOR ,X.ENTRADA_ANTECIPADA ,X.MULTA_INTERJORNADA ,X.EXTRA_DIA_INFO_SEM_MENSAL ,X.DESCONTO_DIA_INFO_SEM_MENSAL
,X.DTCADASTRO ,X.COD_PESSOA ,X.COD_JUSTIFICATIVA_PONTO ,X.COD_PONTO_FECHAMENTO ,X.COD_BANCO_HORAS ,X.COD_CARGO ,X.COD_UNIDADE ,X.COD_HORARIO ,X.COD_ESCALA_PADRAO ,X.CAMPO_LIVRE
,X.MARCACAO1 ,X.MARCACAO2 ,X.MARCACAO3 ,X.MARCACAO4 ,X.MARCACAO5 ,X.MARCACAO6 ,X.MARCACAO7 ,X.MARCACAO8 ,X.MARCACAO9 ,X.MARCACAO10 ,X.MARCACAO11 ,X.MARCACAO12 ,X.MARCACAO_E2 ,X.MARCACAO_E3 ,X.MARCACAO_E4 ,X.MARCACAO_E5 ,X.MARCACAO_E6 ,X.MARCACAO_E7 ,X.MARCACAO_E8 ,X.MARCACAO_E9 ,X.MARCACAO_E10 ,X.MARCACAO_E11 ,X.MARCACAO_E12 ,X.MARCACAO1_ALTERADA ,X.MARCACAO2_ALTERADA ,X.MARCACAO3_ALTERADA ,X.MARCACAO4_ALTERADA ,X.MARCACAO5_ALTERADA ,X.MARCACAO6_ALTERADA ,X.MARCACAO7_ALTERADA ,X.MARCACAO8_ALTERADA ,X.MARCACAO9_ALTERADA ,X.MARCACAO10_ALTERADA ,X.MARCACAO11_ALTERADA ,X.MARCACAO12_ALTERADA 
,X.OBS_MARCACAO_ALTERADA ,X.BANCO_HORAS ,X.TIPO_BANCO_HORAS ,X.OBS 
 ,X.BIT_DIVERGENCIA ,X.COD_COMPENSACAO ,X.MULTIPLICADOR_BANCO_HORAS ,X.NA009 ,X.DTJUSTIFICATIVA ,X.LOGIN_JUSTIFICATIVA ,X.DTAVALIADOR ,X.LOGIN_AVALIADOR ,X.DTALTERACAO ,X.LOGIN_ALTERACAO ,X.FOTO ,X.SOBREAVISO_DOBRA ,X.COD_JUSTIFICATIVA_BANCO_HORAS ,X.DESCRICAO_BANCO_HORAS ,X.COMPROVANTE_JUSTIFICATIVA ,X.RELATORIO_RH_VALIDADO
,X.TOTAIS , X.AGRUPADOR
FROM PONTO_ELETRONICO.IFPONTO_ESPELHO_HISTORICA X 
WHERE DATA_PROCESSAMENTO IS NULL
and X.MATRICULA IS NOT NULL -- DE 8218 PARA 8218
AND LPAD(x.EMPRESA,4,'0') IN (SELECT DADO_ORIGEM FROM ARTERH.RHINTE_ED_IT_CONV WHERE CODIGO_CONVERSAO = 'IFP4')--NOVO EM 7/11/23 na verdade inserido apenas em 5/1/24

ORDER BY X.EMPRESA ,X.TIPO_CONTRATO ,X.MATRICULA, X.DATA

)X2
)X3
LEFT OUTER JOIN ARTERH.rhpess_contrato c on LPAD(X3.EMPRESA,4,0) = c.codigo_empresa and LPAD(X3.TIPO_CONTRATO,4,0) = C.TIPO_CONTRATO AND LPAD(X3.MATRICULA,15,0) = C.CODIGO
LEFT OUTER JOIN ARTERH.RHPONT_SITUACAO SP ON LPAD(X3.SIT_PONTO, 4,0) = SP.CODIGO  
LEFT OUTER JOIN ARTERH.RHPLCS_CARGO CC ON CC.CODIGO_EMPRESA = C.CODIGO_EMPRESA AND CC.CODIGO = C.cod_cargo_comiss
left outer join ARTERH.RHTABS_VINCULO_EMP V ON V.CODIGO = c.VINCULO
LEFT OUTER JOIN (select * from ARTERH.rhtabs_itds_sist WHERE CODIGO_DOMINIO IN (select CODIGO_DOMINIO from RHTABS_COLS_SIST  where codigo_tabela = 'RHTABS_VINCULO_EMP' and codigo_coluna = 'TP_REGIME_TRAB_ESOCIAL'))RG_TRAB
ON RG_TRAB.CONTEUDO_INICIAL = V.TP_REGIME_TRAB_ESOCIAL
LEFT OUTER JOIN (select * from ARTERH.rhtabs_itds_sist WHERE CODIGO_DOMINIO IN (select CODIGO_DOMINIO from RHTABS_COLS_SIST  where codigo_tabela = 'RHTABS_VINCULO_EMP' and codigo_coluna = 'TP_REGIME_PREV_ESOCIAL'))RG_PREV
ON RG_PREV.CONTEUDO_INICIAL = V.TP_REGIME_PREV_ESOCIAL
LEFT OUTER JOIN (select * from ARTERH.rhtabs_itds_sist WHERE CODIGO_DOMINIO IN (select CODIGO_DOMINIO from RHTABS_COLS_SIST  where codigo_tabela = 'RHTABS_VINCULO_EMP' and codigo_coluna = 'COD_CATEG_ESOCIAL'))COD_CATEG
ON COD_CATEG.CONTEUDO_INICIAL = V.COD_CATEG_ESOCIAL
LEFT OUTER JOIN (select OC.* from PONTO_ELETRONICO.IFPONTO_OCORRENCIAS OC WHERE OC.DATA_PROCESSAMENTO IS NULL)OC
ON X3.EMPRESA = OC.EMPRESA AND X3.TIPO_CONTRATO = OC.TIPO_CONTRATO AND X3.MATRICULA = OC.MATRICULA AND TRUNC(X3.DATA) BETWEEN TRUNC(OC.DTINICIO) AND TRUNC(DTFIM)
LEFT OUTER JOIN (SELECT * FROM ARTERH.RHINTE_ED_IT_CONV WHERE CODIGO_CONVERSAO = 'IFP1')IFP1 ON IFP1.DADO_ORIGEM = SP.CODIGO--novo em 26/6/20
LEFT OUTER JOIN (SELECT U.* FROM ARTERH.RHCGED_ALT_SIT_FUN U WHERE U.DATA_INIC_SITUACAO = (SELECT MAX(A.DATA_INIC_SITUACAO)
               FROM ARTERH.RHCGED_ALT_SIT_FUN A WHERE A.CODIGO_EMPRESA = U.CODIGO_EMPRESA AND A.TIPO_CONTRATO = U.TIPO_CONTRATO AND A.CODIGO = U.CODIGO))ASF
                ON ASF.CODIGO_EMPRESA = X3.EMPRESA AND ASF.TIPO_CONTRATO = X3.TIPO_CONTRATO AND ASF.CODIGO = X3.MATRICULA --novo em 9/12/21
LEFT OUTER JOIN ARTERH.RHPARM_SIT_FUNC SF ON SF.CODIGO = ASF.COD_SIT_FUNCIONAL--novo em 9/12/21
LEFT OUTER JOIN (SELECT SUBSTR(DADO_ORIGEM,5,4)SIT_FUNC_IFPONTO, DADO_DESTINO STATUS_IFPONTO FROM ARTERH.RHINTE_ED_IT_CONV where codigo_CONVERSAO ='POST' AND SUBSTR(DADO_ORIGEM, 1,4) = '0001')POST ON POST.SIT_FUNC_IFPONTO = ASF.COD_SIT_FUNCIONAL--novo em 9/12/21
WHERE
C.ANO_MES_REFERENCIA = (SELECT MAX(AUX.ANO_MES_REFERENCIA) FROM ARTERH.RHPESS_CONTRATO AUX WHERE AUX.CODIGO_EMPRESA = C.CODIGO_EMPRESA AND AUX.TIPO_CONTRATO = C.TIPO_CONTRATO AND AUX.CODIGO = C.CODIGO)
)X4 
)X5
)
LOOP
vCONTADOR :=vCONTADOR+1;

IF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200')
AND C1.O_QUE_FAZER ='A.27 - Gravado como ocorrencia as permitidas e aprovadas'
THEN
dbms_output.put_line('--A.27 - Gravado como ocorrencia as permitidas e aprovadas');
INSERT INTO PONTO_ELETRONICO.IFPONTO_FECHAMENTO_LOG_RELAT (CONSIDERACOES, CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA_DADOS, CAMPO_1, CAMPO_2, CAMPO_3, CAMPO_4)VALUES('ifponto_gera_sit_ponto_V7.sql',C1.EMPRESA,C1.TIPO_CONTRATO,C1.MATRICULA, C1.DATA, 'A.27 - Gravado como ocorrencia as permitidas e aprovadas',NULL, NULL,NULL  ); COMMIT;

ELSIF
C1.JUSTIF_GERA_HORAS_NORMAIS = 'NAO' 
AND C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200')
AND C1.O_QUE_FAZER = 'A.11-GRAVAR: Situação de Ponto da Justificativa'
AND C1.H_NORMAIS_N = C1.PREVISTO_N--NOVO 16/8/20
THEN
  dbms_output.put_line('--A.11.1-GRAVAR: Situação de Ponto da Justificativa');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA =  LPAD(C1.EMPRESA,4,0) AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0) AND CODIGO_CONTRATO = LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE(trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = LPAD(C1.SIT_PONTO,4,0); COMMIT;   
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0),LPAD(C1.TIPO_CONTRATO,4,0) ,LPAD(C1.MATRICULA,15,0), TO_DATE(trunc(C1.DATA),'DD/MM/YYYY'), LPAD(C1.SIT_PONTO,4,0), ROUND(C1.HORAS_ABONADA_F , 2), 'F', SYSDATE, 'IFPONTO', 'N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;

ELSIF C1.JUSTIF_GERA_HORAS_NORMAIS = 'SIM' 
AND C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.11-GRAVAR: Situação de Ponto da Justificativa'
AND C1.H_NORMAIS_N = C1.PREVISTO_N--NOVO 16/8/20
THEN
dbms_output.put_line('--A.11.2-GRAVAR: Situação de Ponto da Justificativa COMO HORAS NORMAIS');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0) AND TIPO_CONTRATO = LPAD(C1.TIPO_CONTRATO,4,0) AND CODIGO_CONTRATO = LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1000'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0), LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE(trunc(C1.DATA) ,'DD/MM/YYYY'),'1000', ROUND(C1.HORAS_ABONADA_F, 2), 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT; 

ELSIF C1.JUSTIF_GERA_HORAS_NORMAIS = 'NAO' 
AND C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200')
AND C1.O_QUE_FAZER = 'A.11-GRAVAR: Situação de Ponto da Justificativa'
AND C1.H_NORMAIS_N > C1.PREVISTO_N--NOVO 16/8/20
THEN
dbms_output.put_line('--A.11.3-GRAVAR: Situação de Ponto da Justificativa + 1002 HORAS EXCEDIDAS');
--vNUMERO := TO_NUMBER(C1.PREVISTO_N) ;
--vSTRING := CASE WHEN INSTR(vNUMERO,',',1,1) = 0 THEN TO_CHAR(vNUMERO) WHEN INSTR(vNUMERO,',',1,1) <> 0 THEN TO_CHAR(SUBSTR(vNUMERO,1,INSTR(vNUMERO,',',1,1)-1) ||'.'||SUBSTR(vNUMERO,INSTR(vNUMERO,',' ,1,1)+1, LENGTH(vNUMERO))) end ;
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0) AND TIPO_CONTRATO = LPAD(C1.TIPO_CONTRATO,4,0) AND CODIGO_CONTRATO = LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE(trunc(C1.DATA),'DD/MM/YYYY') AND CODIGO_SITUACAO = LPAD(C1.SIT_PONTO,4,0); COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE(trunc(C1.DATA) ,'DD/MM/YYYY'), LPAD(C1.SIT_PONTO,4,0) , ROUND(C1.PREVISTO_N, 2), 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  
--INSERT INTO PONTO_ELETRONICO.IFPONTO_FECHAMENTO_LOG_RELAT (CONSIDERACOES, CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA_DADOS, CAMPO_1, CAMPO_2, CAMPO_3, CAMPO_4)VALUES('ifponto_gera_sit_ponto_V7.sql',C1.EMPRESA, C1.TIPO_CONTRATO, C1.MATRICULA, C1.DATA,'--A.11.3-GRAVAR: Situação de Ponto da Justificativa + 1002 HORAS EXCEDIDAS' , LPAD(C1.SIT_PONTO,4,0) , ROUND(C1.PREVISTO_N, 2), 'ROUND(C1.PREVISTO_N, 2)'); COMMIT;
--vNUMERO := TO_NUMBER(C1.H_NORMAIS_N) - TO_NUMBER(C1.PREVISTO_N) ;
--vSTRING := CASE WHEN INSTR(vNUMERO,',',1,1) = 0 THEN TO_CHAR(vNUMERO) WHEN INSTR(vNUMERO,',',1,1) <> 0 THEN TO_CHAR(SUBSTR(vNUMERO,1,INSTR(vNUMERO,',',1,1)-1) ||'.'||SUBSTR(vNUMERO,INSTR(vNUMERO,',' ,1,1)+1, LENGTH(vNUMERO))) end ;
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0) AND TIPO_CONTRATO = LPAD(C1.TIPO_CONTRATO,4,0) AND CODIGO_CONTRATO = LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE(trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1002'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) ,LPAD(C1.TIPO_CONTRATO,4,0) ,LPAD(C1.MATRICULA,15,0), TO_DATE(trunc(C1.DATA) ,'DD/MM/YYYY'),'1002', ROUND(C1.H_NORMAIS_N - C1.PREVISTO_N, 2),'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;
--INSERT INTO PONTO_ELETRONICO.IFPONTO_FECHAMENTO_LOG_RELAT (CONSIDERACOES, CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA_DADOS, CAMPO_1, CAMPO_2, CAMPO_3, CAMPO_4)VALUES('ifponto_gera_sit_ponto_V7.sql',C1.EMPRESA, C1.TIPO_CONTRATO, C1.MATRICULA, C1.DATA,'--A.11.3-GRAVAR: Situação de Ponto da Justificativa + 1002 HORAS EXCEDIDAS','1002', ROUND(C1.H_NORMAIS_N - C1.PREVISTO_N, 2) , 'ROUND(C1.H_NORMAIS_N - C1.PREVISTO_N, 2)'); COMMIT;

ELSIF C1.JUSTIF_GERA_HORAS_NORMAIS = 'SIM' 
AND C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.11-GRAVAR: Situação de Ponto da Justificativa'
AND C1.H_NORMAIS_N > C1.PREVISTO_N--NOVO 16/8/20
THEN
dbms_output.put_line('--A.11.4-GRAVAR: Situação de Ponto da Justificativa COMO HORAS NORMAIS + 1002 HORAS EXCEDIDAS');
--vNUMERO := TO_NUMBER(C1.PREVISTO_N) ;
--vSTRING := CASE WHEN INSTR(vNUMERO,',',1,1) = 0 THEN TO_CHAR(vNUMERO) WHEN INSTR(vNUMERO,',',1,1) <> 0 THEN TO_CHAR(SUBSTR(vNUMERO,1,INSTR(vNUMERO,',',1,1)-1) ||'.'||SUBSTR(vNUMERO,INSTR(vNUMERO,',' ,1,1)+1, LENGTH(vNUMERO))) end ;
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0) AND TIPO_CONTRATO = LPAD(C1.TIPO_CONTRATO,4,0) AND CODIGO_CONTRATO = LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE(trunc(C1.DATA),'DD/MM/YYYY') AND CODIGO_SITUACAO = '1000'; COMMIT;
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE(trunc(C1.DATA) ,'DD/MM/YYYY'),'1000', ROUND(C1.PREVISTO_N, 2), 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;   
--INSERT INTO PONTO_ELETRONICO.IFPONTO_FECHAMENTO_LOG_RELAT (CONSIDERACOES, CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA_DADOS, CAMPO_1, CAMPO_2, CAMPO_3, CAMPO_4)VALUES('ifponto_gera_sit_ponto_V7.sql',C1.EMPRESA, C1.TIPO_CONTRATO, C1.MATRICULA, C1.DATA,'--A.11.4-GRAVAR: Situação de Ponto da Justificativa COMO HORAS NORMAIS + 1002 HORAS EXCEDIDAS','1000', ROUND(C1.PREVISTO_N, 2), 'ROUND(C1.PREVISTO_N, 2)' ); COMMIT;
--vNUMERO := TO_NUMBER(C1.H_NORMAIS_N) - TO_NUMBER(C1.PREVISTO_N) ;
--vSTRING := CASE WHEN INSTR(vNUMERO,',',1,1) = 0 THEN TO_CHAR(vNUMERO) WHEN INSTR(vNUMERO,',',1,1) <> 0 THEN TO_CHAR(SUBSTR(vNUMERO,1,INSTR(vNUMERO,',',1,1)-1) ||'.'||SUBSTR(vNUMERO,INSTR(vNUMERO,',' ,1,1)+1, LENGTH(vNUMERO))) end ;
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0) AND TIPO_CONTRATO = LPAD(C1.TIPO_CONTRATO,4,0) AND CODIGO_CONTRATO = LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE(trunc(C1.DATA),'DD/MM/YYYY') AND CODIGO_SITUACAO = '1002'; COMMIT; 
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) ,LPAD(C1.MATRICULA,15,0) , TO_DATE(trunc(C1.DATA),'DD/MM/YYYY'),'1002', ROUND(C1.H_NORMAIS_N - C1.PREVISTO_N, 2),'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;
--INSERT INTO PONTO_ELETRONICO.IFPONTO_FECHAMENTO_LOG_RELAT (CONSIDERACOES, CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA_DADOS, CAMPO_1, CAMPO_2, CAMPO_3, CAMPO_4)VALUES('ifponto_gera_sit_ponto_V7.sql',C1.EMPRESA, C1.TIPO_CONTRATO, C1.MATRICULA, C1.DATA,'--A.11.4-GRAVAR: Situação de Ponto da Justificativa COMO HORAS NORMAIS + 1002 HORAS EXCEDIDAS' ,'1002', ROUND(C1.H_NORMAIS_N - C1.PREVISTO_N, 2), 'ROUND(C1.H_NORMAIS_N - C1.PREVISTO_N, 2)' ); COMMIT;

ELSIF C1.JUSTIF_GERA_HORAS_NORMAIS = 'NAO' 
AND C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200')
AND C1.O_QUE_FAZER = 'A.11-GRAVAR: Situação de Ponto da Justificativa'
AND C1.H_NORMAIS_N < C1.PREVISTO_N--NOVO 16/8/20
THEN
dbms_output.put_line('--A.11.5-GRAVAR: Situação de Ponto da Justificativa + 1001 HORAS DIFERENCIADAS');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0) AND TIPO_CONTRATO = LPAD(C1.TIPO_CONTRATO,4,0) AND CODIGO_CONTRATO = LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE(trunc(C1.DATA),'DD/MM/YYYY') AND CODIGO_SITUACAO = LPAD(C1.SIT_PONTO,4,0); COMMIT;
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE(trunc(C1.DATA) ,'DD/MM/YYYY'), LPAD(C1.SIT_PONTO,4,0) , ROUND(C1.HORAS_ABONADA_F, 2), 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT; 
--INSERT INTO PONTO_ELETRONICO.IFPONTO_FECHAMENTO_LOG_RELAT (CONSIDERACOES, CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA_DADOS, CAMPO_1, CAMPO_2, CAMPO_3, CAMPO_4)VALUES('ifponto_gera_sit_ponto_V7.sql',C1.EMPRESA, C1.TIPO_CONTRATO, C1.MATRICULA, C1.DATA,'--A.11.5-GRAVAR: Situação de Ponto da Justificativa + 1001 HORAS DIFERENCIADAS', LPAD(C1.SIT_PONTO,4,0) , ROUND(C1.HORAS_ABONADA_F, 2), 'ROUND(C1.HORAS_ABONADA_F, 2)' ); COMMIT;
--vNUMERO := C1.PREVISTO_N - C1.H_NORMAIS_N ;
--vSTRING := CASE WHEN INSTR(vNUMERO,',',1,1) = 0 THEN TO_CHAR(vNUMERO) WHEN INSTR(vNUMERO,',',1,1) <> 0 THEN TO_CHAR(SUBSTR(vNUMERO,1,INSTR(vNUMERO,',',1,1)-1) ||'.'||SUBSTR(vNUMERO,INSTR(vNUMERO,',' ,1,1)+1, LENGTH(vNUMERO))) end ;
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0) AND TIPO_CONTRATO = LPAD(C1.TIPO_CONTRATO,4,0) AND CODIGO_CONTRATO = LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE(trunc(C1.DATA),'DD/MM/YYYY') AND CODIGO_SITUACAO = '1001'; COMMIT; 
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE(trunc(C1.DATA) ,'DD/MM/YYYY'),'1001', ROUND(C1.PREVISTO_N - C1.H_NORMAIS_N ,2),'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT; 
--INSERT INTO PONTO_ELETRONICO.IFPONTO_FECHAMENTO_LOG_RELAT (CONSIDERACOES, CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA_DADOS, CAMPO_1, CAMPO_2, CAMPO_3, CAMPO_4)VALUES('ifponto_gera_sit_ponto_V7.sql',C1.EMPRESA, C1.TIPO_CONTRATO, C1.MATRICULA, C1.DATA,'--A.11.5-GRAVAR: Situação de Ponto da Justificativa + 1001 HORAS DIFERENCIADAS','1001', ROUND(C1.PREVISTO_N - C1.H_NORMAIS_N ,2), 'ROUND(C1.PREVISTO_N - C1.H_NORMAIS_N ,2)' ); COMMIT;

--NOVO EM 26/6/20

ELSIF C1.JUSTIF_GERA_HORAS_NORMAIS = 'SIM' 
AND C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.11-GRAVAR: Situação de Ponto da Justificativa'
AND C1.H_NORMAIS_N < C1.PREVISTO_N--NOVO 16/8/20
THEN
dbms_output.put_line('--A.11.6-GRAVAR: Situação de Ponto da Justificativa COMO HORAS NORMAIS + 1001 HORAS DIFERENCIADAS');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0) AND TIPO_CONTRATO = LPAD(C1.TIPO_CONTRATO,4,0) AND CODIGO_CONTRATO = LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE(trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1000'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) ,LPAD(C1.TIPO_CONTRATO,4,0) ,LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1000', ROUND(C1.HORAS_ABONADA_F, 2), 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  
--INSERT INTO PONTO_ELETRONICO.IFPONTO_FECHAMENTO_LOG_RELAT (CONSIDERACOES, CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA_DADOS, CAMPO_1, CAMPO_2, CAMPO_3, CAMPO_4)VALUES('ifponto_gera_sit_ponto_V7.sql',C1.EMPRESA, C1.TIPO_CONTRATO, C1.MATRICULA, C1.DATA,'--A.11.6-GRAVAR: Situação de Ponto da Justificativa COMO HORAS NORMAIS + 1001 HORAS DIFERENCIADAS','1000', ROUND(C1.HORAS_ABONADA_F, 2), 'ROUND(C1.HORAS_ABONADA_F, 2' ); COMMIT;
--vNUMERO := TO_NUMBER(C1.PREVISTO_N) - TO_NUMBER(C1.H_NORMAIS_N) ;
--vSTRING := CASE WHEN INSTR(vNUMERO,',',1,1) = 0 THEN TO_CHAR(vNUMERO) WHEN INSTR(vNUMERO,',',1,1) <> 0 THEN TO_CHAR(SUBSTR(vNUMERO,1,INSTR(vNUMERO,',',1,1)-1) ||'.'||SUBSTR(vNUMERO,INSTR(vNUMERO,',' ,1,1)+1, LENGTH(vNUMERO))) end ;
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0) AND TIPO_CONTRATO = LPAD(C1.TIPO_CONTRATO,4,0) AND CODIGO_CONTRATO = LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE(trunc(C1.DATA),'DD/MM/YYYY') AND CODIGO_SITUACAO = '1001'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) ,LPAD(C1.TIPO_CONTRATO,4,0) ,LPAD(C1.MATRICULA,15,0) , TO_DATE(trunc(C1.DATA),'DD/MM/YYYY'),'1001', ROUND(C1.PREVISTO_N - C1.H_NORMAIS_F, 2),'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;
--INSERT INTO PONTO_ELETRONICO.IFPONTO_FECHAMENTO_LOG_RELAT (CONSIDERACOES, CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA_DADOS, CAMPO_1, CAMPO_2, CAMPO_3, CAMPO_4)VALUES('ifponto_gera_sit_ponto_V7.sql',C1.EMPRESA, C1.TIPO_CONTRATO, C1.MATRICULA, C1.DATA,'--A.11.6-GRAVAR: Situação de Ponto da Justificativa COMO HORAS NORMAIS + 1001 HORAS DIFERENCIADAS','1001', ROUND(C1.PREVISTO_N - C1.H_NORMAIS_F, 2) , 'ROUND(C1.PREVISTO_N - C1.H_NORMAIS_F, 2)'); COMMIT;

ELSIF
C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200')
AND C1.O_QUE_FAZER = 'A.1-GRAVAR: 1003-FOLGA'
THEN
dbms_output.put_line('--A.1-GRAVAR: 1003-FOLGA');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0) AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO = LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE(trunc(C1.DATA),'DD/MM/YYYY') AND CODIGO_SITUACAO = '1003'; COMMIT;
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0), LPAD(C1.MATRICULA,15,0), TO_DATE( trunc(C1.DATA),'DD/MM/YYYY'),'1003', 1, 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;

--dbms_output.put_line('DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = ''F'' AND CODIGO_EMPRESA = ''' ||LPAD(C1.EMPRESA,4,0) ||''' AND TIPO_CONTRATO = ''' || LPAD(C1.TIPO_CONTRATO,4,0) ||''' AND CODIGO_CONTRATO = '''|| LPAD(C1.MATRICULA,15,0) ||'''AND TRUNC(DATA) = TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY'') AND CODIGO_SITUACAO = ''1003''; COMMIT;' );  
--dbms_output.put_line('INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES ('''||LPAD(C1.EMPRESA,4,0) ||''','''|| LPAD(C1.TIPO_CONTRATO,4,0) ||''','''|| LPAD(C1.MATRICULA,15,0) ||''', TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY''),''1003'', 1, ''F'', SYSDATE, ''IFPONTO'','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;' );  

ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.2-GRAVAR: 1012-PONTO FACULTATIVO'
THEN
dbms_output.put_line('--A.2-GRAVAR: 1012-PONTO FACULTATIVO');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0) AND TIPO_CONTRATO = LPAD(C1.TIPO_CONTRATO,4,0) AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE(trunc(C1.DATA),'DD/MM/YYYY') AND CODIGO_SITUACAO = '1012'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0),LPAD(C1.TIPO_CONTRATO,4,0), LPAD(C1.MATRICULA,15,0) , TO_DATE(trunc(C1.DATA) ,'DD/MM/YYYY'),'1012', 1, 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;
--dbms_output.put_line('DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = ''F'' AND CODIGO_EMPRESA = ''' ||LPAD(C1.EMPRESA,4,0) ||''' AND TIPO_CONTRATO = ''' || LPAD(C1.TIPO_CONTRATO,4,0) ||''' AND CODIGO_CONTRATO = '''|| LPAD(C1.MATRICULA,15,0) ||'''AND TRUNC(DATA) = TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY'') AND CODIGO_SITUACAO = ''1012''; COMMIT;' );  
--dbms_output.put_line('INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES ('''||LPAD(C1.EMPRESA,4,0) ||''','''|| LPAD(C1.TIPO_CONTRATO,4,0) ||''','''|| LPAD(C1.MATRICULA,15,0) ||''', TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY''),''1012'', 1, ''F'', SYSDATE, ''IFPONTO'','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;' );  

ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.3-GRAVAR: 0068-FERIADO'
THEN
dbms_output.put_line('--A.3-GRAVAR: 0068-FERIADO');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0) AND TIPO_CONTRATO = LPAD(C1.TIPO_CONTRATO,4,0) AND CODIGO_CONTRATO = LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '0068'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0), LPAD(C1.TIPO_CONTRATO,4,0),LPAD(C1.MATRICULA,15,0), TO_DATE( trunc(C1.DATA),'DD/MM/YYYY'),'0068', 1, 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;
--dbms_output.put_line('DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = ''F'' AND CODIGO_EMPRESA = ''' ||LPAD(C1.EMPRESA,4,0) ||''' AND TIPO_CONTRATO = ''' || LPAD(C1.TIPO_CONTRATO,4,0) ||''' AND CODIGO_CONTRATO = '''|| LPAD(C1.MATRICULA,15,0) ||'''AND TRUNC(DATA) = TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY'') AND CODIGO_SITUACAO = ''0068''; COMMIT;' );  
--dbms_output.put_line('INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES ('''||LPAD(C1.EMPRESA,4,0) ||''','''|| LPAD(C1.TIPO_CONTRATO,4,0) ||''','''|| LPAD(C1.MATRICULA,15,0) ||''', TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY''),''0068'', 1, ''F'', SYSDATE, ''IFPONTO'','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;' );  

ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.6.1-GRAVAR: 1000-HORAS NORMAIS'
AND C1.H_NORMAIS_N = C1.PREVISTO_N--NOVO 15/8/20
THEN
dbms_output.put_line('--A.6.1-GRAVAR: 1000-HORAS NORMAIS');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0) AND TIPO_CONTRATO = LPAD(C1.TIPO_CONTRATO,4,0) AND CODIGO_CONTRATO = LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE(trunc(C1.DATA), 'DD/MM/YYYY') AND CODIGO_SITUACAO = '1000'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0), LPAD(C1.TIPO_CONTRATO,4,0),LPAD(C1.MATRICULA,15,0), TO_DATE(trunc(C1.DATA),'DD/MM/YYYY'),'1000', ROUND(C1.H_NORMAIS_F,2), 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;
--dbms_output.put_line('DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = ''F'' AND CODIGO_EMPRESA = ''' ||LPAD(C1.EMPRESA,4,0) ||''' AND TIPO_CONTRATO = ''' || LPAD(C1.TIPO_CONTRATO,4,0) ||''' AND CODIGO_CONTRATO = '''|| LPAD(C1.MATRICULA,15,0) ||'''AND TRUNC(DATA) = TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY'') AND CODIGO_SITUACAO = ''1000''; COMMIT;' );  
--dbms_output.put_line('INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES ('''||LPAD(C1.EMPRESA,4,0) ||''','''|| LPAD(C1.TIPO_CONTRATO,4,0) ||''','''|| LPAD(C1.MATRICULA,15,0) ||''', TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY''),''1000'', ROUND('|| C1.H_NORMAIS_F ||',2), ''F'', SYSDATE, ''IFPONTO'','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;' );  

--DESATIVADO EM 5/8/20
--INICIO NOVO EM 15/8/20
ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.6.1-GRAVAR: 1000-HORAS NORMAIS'
AND C1.H_NORMAIS_N < C1.PREVISTO_N--NOVO 15/8/20
THEN
dbms_output.put_line('--A.6.1-GRAVAR: 1000-HORAS NORMAIS 1001-HORAS DIFERENCIADAS');
--vNUMERO := TO_NUMBER(C1.PREVISTO_N) - TO_NUMBER(C1.H_NORMAIS_N) ;
--vSTRING := CASE WHEN INSTR(vNUMERO,',',1,1) = 0 THEN TO_CHAR(vNUMERO) WHEN INSTR(vNUMERO,',',1,1) <> 0 THEN TO_CHAR(SUBSTR(vNUMERO,1,INSTR(vNUMERO,',',1,1)-1) ||'.'||SUBSTR(vNUMERO,INSTR(vNUMERO,',' ,1,1)+1, LENGTH(vNUMERO))) end ;
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0) AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0) AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE(trunc(C1.DATA),'DD/MM/YYYY') AND CODIGO_SITUACAO = '1000'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) ,LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1000', ROUND(C1.H_NORMAIS_F,2), 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT; 
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0) AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0) AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE(trunc(C1.DATA),'DD/MM/YYYY') AND CODIGO_SITUACAO = '1001'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0), TO_DATE( trunc(C1.DATA),'DD/MM/YYYY'),'1001', ROUND(C1.PREVISTO_N - C1.H_NORMAIS_N ,2),'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;
--dbms_output.put_line('DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = ''F'' AND CODIGO_EMPRESA = ''' ||LPAD(C1.EMPRESA,4,0) ||''' AND TIPO_CONTRATO = ''' || LPAD(C1.TIPO_CONTRATO,4,0) ||''' AND CODIGO_CONTRATO = '''|| LPAD(C1.MATRICULA,15,0) ||'''AND TRUNC(DATA) = TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY'') AND CODIGO_SITUACAO = ''1000''; COMMIT;' );  
--dbms_output.put_line('INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES ('''||LPAD(C1.EMPRESA,4,0) ||''','''|| LPAD(C1.TIPO_CONTRATO,4,0) ||''','''|| LPAD(C1.MATRICULA,15,0) ||''', TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY''),''1000'', ROUND('|| C1.H_NORMAIS_F ||',2), ''F'', SYSDATE, ''IFPONTO'','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;' );  
--dbms_output.put_line('DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = ''F'' AND CODIGO_EMPRESA = ''' ||LPAD(C1.EMPRESA,4,0) ||''' AND TIPO_CONTRATO = ''' || LPAD(C1.TIPO_CONTRATO,4,0) ||''' AND CODIGO_CONTRATO = '''|| LPAD(C1.MATRICULA,15,0) ||'''AND TRUNC(DATA) = TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY'') AND CODIGO_SITUACAO = ''1001''; COMMIT;' );  
--dbms_output.put_line('INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES ('''||LPAD(C1.EMPRESA,4,0) ||''','''|| LPAD(C1.TIPO_CONTRATO,4,0) ||''','''|| LPAD(C1.MATRICULA,15,0) ||''', TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY''),''1001'', ROUND('||vSTRING ||',2),''F'', SYSDATE, ''IFPONTO'','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;' );  

ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.6.1-GRAVAR: 1000-HORAS NORMAIS'
AND C1.H_NORMAIS_N > C1.PREVISTO_N--NOVO 15/8/20
THEN
--vNUMERO := TO_NUMBER(C1.H_NORMAIS_N) - TO_NUMBER(C1.PREVISTO_N) ;
--vSTRING := CASE WHEN INSTR(vNUMERO,',',1,1) = 0 THEN TO_CHAR(vNUMERO) WHEN INSTR(vNUMERO,',',1,1) <> 0 THEN TO_CHAR(SUBSTR(vNUMERO,1,INSTR(vNUMERO,',',1,1)-1) ||'.'||SUBSTR(vNUMERO,INSTR(vNUMERO,',' ,1,1)+1, LENGTH(vNUMERO))) end ;
dbms_output.put_line('--A.6.1-GRAVAR: 1000-HORAS NORMAIS E 1002-HORAS EXCEDENTES');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1000'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1000', ROUND(C1.H_NORMAIS_F ,2), 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1002'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1002', ROUND(C1.H_NORMAIS_N - C1.PREVISTO_N ,2),'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  
--dbms_output.put_line('DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = ''F'' AND CODIGO_EMPRESA = ''' ||LPAD(C1.EMPRESA,4,0) ||''' AND TIPO_CONTRATO = ''' || LPAD(C1.TIPO_CONTRATO,4,0) ||''' AND CODIGO_CONTRATO = '''|| LPAD(C1.MATRICULA,15,0) ||'''AND TRUNC(DATA) = TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY'') AND CODIGO_SITUACAO = ''1000''; COMMIT;' );  
--dbms_output.put_line('INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES ('''||LPAD(C1.EMPRESA,4,0) ||''','''|| LPAD(C1.TIPO_CONTRATO,4,0) ||''','''|| LPAD(C1.MATRICULA,15,0) ||''', TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY''),''1000'', ROUND('|| C1.H_NORMAIS_F ||',2), ''F'', SYSDATE, ''IFPONTO'','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;' );  
--dbms_output.put_line('DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = ''F'' AND CODIGO_EMPRESA = ''' ||LPAD(C1.EMPRESA,4,0) ||''' AND TIPO_CONTRATO = ''' || LPAD(C1.TIPO_CONTRATO,4,0) ||''' AND CODIGO_CONTRATO = '''|| LPAD(C1.MATRICULA,15,0) ||'''AND TRUNC(DATA) = TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY'') AND CODIGO_SITUACAO = ''1002''; COMMIT;' );  
--dbms_output.put_line('INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES ('''||LPAD(C1.EMPRESA,4,0) ||''','''|| LPAD(C1.TIPO_CONTRATO,4,0) ||''','''|| LPAD(C1.MATRICULA,15,0) ||''', TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY''),''1002'', ROUND('||vSTRING ||',2),''F'', SYSDATE, ''IFPONTO'','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;' );  
--FIM NOVO EM 15/8/20

ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.7.1-GRAVAR: 1000-HORAS NORMAIS E 1002-HORAS EXCEDENTES'
THEN
dbms_output.put_line('--A.7.1-GRAVAR: 1000-HORAS NORMAIS E 1002-HORAS EXCEDENTES');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1000'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1000', ROUND(C1.PREVISTO_F,2), 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1002'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1002', ROUND(C1.EXTRA_DIA_INFO_SEM_MENSAL,2),'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  
--dbms_output.put_line('DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = ''F'' AND CODIGO_EMPRESA = ''' ||LPAD(C1.EMPRESA,4,0) ||''' AND TIPO_CONTRATO = ''' || LPAD(C1.TIPO_CONTRATO,4,0) ||''' AND CODIGO_CONTRATO = '''|| LPAD(C1.MATRICULA,15,0) ||'''AND TRUNC(DATA) = TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY'') AND CODIGO_SITUACAO = ''1000''; COMMIT;' );  
--dbms_output.put_line('INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES ('''||LPAD(C1.EMPRESA,4,0) ||''','''|| LPAD(C1.TIPO_CONTRATO,4,0) ||''','''|| LPAD(C1.MATRICULA,15,0) ||''', TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY''),''1000'', ROUND('|| C1.PREVISTO_F ||',2), ''F'', SYSDATE, ''IFPONTO''); COMMIT;' );  
--dbms_output.put_line('DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = ''F'' AND CODIGO_EMPRESA = ''' ||LPAD(C1.EMPRESA,4,0) ||''' AND TIPO_CONTRATO = ''' || LPAD(C1.TIPO_CONTRATO,4,0) ||''' AND CODIGO_CONTRATO = '''|| LPAD(C1.MATRICULA,15,0) ||'''AND TRUNC(DATA) = TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY'') AND CODIGO_SITUACAO = ''1002''; COMMIT;' );  
--dbms_output.put_line('INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES ('''||LPAD(C1.EMPRESA,4,0) ||''','''|| LPAD(C1.TIPO_CONTRATO,4,0) ||''','''|| LPAD(C1.MATRICULA,15,0) ||''', TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY''),''1002'', ROUND('||C1.EXTRA_DIA_INFO_SEM_MENSAL_F ||',2),''F'', SYSDATE, ''IFPONTO''); COMMIT;' );  

ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.8.1-GRAVAR: 1000-HORAS NORMAIS E 1001-HORAS DIFERENCIADAS'
THEN
dbms_output.put_line('--A.8.1-GRAVAR: 1000-HORAS NORMAIS E 1001-HORAS DIFERENCIADAS');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1000'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1000', ROUND(C1.H_NORMAIS_F ,2), 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1001'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1001', ROUND(C1.DESCONTO_DIA_INFO_SEM_MENSAL_F ,2),'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  
--dbms_output.put_line('DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = ''F'' AND CODIGO_EMPRESA = ''' ||LPAD(C1.EMPRESA,4,0) ||''' AND TIPO_CONTRATO = ''' || LPAD(C1.TIPO_CONTRATO,4,0) ||''' AND CODIGO_CONTRATO = '''|| LPAD(C1.MATRICULA,15,0) ||'''AND TRUNC(DATA) = TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY'') AND CODIGO_SITUACAO = ''1000''; COMMIT;' );  
--dbms_output.put_line('INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES ('''||LPAD(C1.EMPRESA,4,0) ||''','''|| LPAD(C1.TIPO_CONTRATO,4,0) ||''','''|| LPAD(C1.MATRICULA,15,0) ||''', TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY''),''1000'', ROUND('|| C1.H_NORMAIS_F ||',2), ''F'', SYSDATE, ''IFPONTO'','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;' );  
--dbms_output.put_line('DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = ''F'' AND CODIGO_EMPRESA = ''' ||LPAD(C1.EMPRESA,4,0) ||''' AND TIPO_CONTRATO = ''' || LPAD(C1.TIPO_CONTRATO,4,0) ||''' AND CODIGO_CONTRATO = '''|| LPAD(C1.MATRICULA,15,0) ||'''AND TRUNC(DATA) = TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY'') AND CODIGO_SITUACAO = ''1001''; COMMIT;' );  
--dbms_output.put_line('INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES ('''||LPAD(C1.EMPRESA,4,0) ||''','''|| LPAD(C1.TIPO_CONTRATO,4,0) ||''','''|| LPAD(C1.MATRICULA,15,0) ||''', TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY''),''1001'', ROUND('||C1.DESCONTO_DIA_INFO_SEM_MENSAL_F ||',2),''F'', SYSDATE, ''IFPONTO'','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;' );  

ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.9.1-GRAVAR: 0020-FALTA PODE VIRAR FALTA COMPENSADA'
THEN
dbms_output.put_line('--A.9.1-GRAVAR: 0020-FALTA PODE VIRAR FALTA COMPENSADA');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '0020'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'0020', 1, 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  
--dbms_output.put_line('DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = ''F'' AND CODIGO_EMPRESA = ''' ||LPAD(C1.EMPRESA,4,0) ||''' AND TIPO_CONTRATO = ''' || LPAD(C1.TIPO_CONTRATO,4,0) ||''' AND CODIGO_CONTRATO = '''|| LPAD(C1.MATRICULA,15,0) ||'''AND TRUNC(DATA) = TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY'') AND CODIGO_SITUACAO = ''0020''; COMMIT;' );  
--dbms_output.put_line('INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES ('''||LPAD(C1.EMPRESA,4,0) ||''','''|| LPAD(C1.TIPO_CONTRATO,4,0) ||''','''|| LPAD(C1.MATRICULA,15,0) ||''', TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY''),''0020'', 1, ''F'', SYSDATE, ''IFPONTO'','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;' );  

ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.9.2-GRAVAR: 0020-FALTA'
THEN
dbms_output.put_line('--A.9.2-GRAVAR: 0020-FALTA');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '0020'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'0020', 1, 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  
--dbms_output.put_line('DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = ''F'' AND CODIGO_EMPRESA = ''' ||LPAD(C1.EMPRESA,4,0) ||''' AND TIPO_CONTRATO = ''' || LPAD(C1.TIPO_CONTRATO,4,0) ||''' AND CODIGO_CONTRATO = '''|| LPAD(C1.MATRICULA,15,0) ||'''AND TRUNC(DATA) = TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY'') AND CODIGO_SITUACAO = ''0020''; COMMIT;' );  
--dbms_output.put_line('INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES ('''||LPAD(C1.EMPRESA,4,0) ||''','''|| LPAD(C1.TIPO_CONTRATO,4,0) ||''','''|| LPAD(C1.MATRICULA,15,0) ||''', TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY''),''0020'', 1, ''F'', SYSDATE, ''IFPONTO'','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;' );  

ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.10.1-POSSIVEL FALTA VIRAR FALTA COMPENSADA'
THEN
 dbms_output.put_line('--A.10.1-POSSIVEL FALTA VIRAR FALTA COMPENSADA');
--COMENTADO EM 2/9/20--dbms_output.put_line('DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = ''F'' AND CODIGO_EMPRESA = ''' ||LPAD(C1.EMPRESA,4,0) ||''' AND TIPO_CONTRATO = ''' || LPAD(C1.TIPO_CONTRATO,4,0) ||''' AND CODIGO_CONTRATO = '''|| LPAD(C1.MATRICULA,15,0) ||'''AND TRUNC(DATA) = TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY'') AND CODIGO_SITUACAO = ''0020''; COMMIT;' );  
--COMENTADO EM 2/9/20--dbms_output.put_line('INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES ('''||LPAD(C1.EMPRESA,4,0) ||''','''|| LPAD(C1.TIPO_CONTRATO,4,0) ||''','''|| LPAD(C1.MATRICULA,15,0) ||''', TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY''),''0020'', 1, ''F'', SYSDATE, ''IFPONTO'','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;' );  
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0) AND TIPO_CONTRATO = LPAD(C1.TIPO_CONTRATO,4,0) AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0)AND TRUNC(DATA) = TO_DATE(trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1001'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE(trunc(C1.DATA) ,'DD/MM/YYYY'),'1001', ROUND(C1.PREVISTO_F,2),'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  
--dbms_output.put_line('DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = ''F'' AND CODIGO_EMPRESA = ''' ||LPAD(C1.EMPRESA,4,0) ||''' AND TIPO_CONTRATO = ''' || LPAD(C1.TIPO_CONTRATO,4,0) ||''' AND CODIGO_CONTRATO = '''|| LPAD(C1.MATRICULA,15,0) ||'''AND TRUNC(DATA) = TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY'') AND CODIGO_SITUACAO = ''1001''; COMMIT;' );  
--dbms_output.put_line('INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES ('''||LPAD(C1.EMPRESA,4,0) ||''','''|| LPAD(C1.TIPO_CONTRATO,4,0) ||''','''|| LPAD(C1.MATRICULA,15,0) ||''', TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY''),''1001'', ROUND('||C1.PREVISTO_F ||',2),''F'', SYSDATE, ''IFPONTO'','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;' );  

ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.10.2-POSSIVEL FALTA'
THEN
  --   --dbms_output.put_line('--A.10.2-POSSIVEL FALTA');
--COMENTADO EM 2/9/20--dbms_output.put_line('DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = ''F'' AND CODIGO_EMPRESA = ''' ||LPAD(C1.EMPRESA,4,0) ||''' AND TIPO_CONTRATO = ''' || LPAD(C1.TIPO_CONTRATO,4,0) ||''' AND CODIGO_CONTRATO = '''|| LPAD(C1.MATRICULA,15,0) ||'''AND TRUNC(DATA) = TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY'') AND CODIGO_SITUACAO = ''0020''; COMMIT;' );  
--COMENTADO EM 2/9/20--dbms_output.put_line('INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES ('''||LPAD(C1.EMPRESA,4,0) ||''','''|| LPAD(C1.TIPO_CONTRATO,4,0) ||''','''|| LPAD(C1.MATRICULA,15,0) ||''', TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY''),''0020'', 1, ''F'', SYSDATE, ''IFPONTO'','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;' );  
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0) AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0) AND CODIGO_CONTRATO = LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE(trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1001'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0), LPAD(C1.MATRICULA,15,0), TO_DATE(trunc(C1.DATA),'DD/MM/YYYY'),'1001', ROUND(C1.DESCONTO_DIA_INFO_SEM_MENSAL_F ,2),'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  
--dbms_output.put_line('DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = ''F'' AND CODIGO_EMPRESA = ''' ||LPAD(C1.EMPRESA,4,0) ||''' AND TIPO_CONTRATO = ''' || LPAD(C1.TIPO_CONTRATO,4,0) ||''' AND CODIGO_CONTRATO = '''|| LPAD(C1.MATRICULA,15,0) ||'''AND TRUNC(DATA) = TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY'') AND CODIGO_SITUACAO = ''1001''; COMMIT;' );  
--dbms_output.put_line('INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES ('''||LPAD(C1.EMPRESA,4,0) ||''','''|| LPAD(C1.TIPO_CONTRATO,4,0) ||''','''|| LPAD(C1.MATRICULA,15,0) ||''', TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY''),''1001'', ROUND('||C1.DESCONTO_DIA_INFO_SEM_MENSAL_F ||',2),''F'', SYSDATE, ''IFPONTO'','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;' );  

ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.12-GRAVAR: 1000-HORAS NORMAIS E 1001-HORAS DIFERENCIADAS'--AJUSTE 17/7/20--ajuste em 24/6/20-- 'A.12-GRAVAR: 1000-HORAS NORMAIS E 1001-HORAS DIFERENCIADAS'
THEN
dbms_output.put_line('--A.12-GRAVAR: 1000-HORAS NORMAIS E 1001-HORAS DIFERENCIADAS');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1000'; COMMIT;  --ajuste 24/6/20, AJUSTE 17/7/20
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1000', ROUND(C1.H_NORMAIS_F ,2), 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1001'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1001', ROUND(C1.DESCONTO_DIA_INFO_SEM_MENSAL_F ,2),'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  
--dbms_output.put_line('DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = ''F'' AND CODIGO_EMPRESA = ''' ||LPAD(C1.EMPRESA,4,0) ||''' AND TIPO_CONTRATO = ''' || LPAD(C1.TIPO_CONTRATO,4,0) ||''' AND CODIGO_CONTRATO = '''|| LPAD(C1.MATRICULA,15,0) ||'''AND TRUNC(DATA) = TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY'') AND CODIGO_SITUACAO = ''1000''; COMMIT;' );  --ajuste 24/6/20, AJUSTE 17/7/20
--dbms_output.put_line('INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES ('''||LPAD(C1.EMPRESA,4,0) ||''','''|| LPAD(C1.TIPO_CONTRATO,4,0) ||''','''|| LPAD(C1.MATRICULA,15,0) ||''', TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY''),''1000'', ROUND('|| C1.H_NORMAIS_F ||',2), ''F'', SYSDATE, ''IFPONTO'','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;' );  
--dbms_output.put_line('DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = ''F'' AND CODIGO_EMPRESA = ''' ||LPAD(C1.EMPRESA,4,0) ||''' AND TIPO_CONTRATO = ''' || LPAD(C1.TIPO_CONTRATO,4,0) ||''' AND CODIGO_CONTRATO = '''|| LPAD(C1.MATRICULA,15,0) ||'''AND TRUNC(DATA) = TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY'') AND CODIGO_SITUACAO = ''1001''; COMMIT;' );  
--dbms_output.put_line('INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES ('''||LPAD(C1.EMPRESA,4,0) ||''','''|| LPAD(C1.TIPO_CONTRATO,4,0) ||''','''|| LPAD(C1.MATRICULA,15,0) ||''', TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY''),''1001'', ROUND('||C1.DESCONTO_DIA_INFO_SEM_MENSAL_F ||',2),''F'', SYSDATE, ''IFPONTO'','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;' );  

ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.13-GRAVAR: 1000-HORAS NORMAIS E 1002-HORAS EXCEDENTES'
THEN
dbms_output.put_line('--A.13-GRAVAR: 1000-HORAS NORMAIS E 1002-HORAS EXCEDENTES');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1000'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1000', ROUND(C1.PREVISTO_F ,2), 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1002'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1002', ROUND(C1.EXTRA_DIA_INFO_SEM_MENSAL_F ,2),'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  
--dbms_output.put_line('DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = ''F'' AND CODIGO_EMPRESA = ''' ||LPAD(C1.EMPRESA,4,0) ||''' AND TIPO_CONTRATO = ''' || LPAD(C1.TIPO_CONTRATO,4,0) ||''' AND CODIGO_CONTRATO = '''|| LPAD(C1.MATRICULA,15,0) ||'''AND TRUNC(DATA) = TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY'') AND CODIGO_SITUACAO = ''1000''; COMMIT;' );  
--dbms_output.put_line('INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES ('''||LPAD(C1.EMPRESA,4,0) ||''','''|| LPAD(C1.TIPO_CONTRATO,4,0) ||''','''|| LPAD(C1.MATRICULA,15,0) ||''', TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY''),''1000'', ROUND('|| C1.PREVISTO_F ||',2), ''F'', SYSDATE, ''IFPONTO'','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;' );  
--dbms_output.put_line('DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = ''F'' AND CODIGO_EMPRESA = ''' ||LPAD(C1.EMPRESA,4,0) ||''' AND TIPO_CONTRATO = ''' || LPAD(C1.TIPO_CONTRATO,4,0) ||''' AND CODIGO_CONTRATO = '''|| LPAD(C1.MATRICULA,15,0) ||'''AND TRUNC(DATA) = TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY'') AND CODIGO_SITUACAO = ''1002''; COMMIT;' );  
--dbms_output.put_line('INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES ('''||LPAD(C1.EMPRESA,4,0) ||''','''|| LPAD(C1.TIPO_CONTRATO,4,0) ||''','''|| LPAD(C1.MATRICULA,15,0) ||''', TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY''),''1002'', ROUND('||C1.EXTRA_DIA_INFO_SEM_MENSAL_F ||',2),''F'', SYSDATE, ''IFPONTO'','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;' );  

ELSIF C1.JUSTIF_GERA_HORAS_NORMAIS = 'NAO' 
AND C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.14-?Gravar no dia a Situação de Ponto da Justificativa?'
AND (C1.HORAS_MARCACOES IS NULL OR C1.HORAS_MARCACOES = 0) --NOVO EM 23/6/20
THEN
dbms_output.put_line('--A.14.1-?Gravar no dia a Situação de Ponto da Justificativa?');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO =  LPAD(C1.SIT_PONTO,4,0); COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'), LPAD(C1.SIT_PONTO,4,0) , ROUND(C1.HORAS_ABONADA_F, 2), 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  
--dbms_output.put_line('DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = ''F'' AND CODIGO_EMPRESA = ''' ||LPAD(C1.EMPRESA,4,0) ||''' AND TIPO_CONTRATO = ''' || LPAD(C1.TIPO_CONTRATO,4,0) ||''' AND CODIGO_CONTRATO = '''|| LPAD(C1.MATRICULA,15,0) ||'''AND TRUNC(DATA) = TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY'') AND CODIGO_SITUACAO = '''|| LPAD(C1.SIT_PONTO,4,0)||'''; COMMIT;' );  
--dbms_output.put_line('INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES ('''||LPAD(C1.EMPRESA,4,0) ||''','''|| LPAD(C1.TIPO_CONTRATO,4,0) ||''','''|| LPAD(C1.MATRICULA,15,0) ||''', TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY''),'''|| LPAD(C1.SIT_PONTO,4,0) ||''', ROUND(' || C1.HORAS_ABONADA_F ||', 2), ''F'', SYSDATE, ''IFPONTO'','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;' );  

--NOVO EM 26/6/20
ELSIF C1.JUSTIF_GERA_HORAS_NORMAIS = 'SIM' 
AND C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO'AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.14-?Gravar no dia a Situação de Ponto da Justificativa?'
AND (C1.HORAS_MARCACOES IS NULL OR C1.HORAS_MARCACOES = 0) --NOVO EM 23/6/20
THEN
dbms_output.put_line('--A.14.2-?Gravar no dia a Situação de Ponto da Justificativa? COMO HORAS NORMAIS');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1000'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1000', ROUND(C1.HORAS_ABONADA_F, 2), 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  
--dbms_output.put_line('DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = ''F'' AND CODIGO_EMPRESA = ''' ||LPAD(C1.EMPRESA,4,0) ||''' AND TIPO_CONTRATO = ''' || LPAD(C1.TIPO_CONTRATO,4,0) ||''' AND CODIGO_CONTRATO = '''|| LPAD(C1.MATRICULA,15,0) ||'''AND TRUNC(DATA) = TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY'') AND CODIGO_SITUACAO = ''1000''; COMMIT;' );  
--dbms_output.put_line('INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES ('''||LPAD(C1.EMPRESA,4,0) ||''','''|| LPAD(C1.TIPO_CONTRATO,4,0) ||''','''|| LPAD(C1.MATRICULA,15,0) ||''', TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY''),''1000'', ROUND(' || C1.HORAS_ABONADA_F ||', 2), ''F'', SYSDATE, ''IFPONTO'','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;' );  

ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.14-?Gravar no dia a Situação de Ponto da Justificativa?'
AND C1.HORAS_MARCACOES IS NOT NULL AND C1.HORAS_MARCACOES <> 0 --NOVO EM 23/6/20
THEN 
dbms_output.put_line('--A.14.3-?Gravar no dia a Situação de Ponto da Justificativa? E HORAS_MARCACOES COMO NORMAIS');
--vNUMERO := C1.HORAS_ABONADA_F ;
--vSTRING := CASE WHEN INSTR(vNUMERO,',',1,1) = 0 THEN TO_CHAR(vNUMERO) WHEN INSTR(vNUMERO,',',1,1) <> 0 THEN TO_CHAR(SUBSTR(vNUMERO,1,INSTR(vNUMERO,',',1,1)-1) ||'.'||SUBSTR(vNUMERO,INSTR(vNUMERO,',' ,1,1)+1, LENGTH(vNUMERO))) end ;
--vSTRING := C1.HORAS_ABONADA_F;
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO =  LPAD(C1.SIT_PONTO,4,0); COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'), LPAD(C1.SIT_PONTO,4,0) , ROUND(C1.HORAS_ABONADA_F,2), 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  
--vNUMERO := TO_NUMBER(C1.HORAS_MARCACOES_F) ;
--vSTRING := CASE WHEN INSTR(vNUMERO,',',1,1) = 0 THEN TO_CHAR(vNUMERO) WHEN INSTR(vNUMERO,',',1,1) <> 0 THEN TO_CHAR(SUBSTR(vNUMERO,1,INSTR(vNUMERO,',',1,1)-1) ||'.'||SUBSTR(vNUMERO,INSTR(vNUMERO,',' ,1,1)+1, LENGTH(vNUMERO))) end ;
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1000'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1000', ROUND(C1.HORAS_MARCACOES_F ,2), 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  
--dbms_output.put_line('DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = ''F'' AND CODIGO_EMPRESA = ''' ||LPAD(C1.EMPRESA,4,0) ||''' AND TIPO_CONTRATO = ''' || LPAD(C1.TIPO_CONTRATO,4,0) ||''' AND CODIGO_CONTRATO = '''|| LPAD(C1.MATRICULA,15,0) ||'''AND TRUNC(DATA) = TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY'') AND CODIGO_SITUACAO = '''|| LPAD(C1.SIT_PONTO,4,0)||'''; COMMIT;' );  
--dbms_output.put_line('INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES ('''||LPAD(C1.EMPRESA,4,0) ||''','''|| LPAD(C1.TIPO_CONTRATO,4,0) ||''','''|| LPAD(C1.MATRICULA,15,0) ||''', TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY''),'''|| LPAD(C1.SIT_PONTO,4,0) ||''', ROUND(' || C1.HORAS_ABONADA_F ||', 2), ''F'', SYSDATE, ''IFPONTO'','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;' );  
--dbms_output.put_line('DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = ''F'' AND CODIGO_EMPRESA = ''' ||LPAD(C1.EMPRESA,4,0) ||''' AND TIPO_CONTRATO = ''' || LPAD(C1.TIPO_CONTRATO,4,0) ||''' AND CODIGO_CONTRATO = '''|| LPAD(C1.MATRICULA,15,0) ||'''AND TRUNC(DATA) = TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY'') AND CODIGO_SITUACAO = ''1000''; COMMIT;' );  
--dbms_output.put_line('INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES ('''||LPAD(C1.EMPRESA,4,0) ||''','''|| LPAD(C1.TIPO_CONTRATO,4,0) ||''','''|| LPAD(C1.MATRICULA,15,0) ||''', TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY''),''1000'', ROUND('|| C1.HORAS_MARCACOES_F ||',2), ''F'', SYSDATE, ''IFPONTO'','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;' );  

ELSIF C1.JUSTIF_GERA_HORAS_NORMAIS = 'NAO' 
AND C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.15-?Gravar no dia a Situação de Ponto da Justificativa + horas excedidas?'
THEN
dbms_output.put_line('--A.15-?Gravar no dia a Situação de Ponto da Justificativa + horas excedidas?');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO =  LPAD(C1.SIT_PONTO,4,0); COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'), LPAD(C1.SIT_PONTO,4,0) , ROUND(C1.HORAS_ABONADA_F , 2), 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1002'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1002', ROUND(C1.EXTRA_DIA_INFO_SEM_MENSAL_F ,2),'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  
--dbms_output.put_line('DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = ''F'' AND CODIGO_EMPRESA = ''' ||LPAD(C1.EMPRESA,4,0) ||''' AND TIPO_CONTRATO = ''' || LPAD(C1.TIPO_CONTRATO,4,0) ||''' AND CODIGO_CONTRATO = '''|| LPAD(C1.MATRICULA,15,0) ||'''AND TRUNC(DATA) = TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY'') AND CODIGO_SITUACAO = '''|| LPAD(C1.SIT_PONTO,4,0)||'''; COMMIT;' );  
--dbms_output.put_line('INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES ('''||LPAD(C1.EMPRESA,4,0) ||''','''|| LPAD(C1.TIPO_CONTRATO,4,0) ||''','''|| LPAD(C1.MATRICULA,15,0) ||''', TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY''),'''|| LPAD(C1.SIT_PONTO,4,0) ||''', ROUND(' || C1.HORAS_ABONADA_F ||', 2), ''F'', SYSDATE, ''IFPONTO'','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;' );  
--dbms_output.put_line('DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = ''F'' AND CODIGO_EMPRESA = ''' ||LPAD(C1.EMPRESA,4,0) ||''' AND TIPO_CONTRATO = ''' || LPAD(C1.TIPO_CONTRATO,4,0) ||''' AND CODIGO_CONTRATO = '''|| LPAD(C1.MATRICULA,15,0) ||'''AND TRUNC(DATA) = TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY'') AND CODIGO_SITUACAO = ''1002''; COMMIT;' );  
--dbms_output.put_line('INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES ('''||LPAD(C1.EMPRESA,4,0) ||''','''|| LPAD(C1.TIPO_CONTRATO,4,0) ||''','''|| LPAD(C1.MATRICULA,15,0) ||''', TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY''),''1002'', ROUND('||C1.EXTRA_DIA_INFO_SEM_MENSAL_F ||',2),''F'', SYSDATE, ''IFPONTO'','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;' );  

--NOVO 26/6/20
ELSIF C1.JUSTIF_GERA_HORAS_NORMAIS = 'SIM' 
AND C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.15-?Gravar no dia a Situação de Ponto da Justificativa + horas excedidas?'
THEN
dbms_output.put_line('--A.15-?Gravar no dia a Situação de Ponto da Justificativa COMO HORAS NORMAIS + horas excedidas?');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1000'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1000', ROUND(C1.HORAS_ABONADA_F, 2), 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1002'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1002', ROUND(C1.EXTRA_DIA_INFO_SEM_MENSAL_F ,2),'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  
--dbms_output.put_line('DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = ''F'' AND CODIGO_EMPRESA = ''' ||LPAD(C1.EMPRESA,4,0) ||''' AND TIPO_CONTRATO = ''' || LPAD(C1.TIPO_CONTRATO,4,0) ||''' AND CODIGO_CONTRATO = '''|| LPAD(C1.MATRICULA,15,0) ||'''AND TRUNC(DATA) = TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY'') AND CODIGO_SITUACAO = ''1000''; COMMIT;' );  
--dbms_output.put_line('INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES ('''||LPAD(C1.EMPRESA,4,0) ||''','''|| LPAD(C1.TIPO_CONTRATO,4,0) ||''','''|| LPAD(C1.MATRICULA,15,0) ||''', TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY''),''1000'', ROUND(' || C1.HORAS_ABONADA_F ||', 2), ''F'', SYSDATE, ''IFPONTO'','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;' );  
--dbms_output.put_line('DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = ''F'' AND CODIGO_EMPRESA = ''' ||LPAD(C1.EMPRESA,4,0) ||''' AND TIPO_CONTRATO = ''' || LPAD(C1.TIPO_CONTRATO,4,0) ||''' AND CODIGO_CONTRATO = '''|| LPAD(C1.MATRICULA,15,0) ||'''AND TRUNC(DATA) = TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY'') AND CODIGO_SITUACAO = ''1002''; COMMIT;' );  
--dbms_output.put_line('INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES ('''||LPAD(C1.EMPRESA,4,0) ||''','''|| LPAD(C1.TIPO_CONTRATO,4,0) ||''','''|| LPAD(C1.MATRICULA,15,0) ||''', TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY''),''1002'', ROUND('||C1.EXTRA_DIA_INFO_SEM_MENSAL_F ||',2),''F'', SYSDATE, ''IFPONTO'','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;' );  

ELSIF C1.JUSTIF_GERA_HORAS_NORMAIS = 'NAO' 
AND C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.16-?Gravar no dia a Situação de Ponto da Justificativa + horas diferenciadas?'
THEN
dbms_output.put_line('--A.16-?Gravar no dia a Situação de Ponto da Justificativa + horas diferenciadas?');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO =  LPAD(C1.SIT_PONTO,4,0); COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'), LPAD(C1.SIT_PONTO,4,0) , ROUND(C1.HORAS_ABONADA_F , 2), 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1001'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1001', ROUND(C1.DESCONTO_DIA_INFO_SEM_MENSAL_F ,2),'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  
--dbms_output.put_line('DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = ''F'' AND CODIGO_EMPRESA = ''' ||LPAD(C1.EMPRESA,4,0) ||''' AND TIPO_CONTRATO = ''' || LPAD(C1.TIPO_CONTRATO,4,0) ||''' AND CODIGO_CONTRATO = '''|| LPAD(C1.MATRICULA,15,0) ||'''AND TRUNC(DATA) = TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY'') AND CODIGO_SITUACAO = '''|| LPAD(C1.SIT_PONTO,4,0)||'''; COMMIT;' );  
--dbms_output.put_line('INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES ('''||LPAD(C1.EMPRESA,4,0) ||''','''|| LPAD(C1.TIPO_CONTRATO,4,0) ||''','''|| LPAD(C1.MATRICULA,15,0) ||''', TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY''),'''|| LPAD(C1.SIT_PONTO,4,0) ||''', ROUND(' || C1.HORAS_ABONADA_F ||', 2), ''F'', SYSDATE, ''IFPONTO'','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;' );  
--dbms_output.put_line('DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = ''F'' AND CODIGO_EMPRESA = ''' ||LPAD(C1.EMPRESA,4,0) ||''' AND TIPO_CONTRATO = ''' || LPAD(C1.TIPO_CONTRATO,4,0) ||''' AND CODIGO_CONTRATO = '''|| LPAD(C1.MATRICULA,15,0) ||'''AND TRUNC(DATA) = TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY'') AND CODIGO_SITUACAO = ''1001''; COMMIT;' );  
--dbms_output.put_line('INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES ('''||LPAD(C1.EMPRESA,4,0) ||''','''|| LPAD(C1.TIPO_CONTRATO,4,0) ||''','''|| LPAD(C1.MATRICULA,15,0) ||''', TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY''),''1001'', ROUND('||C1.DESCONTO_DIA_INFO_SEM_MENSAL_F ||',2),''F'', SYSDATE, ''IFPONTO'','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;' );  

--NOVO EM 26/6/20
ELSIF C1.JUSTIF_GERA_HORAS_NORMAIS = 'SIM' 
AND C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.16-?Gravar no dia a Situação de Ponto da Justificativa + horas diferenciadas?'
THEN
dbms_output.put_line('--A.16-?Gravar no dia a Situação de Ponto da Justificativa COMO HORAS NORMAIS + horas diferenciadas?');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1000'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1000', ROUND(C1.HORAS_ABONADA_F, 2), 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1001'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1001', ROUND(C1.DESCONTO_DIA_INFO_SEM_MENSAL_F, 2),'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  
--dbms_output.put_line('DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = ''F'' AND CODIGO_EMPRESA = ''' ||LPAD(C1.EMPRESA,4,0) ||''' AND TIPO_CONTRATO = ''' || LPAD(C1.TIPO_CONTRATO,4,0) ||''' AND CODIGO_CONTRATO = '''|| LPAD(C1.MATRICULA,15,0) ||'''AND TRUNC(DATA) = TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY'') AND CODIGO_SITUACAO = ''1000''; COMMIT;' );  
--dbms_output.put_line('INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES ('''||LPAD(C1.EMPRESA,4,0) ||''','''|| LPAD(C1.TIPO_CONTRATO,4,0) ||''','''|| LPAD(C1.MATRICULA,15,0) ||''', TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY''),''1000'', ROUND(' || C1.HORAS_ABONADA_F ||', 2), ''F'', SYSDATE, ''IFPONTO'','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;' );  
--dbms_output.put_line('DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = ''F'' AND CODIGO_EMPRESA = ''' ||LPAD(C1.EMPRESA,4,0) ||''' AND TIPO_CONTRATO = ''' || LPAD(C1.TIPO_CONTRATO,4,0) ||''' AND CODIGO_CONTRATO = '''|| LPAD(C1.MATRICULA,15,0) ||'''AND TRUNC(DATA) = TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY'') AND CODIGO_SITUACAO = ''1001''; COMMIT;' );  
--dbms_output.put_line('INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES ('''||LPAD(C1.EMPRESA,4,0) ||''','''|| LPAD(C1.TIPO_CONTRATO,4,0) ||''','''|| LPAD(C1.MATRICULA,15,0) ||''', TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY''),''1001'', ROUND('||C1.DESCONTO_DIA_INFO_SEM_MENSAL_F ||',2),''F'', SYSDATE, ''IFPONTO'','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;' );  

ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'NAO LOCALIZADO SIT PONTO 13-GRAVAR: 1000-HORAS NORMAIS E 1002-HORAS EXCEDENTES' THEN
dbms_output.put_line('--NAO LOCALIZADO SIT PONTO 13-GRAVAR: 1000-HORAS NORMAIS E 1002-HORAS EXCEDENTES');  
INSERT INTO PONTO_ELETRONICO.IFPONTO_FECHAMENTO_LOG_RELAT (CONSIDERACOES, CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA_DADOS, CAMPO_1, CAMPO_2, CAMPO_3, CAMPO_4)VALUES('ifponto_gera_sit_ponto_V7.sql',C1.EMPRESA,C1.TIPO_CONTRATO,C1.MATRICULA, C1.DATA, 'NAO LOCALIZADO SIT PONTO 13-GRAVAR: 1000-HORAS NORMAIS E 1002-HORAS EXCEDENTES',NULL, NULL,NULL  ); COMMIT;

ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200')
AND C1.O_QUE_FAZER = 'NAO LOCALIZADO SIT PONTO 14-?Gravar no dia a Situação de Ponto da Justificativa?' THEN
dbms_output.put_line('--NAO LOCALIZADO SIT PONTO 14-?Gravar no dia a Situação de Ponto da Justificativa?');  
INSERT INTO PONTO_ELETRONICO.IFPONTO_FECHAMENTO_LOG_RELAT (CONSIDERACOES, CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA_DADOS, CAMPO_1, CAMPO_2, CAMPO_3, CAMPO_4)VALUES('ifponto_gera_sit_ponto_V7.sql',C1.EMPRESA,C1.TIPO_CONTRATO,C1.MATRICULA, C1.DATA, '--NAO LOCALIZADO SIT PONTO 14-?Gravar no dia a Situação de Ponto da Justificativa?',NULL, NULL,NULL  ); COMMIT;


ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.17-GRAVAR: 0020 FALTA'
THEN
dbms_output.put_line('--A.17-GRAVAR: 0020 FALTA');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '0020'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'0020', 1, 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  
--dbms_output.put_line('DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = ''F'' AND CODIGO_EMPRESA = ''' ||LPAD(C1.EMPRESA,4,0) ||''' AND TIPO_CONTRATO = ''' || LPAD(C1.TIPO_CONTRATO,4,0) ||''' AND CODIGO_CONTRATO = '''|| LPAD(C1.MATRICULA,15,0) ||'''AND TRUNC(DATA) = TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY'') AND CODIGO_SITUACAO = ''0020''; COMMIT;' );  
--dbms_output.put_line('INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES ('''||LPAD(C1.EMPRESA,4,0) ||''','''|| LPAD(C1.TIPO_CONTRATO,4,0) ||''','''|| LPAD(C1.MATRICULA,15,0) ||''', TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY''),''0020'', 1, ''F'', SYSDATE, ''IFPONTO'','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;' );  

ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.18-GRAVAR: 0020 FALTA PODE VIRAR FALTA COMPENSADA'
THEN
dbms_output.put_line('--A.18-GRAVAR: 0020 FALTA PODE VIRAR FALTA COMPENSADA');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '0020'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'0020', 1, 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  
--dbms_output.put_line('DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = ''F'' AND CODIGO_EMPRESA = ''' ||LPAD(C1.EMPRESA,4,0) ||''' AND TIPO_CONTRATO = ''' || LPAD(C1.TIPO_CONTRATO,4,0) ||''' AND CODIGO_CONTRATO = '''|| LPAD(C1.MATRICULA,15,0) ||'''AND TRUNC(DATA) = TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY'') AND CODIGO_SITUACAO = ''0020''; COMMIT;' );  
--dbms_output.put_line('INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES ('''||LPAD(C1.EMPRESA,4,0) ||''','''|| LPAD(C1.TIPO_CONTRATO,4,0) ||''','''|| LPAD(C1.MATRICULA,15,0) ||''', TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY''),''0020'', 1, ''F'', SYSDATE, ''IFPONTO'','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;' );  

ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.19.1-GRAVAR: 1001 HORAS DIFERENCIADAS e 1000 HORAS NORMAIS'
THEN
dbms_output.put_line('--A.19.1-GRAVAR: 1001 HORAS DIFERENCIADAS e 1000 HORAS NORMAIS');
--inicio--novo em 6/11/20
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1000'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1000', ROUND(C1.H_NORMAIS_F ,2), 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  
--fim--novo em 6/11/20
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1001'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1001', ROUND(C1.DESCONTO_DIA_INFO_SEM_MENSAL_F ,2),'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  
--dbms_output.put_line('DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = ''F'' AND CODIGO_EMPRESA = ''' ||LPAD(C1.EMPRESA,4,0) ||''' AND TIPO_CONTRATO = ''' || LPAD(C1.TIPO_CONTRATO,4,0) ||''' AND CODIGO_CONTRATO = '''|| LPAD(C1.MATRICULA,15,0) ||'''AND TRUNC(DATA) = TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY'') AND CODIGO_SITUACAO = ''1001''; COMMIT;' );  
--dbms_output.put_line('INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES ('''||LPAD(C1.EMPRESA,4,0) ||''','''|| LPAD(C1.TIPO_CONTRATO,4,0) ||''','''|| LPAD(C1.MATRICULA,15,0) ||''', TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY''),''1001'', ROUND('||C1.DESCONTO_DIA_INFO_SEM_MENSAL_F ||',2),''F'', SYSDATE, ''IFPONTO'','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;' );  
--/*
--inicio--novo em 6/11/20
ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
--COMENTANDO PRIMEIRO AND EM 28/9/21--AND C1.TEM_DESCONTO = 'SIM'
--AND (C1.DESCONTO IS NOT NULL AND C1.DESCONTO <> O)
AND C1.O_QUE_FAZER = 'A.19.2-GRAVAR: 1001 HORAS DIFERENCIADAS E 1000-HORAS NORMAIS ULTIMO DIA PERIODO'
THEN
dbms_output.put_line('A.19.2-GRAVAR: 1001 HORAS DIFERENCIADAS E 1000-HORAS NORMAIS ULTIMO DIA PERIODO');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1000'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1000', ROUND(C1.H_NORMAIS_F ,2), 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1001'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1001', ROUND(C1.HORAS_ABONADA_F ,2),'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  
--fim--novo em 6/11/20
--*/
ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.20-GRAVAR: 0020 FALTA'
THEN
dbms_output.put_line('--A.20-GRAVAR: 0020 FALTA');
--COMENTADO EM 2/9/20--dbms_output.put_line('DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = ''F'' AND CODIGO_EMPRESA = ''' ||LPAD(C1.EMPRESA,4,0) ||''' AND TIPO_CONTRATO = ''' || LPAD(C1.TIPO_CONTRATO,4,0) ||''' AND CODIGO_CONTRATO = '''|| LPAD(C1.MATRICULA,15,0) ||'''AND TRUNC(DATA) = TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY'') AND CODIGO_SITUACAO = ''0020''; COMMIT;' );  
--COMENTADO EM 2/9/20--dbms_output.put_line('INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES ('''||LPAD(C1.EMPRESA,4,0) ||''','''|| LPAD(C1.TIPO_CONTRATO,4,0) ||''','''|| LPAD(C1.MATRICULA,15,0) ||''', TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY''),''0020'', 1, ''F'', SYSDATE, ''IFPONTO'','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;' );  
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0) AND TIPO_CONTRATO = LPAD(C1.TIPO_CONTRATO,4,0) AND CODIGO_CONTRATO = LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE(trunc(C1.DATA),'DD/MM/YYYY') AND CODIGO_SITUACAO = '1001'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0), LPAD(C1.TIPO_CONTRATO,4,0), LPAD(C1.MATRICULA,15,0) , TO_DATE(trunc(C1.DATA) ,'DD/MM/YYYY'),'1001', ROUND(C1.PREVISTO_F,2),'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;
--dbms_output.put_line('DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = ''F'' AND CODIGO_EMPRESA = ''' ||LPAD(C1.EMPRESA,4,0) ||''' AND TIPO_CONTRATO = ''' || LPAD(C1.TIPO_CONTRATO,4,0) ||''' AND CODIGO_CONTRATO = '''|| LPAD(C1.MATRICULA,15,0) ||'''AND TRUNC(DATA) = TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY'') AND CODIGO_SITUACAO = ''1001''; COMMIT;' );  
--dbms_output.put_line('INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES ('''||LPAD(C1.EMPRESA,4,0) ||''','''|| LPAD(C1.TIPO_CONTRATO,4,0) ||''','''|| LPAD(C1.MATRICULA,15,0) ||''', TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY''),''1001'', ROUND('||C1.PREVISTO_F ||',2),''F'', SYSDATE, ''IFPONTO'','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;' );  

ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.21-GRAVAR: 1002 HORAS EXCEDIDAS'
THEN
dbms_output.put_line('--A.21-GRAVAR: 1002 HORAS EXCEDIDAS');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1002'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1002', ROUND(C1.EXTRA_DIA_INFO_SEM_MENSAL_F ,2),'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  
--dbms_output.put_line('DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = ''F'' AND CODIGO_EMPRESA = ''' ||LPAD(C1.EMPRESA,4,0) ||''' AND TIPO_CONTRATO = ''' || LPAD(C1.TIPO_CONTRATO,4,0) ||''' AND CODIGO_CONTRATO = '''|| LPAD(C1.MATRICULA,15,0) ||'''AND TRUNC(DATA) = TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY'') AND CODIGO_SITUACAO = ''1002''; COMMIT;' );  
--dbms_output.put_line('INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES ('''||LPAD(C1.EMPRESA,4,0) ||''','''|| LPAD(C1.TIPO_CONTRATO,4,0) ||''','''|| LPAD(C1.MATRICULA,15,0) ||''', TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY''),''1002'', ROUND('||C1.EXTRA_DIA_INFO_SEM_MENSAL_F ||',2),''F'', SYSDATE, ''IFPONTO'','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;' );  

ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.22-GRAVAR: 1001 HORAS DIFERENCIADAS'
THEN
dbms_output.put_line('--A.22-GRAVAR: 1001 HORAS DIFERENCIADAS');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1001'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1001', ROUND(C1.DESCONTO_DIA_INFO_SEM_MENSAL_F ,2),'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  
--dbms_output.put_line('DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = ''F'' AND CODIGO_EMPRESA = ''' ||LPAD(C1.EMPRESA,4,0) ||''' AND TIPO_CONTRATO = ''' || LPAD(C1.TIPO_CONTRATO,4,0) ||''' AND CODIGO_CONTRATO = '''|| LPAD(C1.MATRICULA,15,0) ||'''AND TRUNC(DATA) = TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY'') AND CODIGO_SITUACAO = ''1001''; COMMIT;' );  
--dbms_output.put_line('INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES ('''||LPAD(C1.EMPRESA,4,0) ||''','''|| LPAD(C1.TIPO_CONTRATO,4,0) ||''','''|| LPAD(C1.MATRICULA,15,0) ||''', TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY''),''1001'', ROUND('||C1.DESCONTO_DIA_INFO_SEM_MENSAL_F ||',2),''F'', SYSDATE, ''IFPONTO'','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;' );  

--inicio novo em 17/7/20
ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.32-DIA DESCANSO SO COM JUSTIFICATIVA ABONADA GRAVAR: 1000-HORAS NORMAIS'
THEN
dbms_output.put_line('--A.32-DIA DESCANSO SO COM JUSTIFICATIVA ABONADA GRAVAR: 1000-HORAS NORMAIS');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1000'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1000', ROUND(C1.H_NORMAIS_F ,2), 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  
--dbms_output.put_line('DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = ''F'' AND CODIGO_EMPRESA = ''' ||LPAD(C1.EMPRESA,4,0) ||''' AND TIPO_CONTRATO = ''' || LPAD(C1.TIPO_CONTRATO,4,0) ||''' AND CODIGO_CONTRATO = '''|| LPAD(C1.MATRICULA,15,0) ||'''AND TRUNC(DATA) = TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY'') AND CODIGO_SITUACAO = ''1000''; COMMIT;' );  
--dbms_output.put_line('INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES ('''||LPAD(C1.EMPRESA,4,0) ||''','''|| LPAD(C1.TIPO_CONTRATO,4,0) ||''','''|| LPAD(C1.MATRICULA,15,0) ||''', TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY''),''1000'', ROUND('|| C1.H_NORMAIS_F ||',2), ''F'', SYSDATE, ''IFPONTO'','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;' );  

ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.33-DIA DESCANSO SO COM JUSTIFICATIVA ABONADA GRAVAR: 1000-HORAS NORMAIS E 1002-HORAS EXCEDENTES'
THEN
dbms_output.put_line('--A.33-DIA DESCANSO SO COM JUSTIFICATIVA ABONADA GRAVAR: 1000-HORAS NORMAIS E 1002-HORAS EXCEDENTES');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1000'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1000', ROUND(C1.H_NORMAIS_F, 2), 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  --NOVO EM 14/8/20
--dbms_output.put_line('DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = ''F'' AND CODIGO_EMPRESA = ''' ||LPAD(C1.EMPRESA,4,0) ||''' AND TIPO_CONTRATO = ''' || LPAD(C1.TIPO_CONTRATO,4,0) ||''' AND CODIGO_CONTRATO = '''|| LPAD(C1.MATRICULA,15,0) ||'''AND TRUNC(DATA) = TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY'') AND CODIGO_SITUACAO = ''1000''; COMMIT;' );  
--dbms_output.put_line('INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES ('''||LPAD(C1.EMPRESA,4,0) ||''','''|| LPAD(C1.TIPO_CONTRATO,4,0) ||''','''|| LPAD(C1.MATRICULA,15,0) ||''', TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY''),''1000'', ROUND('|| C1.H_NORMAIS_F ||',2), ''F'', SYSDATE, ''IFPONTO'','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;' );  --NOVO EM 14/8/20

--COMENTADO EM 14/8/20--dbms_output.put_line('INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES ('''||LPAD(C1.EMPRESA,4,0) ||''','''|| LPAD(C1.TIPO_CONTRATO,4,0) ||''','''|| LPAD(C1.MATRICULA,15,0) ||''', TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY''),''1000'', ROUND('|| C1.PREVISTO_F ||',2), ''F'', SYSDATE, ''IFPONTO'','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;' );  
--COMENTADO EM 14/8/20--dbms_output.put_line('DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = ''F'' AND CODIGO_EMPRESA = ''' ||LPAD(C1.EMPRESA,4,0) ||''' AND TIPO_CONTRATO = ''' || LPAD(C1.TIPO_CONTRATO,4,0) ||''' AND CODIGO_CONTRATO = '''|| LPAD(C1.MATRICULA,15,0) ||'''AND TRUNC(DATA) = TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY'') AND CODIGO_SITUACAO = ''1002''; COMMIT;' );  
--COMENTADO EM 14/8/20--dbms_output.put_line('INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES ('''||LPAD(C1.EMPRESA,4,0) ||''','''|| LPAD(C1.TIPO_CONTRATO,4,0) ||''','''|| LPAD(C1.MATRICULA,15,0) ||''', TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY''),''1002'', ROUND('||C1.EXTRA_DIA_INFO_SEM_MENSAL_F ||',2),''F'', SYSDATE, ''IFPONTO'','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;' );  

ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.34-DIA DESCANSO SO COM MARCACAO E SEM JUSTIFICATIVA GRAVAR: 1000-HORAS NORMAIS'
THEN
dbms_output.put_line('--A.34-DIA DESCANSO SO COM MARCACAO E SEM JUSTIFICATIVA GRAVAR: 1000-HORAS NORMAIS');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1000'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1000', ROUND(C1.H_NORMAIS_F ,2), 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  
--dbms_output.put_line('DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = ''F'' AND CODIGO_EMPRESA = ''' ||LPAD(C1.EMPRESA,4,0) ||''' AND TIPO_CONTRATO = ''' || LPAD(C1.TIPO_CONTRATO,4,0) ||''' AND CODIGO_CONTRATO = '''|| LPAD(C1.MATRICULA,15,0) ||'''AND TRUNC(DATA) = TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY'') AND CODIGO_SITUACAO = ''1000''; COMMIT;' );  
--dbms_output.put_line('INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES ('''||LPAD(C1.EMPRESA,4,0) ||''','''|| LPAD(C1.TIPO_CONTRATO,4,0) ||''','''|| LPAD(C1.MATRICULA,15,0) ||''', TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY''),''1000'', ROUND('|| C1.H_NORMAIS_F ||',2), ''F'', SYSDATE, ''IFPONTO'','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;' );  

ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.35-DIA DESCANSO SO COM MARCACAO E SEM JUSTIFICATIVA GRAVAR: 1000-HORAS NORMAIS E 1002-HORAS EXCEDENTES'
THEN
dbms_output.put_line('--A.35-DIA DESCANSO SO COM MARCACAO E SEM JUSTIFICATIVA GRAVAR: 1000-HORAS NORMAIS TIREI A 1002');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1000'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1000', ROUND(C1.H_NORMAIS_F ,2), 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  
--dbms_output.put_line('DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = ''F'' AND CODIGO_EMPRESA = ''' ||LPAD(C1.EMPRESA,4,0) ||''' AND TIPO_CONTRATO = ''' || LPAD(C1.TIPO_CONTRATO,4,0) ||''' AND CODIGO_CONTRATO = '''|| LPAD(C1.MATRICULA,15,0) ||'''AND TRUNC(DATA) = TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY'') AND CODIGO_SITUACAO = ''1000''; COMMIT;' );  
--dbms_output.put_line('INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES ('''||LPAD(C1.EMPRESA,4,0) ||''','''|| LPAD(C1.TIPO_CONTRATO,4,0) ||''','''|| LPAD(C1.MATRICULA,15,0) ||''', TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY''),''1000'', ROUND('|| C1.H_NORMAIS_F ||',2), ''F'', SYSDATE, ''IFPONTO'','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;' );  
--DESATIVADO 14/8/20--dbms_output.put_line('INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES ('''||LPAD(C1.EMPRESA,4,0) ||''','''|| LPAD(C1.TIPO_CONTRATO,4,0) ||''','''|| LPAD(C1.MATRICULA,15,0) ||''', TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY''),''1000'', ROUND('|| C1.PREVISTO_F ||',2), ''F'', SYSDATE, ''IFPONTO'','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;' );  
--DESATIVADO 14/8/20--dbms_output.put_line('DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = ''F'' AND CODIGO_EMPRESA = ''' ||LPAD(C1.EMPRESA,4,0) ||''' AND TIPO_CONTRATO = ''' || LPAD(C1.TIPO_CONTRATO,4,0) ||''' AND CODIGO_CONTRATO = '''|| LPAD(C1.MATRICULA,15,0) ||'''AND TRUNC(DATA) = TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY'') AND CODIGO_SITUACAO = ''1002''; COMMIT;' );  
--DESATIVADO 14/8/20--dbms_output.put_line('INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES ('''||LPAD(C1.EMPRESA,4,0) ||''','''|| LPAD(C1.TIPO_CONTRATO,4,0) ||''','''|| LPAD(C1.MATRICULA,15,0) ||''', TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY''),''1002'', ROUND('||C1.EXTRA_DIA_INFO_SEM_MENSAL_F ||',2),''F'', SYSDATE, ''IFPONTO'','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;' ); 

ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.36-DIA DESCANSO COM MARCACAO E JUSTIFICATIVA ABONADA GRAVAR: 1000-HORAS NORMAIS'
THEN
dbms_output.put_line('--A.36-DIA DESCANSO COM MARCACAO E JUSTIFICATIVA ABONADA GRAVAR: 1000-HORAS NORMAIS');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1000'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1000', ROUND( C1.H_NORMAIS_F ,2), 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  
--dbms_output.put_line('DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = ''F'' AND CODIGO_EMPRESA = ''' ||LPAD(C1.EMPRESA,4,0) ||''' AND TIPO_CONTRATO = ''' || LPAD(C1.TIPO_CONTRATO,4,0) ||''' AND CODIGO_CONTRATO = '''|| LPAD(C1.MATRICULA,15,0) ||'''AND TRUNC(DATA) = TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY'') AND CODIGO_SITUACAO = ''1000''; COMMIT;' );  
--dbms_output.put_line('INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES ('''||LPAD(C1.EMPRESA,4,0) ||''','''|| LPAD(C1.TIPO_CONTRATO,4,0) ||''','''|| LPAD(C1.MATRICULA,15,0) ||''', TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY''),''1000'', ROUND('|| C1.H_NORMAIS_F ||',2), ''F'', SYSDATE, ''IFPONTO'','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;' );  

ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.37-DIA DESCANSO COM MARCACAO E JUSTIFICATIVA ABONADA GRAVAR: 1000-HORAS NORMAIS E 1002-HORAS EXCEDENTES'
THEN
dbms_output.put_line('--A.37-DIA DESCANSO COM MARCACAO E JUSTIFICATIVA ABONADA GRAVAR: 1000-HORAS NORMAIS E 1002-HORAS EXCEDENTES');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1000'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1000', ROUND( C1.H_NORMAIS_F ,2), 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  --NOVO EM 14/8/20
--dbms_output.put_line('DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = ''F'' AND CODIGO_EMPRESA = ''' ||LPAD(C1.EMPRESA,4,0) ||''' AND TIPO_CONTRATO = ''' || LPAD(C1.TIPO_CONTRATO,4,0) ||''' AND CODIGO_CONTRATO = '''|| LPAD(C1.MATRICULA,15,0) ||'''AND TRUNC(DATA) = TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY'') AND CODIGO_SITUACAO = ''1000''; COMMIT;' );  
--dbms_output.put_line('INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES ('''||LPAD(C1.EMPRESA,4,0) ||''','''|| LPAD(C1.TIPO_CONTRATO,4,0) ||''','''|| LPAD(C1.MATRICULA,15,0) ||''', TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY''),''1000'', ROUND('|| C1.H_NORMAIS_F ||',2), ''F'', SYSDATE, ''IFPONTO'','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;' );  --NOVO EM 14/8/20

--COMENTADO EM 14/8/20--dbms_output.put_line('INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES ('''||LPAD(C1.EMPRESA,4,0) ||''','''|| LPAD(C1.TIPO_CONTRATO,4,0) ||''','''|| LPAD(C1.MATRICULA,15,0) ||''', TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY''),''1000'', ROUND('|| C1.PREVISTO_F ||',2), ''F'', SYSDATE, ''IFPONTO'','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;' );  
--COMENTADO EM 14/8/20--dbms_output.put_line('DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = ''F'' AND CODIGO_EMPRESA = ''' ||LPAD(C1.EMPRESA,4,0) ||''' AND TIPO_CONTRATO = ''' || LPAD(C1.TIPO_CONTRATO,4,0) ||''' AND CODIGO_CONTRATO = '''|| LPAD(C1.MATRICULA,15,0) ||'''AND TRUNC(DATA) = TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY'') AND CODIGO_SITUACAO = ''1002''; COMMIT;' );  
--COMENTADO EM 14/8/20--dbms_output.put_line('INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES ('''||LPAD(C1.EMPRESA,4,0) ||''','''|| LPAD(C1.TIPO_CONTRATO,4,0) ||''','''|| LPAD(C1.MATRICULA,15,0) ||''', TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY''),''1002'', ROUND('||C1.EXTRA_DIA_INFO_SEM_MENSAL_F ||',2),''F'', SYSDATE, ''IFPONTO'','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;' );  

----INICIO---------------------------------------------------------------------------------------CENARIOS NOVOS EM 3/12/20 DO A.45 a A.54 E 10/12/20 A.55 a A.58

ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.45-GRAVAR: 1012-PONTO FACULTATIVO'
THEN
dbms_output.put_line('--A.45-GRAVAR: 1012-PONTO FACULTATIVO');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0) AND TIPO_CONTRATO = LPAD(C1.TIPO_CONTRATO,4,0) AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE(trunc(C1.DATA),'DD/MM/YYYY') AND CODIGO_SITUACAO = '1012'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0),LPAD(C1.TIPO_CONTRATO,4,0), LPAD(C1.MATRICULA,15,0) , TO_DATE(trunc(C1.DATA) ,'DD/MM/YYYY'),'1012', 1, 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;

ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.46-PONTO FACULTATIVO GRAVAR: 1000-HORAS NORMAIS'
THEN
dbms_output.put_line('--A.46-PONTO FACULTATIVO GRAVAR: 1000-HORAS NORMAIS');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0) AND TIPO_CONTRATO = LPAD(C1.TIPO_CONTRATO,4,0) AND CODIGO_CONTRATO = LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE(trunc(C1.DATA), 'DD/MM/YYYY') AND CODIGO_SITUACAO = '1000'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0), LPAD(C1.TIPO_CONTRATO,4,0),LPAD(C1.MATRICULA,15,0), TO_DATE(trunc(C1.DATA),'DD/MM/YYYY'),'1000', ROUND(C1.H_NORMAIS_F,2), 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;

ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.47-GRAVAR: 0068-FERIADO'
THEN
dbms_output.put_line('--A.47-GRAVAR: 0068-FERIADO');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0) AND TIPO_CONTRATO = LPAD(C1.TIPO_CONTRATO,4,0) AND CODIGO_CONTRATO = LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '0068'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0), LPAD(C1.TIPO_CONTRATO,4,0),LPAD(C1.MATRICULA,15,0), TO_DATE( trunc(C1.DATA),'DD/MM/YYYY'),'0068', 1, 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;

ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200')
AND C1.O_QUE_FAZER = 'A.48-GRAVAR: 1003-FOLGA'
THEN
dbms_output.put_line('--A.48-GRAVAR: 1003-FOLGA');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0) AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO = LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE(trunc(C1.DATA),'DD/MM/YYYY') AND CODIGO_SITUACAO = '1003'; COMMIT;
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0), LPAD(C1.MATRICULA,15,0), TO_DATE( trunc(C1.DATA),'DD/MM/YYYY'),'1003', 1, 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;

ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200')
AND C1.O_QUE_FAZER = 'A.49-GRAVAR: 1003-FOLGA'
THEN
dbms_output.put_line('--A.49-GRAVAR: 1003-FOLGA');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0) AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO = LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE(trunc(C1.DATA),'DD/MM/YYYY') AND CODIGO_SITUACAO = '1003'; COMMIT;
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0), LPAD(C1.MATRICULA,15,0), TO_DATE( trunc(C1.DATA),'DD/MM/YYYY'),'1003', 1, 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;

ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.50-GRAVAR: 1012-PONTO FACULTATIVO'
THEN
dbms_output.put_line('--A.50-GRAVAR: 1012-PONTO FACULTATIVO');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0) AND TIPO_CONTRATO = LPAD(C1.TIPO_CONTRATO,4,0) AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE(trunc(C1.DATA),'DD/MM/YYYY') AND CODIGO_SITUACAO = '1012'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0),LPAD(C1.TIPO_CONTRATO,4,0), LPAD(C1.MATRICULA,15,0) , TO_DATE(trunc(C1.DATA) ,'DD/MM/YYYY'),'1012', 1, 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;

ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200')
AND C1.O_QUE_FAZER = 'A.51-GRAVAR: 1003-FOLGA'
THEN
dbms_output.put_line('--A.51-GRAVAR: 1003-FOLGA');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0) AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO = LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE(trunc(C1.DATA),'DD/MM/YYYY') AND CODIGO_SITUACAO = '1003'; COMMIT;
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0), LPAD(C1.MATRICULA,15,0), TO_DATE( trunc(C1.DATA),'DD/MM/YYYY'),'1003', 1, 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;

ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200')
AND C1.O_QUE_FAZER = 'A.52-GRAVAR: 1003-FOLGA'
THEN
dbms_output.put_line('--A.52-GRAVAR: 1003-FOLGA');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0) AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO = LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE(trunc(C1.DATA),'DD/MM/YYYY') AND CODIGO_SITUACAO = '1003'; COMMIT;
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0), LPAD(C1.MATRICULA,15,0), TO_DATE( trunc(C1.DATA),'DD/MM/YYYY'),'1003', 1, 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;

ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200')
AND C1.O_QUE_FAZER = 'A.53-GRAVAR: 1003-FOLGA'
THEN
dbms_output.put_line('--A.53-GRAVAR: 1003-FOLGA');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0) AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO = LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE(trunc(C1.DATA),'DD/MM/YYYY') AND CODIGO_SITUACAO = '1003'; COMMIT;
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0), LPAD(C1.MATRICULA,15,0), TO_DATE( trunc(C1.DATA),'DD/MM/YYYY'),'1003', 1, 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;

ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.54-GRAVAR: 1001 HORAS DIFERENCIADAS'
THEN
dbms_output.put_line('--A.54-GRAVAR: 1001 HORAS DIFERENCIADAS');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1001'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1001', ROUND(C1.DESCONTO_DIA_INFO_SEM_MENSAL_F ,2),'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  

ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.55-PONTO FACULTATIVO COM JUSTIFICATIVA ABONADA GRAVAR: 1000-HORAS NORMAIS'
THEN
dbms_output.put_line('--A.55-PONTO FACULTATIVO COM JUSTIFICATIVA ABONADA GRAVAR: 1000-HORAS NORMAIS');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0) AND TIPO_CONTRATO = LPAD(C1.TIPO_CONTRATO,4,0) AND CODIGO_CONTRATO = LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE(trunc(C1.DATA), 'DD/MM/YYYY') AND CODIGO_SITUACAO = '1000'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0), LPAD(C1.TIPO_CONTRATO,4,0),LPAD(C1.MATRICULA,15,0), TO_DATE(trunc(C1.DATA),'DD/MM/YYYY'),'1000', ROUND(C1.H_NORMAIS_F,2), 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;

ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.56-DIA DESCANSO COM MARCACAO E JUSTIFICATIVA ABONADA GRAVAR: 1000-HORAS NORMAIS'
THEN
dbms_output.put_line('--A.56-DIA DESCANSO COM MARCACAO E JUSTIFICATIVA ABONADA GRAVAR: 1000-HORAS NORMAIS');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0) AND TIPO_CONTRATO = LPAD(C1.TIPO_CONTRATO,4,0) AND CODIGO_CONTRATO = LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE(trunc(C1.DATA), 'DD/MM/YYYY') AND CODIGO_SITUACAO = '1000'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0), LPAD(C1.TIPO_CONTRATO,4,0),LPAD(C1.MATRICULA,15,0), TO_DATE(trunc(C1.DATA),'DD/MM/YYYY'),'1000', ROUND(C1.H_NORMAIS_F,2), 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;

ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.57-FERIADO COM JUSTIFICATIVA ABONADA GRAVAR: 1000-HORAS NORMAIS'
THEN
dbms_output.put_line('--A.57-FERIADO COM JUSTIFICATIVA ABONADA GRAVAR: 1000-HORAS NORMAIS');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0) AND TIPO_CONTRATO = LPAD(C1.TIPO_CONTRATO,4,0) AND CODIGO_CONTRATO = LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE(trunc(C1.DATA), 'DD/MM/YYYY') AND CODIGO_SITUACAO = '1000'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0), LPAD(C1.TIPO_CONTRATO,4,0),LPAD(C1.MATRICULA,15,0), TO_DATE(trunc(C1.DATA),'DD/MM/YYYY'),'1000', ROUND(C1.H_NORMAIS_F,2), 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;

ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.58-PONTO FACULTATIVO COM MARCACAO GRAVAR: 1000-HORAS NORMAIS'
THEN
dbms_output.put_line('--A.58-PONTO FACULTATIVO COM MARCACAO GRAVAR: 1000-HORAS NORMAIS');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0) AND TIPO_CONTRATO = LPAD(C1.TIPO_CONTRATO,4,0) AND CODIGO_CONTRATO = LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE(trunc(C1.DATA), 'DD/MM/YYYY') AND CODIGO_SITUACAO = '1000'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0), LPAD(C1.TIPO_CONTRATO,4,0),LPAD(C1.MATRICULA,15,0), TO_DATE(trunc(C1.DATA),'DD/MM/YYYY'),'1000', ROUND(C1.H_NORMAIS_F,2), 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;

ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.59-GRAVAR: 0020-FALTA'
THEN
dbms_output.put_line('--A.59-GRAVAR: 0020-FALTA');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '0020'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'0020', 1,'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  

--FIM-----------------------------------------------------------------------------------------------CENARIOS NOVOS EM 3/12/20 DO A.45 a A.54 E 10/12/20 A.55 a A.58

--INICIO----------------------------------------------CENARIOS NOVOS EM 30/12/20 DO A.60 a A.66
ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.60-GRAVAR: 1000-HORAS NORMAIS E 1001-HORAS DIFERENCIADAS'
THEN
dbms_output.put_line('--A.60-GRAVAR: 1000-HORAS NORMAIS E 1001-HORAS DIFERENCIADAS');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1000'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1000', ROUND(C1.H_NORMAIS_F ,2), 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1001'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1001', ROUND(C1.DESCONTO_DIA_INFO_SEM_MENSAL_F ,2),'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  

ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.61-GRAVAR: 0020-FALTA ULTIMO DIA PERIODO'
THEN
dbms_output.put_line('--A.61-GRAVAR: 0020-FALTA ULTIMO DIA PERIODO');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '0020'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'0020', 1,'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  

ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.62-GRAVAR FALTA'
THEN
dbms_output.put_line('--A.62-GRAVAR FALTA');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '0020'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'0020', 1,'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  

ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.63-GRAVA FALTA'
THEN
dbms_output.put_line('--A.63-GRAVA FALTA');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '0020'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'0020', 1,'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  

ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.64-GRAVA FERIADO'
THEN
dbms_output.put_line('--A.64-GRAVA FERIADO');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0) AND TIPO_CONTRATO = LPAD(C1.TIPO_CONTRATO,4,0) AND CODIGO_CONTRATO = LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '0068'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0), LPAD(C1.TIPO_CONTRATO,4,0),LPAD(C1.MATRICULA,15,0), TO_DATE( trunc(C1.DATA),'DD/MM/YYYY'),'0068', 1, 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;

ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200')
AND C1.O_QUE_FAZER = 'A.65-GRAVA FOLGA'
THEN
dbms_output.put_line('--A.65-GRAVA FOLGA');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0) AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO = LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE(trunc(C1.DATA),'DD/MM/YYYY') AND CODIGO_SITUACAO = '1003'; COMMIT;
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0), LPAD(C1.MATRICULA,15,0), TO_DATE( trunc(C1.DATA),'DD/MM/YYYY'),'1003', 1, 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;

ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.66-HORAS NORMAIS E HORAS EXCEDIDAS'
THEN
dbms_output.put_line('--A.66-HORAS NORMAIS E HORAS EXCEDIDAS');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1000'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1000', ROUND(C1.PREVISTO_F ,2), 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1002'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1002', ROUND(C1.EXTRA_DIA_INFO_SEM_MENSAL_F ,2),'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  

--FIM-------------------------------------------------CENARIOS NOVOS EM 30/12/20 DO A.60 a A.66


ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200')
AND C1.O_QUE_FAZER = 'A.38-DIA DESCANSO SO COM JUSTIFICATIVA NAO ABONADA GRAVAR: 1003-FOLGA'
THEN
dbms_output.put_line('--A.38-DIA DESCANSO SO COM JUSTIFICATIVA NAO ABONADA GRAVAR: 1003-FOLGA');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1003'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1003', 1, 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  
--dbms_output.put_line('DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = ''F'' AND CODIGO_EMPRESA = ''' ||LPAD(C1.EMPRESA,4,0) ||''' AND TIPO_CONTRATO = ''' || LPAD(C1.TIPO_CONTRATO,4,0) ||''' AND CODIGO_CONTRATO = '''|| LPAD(C1.MATRICULA,15,0) ||'''AND TRUNC(DATA) = TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY'') AND CODIGO_SITUACAO = ''1003''; COMMIT;' );  
--dbms_output.put_line('INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES ('''||LPAD(C1.EMPRESA,4,0) ||''','''|| LPAD(C1.TIPO_CONTRATO,4,0) ||''','''|| LPAD(C1.MATRICULA,15,0) ||''', TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY''),''1003'', 1, ''F'', SYSDATE, ''IFPONTO'','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;' );  

ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.39-DIA DESCANSO SO COM JUSTIFICATIVA NAO ABONADA GRAVAR: 0068-FERIADO'
THEN
dbms_output.put_line('--A.39-DIA DESCANSO SO COM JUSTIFICATIVA NAO ABONADA GRAVAR: 0068-FERIADO');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '0068'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'0068', 1, 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  
--dbms_output.put_line('DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = ''F'' AND CODIGO_EMPRESA = ''' ||LPAD(C1.EMPRESA,4,0) ||''' AND TIPO_CONTRATO = ''' || LPAD(C1.TIPO_CONTRATO,4,0) ||''' AND CODIGO_CONTRATO = '''|| LPAD(C1.MATRICULA,15,0) ||'''AND TRUNC(DATA) = TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY'') AND CODIGO_SITUACAO = ''0068''; COMMIT;' );  
--dbms_output.put_line('INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES ('''||LPAD(C1.EMPRESA,4,0) ||''','''|| LPAD(C1.TIPO_CONTRATO,4,0) ||''','''|| LPAD(C1.MATRICULA,15,0) ||''', TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY''),''0068'', 1, ''F'', SYSDATE, ''IFPONTO'','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;' );  

ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.40-DIA DESCANSO SO COM JUSTIFICATIVA NAO ABONADA GRAVAR: 1012-PONTO FACULTATIVO'
THEN
dbms_output.put_line('--A.40-DIA DESCANSO SO COM JUSTIFICATIVA NAO ABONADA GRAVAR: 1012-PONTO FACULTATIVO');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1012'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1012', 1, 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  
--dbms_output.put_line('DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = ''F'' AND CODIGO_EMPRESA = ''' ||LPAD(C1.EMPRESA,4,0) ||''' AND TIPO_CONTRATO = ''' || LPAD(C1.TIPO_CONTRATO,4,0) ||''' AND CODIGO_CONTRATO = '''|| LPAD(C1.MATRICULA,15,0) ||'''AND TRUNC(DATA) = TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY'') AND CODIGO_SITUACAO = ''1012''; COMMIT;' );  
--dbms_output.put_line('INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES ('''||LPAD(C1.EMPRESA,4,0) ||''','''|| LPAD(C1.TIPO_CONTRATO,4,0) ||''','''|| LPAD(C1.MATRICULA,15,0) ||''', TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY''),''1012'', 1, ''F'', SYSDATE, ''IFPONTO'','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;' );  

--fim novo em 17/7/20


--inicio-----------------------------novo em 6/7/21
--'A.54.2-GRAVAR: 1001 HORAS DIFERENCIADAS'
ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.54.2-GRAVAR: 1001 HORAS DIFERENCIADAS'
THEN
dbms_output.put_line('--A.54.2-GRAVAR: 1001 HORAS DIFERENCIADAS');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1001'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1001', ROUND(C1.DESCONTO_DIA_INFO_SEM_MENSAL_F ,2),'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  

--'A.60.2-GRAVAR: 1000-HORAS NORMAIS E 1001-HORAS DIFERENCIADAS'
ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.60.2-GRAVAR: 1000-HORAS NORMAIS E 1001-HORAS DIFERENCIADAS'
THEN
dbms_output.put_line('--A.60.2-GRAVAR: 1000-HORAS NORMAIS E 1001-HORAS DIFERENCIADAS');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1000'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1000', ROUND(C1.H_NORMAIS_F ,2), 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1001'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1001', ROUND(C1.DESCONTO_DIA_INFO_SEM_MENSAL_F ,2),'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  

--'A.87-GRAVAR: 1000-HORAS NORMAIS E 1002-HORAS EXCEDENTES'
ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.87-GRAVAR: 1000-HORAS NORMAIS E 1002-HORAS EXCEDENTES'
THEN
dbms_output.put_line('--A.87-GRAVAR: 1000-HORAS NORMAIS E 1002-HORAS EXCEDENTES');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1000'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1000', ROUND(C1.PREVISTO_F ,2), 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1002'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1002', ROUND(C1.EXTRA_DIA_INFO_SEM_MENSAL_F ,2),'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  

--'A.70-FOLGA GRAVAR: 1002-HORAS EXCEDENTES'
ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.70-FOLGA GRAVAR: 1002-HORAS EXCEDENTES'
THEN
dbms_output.put_line('--A.70-FOLGA GRAVAR: 1002-HORAS EXCEDENTES');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1002'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1002', ROUND(C1.EXTRA_DIA_INFO_SEM_MENSAL_F ,2),'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  

--'A.71-GRAVAR: 1003-FOLGA'
ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200')
AND C1.O_QUE_FAZER = 'A.71-GRAVAR: 1003-FOLGA'
THEN
dbms_output.put_line('--A.71-GRAVAR: 1003-FOLGA');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0) AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO = LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE(trunc(C1.DATA),'DD/MM/YYYY') AND CODIGO_SITUACAO = '1003'; COMMIT;
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0), LPAD(C1.MATRICULA,15,0), TO_DATE( trunc(C1.DATA),'DD/MM/YYYY'),'1003', 1, 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;

--'A.72-GRAVAR: 1002-HORAS EXCEDENTES'
ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.72-GRAVAR: 1002-HORAS EXCEDENTES'
THEN
dbms_output.put_line('--A.72-GRAVAR: 1002-HORAS EXCEDENTES');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1002'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1002', ROUND(C1.EXTRA_DIA_INFO_SEM_MENSAL_F ,2),'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  

--'A.73-GRAVAR: 1002-HORAS EXCEDENTES'
ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.73-GRAVAR: 1002-HORAS EXCEDENTES'
THEN
dbms_output.put_line('--A.73-GRAVAR: 1002-HORAS EXCEDENTES');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1002'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1002', ROUND(C1.EXTRA_DIA_INFO_SEM_MENSAL_F ,2),'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  

--'A.74-GRAVAR: 1003-FOLGA'
ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200')
AND C1.O_QUE_FAZER = 'A.74-GRAVAR: 1003-FOLGA'
THEN
dbms_output.put_line('--A.74-GRAVAR: 1003-FOLGA');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0) AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO = LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE(trunc(C1.DATA),'DD/MM/YYYY') AND CODIGO_SITUACAO = '1003'; COMMIT;
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0), LPAD(C1.MATRICULA,15,0), TO_DATE( trunc(C1.DATA),'DD/MM/YYYY'),'1003', 1, 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;

--'A.75-GRAVAR: 1002-HORAS EXCEDENTES'
ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.75-GRAVAR: 1002-HORAS EXCEDENTES'
THEN
dbms_output.put_line('--A.75-GRAVAR: 1002-HORAS EXCEDENTES');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1002'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1002', ROUND(C1.EXTRA_DIA_INFO_SEM_MENSAL_F ,2),'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  

--'A.76-GRAVAR: 1003-FOLGA'
ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200')
AND C1.O_QUE_FAZER = 'A.76-GRAVAR: 1003-FOLGA'
THEN
dbms_output.put_line('--A.76-GRAVAR: 1003-FOLGA');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0) AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO = LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE(trunc(C1.DATA),'DD/MM/YYYY') AND CODIGO_SITUACAO = '1003'; COMMIT;
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0), LPAD(C1.MATRICULA,15,0), TO_DATE( trunc(C1.DATA),'DD/MM/YYYY'),'1003', 1, 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;

--'A.77-GRAVAR: 1003-FOLGA'
ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200')
AND C1.O_QUE_FAZER = 'A.77-GRAVAR: 1003-FOLGA'
THEN
dbms_output.put_line('--A.77-GRAVAR: 1003-FOLGA');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0) AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO = LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE(trunc(C1.DATA),'DD/MM/YYYY') AND CODIGO_SITUACAO = '1003'; COMMIT;
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0), LPAD(C1.MATRICULA,15,0), TO_DATE( trunc(C1.DATA),'DD/MM/YYYY'),'1003', 1, 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;

--'A.78-GRAVAR: 1003-FOLGA'
ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200')
AND C1.O_QUE_FAZER = 'A.78-GRAVAR: 1003-FOLGA'
THEN
dbms_output.put_line('--A.78-GRAVAR: 1003-FOLGA');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0) AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO = LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE(trunc(C1.DATA),'DD/MM/YYYY') AND CODIGO_SITUACAO = '1003'; COMMIT;
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0), LPAD(C1.MATRICULA,15,0), TO_DATE( trunc(C1.DATA),'DD/MM/YYYY'),'1003', 1, 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;

--'A.79-GRAVAR: 1002-HORAS EXCEDENTES'
ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.79-GRAVAR: 1002-HORAS EXCEDENTES'
THEN
dbms_output.put_line('--A.79-GRAVAR: 1002-HORAS EXCEDENTES');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1002'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1002', ROUND(C1.EXTRA_DIA_INFO_SEM_MENSAL_F ,2),'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  

--'A.80-GRAVAR: 1003-FOLGA'
ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200')
AND C1.O_QUE_FAZER = 'A.80-GRAVAR: 1003-FOLGA'
THEN
dbms_output.put_line('--A.80-GRAVAR: 1003-FOLGA');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0) AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO = LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE(trunc(C1.DATA),'DD/MM/YYYY') AND CODIGO_SITUACAO = '1003'; COMMIT;
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0), LPAD(C1.MATRICULA,15,0), TO_DATE( trunc(C1.DATA),'DD/MM/YYYY'),'1003', 1, 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;

--'A.81-GRAVAR: 1002-HORAS EXCEDENTES'
ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.81-GRAVAR: 1002-HORAS EXCEDENTES'
THEN
dbms_output.put_line('--A.81-GRAVAR: 1002-HORAS EXCEDENTES');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1002'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1002', ROUND(C1.EXTRA_DIA_INFO_SEM_MENSAL_F ,2),'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  

--'A.82-GRAVAR: 1003-FOLGA'
ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200')
AND C1.O_QUE_FAZER = 'A.82-GRAVAR: 1003-FOLGA'
THEN
dbms_output.put_line('--A.82-GRAVAR: 1003-FOLGA');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0) AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO = LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE(trunc(C1.DATA),'DD/MM/YYYY') AND CODIGO_SITUACAO = '1003'; COMMIT;
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0), LPAD(C1.MATRICULA,15,0), TO_DATE( trunc(C1.DATA),'DD/MM/YYYY'),'1003', 1, 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;

--'A.83-GRAVAR: 0020-FALTA'
ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.83-GRAVAR: 0020-FALTA'
THEN
dbms_output.put_line('--A.83-GRAVAR: 0020-FALTA');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '0020'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'0020', 1,'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  

--'A.84-GRAVAR: 1001-HORAS DIFERENCIADAS'
ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.84-GRAVAR: 1001-HORAS DIFERENCIADAS'
THEN
dbms_output.put_line('--A.84-GRAVAR: 1001-HORAS DIFERENCIADAS');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1001'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1001', ROUND(C1.DESCONTO_DIA_INFO_SEM_MENSAL_F ,2),'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  

--'A.85-FERIADO GRAVAR: 1000-HORAS NORMAIS E 1001-HORAS DIFERENCIADAS'
ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.85-FERIADO GRAVAR: 1000-HORAS NORMAIS E 1001-HORAS DIFERENCIADAS'
THEN
dbms_output.put_line('--A.85-FERIADO GRAVAR: 1000-HORAS NORMAIS E 1001-HORAS DIFERENCIADAS');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1000'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1000', ROUND(C1.H_NORMAIS_F ,2), 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1001'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1001', ROUND(C1.DESCONTO_DIA_INFO_SEM_MENSAL_F ,2),'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  

--'A.11-GRAVAR: Situação de Ponto da Justificativa'>'A.86-FERIADO GRAVAR: JUSTIFICATIVA E 1001- HORAS DIFERENCIADAS'

--'********A.88- ERRO IFRACTAL AVISAR ASTIN E FAZER AJUSTE MANUAL'
ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.113-GRAVAR: 1000-HORAS NORMAIS'-- --'********A.88- ERRO IFRACTAL AVISAR ASTIN E FAZER AJUSTE MANUAL'
THEN
dbms_output.put_line('A.113-GRAVAR: 1000-HORAS NORMAIS');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0) AND TIPO_CONTRATO = LPAD(C1.TIPO_CONTRATO,4,0) AND CODIGO_CONTRATO = LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE(trunc(C1.DATA), 'DD/MM/YYYY') AND CODIGO_SITUACAO = '1000'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0), LPAD(C1.TIPO_CONTRATO,4,0),LPAD(C1.MATRICULA,15,0), TO_DATE(trunc(C1.DATA),'DD/MM/YYYY'),'1000', ROUND(C1.H_NORMAIS_F,2), 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;


--'A.89-FERIADO GRAVAR: 1000-HORAS NORMAIS E 1001-HORAS DIFERENCIADAS'
ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.89-FERIADO GRAVAR: 1000-HORAS NORMAIS E 1001-HORAS DIFERENCIADAS'
THEN
dbms_output.put_line('--A.89-FERIADO GRAVAR: 1000-HORAS NORMAIS E 1001-HORAS DIFERENCIADAS');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1000'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1000', ROUND(C1.H_NORMAIS_F ,2), 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1001'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1001', ROUND(C1.DESCONTO_DIA_INFO_SEM_MENSAL_F ,2),'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  

--'A.90-GRAVAR: 0020 FALTA'
ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.90-GRAVAR: 0020 FALTA'
THEN
dbms_output.put_line('--A.90-GRAVAR: 0020 FALTA');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '0020'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'0020', 1,'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  

--'A.11-GRAVAR: Situação de Ponto da Justificativa'>'A.91-GRAVAR: 1000-HORAS NORMAIS E 1001-HORAS DIFERENCIADAS'
--'A.11-GRAVAR: Situação de Ponto da Justificativa'>'A.92-GRAVAR: JUSTIFICATIVA'

--'A.93-GRAVAR: 0020 FALTA'
ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.93-GRAVAR: 0020 FALTA'
THEN
dbms_output.put_line('--A.93-GRAVAR: 0020 FALTA');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '0020'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'0020', 1,'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  

--'A.94-GRAVAR: 0020 FALTA'
ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.94-GRAVAR: 0020 FALTA'
THEN
dbms_output.put_line('--A.94-GRAVAR: 0020 FALTA');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '0020'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'0020', 1,'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  

--fim-----------------------------novo em 6/7/21


--inicio-----------------------------novo em 11/8/21
ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200')
AND C1.O_QUE_FAZER = 'A.95-GRAVAR: 1003-FOLGA'
THEN
dbms_output.put_line('--A.95-GRAVAR: 1003-FOLGA');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0) AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO = LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE(trunc(C1.DATA),'DD/MM/YYYY') AND CODIGO_SITUACAO = '1003'; COMMIT;
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0), LPAD(C1.MATRICULA,15,0), TO_DATE( trunc(C1.DATA),'DD/MM/YYYY'),'1003', 1, 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;

ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200')
AND C1.O_QUE_FAZER = 'A.96-GRAVAR: 1003-FOLGA'
THEN
dbms_output.put_line('--A.96-GRAVAR: 1003-FOLGA');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0) AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO = LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE(trunc(C1.DATA),'DD/MM/YYYY') AND CODIGO_SITUACAO = '1003'; COMMIT;
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0), LPAD(C1.MATRICULA,15,0), TO_DATE( trunc(C1.DATA),'DD/MM/YYYY'),'1003', 1, 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;

ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.97-GRAVAR: 1002-HORAS EXCEDENTES'
THEN
dbms_output.put_line('--A.97-GRAVAR: 1002-HORAS EXCEDENTES');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1002'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1002', ROUND(C1.EXTRA_DIA_INFO_SEM_MENSAL_F ,2),'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  

ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.98-GRAVAR: 1002-HORAS EXCEDENTES'
THEN
dbms_output.put_line('--A.98-GRAVAR: 1002-HORAS EXCEDENTES');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1002'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1002', ROUND(C1.EXTRA_DIA_INFO_SEM_MENSAL_F ,2),'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  

ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.99-GRAVAR: 1002-HORAS EXCEDENTES'
THEN
dbms_output.put_line('--A.99-GRAVAR: 1002-HORAS EXCEDENTES');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1002'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1002', ROUND(C1.EXTRA_DIA_INFO_SEM_MENSAL_F ,2),'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  

ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200')
AND C1.O_QUE_FAZER = 'A.100-GRAVAR: 1003-FOLGA'
THEN
dbms_output.put_line('--A.100-GRAVAR: 1003-FOLGA');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0) AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO = LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE(trunc(C1.DATA),'DD/MM/YYYY') AND CODIGO_SITUACAO = '1003'; COMMIT;
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0), LPAD(C1.MATRICULA,15,0), TO_DATE( trunc(C1.DATA),'DD/MM/YYYY'),'1003', 1, 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;

ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.101-GRAVAR: 1002-HORAS EXCEDENTES'
THEN
dbms_output.put_line('--A.101-GRAVAR: 1002-HORAS EXCEDENTES');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1002'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1002', ROUND(C1.EXTRA_DIA_INFO_SEM_MENSAL_F ,2),'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  

--A.11-GRAVAR: Situação de Ponto da Justificativa'	A.102-FERIADO COM JUSTIFICATIVA ABONADA GRAVAR: 1000-HORAS NORMAIS e 1001-HORAS DIFERENCIADAS'

--A.11-GRAVAR: Situação de Ponto da Justificativa'	A.103-FERIADO GRAVAR: JUSTIFICATIVA E 1002- HORAS EXCEDENTES'

ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.109-GRAVAR: 0020 FALTA'
THEN
dbms_output.put_line('--A.109-GRAVAR: 0020 FALTA');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '0020'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'0020', 1,'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  

--A.11-GRAVAR: Situação de Ponto da Justificativa'	A.104-FERIADO COM JUSTIFICATIVA ABONADA GRAVAR: 1000-HORAS NORMAIS e 1001-HORAS DIFERENCIADAS'

--A.11-GRAVAR: Situação de Ponto da Justificativa'	A.105-FERIADO COM JUSTIFICATIVA ABONADA GRAVAR: 1000-HORAS NORMAIS'

ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200')
AND C1.O_QUE_FAZER = 'A.106-GRAVAR: 1003-FOLGA'
THEN
dbms_output.put_line('--A.106-GRAVAR: 1003-FOLGA');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0) AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO = LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE(trunc(C1.DATA),'DD/MM/YYYY') AND CODIGO_SITUACAO = '1003'; COMMIT;
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0), LPAD(C1.MATRICULA,15,0), TO_DATE( trunc(C1.DATA),'DD/MM/YYYY'),'1003', 1, 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;

--A.11-GRAVAR: Situação de Ponto da Justificativa'	A.107-FERIADO COM JUSTIFICATIVA ABONADA GRAVAR: 1000-HORAS NORMAIS+1002-EXEDIDAS'

ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.108-FERIADO GRAVAR: 1000-HORAS NORMAIS E 1002-HORAS EXCEDIDAS'
THEN
dbms_output.put_line('--A.108-FERIADO GRAVAR: 1000-HORAS NORMAIS E 1002-HORAS EXCEDIDAS');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1000'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1000', ROUND(C1.PREVISTO_F ,2), 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1002'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1002', ROUND(C1.EXTRA_DIA_INFO_SEM_MENSAL_F ,2),'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  

ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.110- GRAVAR: 1000-HORAS NORMAIS + 1001-HORAS DIFERENCIADAS'
THEN
dbms_output.put_line('--A.110- GRAVAR: 1000-HORAS NORMAIS + 1001-HORAS DIFERENCIADAS');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1000'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1000', ROUND(C1.H_NORMAIS_F ,2), 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1001'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1001', ROUND(C1.DESCONTO_DIA_INFO_SEM_MENSAL_F ,2),'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  

ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.111-GRAVAR: 0020 FALTA'
THEN
dbms_output.put_line('--A.111-GRAVAR: 0020 FALTA');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '0020'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'0020', 1,'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  

--fim-----------------------------novo em 11/8/21

--INICIO-----------------------------novo em 28/9/21
--A.112-FERIADO GRAVAR: 1000-HORAS NORMAIS E 1002-HORAS EXCEDIDAS'
ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.112-FERIADO GRAVAR: 1000-HORAS NORMAIS E 1002-HORAS EXCEDIDAS'
THEN
dbms_output.put_line('--A.112-FERIADO GRAVAR: 1000-HORAS NORMAIS E 1002-HORAS EXCEDIDAS');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1000'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1000', ROUND(C1.PREVISTO_F ,2), 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1002'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1002', ROUND(C1.EXTRA_DIA_INFO_SEM_MENSAL_F ,2),'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  

--A.115-GRAVAR: 1001-HORAS DIFERENCIADAS'
ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.115-GRAVAR: 1001-HORAS DIFERENCIADAS'
THEN
dbms_output.put_line('--A.115-GRAVAR: 1001-HORAS DIFERENCIADAS');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1001'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1001', ROUND(C1.DESCONTO_DIA_INFO_SEM_MENSAL_F ,2),'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  

--A.15-?Gravar no dia a Situação de Ponto da Justificativa + horas excedidas?'
--A.15-?Gravar no dia a Situação de Ponto da Justificativa + horas excedidas?'

--A.114-GRAVAR: 1001-HORAS DIFERENCIADAS'
ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.114-GRAVAR: 1001-HORAS DIFERENCIADAS'
THEN
dbms_output.put_line('--A.114-GRAVAR: 1001-HORAS DIFERENCIADAS');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1001'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1001', ROUND(C1.DESCONTO_DIA_INFO_SEM_MENSAL_F ,2),'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  

--A.116-GRAVAR: 1000-HORAS NORMAIS'
ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.116-GRAVAR: 1000-HORAS NORMAIS'
THEN
dbms_output.put_line('--A.116-GRAVAR: 1000-HORAS NORMAIS');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0) AND TIPO_CONTRATO = LPAD(C1.TIPO_CONTRATO,4,0) AND CODIGO_CONTRATO = LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE(trunc(C1.DATA), 'DD/MM/YYYY') AND CODIGO_SITUACAO = '1000'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0), LPAD(C1.TIPO_CONTRATO,4,0),LPAD(C1.MATRICULA,15,0), TO_DATE(trunc(C1.DATA),'DD/MM/YYYY'),'1000', ROUND(C1.H_NORMAIS_F,2), 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;

--A.117-GRAVAR: 1003-FOLGA'
ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200')
AND C1.O_QUE_FAZER = 'A.117-GRAVAR: 1003-FOLGA'
THEN
dbms_output.put_line('--A.117-GRAVAR: 1003-FOLGA');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0) AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO = LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE(trunc(C1.DATA),'DD/MM/YYYY') AND CODIGO_SITUACAO = '1003'; COMMIT;
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0), LPAD(C1.MATRICULA,15,0), TO_DATE( trunc(C1.DATA),'DD/MM/YYYY'),'1003', 1, 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;

--A.118-DIA DESCANSO COM MARCACAO E JUSTIFICATIVA ABONADA GRAVAR: 1002-HORAS EXCEDIDAS
ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.118-DIA DESCANSO COM MARCACAO E JUSTIFICATIVA ABONADA GRAVAR: 1002-HORAS EXCEDIDAS'
THEN
dbms_output.put_line('--A.118-DIA DESCANSO COM MARCACAO E JUSTIFICATIVA ABONADA GRAVAR: 1002-HORAS EXCEDIDAS');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1002'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1002', ROUND(C1.EXTRA_DIA_INFO_SEM_MENSAL_F ,2),'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  

--FIM-----------------------------novo em 28/9/21

--INICIO-----------------------------novo em 29/10/21
--A.119-GRAVAR: 1002-HORAS EXCEDENTES'
ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.119-GRAVAR: 1002-HORAS EXCEDENTES'
THEN
dbms_output.put_line('--A.119-GRAVAR: 1002-HORAS EXCEDENTES');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1002'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1002', ROUND(C1.EXTRA_DIA_INFO_SEM_MENSAL_F ,2),'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  

--A.120-GRAVAR: 1002-HORAS EXCEDENTES'
ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.120-GRAVAR: 1002-HORAS EXCEDENTES'
THEN
dbms_output.put_line('--A.120-GRAVAR: 1002-HORAS EXCEDENTES');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1002'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1002', ROUND(C1.EXTRA_DIA_INFO_SEM_MENSAL_F ,2),'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  

--A.121-GRAVAR: 1003-FOLGA
ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200')
AND C1.O_QUE_FAZER = 'A.121-GRAVAR: 1003-FOLGA'
THEN
dbms_output.put_line('--A.121-GRAVAR: 1003-FOLGA');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0) AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO = LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE(trunc(C1.DATA),'DD/MM/YYYY') AND CODIGO_SITUACAO = '1003'; COMMIT;
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0), LPAD(C1.MATRICULA,15,0), TO_DATE( trunc(C1.DATA),'DD/MM/YYYY'),'1003', 1, 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;

--A.122-GRAVAR: 1002-HORAS EXCEDENTES'
ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.122-GRAVAR: 1002-HORAS EXCEDENTES'
THEN
dbms_output.put_line('--A.122-GRAVAR: 1002-HORAS EXCEDENTES');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1002'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1002', ROUND(C1.EXTRA_DIA_INFO_SEM_MENSAL_F ,2),'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  

--A.123-GRAVAR: 1003-FOLGA
ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200')
AND C1.O_QUE_FAZER = 'A.123-GRAVAR: 1003-FOLGA'
THEN
dbms_output.put_line('--A.123-GRAVAR: 1003-FOLGA');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0) AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO = LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE(trunc(C1.DATA),'DD/MM/YYYY') AND CODIGO_SITUACAO = '1003'; COMMIT;
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0), LPAD(C1.MATRICULA,15,0), TO_DATE( trunc(C1.DATA),'DD/MM/YYYY'),'1003', 1, 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;

--A.124-GRAVAR: 1002-HORAS EXCEDENTES'
ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.124-GRAVAR: 1002-HORAS EXCEDENTES'
THEN
dbms_output.put_line('--A.124-GRAVAR: 1002-HORAS EXCEDENTES');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1002'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1002', ROUND(C1.EXTRA_DIA_INFO_SEM_MENSAL_F ,2),'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  

--A.125-GRAVAR: 0020-FALTA'
ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.125-GRAVAR: 0020-FALTA'
THEN
dbms_output.put_line('--A.125-GRAVAR: 0020-FALTA');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '0020'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'0020', 1,'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  

--A.126-GRAVAR: 0020-FALTA'
ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.126-GRAVAR: 0020-FALTA'
THEN
dbms_output.put_line('--A.126-GRAVAR: 0020-FALTA');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '0020'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'0020', 1,'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  

--A.127-GRAVAR: 1000-HORAS NORMAIS'
ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.127-GRAVAR: 1000-HORAS NORMAIS'
THEN
dbms_output.put_line('--A.127-GRAVAR: 1000-HORAS NORMAIS');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0) AND TIPO_CONTRATO = LPAD(C1.TIPO_CONTRATO,4,0) AND CODIGO_CONTRATO = LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE(trunc(C1.DATA), 'DD/MM/YYYY') AND CODIGO_SITUACAO = '1000'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0), LPAD(C1.TIPO_CONTRATO,4,0),LPAD(C1.MATRICULA,15,0), TO_DATE(trunc(C1.DATA),'DD/MM/YYYY'),'1000', ROUND(C1.H_NORMAIS_F,2), 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;

--A.128-FERIADO GRAVAR: 1000-HORAS NORMAIS E 1001-HORAS DIFERENCIADAS'
ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.128-FERIADO GRAVAR: 1000-HORAS NORMAIS E 1001-HORAS DIFERENCIADAS'
THEN
dbms_output.put_line('--A.128-FERIADO GRAVAR: 1000-HORAS NORMAIS E 1001-HORAS DIFERENCIADAS');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1000'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1000', ROUND(C1.H_NORMAIS_F ,2), 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1001'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1001', ROUND(C1.DESCONTO_DIA_INFO_SEM_MENSAL_F ,2),'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  

--A.129-FERIADO GRAVAR: 1000-HORAS NORMAIS E 1002-HORAS EXCEDIDAS'
ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.129-FERIADO GRAVAR: 1000-HORAS NORMAIS E 1002-HORAS EXCEDIDAS'
THEN
dbms_output.put_line('--A.129-FERIADO GRAVAR: 1000-HORAS NORMAIS E 1002-HORAS EXCEDIDAS');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1000'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1000', ROUND(C1.PREVISTO_F ,2), 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1002'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1002', ROUND(C1.EXTRA_DIA_INFO_SEM_MENSAL_F ,2),'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  

--A.130-GRAVAR: 1001-HORAS DIFERENCIADAS'
ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.130-GRAVAR: 1001-HORAS DIFERENCIADAS'
THEN
dbms_output.put_line('--A.130-GRAVAR: 1001-HORAS DIFERENCIADAS');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1001'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1001', ROUND(C1.DESCONTO_DIA_INFO_SEM_MENSAL_F ,2),'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  

--A.131-GRAVAR: 1001-HORAS DIFERENCIADAS'
ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.131-GRAVAR: 1001-HORAS DIFERENCIADAS'
THEN
dbms_output.put_line('--A.131-GRAVAR: 1001-HORAS DIFERENCIADAS');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1001'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1001', ROUND(C1.DESCONTO_DIA_INFO_SEM_MENSAL_F ,2),'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  

--FIM-----------------------------novo em 29/10/21

--INICIO----------------------------------------------------NOVO EM 11/11/21
--A.132-GRAVAR: 1002-HORAS EXCEDENTES'
ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.132-GRAVAR: 1002-HORAS EXCEDENTES'
THEN
dbms_output.put_line('--A.132-GRAVAR: 1002-HORAS EXCEDENTES');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1002'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1002', ROUND(C1.EXTRA_DIA_INFO_SEM_MENSAL_F ,2),'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  

--A.133-GRAVAR: 1003-FOLGA'
ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200')
AND C1.O_QUE_FAZER = 'A.133-GRAVAR: 1003-FOLGA'
THEN
dbms_output.put_line('--A.133-GRAVAR: 1003-FOLGA');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0) AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO = LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE(trunc(C1.DATA),'DD/MM/YYYY') AND CODIGO_SITUACAO = '1003'; COMMIT;
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0), LPAD(C1.MATRICULA,15,0), TO_DATE( trunc(C1.DATA),'DD/MM/YYYY'),'1003', 1, 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;

--A.134-PONTO_FACULTATIVO GRAVAR: 1000-HORAS NORMAIS E 1001-HORAS DIFERENCIADAS'
ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.134-PONTO_FACULTATIVO GRAVAR: 1000-HORAS NORMAIS E 1001-HORAS DIFERENCIADAS'
THEN
dbms_output.put_line('--A.134-PONTO_FACULTATIVO GRAVAR: 1000-HORAS NORMAIS E 1001-HORAS DIFERENCIADAS');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1000'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1000', ROUND(C1.H_NORMAIS_F ,2), 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1001'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1001', ROUND(C1.DESCONTO_DIA_INFO_SEM_MENSAL_F ,2),'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  

--A.135-GRAVAR: 0020-FALTA'
ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.135-GRAVAR: 0020-FALTA'
THEN
dbms_output.put_line('--A.135-GRAVAR: 0020-FALTA');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '0020'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'0020', 1,'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  

--A.136-GRAVAR: 0020-FALTA'
ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.136-GRAVAR: 0020-FALTA'
THEN
dbms_output.put_line('--A.136-GRAVAR: 0020-FALTA');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '0020'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'0020', 1,'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  

--A.137-PONTO_FACULTATIVO GRAVAR: 1000-HORAS NORMAIS E 1002-HORAS EXCEDIDAS'
ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.137-PONTO_FACULTATIVO GRAVAR: 1000-HORAS NORMAIS E 1002-HORAS EXCEDIDAS'
THEN
dbms_output.put_line('--A.137-PONTO_FACULTATIVO GRAVAR: 1000-HORAS NORMAIS E 1002-HORAS EXCEDIDAS');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1000'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1000', ROUND(C1.PREVISTO_F ,2), 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1002'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1002', ROUND(C1.EXTRA_DIA_INFO_SEM_MENSAL_F ,2),'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  

--FIM----------------------------------------------------NOVO EM 11/11/21


--INICIO----------------------------------------------------NOVO EM 10/12/21
--A.138-GRAVAR: 1002-HORAS EXCEDENTES'
ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.138-GRAVAR: 1002-HORAS EXCEDENTES'
THEN
dbms_output.put_line('--A.138-GRAVAR: 1002-HORAS EXCEDENTES');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1002'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1002', ROUND(C1.EXTRA_DIA_INFO_SEM_MENSAL_F ,2),'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  

--'A.139-GRAVAR: 1002-HORAS EXCEDENTES'
ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.139-GRAVAR: 1002-HORAS EXCEDENTES'
THEN
dbms_output.put_line('--A.139-GRAVAR: 1002-HORAS EXCEDENTES');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1002'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1002', ROUND(C1.EXTRA_DIA_INFO_SEM_MENSAL_F ,2),'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  

--'A.140-GRAVA FOLGA
ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200')
AND C1.O_QUE_FAZER = 'A.140-GRAVA FOLGA'
THEN
dbms_output.put_line('--A.140-GRAVA FOLGA');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0) AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO = LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE(trunc(C1.DATA),'DD/MM/YYYY') AND CODIGO_SITUACAO = '1003'; COMMIT;
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0), LPAD(C1.MATRICULA,15,0), TO_DATE( trunc(C1.DATA),'DD/MM/YYYY'),'1003', 1, 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;

--'A.141-GRAVAR: 1002-HORAS EXCEDENTES'
ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.141-GRAVAR: 1002-HORAS EXCEDENTES'
THEN
dbms_output.put_line('--A.141-GRAVAR: 1002-HORAS EXCEDENTES');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1002'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1002', ROUND(C1.EXTRA_DIA_INFO_SEM_MENSAL_F ,2),'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  

--'A.142-GRAVA FOLGA
ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200')
AND C1.O_QUE_FAZER = 'A.142-GRAVA FOLGA'
THEN
dbms_output.put_line('--A.142-GRAVA FOLGA');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0) AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO = LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE(trunc(C1.DATA),'DD/MM/YYYY') AND CODIGO_SITUACAO = '1003'; COMMIT;
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0), LPAD(C1.MATRICULA,15,0), TO_DATE( trunc(C1.DATA),'DD/MM/YYYY'),'1003', 1, 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;

--'A.143-GRAVAR: 1003-FOLGA'
ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200')
AND C1.O_QUE_FAZER = 'A.143-GRAVAR: 1003-FOLGA'
THEN
dbms_output.put_line('--A.143-GRAVAR: 1003-FOLGA');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0) AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO = LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE(trunc(C1.DATA),'DD/MM/YYYY') AND CODIGO_SITUACAO = '1003'; COMMIT;
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0), LPAD(C1.MATRICULA,15,0), TO_DATE( trunc(C1.DATA),'DD/MM/YYYY'),'1003', 1, 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;

--'A.144-GRAVAR: 1002-HORAS EXCEDENTES'
ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.144-GRAVAR: 1002-HORAS EXCEDENTES'
THEN
dbms_output.put_line('--A.144-GRAVAR: 1002-HORAS EXCEDENTES');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1002'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1002', ROUND(C1.EXTRA_DIA_INFO_SEM_MENSAL_F ,2),'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  

--	A.145-GRAVAR: 1003-FOLGA'
ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200')
AND C1.O_QUE_FAZER = 'A.145-GRAVAR: 1003-FOLGA'
THEN
dbms_output.put_line('--A.145-GRAVAR: 1003-FOLGA');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0) AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO = LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE(trunc(C1.DATA),'DD/MM/YYYY') AND CODIGO_SITUACAO = '1003'; COMMIT;
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0), LPAD(C1.MATRICULA,15,0), TO_DATE( trunc(C1.DATA),'DD/MM/YYYY'),'1003', 1, 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;

--'A.11-GRAVAR: Situação de Ponto da Justificativa'	--'A.146-FERIADO GRAVAR: 1000-HORAS NORMAIS E 1002-HORAS EXCEDIDAS'

--'A.147-GRAVAR: 1000-HORAS NORMAIS'
ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.147-GRAVAR: 1000-HORAS NORMAIS'
THEN
dbms_output.put_line('--A.147-GRAVAR: 1000-HORAS NORMAIS');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0) AND TIPO_CONTRATO = LPAD(C1.TIPO_CONTRATO,4,0) AND CODIGO_CONTRATO = LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE(trunc(C1.DATA), 'DD/MM/YYYY') AND CODIGO_SITUACAO = '1000'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0), LPAD(C1.TIPO_CONTRATO,4,0),LPAD(C1.MATRICULA,15,0), TO_DATE(trunc(C1.DATA),'DD/MM/YYYY'),'1000', ROUND(C1.H_NORMAIS_F,2), 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;

--'A.148-GRAVAR: 0020-FALTA'
ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.148-GRAVAR: 0020-FALTA'
THEN
dbms_output.put_line('--A.148-GRAVAR: 0020-FALTA');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '0020'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'0020', 1,'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  

--A.149-PONTO_FACULTATIVO GRAVAR: 1000-HORAS NORMAIS E 1002-HORAS EXCEDIDAS'
ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.149-PONTO_FACULTATIVO GRAVAR: 1000-HORAS NORMAIS E 1002-HORAS EXCEDIDAS'
THEN
dbms_output.put_line('--A.149-PONTO_FACULTATIVO GRAVAR: 1000-HORAS NORMAIS E 1002-HORAS EXCEDIDAS');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1000'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1000', ROUND(C1.PREVISTO_F ,2), 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1002'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1002', ROUND(C1.EXTRA_DIA_INFO_SEM_MENSAL_F ,2),'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  

--'A.11-GRAVAR: Situação de Ponto da Justificativa' -- 'A.150-GRAVAR: JUSTIFICATIVA'

--'A.151-GRAVAR: 0020-FALTA'
ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.151-GRAVAR: 0020-FALTA'
THEN
dbms_output.put_line('--A.151-GRAVAR: 0020-FALTA');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '0020'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'0020', 1,'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  

--'A.152-GRAVAR: 0020-FALTA'
ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.152-GRAVAR: 0020-FALTA'
THEN
dbms_output.put_line('--A.152-GRAVAR: 0020-FALTA');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '0020'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'0020', 1,'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  

--	'A.153-GRAVAR: 0020-FALTA'
ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.153-GRAVAR: 0020-FALTA'
THEN
dbms_output.put_line('--A.153-GRAVAR: 0020-FALTA');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '0020'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'0020', 1,'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  

--	'A.154-GRAVAR: 1000-HORAS NORMAIS'
ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.154-GRAVAR: 1000-HORAS NORMAIS'
THEN
dbms_output.put_line('--A.154-GRAVAR: 1000-HORAS NORMAIS');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0) AND TIPO_CONTRATO = LPAD(C1.TIPO_CONTRATO,4,0) AND CODIGO_CONTRATO = LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE(trunc(C1.DATA), 'DD/MM/YYYY') AND CODIGO_SITUACAO = '1000'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0), LPAD(C1.TIPO_CONTRATO,4,0),LPAD(C1.MATRICULA,15,0), TO_DATE(trunc(C1.DATA),'DD/MM/YYYY'),'1000', ROUND(C1.H_NORMAIS_F,2), 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;

--'A.155-GRAVAR: 1000-HORAS NORMAIS E 1001-HORAS DIFERENCIADAS'
ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.155-GRAVAR: 1000-HORAS NORMAIS E 1001-HORAS DIFERENCIADAS'
THEN
dbms_output.put_line('--A.155-GRAVAR: 1000-HORAS NORMAIS E 1001-HORAS DIFERENCIADAS');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1000'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1000', ROUND(C1.H_NORMAIS_F ,2), 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1001'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1001', ROUND(C1.DESCONTO_DIA_INFO_SEM_MENSAL_F ,2),'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  


--'A.156-GRAVAR: 1000-HORAS NORMAIS E 1002-HORAS EXCEDENTES'
ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.156-GRAVAR: 1000-HORAS NORMAIS E 1002-HORAS EXCEDENTES'
THEN
dbms_output.put_line('--A.156-GRAVAR: 1000-HORAS NORMAIS E 1002-HORAS EXCEDENTES');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1000'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1000', ROUND(C1.PREVISTO_F ,2), 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1002'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1002', ROUND(C1.EXTRA_DIA_INFO_SEM_MENSAL_F ,2),'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  

--'A.157-GRAVAR: 1000-HORAS NORMAIS E 1001-HORAS DIFERENCIADAS'
ELSIF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.O_QUE_FAZER = 'A.157-GRAVAR: 1000-HORAS NORMAIS E 1001-HORAS DIFERENCIADAS'
THEN
dbms_output.put_line('--A.157-GRAVAR: 1000-HORAS NORMAIS E 1001-HORAS DIFERENCIADAS');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1000'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1000', ROUND(C1.H_NORMAIS_F ,2), 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1001'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1001', ROUND(C1.DESCONTO_DIA_INFO_SEM_MENSAL_F ,2),'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  
--FIM----------------------------------------------------NOVO EM 10/12/21



ELSIF C1.FOLHA_ESPECIAL = 'SIM' OR C1.REGISTRO_PONTO IN ('0110','0120','0150','0160','0200') THEN
dbms_output.put_line('--PESSOA FAZ PARTE FOLHA ESPECIAL ou CAMPO REGISTRO_PONTO NÃO OBRIGA USAR IFPONTO');  
INSERT INTO PONTO_ELETRONICO.IFPONTO_FECHAMENTO_LOG_RELAT (CONSIDERACOES, CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA_DADOS, CAMPO_1, CAMPO_2, CAMPO_3, CAMPO_4)VALUES('ifponto_gera_sit_ponto_V7.sql',C1.EMPRESA,C1.TIPO_CONTRATO,C1.MATRICULA, C1.DATA, '--PESSOA FAZ PARTE FOLHA ESPECIAL ou CAMPO REGISTRO_PONTO NÃO OBRIGA USAR IFPONTO',NULL, NULL,NULL  ); COMMIT;

--ELSIF C1.O_QUE_FAZER = 'A.ESTAGIARIO DEFINIR REGRAS' THEN    --dbms_output.put_line('--A.ESTAGIARIO DEFINIR REGRAS'); --COMENTADO EM 6/8/20

ELSE
dbms_output.put_line('--***********CENARIO NAO MAPEADO*************************'); 
INSERT INTO PONTO_ELETRONICO.IFPONTO_FECHAMENTO_LOG_RELAT (CONSIDERACOES, CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA_DADOS, CAMPO_1, CAMPO_2, CAMPO_3, CAMPO_4)VALUES('ifponto_gera_sit_ponto_V7.sql',C1.EMPRESA,C1.TIPO_CONTRATO,C1.MATRICULA, C1.DATA, 'CENARIO NAO MAPEADO',NULL, NULL,NULL  ); COMMIT;

--*/-----fim parte 2 parcial ate resolver problema saida dbms 17/8/20 17h01


END IF;
--FIM----------------------------------------------------------------COMBINAÇÕES DE CENARIOS------------------------------------------------------------------------------


--INICIO----------------------------------------AJUSTES PARA COMPENSACAO NATIVA DO IFPONTO USADA PARA OS ESTAGIARIOS QUE TEM CARGA HORARIA = DIARIA------------------------------
--INICIO NOVO EM 5/8/20

IF C1.COD_VINCULO = '0009' THEN

--INICIO-----PARA DIA EM QUE HAVIA FALTA/HORAS DIFERENCIADAS E FOI PROGRAMADA A COMPENSACAO ONDE HÁ NO ESPELHO O CAMPO COD_COMPENSACAO PREENCHIDO
IF C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.COD_COMPENSACAO IS NOT NULL
THEN
vNUMERO := TO_NUMBER(C1.PREVISTO_N) - TO_NUMBER(C1.H_NORMAIS_N) ;--descomentado em 7/12/20
--vSTRING := CASE WHEN INSTR(vNUMERO,',',1,1) = 0 THEN TO_CHAR(vNUMERO) WHEN INSTR(vNUMERO,',',1,1) <> 0 THEN TO_CHAR(SUBSTR(vNUMERO,1,INSTR(vNUMERO,',',1,1)-1) ||'.'||SUBSTR(vNUMERO,INSTR(vNUMERO,',' ,1,1)+1, LENGTH(vNUMERO))) end ;--descomentado em 7/12/20
IF vNUMERO > 0 THEN
dbms_output.put_line('--A.41-GRAVAR: 1200-HORAS PROGRAMADAS A COMPENSAR');
--comentado em 7/12/20--DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1200'; COMMIT;  
--comentado em 7/12/20--INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1200', ROUND(C1.PREVISTO_N - C1.H_NORMAIS_N ,2), 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0) AND TIPO_CONTRATO = LPAD(C1.TIPO_CONTRATO,4,0) AND CODIGO_CONTRATO = LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE(trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '0020'; COMMIT;   --novo em 7/12/20
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0) AND TIPO_CONTRATO = LPAD(C1.TIPO_CONTRATO,4,0) AND CODIGO_CONTRATO = LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE(trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1001'; COMMIT;   --novo em 7/12/20
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0) AND TIPO_CONTRATO = LPAD(C1.TIPO_CONTRATO,4,0) AND CODIGO_CONTRATO = LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE(trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1200'; COMMIT;  --descomentado em 7/12/20
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) ,LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE(trunc(C1.DATA) ,'DD/MM/YYYY'),'1200', ROUND(C1.PREVISTO_N - C1.H_NORMAIS_N, 2), 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT; --descomentado em 7/12/20 

ELSE
   dbms_output.put_line('--A.42-DEVERIA TER 1200-HORAS PROGRAMADAS A COMPENSAR');
END IF;

END IF;

--FIM-----PARA DIA EM QUE HAVIA FALTA/HORAS DIFERENCIADAS E FOI PROGRAMADA A COMPENSACAO ONDE HÁ NO ESPELHO O CAMPO COD_COMPENSACAO PREENCHIDO

--INICIO ----DIA QUE FOI PROGRAMADO O PAGAMENTO DE HORAS
--CAMPO COMPENSADO
IF 
C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.COMPENSADO > 0
THEN
--vNUMERO := C1.COMPENSADO;
--vSTRING := CASE WHEN INSTR(vNUMERO,',',1,1) = 0 THEN TO_CHAR(vNUMERO) WHEN INSTR(vNUMERO,',',1,1) <> 0 THEN TO_CHAR(SUBSTR(vNUMERO,1,INSTR(vNUMERO,',',1,1)-1) ||'.'||SUBSTR(vNUMERO,INSTR(vNUMERO,',' ,1,1)+1, LENGTH(vNUMERO))) end ;
dbms_output.put_line('--A.43-GRAVAR: 1201-HORAS PROGRAMADAS E COMPENSADAS');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1201'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1201', ROUND(C1.COMPENSADO ,2), 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  
--dbms_output.put_line('DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = ''F'' AND CODIGO_EMPRESA = ''' ||LPAD(C1.EMPRESA,4,0) ||''' AND TIPO_CONTRATO = ''' || LPAD(C1.TIPO_CONTRATO,4,0) ||''' AND CODIGO_CONTRATO = '''|| LPAD(C1.MATRICULA,15,0) ||'''AND TRUNC(DATA) = TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY'') AND CODIGO_SITUACAO = ''1201''; COMMIT;' );  
--dbms_output.put_line('INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES ('''||LPAD(C1.EMPRESA,4,0) ||''','''|| LPAD(C1.TIPO_CONTRATO,4,0) ||''','''|| LPAD(C1.MATRICULA,15,0) ||''', TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY''),''1201'', ROUND('|| vSTRING ||',2), ''F'', SYSDATE, ''IFPONTO'','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;' );  

END IF;

--CAMPO FALTA_COMPENSAR
IF 
C1.ERRO_IFPONTO_OCORREN_ESPELHO = 'NAO' AND C1.FOLHA_ESPECIAL = 'NAO' AND C1.REGISTRO_PONTO NOT IN ('0110','0120','0150','0160','0200') 
AND C1.FALTA_COMPENSAR > 0 
THEN
--vNUMERO := C1.FALTA_COMPENSAR;
--vSTRING := CASE WHEN INSTR(vNUMERO,',',1,1) = 0 THEN TO_CHAR(vNUMERO) WHEN INSTR(vNUMERO,',',1,1) <> 0 THEN TO_CHAR(SUBSTR(vNUMERO,1,INSTR(vNUMERO,',',1,1)-1) ||'.'||SUBSTR(vNUMERO,INSTR(vNUMERO,',' ,1,1)+1, LENGTH(vNUMERO))) end ;
dbms_output.put_line('--A.44-GRAVAR: 1202-HORAS PROGRAMADAS NAO COMPENSADAS');
DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = 'F' AND CODIGO_EMPRESA = LPAD(C1.EMPRESA,4,0)  AND TIPO_CONTRATO =  LPAD(C1.TIPO_CONTRATO,4,0)  AND CODIGO_CONTRATO =  LPAD(C1.MATRICULA,15,0) AND TRUNC(DATA) = TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY') AND CODIGO_SITUACAO = '1202'; COMMIT;  
INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES (LPAD(C1.EMPRESA,4,0) , LPAD(C1.TIPO_CONTRATO,4,0) , LPAD(C1.MATRICULA,15,0) , TO_DATE( trunc(C1.DATA) ,'DD/MM/YYYY'),'1202', ROUND(C1.FALTA_COMPENSAR ,2), 'F', SYSDATE, 'IFPONTO','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;  
--dbms_output.put_line('DELETE ARTERH.RHPONT_RES_SIT_DIA WHERE TIPO_APURACAO = ''F'' AND CODIGO_EMPRESA = ''' ||LPAD(C1.EMPRESA,4,0) ||''' AND TIPO_CONTRATO = ''' || LPAD(C1.TIPO_CONTRATO,4,0) ||''' AND CODIGO_CONTRATO = '''|| LPAD(C1.MATRICULA,15,0) ||'''AND TRUNC(DATA) = TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY'') AND CODIGO_SITUACAO = ''1202''; COMMIT;' );  
--dbms_output.put_line('INSERT INTO ARTERH.RHPONT_RES_SIT_DIA (CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, DATA, CODIGO_SITUACAO, REF_HORAS, TIPO_APURACAO, DT_ULT_ALTER_USUA, LOGIN_USUARIO, FORCA_SITUACAO, TEXTO_ASSOCIADO) VALUES ('''||LPAD(C1.EMPRESA,4,0) ||''','''|| LPAD(C1.TIPO_CONTRATO,4,0) ||''','''|| LPAD(C1.MATRICULA,15,0) ||''', TO_DATE('''|| trunc(C1.DATA) ||''',''DD/MM/YYYY''),''1202'', ROUND('|| vSTRING ||',2), ''F'', SYSDATE, ''IFPONTO'','N', 'SCRIPT FECHAMENTO IFPONTO(ifponto_gera_sit_ponto_V7.sql)'||'|'||C1.O_QUE_FAZER); COMMIT;' );  

END IF;

END IF;

END LOOP;

END;

END;