
  CREATE OR REPLACE EDITIONABLE PROCEDURE "PONTO_ELETRONICO"."SMARH_INT_CAD_CERCAS" (DATA_INICIO IN VARCHAR2, DATA_FIM IN VARCHAR2)
AS
BEGIN
DECLARE
vDATA_INICIO VARCHAR2(100);
vDATA_FIM VARCHAR2(100);
vCONTADOR NUMBER;
BEGIN
dbms_output.enable(null);
vCONTADOR :=0;
vDATA_INICIO := DATA_INICIO;
vDATA_FIM := DATA_FIM;
FOR C1 IN (
SELECT '0001' AS CODIGO_EMPRESA, 'ADM DIRETA' AS AGRUPAMENTO_EMPRESA,'100' AS RAIO, CASE WHEN X.DATA_IMPLANTACAO IS NOT NULL AND X.DATA_EXTINCAO IS NULL THEN'INCLUIR'
WHEN X.DATA_EXTINCAO IS NOT NULL AND X.DATA_IMPLANTACAO IS NOT NULL THEN 'EXCLUIR'
ELSE 'ALTERACAO_DIVERSAS' END AS TIPO,X.* FROM (SELECT CODIGO AS CODIGO_LEGADO,
  CODIGO      AS NRO,
  TRIM(DESCRICAO
  ||' '
  ||NUMERO) AS DESCRICAO ,
  TRIM(DESCRICAO
  ||' '
  ||NUMERO)      AS NOME,
  caixa_postal   AS LATITUDE,
  telex          AS LONGITUDE,
  texto_assoc    AS IP,
  c_livre_data01 AS DATA_IMPLANTACAO,
  c_livre_data02 AS DATA_EXTINCAO ,
  SYSDATE        AS DT_SAIU_ARTE,
  NULL           AS DT_ENVIADO_IFPONTO_SURICATO
FROM ARTERH.RHORGA_ENDERECO
WHERE (TRUNC(DT_ULT_ALTER_USUA)BETWEEN vDATA_INICIO AND vDATA_FIM)
)X
WHERE X.DATA_IMPLANTACAO IS NOT NULL
)
LOOP
INSERT INTO PONTO_ELETRONICO.SMARH_INT_CAD_CERCA_DIGITAL
(
CODIGO_EMPRESA,
AGRUPAMENTO_EMPRESA,
TIPO,
CODIGO_LEGADO,
DESCRICAO,
NOME,
LATITUDE,
LONGITUDE,
IP,
NRO,
DATA_IMPLANTACAO,
DATA_EXTINCAO,
DT_SAIU_ARTE,
DT_ENVIADO_IFPONTO_SURICATO,
RAIO
,CODIGO_INTEGRA_ARTE --NOVO 4/7/22
)
VALUES
(C1.CODIGO_EMPRESA,
C1.AGRUPAMENTO_EMPRESA,
C1.TIPO,
C1.CODIGO_LEGADO,
C1.DESCRICAO,
C1.NOME,
C1.LATITUDE,
C1.LONGITUDE,
C1.IP,
C1.NRO,
C1.DATA_IMPLANTACAO,
C1.DATA_EXTINCAO,
C1.DT_SAIU_ARTE,
C1.DT_ENVIADO_IFPONTO_SURICATO,
C1.RAIO
,SEQUENCE_INTEGRA_ARTE.NEXTVAL --NOVO 4/7/22
);
COMMIT;
END LOOP;
END ;
END SMARH_INT_CAD_CERCAS;

