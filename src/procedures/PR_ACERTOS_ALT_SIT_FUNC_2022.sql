
  CREATE OR REPLACE EDITIONABLE PROCEDURE "ARTERH"."PR_ACERTOS_ALT_SIT_FUNC_2022" AS
BEGIN



--KELLYSSON EM 6/12/19
DECLARE   
vCONTADOR NUMBER (10); 
V_SIT_FUNC_ATIVA_VINCULO VARCHAR2 (4 BYTE);
V_SIT_FUNC_PADRAO_VINCULO VARCHAR2 (4 BYTE);
vREG_NEGATIVO NUMBER;

err_msg varchar2 (4000);

BEGIN  
dbms_output.enable(null);
vCONTADOR :=0;
V_SIT_FUNC_ATIVA_VINCULO := NULL;
V_SIT_FUNC_PADRAO_VINCULO := NULL;
vREG_NEGATIVO := 0;

err_msg := NULL;

select 
COUNT(1)
INTO vREG_NEGATIVO
FROM RHCGED_ALT_SIT_FUN A 
LEFT OUTER JOIN RHPARM_SIT_FUNC S ON S.CODIGO = A.COD_SIT_FUNCIONAL 
WHERE  
A.CODIGO_EMPRESA IN ('0001','0002','0003','0013','0014')--ADICIONANDO EMPRESA 2 E 3 EM 26/10/23
--A.CODIGO_EMPRESA IN ('0001','0098','0003','0013','0014', '0002','0007','0009','0010')
AND TRUNC(A.DATA_INIC_SITUACAO) >= TO_DATE('30/09/2019','DD/MM/YYYY')
and TRUNC(a.DATA_FIM_SITUACAO)-TRUNC(a.DATA_INIC_SITUACAO)<0
and trunc(a.dt_ult_alter_usua)> to_date('02/01/2020','dd/mm/yyyy');


---INICIO-------------------------------------------------------------------------PRIMEIRA PARTE------------------------------LOCALIZAR OS REGISTROS E ACERTAR-----------------------------------------------------------------------------------
IF vREG_NEGATIVO = 0 THEN


FOR C1 IN ( 
--SELECT baseado (analitico_sitentico_erros_ALT_SIT_FUNC.sql)

--SELECT X4.CENARIO_2022, COUNT(1)QTD_REG FROM (--SENTETICO DE CENARIO
--ANALITICO E SINTETICO
SELECT 
CASE
--INICIO---NOVO EM 17/3/22
WHEN /*X3.SO_GERA_SIT_PONTO <> 'NAO' AND*/ X3.CONTROLE_FOLHA = 'S' AND X3.E_AFASTAMENTO = 'N'	AND X3.SUSPENDE_REMUNERA = 'N' AND	X3.TEM_PROXIMA_SIT_FUNC_NO_CAD = 'NAO'
THEN '52-AVISAR GESFO - SITUAÇÃO FUNCIONAL DE DESLIGAMENTO COM DATA FIM' 
WHEN /*X3.SO_GERA_SIT_PONTO = 'NAO' AND*/ X3.CONTROLE_FOLHA = 'L' AND X3.E_AFASTAMENTO = 'S'	AND X3.SUSPENDE_REMUNERA = 'S' AND	X3.TEM_PROXIMA_SIT_FUNC_NO_CAD = 'NAO'
THEN '53- AVISAR GEVIF (COORD. INGRESSO E MOVIMENTACAO) LICENÇA COM DATA FIM SEM LANCAMENTO POSTERIOR'
WHEN /*X3.SO_GERA_SIT_PONTO = 'NAO' AND*/  X3.CONTROLE_FOLHA = 'A' AND X3.E_AFASTAMENTO = 'N'	AND X3.SUSPENDE_REMUNERA = 'S' AND	X3.TEM_PROXIMA_SIT_FUNC_NO_CAD = 'SIM'
THEN '54- AVISAR GEVIF (COORD. INGRESSO E MOVIMENTACAO)  APÓS SIT FUNC DE INGRESSO LACUNA COM PROXIMA SITUACAO'

WHEN X3.SO_GERA_SIT_PONTO <> 'NAO' AND CESS.TIPO_CESS IS     NULL THEN 'SITUACAO FUNCIONAL CAMPO SO_GERA_SIT_PONTO DIFERENTE QUE NAO' --AJUSTADO EM 16/3/22
WHEN X3.SO_GERA_SIT_PONTO <> 'NAO' AND CESS.TIPO_CESS IS NOT NULL THEN 'SITUACAO FUNCIONAL DE CESSAO' --NOVO EM 16/3/22
--FIM---NOVO EM 17/3/22

WHEN X3.STATUS_LACUNAS = 'VALOR_NEGATIVO' AND X3.SO_GERA_SIT_PONTO = 'NAO' AND X3.ULTIMO_REGISTRO = 'NAO' AND X3.CONTROLE_FOLHA = 'N' AND X3.E_AFASTAMENTO = 'N'	AND X3.SUSPENDE_REMUNERA = 'N'	AND X3.TEM_QTDE_DIAS_PROXIMO = 'NAO' 
AND	X3.TEM_PROXIMA_SIT_FUNC_NO_CAD = 'NAO' AND X3.TEM_DATA_FIM = 'SIM' AND X3.PROXIMO_CONTROLE_FOLHA <> 'N' --AND	X3.PROXIMO_E_AFASTAMENTO	X3.PROXIMO_SUSPENDE_REMUNERA	X3.TEM_PROXIMA_DATA_FIM
THEN '1-DIMINUI DT FIM DA SIT FUNC CONTROLE FOLHA IGUAL A NORMAL (ATIVO)'

WHEN X3.STATUS_LACUNAS = 'VALOR_POSITIVO' AND X3.SO_GERA_SIT_PONTO = 'NAO' AND X3.ULTIMO_REGISTRO = 'NAO' AND X3.CONTROLE_FOLHA = 'L' AND X3.E_AFASTAMENTO = 'S'	AND X3.SUSPENDE_REMUNERA = 'N'	AND X3.TEM_QTDE_DIAS_PROXIMO = 'NAO' 
AND	X3.TEM_PROXIMA_SIT_FUNC_NO_CAD = 'NAO' AND X3.TEM_DATA_FIM = 'SIM' AND X3.PROXIMO_CONTROLE_FOLHA = 'L' AND	X3.PROXIMO_E_AFASTAMENTO = 'S' AND X3.PROXIMO_SUSPENDE_REMUNERA	= 'N' AND X3.TEM_PROXIMA_DATA_FIM = 'SIM'
THEN '2-CRIA PERIODO ENTRE SIT FUNC DE LICENCA COM CONTROLE FOLHA IGUAL A NORMAL (ATIVO)'

WHEN X3.STATUS_LACUNAS = 'VALOR_POSITIVO' AND X3.SO_GERA_SIT_PONTO = 'NAO' AND X3.ULTIMO_REGISTRO = 'NAO' AND X3.CONTROLE_FOLHA = 'L' AND X3.E_AFASTAMENTO = 'S'	AND X3.SUSPENDE_REMUNERA = 'N'	AND X3.TEM_QTDE_DIAS_PROXIMO = 'NAO' 
AND	X3.TEM_PROXIMA_SIT_FUNC_NO_CAD = 'NAO' AND X3.TEM_DATA_FIM = 'SIM' AND X3.PROXIMO_CONTROLE_FOLHA = 'M' AND	X3.PROXIMO_E_AFASTAMENTO = 'S' AND X3.PROXIMO_SUSPENDE_REMUNERA	= 'N' AND X3.TEM_PROXIMA_DATA_FIM = 'SIM'
THEN '3-CRIA PERIODO ENTRE SIT FUNC DE LICENCA E MATERNIDADE COM CONTROLE FOLHA IGUAL A NORMAL (ATIVO)'

WHEN X3.STATUS_LACUNAS = 'VALOR_POSITIVO' AND X3.SO_GERA_SIT_PONTO = 'NAO' AND X3.ULTIMO_REGISTRO = 'NAO' AND X3.CONTROLE_FOLHA = 'M' AND X3.E_AFASTAMENTO = 'S'	AND X3.SUSPENDE_REMUNERA = 'N'	AND X3.TEM_QTDE_DIAS_PROXIMO = 'SIM' 
AND	X3.TEM_PROXIMA_SIT_FUNC_NO_CAD = 'NAO' AND X3.TEM_DATA_FIM = 'SIM' AND X3.PROXIMO_CONTROLE_FOLHA = 'L' AND	X3.PROXIMO_E_AFASTAMENTO = 'S' AND X3.PROXIMO_SUSPENDE_REMUNERA	= 'N' AND X3.TEM_PROXIMA_DATA_FIM = 'SIM'
THEN '4-CRIA PERIODO ENTRE SIT FUNC DE PRORROGACAO MATERNIDADE E LICENCA COM CONTROLE FOLHA IGUAL A NORMAL (ATIVO)'

WHEN X3.STATUS_LACUNAS = 'VALOR_POSITIVO' AND X3.SO_GERA_SIT_PONTO = 'NAO' AND X3.ULTIMO_REGISTRO = 'NAO' AND X3.CONTROLE_FOLHA = 'M' AND X3.E_AFASTAMENTO = 'S'	AND X3.SUSPENDE_REMUNERA = 'N'	AND X3.TEM_QTDE_DIAS_PROXIMO = 'SIM' 
AND	X3.TEM_PROXIMA_SIT_FUNC_NO_CAD = 'SIM' AND X3.TEM_DATA_FIM = 'SIM' AND X3.PROXIMO_CONTROLE_FOLHA = 'L' AND	X3.PROXIMO_E_AFASTAMENTO = 'S' AND X3.PROXIMO_SUSPENDE_REMUNERA	= 'N' AND X3.TEM_PROXIMA_DATA_FIM = 'SIM'
THEN '5-AVISAR GETED - NAO FOI LANCADA PRORROGACAO MATERNIDADE E TEM LACUNA ENTRE A MATERNIDADE E LICENCA'

WHEN X3.STATUS_LACUNAS = 'VALOR_POSITIVO' AND X3.SO_GERA_SIT_PONTO = 'NAO' AND X3.ULTIMO_REGISTRO = 'NAO' AND X3.CONTROLE_FOLHA = 'N' AND X3.E_AFASTAMENTO = 'N'	AND X3.SUSPENDE_REMUNERA = 'N'	AND X3.TEM_QTDE_DIAS_PROXIMO = 'NAO' 
AND	X3.TEM_PROXIMA_SIT_FUNC_NO_CAD = 'NAO' AND X3.TEM_DATA_FIM = 'NAO' AND X3.PROXIMO_CONTROLE_FOLHA <> 'N' --AND	X3.PROXIMO_E_AFASTAMENTO = 'S' AND X3.PROXIMO_SUSPENDE_REMUNERA	= 'N' AND X3.TEM_PROXIMA_DATA_FIM = 'SIM'
THEN '6-GRAVA DATA FIM SIT FUNC COM CONTROLE FOLHA IGUAL A NORMAL (ATIVO)'

WHEN X3.STATUS_LACUNAS = 'VALOR_POSITIVO' AND X3.SO_GERA_SIT_PONTO = 'NAO' AND X3.ULTIMO_REGISTRO = 'NAO' AND X3.CONTROLE_FOLHA = 'N' AND X3.E_AFASTAMENTO = 'N'	AND X3.SUSPENDE_REMUNERA = 'N'	AND X3.TEM_QTDE_DIAS_PROXIMO = 'NAO' 
AND	X3.TEM_PROXIMA_SIT_FUNC_NO_CAD = 'NAO' AND X3.TEM_DATA_FIM = 'SIM' AND X3.PROXIMO_CONTROLE_FOLHA <> 'N' --AND	X3.PROXIMO_E_AFASTAMENTO = 'S' AND X3.PROXIMO_SUSPENDE_REMUNERA	= 'N' AND X3.TEM_PROXIMA_DATA_FIM = 'SIM'
THEN '7-AUMENTA DATA FIM SIT FUNC COM CONTROLE FOLHA IGUAL A NORMAL (ATIVO)'

WHEN X3.STATUS_LACUNAS = 'VALOR_POSITIVO' AND X3.SO_GERA_SIT_PONTO = 'NAO' AND X3.ULTIMO_REGISTRO = 'SIM' AND X3.CONTROLE_FOLHA = 'L' AND X3.E_AFASTAMENTO = 'S'	AND X3.SUSPENDE_REMUNERA = 'N'	AND X3.TEM_QTDE_DIAS_PROXIMO = 'NAO' 
AND	X3.TEM_PROXIMA_SIT_FUNC_NO_CAD = 'NAO' AND X3.TEM_DATA_FIM = 'SIM' AND X3.PROXIMO_CONTROLE_FOLHA IS NULL --AND	X3.PROXIMO_E_AFASTAMENTO = 'S' AND X3.PROXIMO_SUSPENDE_REMUNERA	= 'N' AND X3.TEM_PROXIMA_DATA_FIM = 'SIM'
THEN '8-ULTIMO REGISTRO LICENCA JA ACABOU VOLTAR CRIAR SIT FUNC COM CONTROLE FOLHA IGUAL A NORMAL (ATIVO)'

WHEN X3.STATUS_LACUNAS = 'VALOR_POSITIVO' AND X3.SO_GERA_SIT_PONTO = 'NAO' AND X3.ULTIMO_REGISTRO = 'SIM' AND X3.CONTROLE_FOLHA = 'M' AND X3.E_AFASTAMENTO = 'S'	AND X3.SUSPENDE_REMUNERA = 'N' AND X3.TEM_QTDE_DIAS_PROXIMO = 'SIM' 
AND	X3.TEM_PROXIMA_SIT_FUNC_NO_CAD = 'NAO' AND X3.TEM_DATA_FIM = 'SIM' AND X3.PROXIMO_CONTROLE_FOLHA IS NULL --AND	X3.PROXIMO_E_AFASTAMENTO = 'S' AND X3.PROXIMO_SUSPENDE_REMUNERA	= 'N' AND X3.TEM_PROXIMA_DATA_FIM = 'SIM'
THEN '9-ULTIMO REGISTRO PRORROGACAO MATERNIDADE ACABOU VOLTAR CRIAR SIT FUNC COM CONTROLE FOLHA IGUAL A NORMAL (ATIVO)'

WHEN X3.STATUS_LACUNAS = 'VALOR_POSITIVO' AND X3.SO_GERA_SIT_PONTO = 'NAO' AND X3.ULTIMO_REGISTRO = 'SIM' AND X3.CONTROLE_FOLHA = 'M' AND X3.E_AFASTAMENTO = 'S'	AND X3.SUSPENDE_REMUNERA = 'N' AND X3.TEM_QTDE_DIAS_PROXIMO = 'SIM' 
AND	X3.TEM_PROXIMA_SIT_FUNC_NO_CAD = 'SIM' AND X3.TEM_DATA_FIM = 'SIM' AND X3.PROXIMO_CONTROLE_FOLHA IS NULL --AND	X3.PROXIMO_E_AFASTAMENTO = 'S' AND X3.PROXIMO_SUSPENDE_REMUNERA	= 'N' AND X3.TEM_PROXIMA_DATA_FIM = 'SIM'
THEN '10-AVISAR GETED - NAO FOI LANCADA PRORROGACAO MATERNIDADE E NENHUMA SIT FUNC APOS FIM MATERNIDADE'

WHEN X3.STATUS_LACUNAS = 'VALOR_POSITIVO' AND X3.SO_GERA_SIT_PONTO = 'NAO' AND X3.ULTIMO_REGISTRO = 'NAO' AND X3.CONTROLE_FOLHA = 'A' AND X3.E_AFASTAMENTO = 'N'	AND X3.SUSPENDE_REMUNERA = 'S' AND X3.TEM_QTDE_DIAS_PROXIMO = 'NAO' 
AND	X3.TEM_PROXIMA_SIT_FUNC_NO_CAD = 'NAO' AND X3.TEM_DATA_FIM = 'SIM' AND X3.PROXIMO_CONTROLE_FOLHA = 'N'AND	X3.PROXIMO_E_AFASTAMENTO = 'N' AND X3.PROXIMO_SUSPENDE_REMUNERA	= 'N' AND X3.TEM_PROXIMA_DATA_FIM = 'NAO'
THEN '11-AUMENTAR DATA FIM DA SIT FUNC 6008 RECEM EMPOSSADO'

WHEN X3.STATUS_LACUNAS = 'VALOR_NEGATIVO' AND X3.SO_GERA_SIT_PONTO = 'NAO' AND X3.ULTIMO_REGISTRO = 'NAO' AND X3.CONTROLE_FOLHA <> 'N' /*AND X3.E_AFASTAMENTO = 'N'	AND X3.SUSPENDE_REMUNERA = 'S' */AND X3.TEM_QTDE_DIAS_PROXIMO = 'NAO' 
AND	X3.TEM_PROXIMA_SIT_FUNC_NO_CAD = 'NAO' AND X3.TEM_DATA_FIM = 'SIM' AND X3.PROXIMO_CONTROLE_FOLHA <> 'N' --AND	X3.PROXIMO_E_AFASTAMENTO = 'N' AND X3.PROXIMO_SUSPENDE_REMUNERA	= 'N' AND X3.TEM_PROXIMA_DATA_FIM = 'NAO'
THEN '12-AVISAR GEVIF - CONCOMITA LINCENCAS AJUSTE MANUAL'

WHEN X3.STATUS_LACUNAS = 'VALOR_NEGATIVO' AND X3.SO_GERA_SIT_PONTO = 'NAO' AND X3.ULTIMO_REGISTRO = 'NAO' AND X3.CONTROLE_FOLHA = 'L' AND X3.E_AFASTAMENTO = 'S'	AND X3.SUSPENDE_REMUNERA = 'N' AND X3.TEM_QTDE_DIAS_PROXIMO = 'NAO' 
AND	X3.TEM_PROXIMA_SIT_FUNC_NO_CAD = 'NAO' AND X3.TEM_DATA_FIM = 'SIM' AND X3.PROXIMO_CONTROLE_FOLHA = 'N' AND	X3.PROXIMO_E_AFASTAMENTO = 'N' AND X3.PROXIMO_SUSPENDE_REMUNERA	= 'N' AND X3.TEM_PROXIMA_DATA_FIM = 'SIM'
THEN '13-AVISAR GEVIF - ERRO LOGICA - ALTERAR DT INICIO DA SIT FUNC CONTROLE FOLHA IGUAL A NORMAL (ATIVO)'

WHEN X3.STATUS_LACUNAS = 'VALOR_NEGATIVO' AND X3.SO_GERA_SIT_PONTO = 'NAO' AND X3.ULTIMO_REGISTRO = 'NAO' AND X3.CONTROLE_FOLHA = 'N' AND X3.E_AFASTAMENTO = 'N'	AND X3.SUSPENDE_REMUNERA = 'N' AND X3.TEM_QTDE_DIAS_PROXIMO = 'NAO' 
AND	X3.TEM_PROXIMA_SIT_FUNC_NO_CAD = 'NAO' AND X3.TEM_DATA_FIM = 'SIM' AND X3.PROXIMO_CONTROLE_FOLHA = 'N' AND	X3.PROXIMO_E_AFASTAMENTO = 'N' AND X3.PROXIMO_SUSPENDE_REMUNERA	= 'N' AND X3.TEM_PROXIMA_DATA_FIM = 'SIM'
AND X3.SIT_FUNC_PADRAO_VINCULO = X3.COD_SIT_FUNCIONAL  AND X3.COD_SIT_FUNCIONAL <> X3.PROXIMA_COD_SIT_FUNCIONAL
THEN '14-DIMINUI DT FIM DA PRIMEIRA SIT FUNC CONTROLE FOLHA IGUAL A NORMAL (ATIVO)'

WHEN X3.STATUS_LACUNAS = 'VALOR_POSITIVO' AND X3.SO_GERA_SIT_PONTO = 'NAO' AND X3.ULTIMO_REGISTRO = 'NAO' AND X3.CONTROLE_FOLHA = 'F' AND X3.E_AFASTAMENTO = 'N'	AND X3.SUSPENDE_REMUNERA = 'N' AND X3.TEM_QTDE_DIAS_PROXIMO = 'NAO' 
AND	X3.TEM_PROXIMA_SIT_FUNC_NO_CAD = 'NAO' AND X3.TEM_DATA_FIM = 'SIM' AND X3.PROXIMO_CONTROLE_FOLHA = 'L' AND	X3.PROXIMO_E_AFASTAMENTO = 'N' AND X3.PROXIMO_SUSPENDE_REMUNERA	= 'S' AND X3.TEM_PROXIMA_DATA_FIM = 'SIM'
THEN '15-AVISAR GETED - LACUNA ENTRE RECESSO E INFREQUENCIA AJUSTAR MANUALMENTE'

WHEN X3.STATUS_LACUNAS = 'VALOR_POSITIVO' AND X3.SO_GERA_SIT_PONTO = 'NAO' AND X3.ULTIMO_REGISTRO = 'NAO' AND X3.CONTROLE_FOLHA = 'L' AND X3.E_AFASTAMENTO = 'N'	AND X3.SUSPENDE_REMUNERA = 'S' AND X3.TEM_QTDE_DIAS_PROXIMO = 'SIM' 
AND	X3.TEM_PROXIMA_SIT_FUNC_NO_CAD = 'SIM' AND X3.TEM_DATA_FIM = 'SIM' AND X3.PROXIMO_CONTROLE_FOLHA = 'L' AND	X3.PROXIMO_E_AFASTAMENTO = 'N' AND X3.PROXIMO_SUSPENDE_REMUNERA	= 'S' AND X3.TEM_PROXIMA_DATA_FIM = 'SIM'
THEN '16-AVISAR GETED - LACUNA ENTRE INFREQUENCIAS AJUSTAR MANUALMENTE'

WHEN X3.STATUS_LACUNAS = 'VALOR_POSITIVO' AND X3.SO_GERA_SIT_PONTO = 'NAO' AND X3.ULTIMO_REGISTRO = 'NAO' AND X3.CONTROLE_FOLHA = 'L' AND X3.E_AFASTAMENTO = 'N'	AND X3.SUSPENDE_REMUNERA = 'S' AND X3.TEM_QTDE_DIAS_PROXIMO = 'SIM' 
AND	X3.TEM_PROXIMA_SIT_FUNC_NO_CAD = 'SIM' AND X3.TEM_DATA_FIM = 'SIM' AND X3.PROXIMO_CONTROLE_FOLHA = 'L' AND	X3.PROXIMO_E_AFASTAMENTO = 'S' AND X3.PROXIMO_SUSPENDE_REMUNERA	= 'N' AND X3.TEM_PROXIMA_DATA_FIM = 'SIM'
THEN '17-AVISAR GETED - LACUNA ENTRE INFREQUENCIA E LICENCA AJUSTAR MANUALMENTE'

WHEN X3.STATUS_LACUNAS = 'VALOR_POSITIVO' AND X3.SO_GERA_SIT_PONTO = 'NAO' AND X3.ULTIMO_REGISTRO = 'NAO' AND X3.CONTROLE_FOLHA = 'L' AND X3.E_AFASTAMENTO = 'N'	AND X3.SUSPENDE_REMUNERA = 'S' AND X3.TEM_QTDE_DIAS_PROXIMO = 'SIM' 
AND	X3.TEM_PROXIMA_SIT_FUNC_NO_CAD = 'SIM' AND X3.TEM_DATA_FIM = 'SIM' AND X3.PROXIMO_CONTROLE_FOLHA = 'N' AND	X3.PROXIMO_E_AFASTAMENTO = 'N' AND X3.PROXIMO_SUSPENDE_REMUNERA	= 'N' AND X3.TEM_PROXIMA_DATA_FIM = 'SIM'
THEN '18-AVISAR GETED - LACUNA ENTRE INFREQUENCIA E ATIVO AJUSTAR MANUALMENTE'

WHEN X3.STATUS_LACUNAS = 'VALOR_POSITIVO' AND X3.SO_GERA_SIT_PONTO = 'NAO' AND X3.ULTIMO_REGISTRO = 'NAO' AND X3.CONTROLE_FOLHA = 'L' AND X3.E_AFASTAMENTO = 'N'	AND X3.SUSPENDE_REMUNERA = 'S' AND X3.TEM_QTDE_DIAS_PROXIMO = 'SIM' 
AND	X3.TEM_PROXIMA_SIT_FUNC_NO_CAD = 'SIM' AND X3.TEM_DATA_FIM = 'SIM' AND X3.PROXIMO_CONTROLE_FOLHA = 'N' AND	X3.PROXIMO_E_AFASTAMENTO = 'N' AND X3.PROXIMO_SUSPENDE_REMUNERA	= 'S' AND X3.TEM_PROXIMA_DATA_FIM = 'SIM'
THEN '19-AVISAR GETED - LACUNA ENTRE INFREQUENCIAS AJUSTAR MANUALMENTE'

WHEN X3.STATUS_LACUNAS = 'VALOR_POSITIVO' AND X3.SO_GERA_SIT_PONTO = 'NAO' AND X3.ULTIMO_REGISTRO = 'NAO' AND X3.CONTROLE_FOLHA = 'L' AND X3.E_AFASTAMENTO = 'N'	AND X3.SUSPENDE_REMUNERA = 'S' AND X3.TEM_QTDE_DIAS_PROXIMO = 'SIM' 
AND	X3.TEM_PROXIMA_SIT_FUNC_NO_CAD = 'SIM' AND X3.TEM_DATA_FIM = 'SIM' AND X3.PROXIMO_CONTROLE_FOLHA = 'N' AND	X3.PROXIMO_E_AFASTAMENTO = 'S' AND X3.PROXIMO_SUSPENDE_REMUNERA	= 'S' AND X3.TEM_PROXIMA_DATA_FIM = 'NAO'
THEN '20-AVISAR GETED - LACUNA ENTRE INFREQUENCIA E AFAST INSS AJUSTAR MANUALMENTE'

WHEN X3.STATUS_LACUNAS = 'VALOR_POSITIVO' AND X3.SO_GERA_SIT_PONTO = 'NAO' AND X3.ULTIMO_REGISTRO = 'NAO' AND X3.CONTROLE_FOLHA = 'L' AND X3.E_AFASTAMENTO = 'S'	AND X3.SUSPENDE_REMUNERA = 'N' AND X3.TEM_QTDE_DIAS_PROXIMO = 'NAO' 
AND	X3.TEM_PROXIMA_SIT_FUNC_NO_CAD = 'NAO' AND X3.TEM_DATA_FIM = 'SIM' AND X3.PROXIMO_CONTROLE_FOLHA = 'F' AND	X3.PROXIMO_E_AFASTAMENTO = 'N' AND X3.PROXIMO_SUSPENDE_REMUNERA	= 'N' AND X3.TEM_PROXIMA_DATA_FIM = 'SIM'
THEN '21-CRIA PERIODO ENTRE SIT FUNC DE LICENCA E RECESSO COM CONTROLE FOLHA IGUAL A NORMAL (ATIVO)'

WHEN X3.STATUS_LACUNAS = 'VALOR_POSITIVO' AND X3.SO_GERA_SIT_PONTO = 'NAO' AND X3.ULTIMO_REGISTRO = 'NAO' AND X3.CONTROLE_FOLHA = 'L' AND X3.E_AFASTAMENTO = 'S'	AND X3.SUSPENDE_REMUNERA = 'N' AND X3.TEM_QTDE_DIAS_PROXIMO = 'NAO' 
AND	X3.TEM_PROXIMA_SIT_FUNC_NO_CAD = 'NAO' AND X3.TEM_DATA_FIM = 'SIM' AND X3.PROXIMO_CONTROLE_FOLHA = 'L' AND	X3.PROXIMO_E_AFASTAMENTO = 'N' AND X3.PROXIMO_SUSPENDE_REMUNERA	= 'S' AND X3.TEM_PROXIMA_DATA_FIM = 'SIM'
THEN '22-AVISAR GEVIF - LACUNA ENTRE LICENCA E INFREQUENCIA AJUSTAR MANUALMENTE'

WHEN X3.STATUS_LACUNAS = 'VALOR_POSITIVO' AND X3.SO_GERA_SIT_PONTO = 'NAO' AND X3.ULTIMO_REGISTRO = 'NAO' AND X3.CONTROLE_FOLHA = 'L' AND X3.E_AFASTAMENTO = 'S'	AND X3.SUSPENDE_REMUNERA = 'N' AND X3.TEM_QTDE_DIAS_PROXIMO = 'NAO' 
AND	X3.TEM_PROXIMA_SIT_FUNC_NO_CAD = 'NAO' AND X3.TEM_DATA_FIM = 'SIM' AND X3.PROXIMO_CONTROLE_FOLHA = 'L' AND	X3.PROXIMO_E_AFASTAMENTO = 'S' AND X3.PROXIMO_SUSPENDE_REMUNERA	= 'S' AND X3.TEM_PROXIMA_DATA_FIM = 'NAO'
THEN '23-AVISAR GEVIF - LACUNA ENTRE LICENCAS DIFERENTES AJUSTAR MANUALMENTE'

WHEN X3.STATUS_LACUNAS = 'VALOR_POSITIVO' AND X3.SO_GERA_SIT_PONTO = 'NAO' AND X3.ULTIMO_REGISTRO = 'NAO' AND X3.CONTROLE_FOLHA = 'L' AND X3.E_AFASTAMENTO = 'S'	AND X3.SUSPENDE_REMUNERA = 'N' AND X3.TEM_QTDE_DIAS_PROXIMO = 'NAO' 
AND	X3.TEM_PROXIMA_SIT_FUNC_NO_CAD = 'NAO' AND X3.TEM_DATA_FIM = 'SIM' AND X3.PROXIMO_CONTROLE_FOLHA = 'N' AND	X3.PROXIMO_E_AFASTAMENTO = 'S' AND X3.PROXIMO_SUSPENDE_REMUNERA	= 'N' AND X3.TEM_PROXIMA_DATA_FIM = 'SIM'
THEN '24-AVISAR GEVIF - LACUNA ENTRE LICENCAS DIFERENTES AJUSTAR MANUALMENTE'

WHEN X3.STATUS_LACUNAS = 'VALOR_POSITIVO' AND X3.SO_GERA_SIT_PONTO = 'NAO' AND X3.ULTIMO_REGISTRO = 'NAO' AND X3.CONTROLE_FOLHA = 'L' AND X3.E_AFASTAMENTO = 'S'	AND X3.SUSPENDE_REMUNERA = 'N' AND X3.TEM_QTDE_DIAS_PROXIMO = 'NAO' 
AND	X3.TEM_PROXIMA_SIT_FUNC_NO_CAD = 'NAO' AND X3.TEM_DATA_FIM = 'SIM' AND X3.PROXIMO_CONTROLE_FOLHA = 'N' AND	X3.PROXIMO_E_AFASTAMENTO = 'S' AND X3.PROXIMO_SUSPENDE_REMUNERA	= 'S' AND X3.TEM_PROXIMA_DATA_FIM = 'SIM'
THEN '25-AVISAR GEVIF - LACUNA ENTRE LICENCA E AFAST INSS/SUSPENSAO AJUSTAR MANUALMENTE'

WHEN X3.STATUS_LACUNAS = 'VALOR_POSITIVO' AND X3.SO_GERA_SIT_PONTO = 'NAO' AND X3.ULTIMO_REGISTRO = 'NAO' AND X3.CONTROLE_FOLHA = 'M' AND X3.E_AFASTAMENTO = 'S'	AND X3.SUSPENDE_REMUNERA = 'N' AND X3.TEM_QTDE_DIAS_PROXIMO = 'SIM' 
AND	X3.TEM_PROXIMA_SIT_FUNC_NO_CAD = 'NAO' AND X3.TEM_DATA_FIM = 'SIM' AND X3.PROXIMO_CONTROLE_FOLHA = 'N' AND	X3.PROXIMO_E_AFASTAMENTO = 'S' AND X3.PROXIMO_SUSPENDE_REMUNERA	= 'S' AND X3.TEM_PROXIMA_DATA_FIM = 'SIM'
THEN '26-AVISAR GEVIF - LACUNA ENTRE PRORROG MATERNIDADE E AFAST INSS AJUSTAR MANUALMENTE'

WHEN X3.STATUS_LACUNAS = 'VALOR_POSITIVO' AND X3.SO_GERA_SIT_PONTO = 'NAO' AND X3.ULTIMO_REGISTRO = 'NAO' AND X3.CONTROLE_FOLHA = 'N' AND X3.E_AFASTAMENTO = 'S'	AND X3.SUSPENDE_REMUNERA = 'S' AND X3.TEM_QTDE_DIAS_PROXIMO = 'NAO' 
AND	X3.TEM_PROXIMA_SIT_FUNC_NO_CAD = 'NAO' AND X3.TEM_DATA_FIM = 'SIM' AND X3.PROXIMO_CONTROLE_FOLHA = 'N' AND	X3.PROXIMO_E_AFASTAMENTO = 'S' AND X3.PROXIMO_SUSPENDE_REMUNERA	= 'S' AND X3.TEM_PROXIMA_DATA_FIM = 'SIM'
THEN '27-AVISAR GETED - LACUNA ENTRE LICENCAS ADMINISTRATIVAS AJUSTAR MANUALMENTE'

WHEN X3.STATUS_LACUNAS = 'VALOR_POSITIVO' AND X3.SO_GERA_SIT_PONTO = 'NAO' AND X3.ULTIMO_REGISTRO = 'NAO' AND X3.CONTROLE_FOLHA = 'L' AND X3.E_AFASTAMENTO = 'S'	AND X3.SUSPENDE_REMUNERA = 'N' AND X3.TEM_QTDE_DIAS_PROXIMO = 'NAO' 
AND	X3.TEM_PROXIMA_SIT_FUNC_NO_CAD = 'NAO' AND X3.TEM_DATA_FIM = 'SIM' AND X3.PROXIMO_CONTROLE_FOLHA = 'N' AND	X3.PROXIMO_E_AFASTAMENTO = 'N' AND X3.PROXIMO_SUSPENDE_REMUNERA	= 'N' AND X3.TEM_PROXIMA_DATA_FIM = 'NAO'
THEN '28-ALTERAR DT INICIO DA SIT FUNC CONTROLE FOLHA IGUAL A NORMAL (ATIVO)'

WHEN X3.STATUS_LACUNAS = 'VALOR_POSITIVO' AND X3.SO_GERA_SIT_PONTO = 'NAO' AND X3.ULTIMO_REGISTRO = 'NAO' AND X3.CONTROLE_FOLHA = 'L' AND X3.E_AFASTAMENTO = 'S'	AND X3.SUSPENDE_REMUNERA = 'N' AND X3.TEM_QTDE_DIAS_PROXIMO = 'NAO' 
AND	X3.TEM_PROXIMA_SIT_FUNC_NO_CAD = 'NAO' AND X3.TEM_DATA_FIM = 'SIM' AND X3.PROXIMO_CONTROLE_FOLHA = 'N' AND	X3.PROXIMO_E_AFASTAMENTO = 'N' AND X3.PROXIMO_SUSPENDE_REMUNERA	= 'N' AND X3.TEM_PROXIMA_DATA_FIM = 'SIM'
THEN '29-ALTERAR DT INICIO DA SIT FUNC CONTROLE FOLHA IGUAL A NORMAL (ATIVO)'

WHEN X3.STATUS_LACUNAS = 'VALOR_POSITIVO' AND X3.SO_GERA_SIT_PONTO = 'NAO' AND X3.ULTIMO_REGISTRO = 'NAO' AND X3.CONTROLE_FOLHA = 'M' AND X3.E_AFASTAMENTO = 'S'	AND X3.SUSPENDE_REMUNERA = 'N' AND X3.TEM_QTDE_DIAS_PROXIMO = 'SIM' 
AND	X3.TEM_PROXIMA_SIT_FUNC_NO_CAD = 'NAO' AND X3.TEM_DATA_FIM = 'SIM' AND X3.PROXIMO_CONTROLE_FOLHA = 'F' AND	X3.PROXIMO_E_AFASTAMENTO = 'N' AND X3.PROXIMO_SUSPENDE_REMUNERA	= 'N' AND X3.TEM_PROXIMA_DATA_FIM = 'SIM'
THEN '30-CRIA PERIODO ENTRE SIT FUNC DE PRORROG MATERNIDADE E RECESSO COM CONTROLE FOLHA IGUAL A NORMAL (ATIVO)'

WHEN X3.STATUS_LACUNAS = 'VALOR_POSITIVO' AND X3.SO_GERA_SIT_PONTO = 'NAO' AND X3.ULTIMO_REGISTRO = 'NAO' AND X3.CONTROLE_FOLHA = 'M' AND X3.E_AFASTAMENTO = 'S'	AND X3.SUSPENDE_REMUNERA = 'N' AND X3.TEM_QTDE_DIAS_PROXIMO = 'SIM' 
AND	X3.TEM_PROXIMA_SIT_FUNC_NO_CAD = 'NAO' AND X3.TEM_DATA_FIM = 'SIM' AND X3.PROXIMO_CONTROLE_FOLHA = 'L' AND	X3.PROXIMO_E_AFASTAMENTO = 'N' AND X3.PROXIMO_SUSPENDE_REMUNERA	= 'N' AND X3.TEM_PROXIMA_DATA_FIM = 'SIM'
THEN '31-CRIA PERIODO ENTRE SIT FUNC DE PRORROG MATERNIDADE E CESSAO COM CONTROLE FOLHA IGUAL A NORMAL (ATIVO)'

WHEN X3.STATUS_LACUNAS = 'VALOR_POSITIVO' AND X3.SO_GERA_SIT_PONTO = 'NAO' AND X3.ULTIMO_REGISTRO = 'NAO' AND X3.CONTROLE_FOLHA = 'N' AND X3.E_AFASTAMENTO = 'N'	AND X3.SUSPENDE_REMUNERA = 'N' AND X3.TEM_QTDE_DIAS_PROXIMO = 'NAO' 
AND	X3.TEM_PROXIMA_SIT_FUNC_NO_CAD = 'NAO' AND X3.TEM_DATA_FIM = 'NAO' AND X3.PROXIMO_CONTROLE_FOLHA = 'N' AND	X3.PROXIMO_E_AFASTAMENTO = 'N' AND X3.PROXIMO_SUSPENDE_REMUNERA	= 'S' AND X3.TEM_PROXIMA_DATA_FIM = 'NAO'
THEN '32-AUMENTAR DT FIM DA SIT FUNC CONTROLE FOLHA IGUAL A NORMAL (ATIVO)'

WHEN X3.STATUS_LACUNAS = 'VALOR_POSITIVO' AND X3.SO_GERA_SIT_PONTO = 'NAO' AND X3.ULTIMO_REGISTRO = 'NAO' AND X3.CONTROLE_FOLHA = 'N' AND X3.E_AFASTAMENTO = 'N'	AND X3.SUSPENDE_REMUNERA = 'N' AND X3.TEM_QTDE_DIAS_PROXIMO = 'NAO' 
AND	X3.TEM_PROXIMA_SIT_FUNC_NO_CAD = 'NAO' AND X3.TEM_DATA_FIM = 'SIM' AND X3.PROXIMO_CONTROLE_FOLHA = 'N' AND	X3.PROXIMO_E_AFASTAMENTO = 'N' AND X3.PROXIMO_SUSPENDE_REMUNERA	= 'S' AND X3.TEM_PROXIMA_DATA_FIM = 'SIM'
THEN '33-AUMENTAR DT FIM DA SIT FUNC CONTROLE FOLHA IGUAL A NORMAL (ATIVO)'

WHEN X3.STATUS_LACUNAS = 'VALOR_POSITIVO' AND X3.SO_GERA_SIT_PONTO = 'NAO' AND X3.ULTIMO_REGISTRO = 'NAO' AND X3.CONTROLE_FOLHA = 'N' AND X3.E_AFASTAMENTO = 'N'	AND X3.SUSPENDE_REMUNERA = 'S' AND X3.TEM_QTDE_DIAS_PROXIMO = 'NAO' 
AND	X3.TEM_PROXIMA_SIT_FUNC_NO_CAD = 'NAO' AND X3.TEM_DATA_FIM = 'SIM' AND X3.PROXIMO_CONTROLE_FOLHA = 'F' AND	X3.PROXIMO_E_AFASTAMENTO = 'N' AND X3.PROXIMO_SUSPENDE_REMUNERA	= 'N' AND X3.TEM_PROXIMA_DATA_FIM = 'SIM'
THEN '34-CRIA PERIODO ENTRE SIT FUNC L.M.INDEFERIDA E RECESSO COM CONTROLE FOLHA IGUAL A NORMAL (ATIVO)'

WHEN X3.STATUS_LACUNAS = 'VALOR_POSITIVO' AND X3.SO_GERA_SIT_PONTO = 'NAO' AND X3.ULTIMO_REGISTRO = 'NAO' AND X3.CONTROLE_FOLHA = 'N' AND X3.E_AFASTAMENTO = 'N'	AND X3.SUSPENDE_REMUNERA = 'S' AND X3.TEM_QTDE_DIAS_PROXIMO = 'NAO' 
AND	X3.TEM_PROXIMA_SIT_FUNC_NO_CAD = 'NAO' AND X3.TEM_DATA_FIM = 'SIM' AND X3.PROXIMO_CONTROLE_FOLHA = 'L' AND	X3.PROXIMO_E_AFASTAMENTO = 'N' AND X3.PROXIMO_SUSPENDE_REMUNERA	= 'S' AND X3.TEM_PROXIMA_DATA_FIM = 'SIM'
THEN '35-AVISAR GETED - LACUNA ENTRE INFREQUENCIAS AJUSTAR MANUALMENTE'

WHEN X3.STATUS_LACUNAS = 'VALOR_POSITIVO' AND X3.SO_GERA_SIT_PONTO = 'NAO' AND X3.ULTIMO_REGISTRO = 'NAO' AND X3.CONTROLE_FOLHA = 'N' AND X3.E_AFASTAMENTO = 'N'	AND X3.SUSPENDE_REMUNERA = 'S' AND X3.TEM_QTDE_DIAS_PROXIMO = 'NAO' 
AND	X3.TEM_PROXIMA_SIT_FUNC_NO_CAD = 'NAO' AND X3.TEM_DATA_FIM = 'SIM' AND X3.PROXIMO_CONTROLE_FOLHA = 'L' AND	X3.PROXIMO_E_AFASTAMENTO = 'S' AND X3.PROXIMO_SUSPENDE_REMUNERA	= 'N' AND X3.TEM_PROXIMA_DATA_FIM = 'SIM'
THEN '36-CRIA PERIODO ENTRE SIT FUNC LICENCAS COM CONTROLE FOLHA IGUAL A NORMAL (ATIVO)'

WHEN X3.STATUS_LACUNAS = 'VALOR_POSITIVO' AND X3.SO_GERA_SIT_PONTO = 'NAO' AND X3.ULTIMO_REGISTRO = 'NAO' AND X3.CONTROLE_FOLHA = 'N' AND X3.E_AFASTAMENTO = 'N'	AND X3.SUSPENDE_REMUNERA = 'S' AND X3.TEM_QTDE_DIAS_PROXIMO = 'NAO' 
AND	X3.TEM_PROXIMA_SIT_FUNC_NO_CAD = 'NAO' AND X3.TEM_DATA_FIM = 'SIM' AND X3.PROXIMO_CONTROLE_FOLHA = 'M' AND	X3.PROXIMO_E_AFASTAMENTO = 'S' AND X3.PROXIMO_SUSPENDE_REMUNERA	= 'N' AND X3.TEM_PROXIMA_DATA_FIM = 'SIM'
THEN '37-CRIA PERIODO ENTRE SIT LM INDEF E MATERNIDADE COM CONTROLE FOLHA IGUAL A NORMAL (ATIVO)'

WHEN X3.STATUS_LACUNAS = 'VALOR_POSITIVO' AND X3.SO_GERA_SIT_PONTO = 'NAO' AND X3.ULTIMO_REGISTRO = 'NAO' AND X3.CONTROLE_FOLHA = 'N' AND X3.E_AFASTAMENTO = 'N'	AND X3.SUSPENDE_REMUNERA = 'S' AND X3.TEM_QTDE_DIAS_PROXIMO = 'NAO' 
AND	X3.TEM_PROXIMA_SIT_FUNC_NO_CAD = 'NAO' AND X3.TEM_DATA_FIM = 'SIM' AND X3.PROXIMO_CONTROLE_FOLHA = 'N' AND	X3.PROXIMO_E_AFASTAMENTO = 'N' AND X3.PROXIMO_SUSPENDE_REMUNERA	= 'N' AND X3.TEM_PROXIMA_DATA_FIM = 'NAO'
THEN '38-CRIA PERIODO ENTRE SIT LICENCA E MATERNIDADE COM CONTROLE FOLHA IGUAL A NORMAL (ATIVO)'

WHEN X3.STATUS_LACUNAS = 'VALOR_POSITIVO' AND X3.SO_GERA_SIT_PONTO = 'NAO' AND X3.ULTIMO_REGISTRO = 'NAO' AND X3.CONTROLE_FOLHA = 'N' AND X3.E_AFASTAMENTO = 'S'	AND X3.SUSPENDE_REMUNERA = 'S' AND X3.TEM_QTDE_DIAS_PROXIMO = 'NAO' 
AND	X3.TEM_PROXIMA_SIT_FUNC_NO_CAD = 'NAO' AND X3.TEM_DATA_FIM = 'SIM' AND X3.PROXIMO_CONTROLE_FOLHA = 'M' AND	X3.PROXIMO_E_AFASTAMENTO = 'S' AND X3.PROXIMO_SUSPENDE_REMUNERA	= 'N' AND X3.TEM_PROXIMA_DATA_FIM = 'SIM'
THEN '39-AVISAR GEVIF - LACUNA ENTRE INFREQUENCIA E ATIVO AJUSTAR MANUALMENTE'

WHEN X3.STATUS_LACUNAS = 'VALOR_POSITIVO' AND X3.SO_GERA_SIT_PONTO = 'NAO' AND X3.ULTIMO_REGISTRO = 'NAO' AND X3.CONTROLE_FOLHA = 'N' AND X3.E_AFASTAMENTO = 'N'	AND X3.SUSPENDE_REMUNERA = 'S' AND X3.TEM_QTDE_DIAS_PROXIMO = 'NAO' 
AND	X3.TEM_PROXIMA_SIT_FUNC_NO_CAD = 'NAO' AND X3.TEM_DATA_FIM = 'SIM' AND X3.PROXIMO_CONTROLE_FOLHA = 'N' AND	X3.PROXIMO_E_AFASTAMENTO = 'N' AND X3.PROXIMO_SUSPENDE_REMUNERA	= 'N' AND X3.TEM_PROXIMA_DATA_FIM = 'SIM'
THEN '40-AVISAR GEVIF - LACUNA ENTRE INFREQUENCIA/LM INDEF E ATIVO AJUSTAR MANUALMENTE'

WHEN X3.STATUS_LACUNAS = 'VALOR_POSITIVO' AND X3.SO_GERA_SIT_PONTO = 'NAO' AND X3.ULTIMO_REGISTRO = 'NAO' AND X3.CONTROLE_FOLHA = 'N' AND X3.E_AFASTAMENTO = 'N'	AND X3.SUSPENDE_REMUNERA = 'S' AND X3.TEM_QTDE_DIAS_PROXIMO = 'NAO' 
AND	X3.TEM_PROXIMA_SIT_FUNC_NO_CAD = 'NAO' AND X3.TEM_DATA_FIM = 'SIM' AND X3.PROXIMO_CONTROLE_FOLHA = 'N' AND	X3.PROXIMO_E_AFASTAMENTO = 'N' AND X3.PROXIMO_SUSPENDE_REMUNERA	= 'S' AND X3.TEM_PROXIMA_DATA_FIM = 'NAO'
THEN '41-AVISAR GETED - LACUNA ENTRE INFREQUENCIAS AJUSTAR MANUALMENTE'

WHEN X3.STATUS_LACUNAS = 'VALOR_POSITIVO' AND X3.SO_GERA_SIT_PONTO = 'NAO' AND X3.ULTIMO_REGISTRO = 'NAO' AND X3.CONTROLE_FOLHA = 'N' AND X3.E_AFASTAMENTO = 'N' AND X3.SUSPENDE_REMUNERA = 'S' AND X3.TEM_QTDE_DIAS_PROXIMO = 'NAO' 
AND	X3.TEM_PROXIMA_SIT_FUNC_NO_CAD = 'NAO' AND X3.TEM_DATA_FIM = 'SIM' AND X3.PROXIMO_CONTROLE_FOLHA = 'N' AND	X3.PROXIMO_E_AFASTAMENTO = 'N' AND X3.PROXIMO_SUSPENDE_REMUNERA	= 'S' AND X3.TEM_PROXIMA_DATA_FIM = 'SIM'
THEN '42-AVISAR GEVIF - LACUNA ENTRE INFREQUENCIAS/LM INDEF AJUSTAR MANUALMENTE'

WHEN X3.STATUS_LACUNAS = 'VALOR_POSITIVO' AND X3.SO_GERA_SIT_PONTO = 'NAO' AND X3.ULTIMO_REGISTRO = 'NAO' AND X3.CONTROLE_FOLHA = 'N' AND X3.E_AFASTAMENTO = 'S' AND X3.SUSPENDE_REMUNERA = 'N' AND X3.TEM_QTDE_DIAS_PROXIMO = 'NAO' 
AND	X3.TEM_PROXIMA_SIT_FUNC_NO_CAD = 'NAO' AND X3.TEM_DATA_FIM = 'SIM' AND X3.PROXIMO_CONTROLE_FOLHA = 'N' AND	X3.PROXIMO_E_AFASTAMENTO = 'S' AND X3.PROXIMO_SUSPENDE_REMUNERA	= 'S' AND X3.TEM_PROXIMA_DATA_FIM = 'SIM'
THEN '43-CRIA PERIODO ENTRE SIT LICENCAS COM CONTROLE FOLHA IGUAL A NORMAL (ATIVO)'

WHEN X3.STATUS_LACUNAS = 'VALOR_POSITIVO' AND X3.SO_GERA_SIT_PONTO = 'NAO' AND X3.ULTIMO_REGISTRO = 'NAO' AND X3.CONTROLE_FOLHA = 'N' AND X3.E_AFASTAMENTO = 'S' AND X3.SUSPENDE_REMUNERA = 'S' AND X3.TEM_QTDE_DIAS_PROXIMO = 'NAO' 
AND	X3.TEM_PROXIMA_SIT_FUNC_NO_CAD = 'NAO' AND X3.TEM_DATA_FIM = 'SIM' AND X3.PROXIMO_CONTROLE_FOLHA = 'F' AND	X3.PROXIMO_E_AFASTAMENTO = 'N' AND X3.PROXIMO_SUSPENDE_REMUNERA	= 'N' AND X3.TEM_PROXIMA_DATA_FIM = 'SIM'
THEN '44-CRIA PERIODO ENTRE SIT LICENCA E RECESSO COM CONTROLE FOLHA IGUAL A NORMAL (ATIVO)'

WHEN X3.STATUS_LACUNAS = 'VALOR_POSITIVO' AND X3.SO_GERA_SIT_PONTO = 'NAO' AND X3.ULTIMO_REGISTRO = 'NAO' AND X3.CONTROLE_FOLHA = 'N' AND X3.E_AFASTAMENTO = 'S' AND X3.SUSPENDE_REMUNERA = 'S' AND X3.TEM_QTDE_DIAS_PROXIMO = 'NAO' 
AND	X3.TEM_PROXIMA_SIT_FUNC_NO_CAD = 'NAO' AND X3.TEM_DATA_FIM = 'SIM' AND X3.PROXIMO_CONTROLE_FOLHA = 'L' AND	X3.PROXIMO_E_AFASTAMENTO = 'S' AND X3.PROXIMO_SUSPENDE_REMUNERA	= 'N' AND X3.TEM_PROXIMA_DATA_FIM = 'SIM'
THEN '45-CRIA PERIODO ENTRE SIT LICENCA ADM E LICENCA COM CONTROLE FOLHA IGUAL A NORMAL (ATIVO)'

WHEN X3.STATUS_LACUNAS = 'VALOR_POSITIVO' AND X3.SO_GERA_SIT_PONTO = 'NAO' AND X3.ULTIMO_REGISTRO = 'NAO' AND X3.CONTROLE_FOLHA = 'O' AND X3.E_AFASTAMENTO = 'N' AND X3.SUSPENDE_REMUNERA = 'S' AND X3.TEM_QTDE_DIAS_PROXIMO = 'NAO' 
AND	X3.TEM_PROXIMA_SIT_FUNC_NO_CAD = 'NAO' AND X3.TEM_DATA_FIM = 'SIM' AND X3.PROXIMO_CONTROLE_FOLHA = 'L' AND	X3.PROXIMO_E_AFASTAMENTO = 'S' AND X3.PROXIMO_SUSPENDE_REMUNERA	= 'S' AND X3.TEM_PROXIMA_DATA_FIM = 'SIM'
THEN '46-AVISAR GEVIF - LACUNA ENTRE SUSPENSAO PAG E LICENCA ADM AJUSTAR MANUALMENTE'

WHEN X3.STATUS_LACUNAS = 'VALOR_POSITIVO' AND X3.SO_GERA_SIT_PONTO = 'NAO' AND X3.ULTIMO_REGISTRO = 'SIM' AND X3.CONTROLE_FOLHA = 'F' AND X3.E_AFASTAMENTO = 'N' AND X3.SUSPENDE_REMUNERA = 'N' AND X3.TEM_QTDE_DIAS_PROXIMO = 'NAO' 
AND	X3.TEM_PROXIMA_SIT_FUNC_NO_CAD = 'NAO' AND X3.TEM_DATA_FIM = 'SIM' AND X3.PROXIMO_CONTROLE_FOLHA IS NULL --= 'L' AND	X3.PROXIMO_E_AFASTAMENTO = 'S' AND X3.PROXIMO_SUSPENDE_REMUNERA	= 'S' AND X3.TEM_PROXIMA_DATA_FIM = 'SIM'
THEN '47-CRIA CONTROLE FOLHA IGUAL A NORMAL (ATIVO) COMO ULTIMA NO HISTORICO'

WHEN X3.STATUS_LACUNAS = 'VALOR_POSITIVO' AND X3.SO_GERA_SIT_PONTO = 'NAO' AND X3.ULTIMO_REGISTRO = 'SIM' AND X3.CONTROLE_FOLHA = 'L' AND X3.E_AFASTAMENTO = 'N' AND X3.SUSPENDE_REMUNERA = 'S' AND X3.TEM_QTDE_DIAS_PROXIMO = 'SIM' 
AND	X3.TEM_PROXIMA_SIT_FUNC_NO_CAD = 'SIM' AND X3.TEM_DATA_FIM = 'SIM' AND X3.PROXIMO_CONTROLE_FOLHA IS NULL --= 'L' AND	X3.PROXIMO_E_AFASTAMENTO = 'S' AND X3.PROXIMO_SUSPENDE_REMUNERA	= 'S' AND X3.TEM_PROXIMA_DATA_FIM = 'SIM'
THEN '48-AVISAR GETED - INFREQUENCIA E SEM NADA LANCADO DEPOIS AJUSTAR MANUALMENTE'

WHEN X3.STATUS_LACUNAS = 'VALOR_POSITIVO' AND X3.SO_GERA_SIT_PONTO = 'NAO' AND X3.ULTIMO_REGISTRO = 'SIM' AND X3.CONTROLE_FOLHA = 'N' AND X3.E_AFASTAMENTO = 'N' AND X3.SUSPENDE_REMUNERA = 'S' AND X3.TEM_QTDE_DIAS_PROXIMO = 'NAO' 
AND	X3.TEM_PROXIMA_SIT_FUNC_NO_CAD = 'NAO' AND X3.TEM_DATA_FIM = 'SIM' AND X3.PROXIMO_CONTROLE_FOLHA IS NULL --= 'L' AND	X3.PROXIMO_E_AFASTAMENTO = 'S' AND X3.PROXIMO_SUSPENDE_REMUNERA	= 'S' AND X3.TEM_PROXIMA_DATA_FIM = 'SIM'
THEN '49-AVISAR GETED - INFREQUENCIA E SEM NADA LANCADO DEPOIS AJUSTAR MANUALMENTE'

WHEN X3.STATUS_LACUNAS = 'VALOR_POSITIVO' AND X3.SO_GERA_SIT_PONTO = 'NAO' AND X3.ULTIMO_REGISTRO = 'SIM' AND X3.CONTROLE_FOLHA = 'N' AND X3.E_AFASTAMENTO = 'S' AND X3.SUSPENDE_REMUNERA = 'N' AND X3.TEM_QTDE_DIAS_PROXIMO = 'NAO' 
AND	X3.TEM_PROXIMA_SIT_FUNC_NO_CAD = 'NAO' AND X3.TEM_DATA_FIM = 'SIM' AND X3.PROXIMO_CONTROLE_FOLHA IS NULL --= 'L' AND	X3.PROXIMO_E_AFASTAMENTO = 'S' AND X3.PROXIMO_SUSPENDE_REMUNERA	= 'S' AND X3.TEM_PROXIMA_DATA_FIM = 'SIM'
THEN '50-CRIA CONTROLE FOLHA IGUAL A NORMAL (ATIVO) COMO ULTIMA NO HISTORICO'

WHEN X3.STATUS_LACUNAS = 'VALOR_POSITIVO' AND X3.SO_GERA_SIT_PONTO = 'NAO' AND X3.ULTIMO_REGISTRO = 'SIM' AND X3.CONTROLE_FOLHA = 'N' AND X3.E_AFASTAMENTO = 'N' AND X3.SUSPENDE_REMUNERA = 'N' AND X3.TEM_QTDE_DIAS_PROXIMO = 'NAO' 
AND	X3.TEM_PROXIMA_SIT_FUNC_NO_CAD = 'NAO' AND X3.TEM_DATA_FIM = 'SIM' AND X3.PROXIMO_CONTROLE_FOLHA IS NULL --= 'L' AND	X3.PROXIMO_E_AFASTAMENTO = 'S' AND X3.PROXIMO_SUSPENDE_REMUNERA	= 'S' AND X3.TEM_PROXIMA_DATA_FIM = 'SIM'
THEN '51-TIRAR DATA FIM CONTROLE FOLHA IGUAL A NORMAL (ATIVO) COMO ULTIMA NO HISTORICO'

ELSE 'NAO_MAPEADO_AINDA'
END CENARIO_2022,
X3.* 
,UA.ULT_SIT_FUNC_ATIVA, TEG1.COD_SIT_FUNC_TEG1, CESS.TIPO_CESS

FROM (

SELECT 'DADOS_SINTETICO' DADOS_SINTETICO,
CASE WHEN TEG1.COD_SIT_FUNC_FICHA IS NULL THEN 'NAO' ELSE 'SIM' END SIT_FUNC_TEG1,
X2.TRATATIVA, X2.CENARIOS, CASE WHEN X2.CONTROLE_FOLHA = 'N' AND X2.E_AFASTAMENTO = 'N' AND X2.SUSPENDE_REMUNERA = 'N' THEN 'SIM' ELSE 'NAO' END SIT_FUNC_CONTRATO_TIPO_ATIVO, 
CASE WHEN X2.LACUNAS > 0 THEN 'VALOR_POSITIVO' WHEN X2.LACUNAS < 0 THEN 'VALOR_NEGATIVO' ELSE 'ERRO' END STATUS_LACUNAS,  
X2.SO_GERA_SIT_PONTO, 
CASE WHEN X2.ORDEM_BM = 1 THEN 'SIM' ELSE 'NAO' END ULTIMO_REGISTRO, 
X2.CONTROLE_FOLHA, X2.E_AFASTAMENTO, X2.SUSPENDE_REMUNERA, 
CASE WHEN X2.QTDE_DIAS_PROXIMO IS NOT NULL AND X2.QTDE_DIAS_PROXIMO <> 0 THEN 'SIM' ELSE 'NAO' END TEM_QTDE_DIAS_PROXIMO,--X2.QTDE_DIAS_PROXIMO, 
CASE WHEN X2.PROXIMA_SIT_FUNC IS NOT NULL THEN 'SIM' ELSE 'NAO' END TEM_PROXIMA_SIT_FUNC_NO_CAD, 
CASE WHEN X2.DATA_FIM IS NULL THEN 'NAO' ELSE 'SIM' END TEM_DATA_FIM,  
X2.PROXIMO_CONTROLE_FOLHA, X2.PROXIMO_E_AFASTAMENTO, X2.PROXIMO_SUSPENDE_REMUNERA,  
CASE WHEN X2.PROXIMA_DATA_FIM IS NULL THEN 'NAO' ELSE 'SIM' END TEM_PROXIMA_DATA_FIM 

,'DADOS_ANALITICO' DADOS_ANALITICO
, X2.SIT_FUNC_ULT_CONTR, X2.LACUNAS, X2.ORDEM_BM, X2.CODIGO_EMPRESA, X2.TIPO_CONTRATO, X2.CODIGO, X2.TIPO_TRABALHADOR, X2.VINCULO, X2.COD_SIT_FUNCIONAL, X2.SIT_FUNCIONAL,
 X2.QTDE_DIAS_PROXIMO, X2.PROXIMA_SIT_FUNC, X2.DATA_INICIO, X2.DATA_FIM, X2.LOGIN_USUARIO, X2.DT_ULT_ALTER_USUA, X2.TEXTO_ASSOCIADO,
 X2.PROXIMA_COD_SIT_FUNCIONAL, X2.PROXIMA_SIT_FUNCIONAL, X2.PROXIMO_SO_GERA_SIT_PONTO, X2.PROXIMA_DATA_INICIO, X2.PROXIMA_DATA_FIM, X2.PROXIMO_LOGIN_USUARIO, X2.PROXIMA_DT_ULT_ALTER_USUA, X2.PROXIMA_TEXTO_ASSOCIADO, 
 X2.DATA_INICIO_COMPARAR, X2.DATA_FIM_COMPARAR 
 , CASE WHEN X2.VINCULO IN ('0000','0001','0002','0007','0013','0015','0023','0033') THEN '1000' WHEN X2.VINCULO IN ('0010','0012','0030') THEN '1012' ELSE '0000' END SIT_FUNC_PADRAO_VINCULO

FROM( 


SELECT CASE   
WHEN X.CENARIOS = '1-DIMINUI DT FIM DA NORMAL' THEN 'AVISAR GEVIF/GETED: 1-DIMINUI DT FIM DA NORMAL'  
WHEN X.CENARIOS = '2-CRIA PERIODO ENTRE SIT COM 1000' THEN '2-CRIA PERIODO ENTRE SIT COM 1000' 
WHEN X.CENARIOS = '3-AUMENTA DATA FIM DA PRIMEIRA 1000' THEN '3-CRIA PERIODO ENTRE SIT COM 1000' 
WHEN X.CENARIOS = '4-ALTERA DATA FIM DA NORMAL-AUMENTA' THEN 'AVISAR GEVIF/GETED: 4-ALTERA DATA FIM DA NORMAL-AUMENTA' 
WHEN X.CENARIOS = '4-ALTERA DATA FIM DA NORMAL-DIMINUI' THEN 'AVISAR GEVIF/GETED: 4-ALTERA DATA FIM DA NORMAL-DIMINUI' 
WHEN X.CENARIOS = '5-FAZER NADA LICENCA AINDA NAO ACABOU' THEN '5-FAZER NADA LICENCA AINDA NAO ACABOU' 
WHEN X.CENARIOS = '6-ULTIMO REGISTRO LICENCA JÁ ACABOU VOLTAR PARA 1000-INSERT' THEN '6-ULTIMO REGISTRO LICENCA JÁ ACABOU VOLTAR PARA 1000-INSERT' 
WHEN X.CENARIOS = '6-ULTIMO REGISTRO LICENCA JÁ ACABOU VOLTAR PARA 1000-SINALIZAR' THEN 'AVISAR GEVIF/GETED: 6-ULTIMO REGISTRO LICENCA JÁ ACABOU VOLTAR PARA 1000-SINALIZAR'  
WHEN X.CENARIOS = '7-CRIA PERIODO ENTRE SIT COM 1000' THEN '7-CRIA PERIODO ENTRE SIT COM 1000' 
WHEN X.CENARIOS = '7-AUMENTAR DATA FIM DA 6008' THEN '7-AUMENTAR DATA FIM DA 6008' 
WHEN X.CENARIOS = '8-CONCOMITANCIA DE LICENCAS DEFINIR QUAL ALTERAR' THEN 'AVISAR GEVIF/GETED: 8-CONCOMITANCIA DE LICENCAS DEFINIR QUAL ALTERAR' 
WHEN X.CENARIOS = '9-LACUNA DE LICENCAS GRAVAR 1000' THEN '9-LACUNA DE LICENCAS GRAVAR 1000' 
WHEN X.CENARIOS = '10-ULTIMO REGISTRO LICENCA JÁ ACABOU VOLTAR PARA ULTIMA ATIVA' THEN '10-ULTIMO REGISTRO LICENCA JÁ ACABOU VOLTAR PARA ULTIMA ATIVA' 
WHEN X.CENARIOS = '11-ULTIMO REGISTRO NORMAL COM DATA FIM, TIRAR DATA FIM' THEN '11-ULTIMO REGISTRO NORMAL COM DATA FIM, TIRAR DATA FIM' 
WHEN X.CENARIOS = '12-ULTIMA SIT SO_GERA_SIT_PONTO = NADA' THEN '12-RETIRAR DO SCRIPT DE LACUNAS ' 
WHEN X.CENARIOS = '13 -APAGAR DATA FIM DA ULTIMA SITUAÇÃO FUNCIONAL' THEN '13 -APAGAR DATA FIM DA ULTIMA SITUAÇÃO FUNCIONAL' 
WHEN X.CENARIOS = '14- RETIRAR DO SCRIPT DE LACUNAS' THEN '14-RETIRAR DO SCRIPT DE LACUNAS ' 

WHEN X.CENARIOS = 'NÃO MAPEADO-FAZER AJUSTES MANUALMENTE' THEN 'AVISAR GEVIF/GETED: NÃO MAPEADO-FAZER AJUSTES MANUALMENTE' 
END TRATATIVA, 

X.* FROM ( 
SELECT  
S.*  
FROM ( 
SELECT  
CASE  
WHEN K.LACUNAS < 0 AND K.CONTROLE_FOLHA = 'N' AND K.PROXIMO_CONTROLE_FOLHA IN ('L','M') AND K.TIPO_TRABALHADOR IN ('101','301') AND K.E_AFASTAMENTO = 'N' AND K.SUSPENDE_REMUNERA = 'N' AND K.PROXIMO_E_AFASTAMENTO = 'S' AND K.PROXIMO_SUSPENDE_REMUNERA = 'N' 
THEN '1-DIMINUI DT FIM DA NORMAL' 
WHEN  
K.LACUNAS > 0 AND K.CONTROLE_FOLHA IN ('L','M') AND K.PROXIMO_CONTROLE_FOLHA IN ('L','M') AND K.TIPO_TRABALHADOR IN ('101','301') AND K.SIT_FUNC_ULT_CONTR = '1000' AND K.E_AFASTAMENTO = 'S' AND K.SUSPENDE_REMUNERA = 'N' AND K.PROXIMO_E_AFASTAMENTO = 'S' AND K.PROXIMO_SUSPENDE_REMUNERA = 'N' 
THEN '2-CRIA PERIODO ENTRE SIT COM 1000' 
WHEN  
K.LACUNAS > 0 AND K.CONTROLE_FOLHA = 'N' AND K.PROXIMO_CONTROLE_FOLHA = 'N' AND K.TIPO_TRABALHADOR IN ('101','301') AND K.SIT_FUNC_ULT_CONTR = '1000' AND K.E_AFASTAMENTO = 'N' AND K.SUSPENDE_REMUNERA = 'N' AND K.PROXIMO_E_AFASTAMENTO = 'N' AND K.PROXIMO_SUSPENDE_REMUNERA = 'N' 
THEN '3-AUMENTA DATA FIM DA PRIMEIRA 1000' 
WHEN  
K.LACUNAS > 0 AND K.CONTROLE_FOLHA = 'N' AND K.PROXIMO_CONTROLE_FOLHA IN ('L','M') AND K.TIPO_TRABALHADOR IN ('101','301') AND K.SIT_FUNC_ULT_CONTR = '1000' AND K.ORDEM_BM <> 1 AND K.E_AFASTAMENTO = 'N' AND K.SUSPENDE_REMUNERA = 'N' AND K.PROXIMO_E_AFASTAMENTO = 'S' AND K.PROXIMO_SUSPENDE_REMUNERA = 'N' 
THEN '4-ALTERA DATA FIM DA NORMAL-AUMENTA' 
WHEN  
K.LACUNAS < 0 AND K.CONTROLE_FOLHA = 'N' AND K.PROXIMO_CONTROLE_FOLHA IN ('L','M') AND K.TIPO_TRABALHADOR IN ('101','301')  AND K.E_AFASTAMENTO = 'N' AND K.SUSPENDE_REMUNERA = 'N' AND K.PROXIMO_E_AFASTAMENTO = 'S' AND K.PROXIMO_SUSPENDE_REMUNERA = 'N' 
THEN '4-ALTERA DATA FIM DA NORMAL-DIMINUI' 
WHEN  
K.LACUNAS < 0 AND K.CONTROLE_FOLHA <> 'N' AND TRUNC(K.DATA_FIM) >= TRUNC(SYSDATE)  
THEN '5-FAZER NADA LICENCA AINDA NAO ACABOU' 
WHEN  
K.LACUNAS > 0 AND K.CONTROLE_FOLHA IN ('L','M') AND K.TIPO_TRABALHADOR IN ('101','301') AND K.ORDEM_BM = 1 AND TRUNC(K.DATA_FIM) < TRUNC(SYSDATE) AND K.E_AFASTAMENTO = 'S' AND K.SUSPENDE_REMUNERA = 'N' AND K.PROXIMA_COD_SIT_FUNCIONAL IS NULL AND K.SO_GERA_SIT_PONTO = 'NAO' 
THEN '6-ULTIMO REGISTRO LICENCA JÁ ACABOU VOLTAR PARA 1000-INSERT' 
WHEN  
K.LACUNAS > 0 AND K.CONTROLE_FOLHA IN ('L','M') AND K.TIPO_TRABALHADOR IN ('101','301') AND K.E_AFASTAMENTO = 'S' AND K.SUSPENDE_REMUNERA = 'N' AND K.PROXIMA_COD_SIT_FUNCIONAL IS NULL AND K.SO_GERA_SIT_PONTO <> 'NAO' 
THEN '6-ULTIMO REGISTRO LICENCA JÁ ACABOU VOLTAR PARA 1000-SINALIZAR' 
WHEN  
K.LACUNAS > 0 AND K.CONTROLE_FOLHA IN ('L','M') AND K.PROXIMO_CONTROLE_FOLHA = 'N' AND K.TIPO_TRABALHADOR IN ('101','301') AND K.SIT_FUNC_ULT_CONTR = '1000' AND K.ORDEM_BM <> 1 AND K.DATA_FIM IS NOT NULL AND K.E_AFASTAMENTO = 'S' AND K.SUSPENDE_REMUNERA = 'N' AND K.PROXIMO_E_AFASTAMENTO = 'N' AND K.PROXIMO_SUSPENDE_REMUNERA = 'N' 
THEN '7-CRIA PERIODO ENTRE SIT COM 1000' 
WHEN  
K.LACUNAS > 0 AND K.CONTROLE_FOLHA = 'A' AND K.PROXIMO_CONTROLE_FOLHA = 'N' AND K.TIPO_TRABALHADOR IN ('101','301') AND K.E_AFASTAMENTO = 'N' AND K.SUSPENDE_REMUNERA = 'S' AND K.PROXIMO_E_AFASTAMENTO = 'N' AND K.PROXIMO_SUSPENDE_REMUNERA = 'N' 
THEN '7-AUMENTAR DATA FIM DA 6008' 
WHEN  
K.LACUNAS < 0 AND K.CONTROLE_FOLHA <> 'N' AND K.PROXIMO_CONTROLE_FOLHA <> 'N' AND K.ORDEM_BM <> 1   
THEN '8-CONCOMITANCIA DE LICENCAS DEFINIR QUAL ALTERAR' 
WHEN  
K.LACUNAS > 0 AND K.CONTROLE_FOLHA IN ('L','M') AND K.PROXIMO_CONTROLE_FOLHA IN ('L','M') AND K.TIPO_TRABALHADOR IN ('101','301') AND K.ORDEM_BM <> 1 AND K.E_AFASTAMENTO = 'S' AND K.SUSPENDE_REMUNERA = 'N' AND K.PROXIMO_E_AFASTAMENTO = 'S' AND K.PROXIMO_SUSPENDE_REMUNERA = 'N' 
THEN '9-LACUNA DE LICENCAS GRAVAR 1000' 
WHEN  
K.LACUNAS > 0 AND K.CONTROLE_FOLHA <> 'N' AND K.ORDEM_BM = 1 AND K.TIPO_TRABALHADOR = '309' AND K.ORDEM_BM = 1 AND K.SO_GERA_SIT_PONTO = 'NAO' 
THEN '10-ULTIMO REGISTRO LICENCA JÁ ACABOU VOLTAR PARA ULTIMA ATIVA' 
WHEN  
K.LACUNAS > 0 AND K.CONTROLE_FOLHA = 'N' AND K.ORDEM_BM = 1 AND K.TIPO_TRABALHADOR = '309' AND K.ORDEM_BM = 1 AND K.SO_GERA_SIT_PONTO = 'SIM' 
THEN '11-ULTIMO REGISTRO NORMAL COM DATA FIM, TIRAR DATA FIM' 
WHEN  
K.LACUNAS > 0 AND K.PROXIMA_COD_SIT_FUNCIONAL IS NULL AND K.SO_GERA_SIT_PONTO = 'NADA' 
THEN '12-ULTIMA SIT SO_GERA_SIT_PONTO = NADA' 
WHEN  
K.LACUNAS > 0 AND K.CONTROLE_FOLHA = 'N' AND K.E_AFASTAMENTO = 'S' AND K.SUSPENDE_REMUNERA = 'S' AND K.PROXIMA_COD_SIT_FUNCIONAL IS NULL AND K.SO_GERA_SIT_PONTO = 'SIM' 
THEN '13 -APAGAR DATA FIM DA ULTIMA SITUAÇÃO FUNCIONAL' 
WHEN  
K.LACUNAS > 0 AND ( 
(K.CONTROLE_FOLHA = 'L' AND K.E_AFASTAMENTO = 'N' AND K.SUSPENDE_REMUNERA = 'N')OR 
(K.CONTROLE_FOLHA = 'L' AND K.E_AFASTAMENTO = 'S' AND K.SUSPENDE_REMUNERA = 'N')OR 
(K.CONTROLE_FOLHA = 'N' AND K.E_AFASTAMENTO = 'N' AND K.SUSPENDE_REMUNERA = 'S' AND K.QTDE_DIAS_PROXIMO IS NULL ) 
) 
AND K.PROXIMA_COD_SIT_FUNCIONAL IS NULL AND K.SO_GERA_SIT_PONTO = 'SIM' 
THEN '14- RETIRAR DO SCRIPT DE LACUNAS' 

ELSE 'NÃO MAPEADO-FAZER AJUSTES MANUALMENTE' END CENARIOS, 

K.* FROM ( 
SELECT 
C.VINCULO,
COD_CATEG.CONTEUDO_INICIAL TIPO_TRABALHADOR, C.SITUACAO_FUNCIONAL SIT_FUNC_ULT_CONTR, 
TRUNC(Q.DATA_INICIO_COMPARAR) - TRUNC(Q.DATA_FIM_COMPARAR) -1 AS LACUNAS  
,Q.*  
FROM( 
SELECT  
T.*  
,CASE  
WHEN T.ORDEM_BM = 1 THEN TO_DATE(TO_CHAR(SYSDATE,'DD/MM/YYYY'),'DD/MM/YYYY')+1  
ELSE TO_DATE(TO_CHAR(T.PROXIMA_DATA_INICIO,'DD/MM/YYYY'),'DD/MM/YYYY') END DATA_INICIO_COMPARAR 
,CASE  
WHEN T.CONTROLE_FOLHA NOT IN ('L','M') AND T.DATA_FIM IS NULL AND T.ORDEM_BM = 1 THEN TO_DATE(TO_CHAR(SYSDATE,'DD/MM/YYYY'),'DD/MM/YYYY') 
WHEN T.CONTROLE_FOLHA NOT IN ('L','M') AND T.DATA_FIM IS NULL AND T.ORDEM_BM <> 1 THEN TO_DATE(TO_CHAR(T.DATA_INICIO,'DD/MM/YYYY'),'DD/MM/YYYY')-1

ELSE TO_DATE(TO_CHAR(T.DATA_FIM,'DD/MM/YYYY'),'DD/MM/YYYY') END DATA_FIM_COMPARAR 
FROM ( 
SELECT  
ROW_NUMBER() OVER (PARTITION BY A.CODIGO_EMPRESA, A.TIPO_CONTRATO, A.CODIGO ORDER BY A.DATA_INIC_SITUACAO DESC) AS ORDEM_BM, 
A.CODIGO_EMPRESA, A.TIPO_CONTRATO, A.CODIGO, A.COD_SIT_FUNCIONAL, S.DESCRICAO SIT_FUNCIONAL, S.CONTROLE_FOLHA,  
S.E_AFASTAMENTO, S.SUSPENDE_REMUNERA, S.QTDE_DIAS_PROXIMO, S.PROXIMA_SIT_FUNC,
CASE WHEN S.C_LIVRE_SELEC02 = '0' THEN 'NADA' WHEN S.C_LIVRE_SELEC02 = '1' THEN 'SIM' WHEN S.C_LIVRE_SELEC02 = '2' THEN 'NAO' ELSE 'ERRO' END SO_GERA_SIT_PONTO,  
TO_DATE(TO_CHAR(A.DATA_INIC_SITUACAO,'DD/MM/YYYY'),'DD/MM/YYYY') DATA_INICIO, TO_DATE(TO_CHAR(A.DATA_FIM_SITUACAO,'DD/MM/YYYY'),'DD/MM/YYYY') DATA_FIM

,A.LOGIN_USUARIO, A.DT_ULT_ALTER_USUA, A.TEXTO_ASSOCIADO 
,LEAD(A.COD_SIT_FUNCIONAL, 1, NULL) OVER (PARTITION BY A.CODIGO_EMPRESA, A.TIPO_CONTRATO, A.CODIGO ORDER BY A.DATA_INIC_SITUACAO ) AS PROXIMA_COD_SIT_FUNCIONAL 
,LEAD(S.DESCRICAO, 1, NULL) OVER (PARTITION BY A.CODIGO_EMPRESA, A.TIPO_CONTRATO, A.CODIGO ORDER BY A.DATA_INIC_SITUACAO ) AS PROXIMA_SIT_FUNCIONAL 
,LEAD(S.CONTROLE_FOLHA, 1, NULL) OVER (PARTITION BY A.CODIGO_EMPRESA, A.TIPO_CONTRATO, A.CODIGO ORDER BY A.DATA_INIC_SITUACAO ) AS PROXIMO_CONTROLE_FOLHA 
,LEAD(S.E_AFASTAMENTO, 1, NULL) OVER (PARTITION BY A.CODIGO_EMPRESA, A.TIPO_CONTRATO, A.CODIGO ORDER BY A.DATA_INIC_SITUACAO ) AS PROXIMO_E_AFASTAMENTO 
,LEAD(S.SUSPENDE_REMUNERA, 1, NULL) OVER (PARTITION BY A.CODIGO_EMPRESA, A.TIPO_CONTRATO, A.CODIGO ORDER BY A.DATA_INIC_SITUACAO ) AS PROXIMO_SUSPENDE_REMUNERA 
,LEAD(CASE WHEN S.C_LIVRE_SELEC02 = '0' THEN 'NADA' WHEN S.C_LIVRE_SELEC02 = '1' THEN 'SIM' WHEN S.C_LIVRE_SELEC02 = '2' THEN 'NÃO' ELSE 'ERRO' END, 1, NULL) OVER (PARTITION BY A.CODIGO_EMPRESA, A.TIPO_CONTRATO, A.CODIGO ORDER BY A.DATA_INIC_SITUACAO ) AS PROXIMO_SO_GERA_SIT_PONTO 
,LEAD(TO_DATE(TO_CHAR(A.DATA_INIC_SITUACAO,'DD/MM/YYYY'),'DD/MM/YYYY'), 1, NULL) OVER (PARTITION BY A.CODIGO_EMPRESA, A.TIPO_CONTRATO, A.CODIGO  ORDER BY A.DATA_INIC_SITUACAO) AS PROXIMA_DATA_INICIO 
,LEAD(TO_DATE(TO_CHAR(A.DATA_FIM_SITUACAO,'DD/MM/YYYY'),'DD/MM/YYYY'), 1, NULL) OVER (PARTITION BY A.CODIGO_EMPRESA, A.TIPO_CONTRATO, A.CODIGO  ORDER BY A.DATA_INIC_SITUACAO ) AS PROXIMA_DATA_FIM 
,LEAD(A.LOGIN_USUARIO, 1, NULL) OVER (PARTITION BY A.CODIGO_EMPRESA, A.TIPO_CONTRATO, A.CODIGO ORDER BY A.DATA_INIC_SITUACAO ) AS PROXIMO_LOGIN_USUARIO 
,LEAD( A.DT_ULT_ALTER_USUA, 1, NULL) OVER (PARTITION BY A.CODIGO_EMPRESA, A.TIPO_CONTRATO, A.CODIGO ORDER BY A.DATA_INIC_SITUACAO ) AS PROXIMA_DT_ULT_ALTER_USUA 
,LEAD( A.TEXTO_ASSOCIADO, 1, NULL) OVER (PARTITION BY A.CODIGO_EMPRESA, A.TIPO_CONTRATO, A.CODIGO ORDER BY A.DATA_INIC_SITUACAO ) AS PROXIMA_TEXTO_ASSOCIADO 
FROM RHCGED_ALT_SIT_FUN A 
LEFT OUTER JOIN RHPARM_SIT_FUNC S ON S.CODIGO = A.COD_SIT_FUNCIONAL 
WHERE  

A.CODIGO_EMPRESA IN ('0001','0002','0003','0013','0014')--A.CODIGO_EMPRESA IN ('0001','0098','0003','0013','0014', '0002','0007','0009','0010')


AND TRUNC(A.DATA_INIC_SITUACAO) >= TO_DATE('30/09/2019','DD/MM/YYYY')

)T 
)Q 
LEFT OUTER JOIN RHPESS_CONTRATO C ON C.CODIGO_EMPRESA = Q.CODIGO_EMPRESA AND C.TIPO_CONTRATO = Q.TIPO_CONTRATO AND C.CODIGO = Q.CODIGO 
LEFT OUTER JOIN RHTABS_VINCULO_EMP V ON V.CODIGO = C.VINCULO 
LEFT OUTER JOIN (SELECT * FROM RHTABS_ITDS_SIST WHERE CODIGO_DOMINIO IN (SELECT CODIGO_DOMINIO FROM RHTABS_COLS_SIST  WHERE CODIGO_TABELA = 'RHTABS_VINCULO_EMP' AND CODIGO_COLUNA = 'TP_REGIME_TRAB_ESOCIAL'))RG_TRAB 
ON RG_TRAB.CONTEUDO_INICIAL = V.TP_REGIME_TRAB_ESOCIAL 
LEFT OUTER JOIN (SELECT * FROM RHTABS_ITDS_SIST WHERE CODIGO_DOMINIO IN (SELECT CODIGO_DOMINIO FROM RHTABS_COLS_SIST  WHERE CODIGO_TABELA = 'RHTABS_VINCULO_EMP' AND CODIGO_COLUNA = 'TP_REGIME_PREV_ESOCIAL'))RG_PREV 
ON RG_PREV.CONTEUDO_INICIAL = V.TP_REGIME_PREV_ESOCIAL 
LEFT OUTER JOIN (SELECT * FROM RHTABS_ITDS_SIST WHERE CODIGO_DOMINIO IN (SELECT CODIGO_DOMINIO FROM RHTABS_COLS_SIST  WHERE CODIGO_TABELA = 'RHTABS_VINCULO_EMP' AND CODIGO_COLUNA = 'COD_CATEG_ESOCIAL'))COD_CATEG 
ON COD_CATEG.CONTEUDO_INICIAL = V.COD_CATEG_ESOCIAL 
WHERE  
C.ANO_MES_REFERENCIA = (SELECT MAX(AUX.ANO_MES_REFERENCIA)FROM RHPESS_CONTRATO AUX WHERE C.CODIGO_EMPRESA = AUX.CODIGO_EMPRESA AND C.TIPO_CONTRATO = AUX.TIPO_CONTRATO AND C.CODIGO = AUX.CODIGO) 
AND C.DATA_RESCISAO IS NULL AND C.CODIGO_EMPRESA IN ('0001','0098','0003','0013','0014', '0002','0007','0009','0010')

)K 
WHERE K.LACUNAS <> 0 
ORDER BY  K.CODIGO_EMPRESA , K.TIPO_CONTRATO , K.CODIGO , K.DATA_INICIO 
)S 


WHERE TRUNC(S.DATA_FIM_COMPARAR) < TRUNC(SYSDATE) 

)X  

)X2  
LEFT OUTER JOIN (SELECT SUBSTR(DADO_DESTINO,1,4)COD_SIT_FUNC_FICHA FROM RHINTE_ED_IT_CONV WHERE CODIGO_CONVERSAO ='TEG1' AND SUBSTR(DADO_DESTINO,1,4) IS NOT NULL GROUP BY SUBSTR(DADO_DESTINO,1,4) 
      UNION ALL SELECT  SUBSTR(DADO_DESTINO,17,4)COD_SIT_FUNC_FICHA FROM RHINTE_ED_IT_CONV WHERE CODIGO_CONVERSAO ='TEG1'AND SUBSTR(DADO_DESTINO,17,4) IS NOT NULL GROUP BY SUBSTR(DADO_DESTINO,17,4)
)TEG1 ON TEG1.COD_SIT_FUNC_FICHA = X2.COD_SIT_FUNCIONAL


ORDER BY  X2.TRATATIVA, X2.CODIGO_EMPRESA , X2.TIPO_CONTRATO , X2.CODIGO , X2.DATA_INICIO  

)X3 

LEFT OUTER JOIN
(
-- INICIO ---------------------BUSCAR ULTIMA SITUAÇÃO FUNCIONAL TIPO ATIVA ANTES DO ATESTADO
SELECT A.CODIGO_EMPRESA,A.TIPO_CONTRATO, A.CODIGO, A.DATA_INIC_SITUACAO, A.COD_SIT_FUNCIONAL ULT_SIT_FUNC_ATIVA
FROM RHCGED_ALT_SIT_FUN A
LEFT OUTER JOIN RHPARM_SIT_FUNC S ON S.CODIGO = A.COD_SIT_FUNCIONAL
LEFT OUTER JOIN RHPONT_SITUACAO P ON P.CODIGO = S.SITUACAO_PONTO
WHERE 
--A.CODIGO_EMPRESA = C1.CODIGO_EMPRESA --'0001'
--AND A.TIPO_CONTRATO = C1.TIPO_CONTRATO--'0001'
--AND A.CODIGO = C1.CODIGO--'000000001109306'
--AND
A.DATA_INIC_SITUACAO = (SELECT MAX(AUX.DATA_INIC_SITUACAO)FROM RHCGED_ALT_SIT_FUN AUX
                                 LEFT OUTER JOIN RHPARM_SIT_FUNC SX ON SX.CODIGO = AUX.COD_SIT_FUNCIONAL
                                WHERE  A.CODIGO_EMPRESA = AUX.CODIGO_EMPRESA AND A.TIPO_CONTRATO = AUX.TIPO_CONTRATO AND A.CODIGO = AUX.CODIGO
                                --AND TRUNC(AUX.DATA_INIC_SITUACAO) < TRUNC(X3.DATA_INICIO)
                                AND SX.CONTROLE_FOLHA = 'N' AND SX.E_AFASTAMENTO = 'N' AND SX.SUSPENDE_REMUNERA = 'N' AND SX.C_LIVRE_SELEC02 = '2')
AND S.CONTROLE_FOLHA = 'N' AND S.E_AFASTAMENTO = 'N' AND S.SUSPENDE_REMUNERA = 'N' AND S.C_LIVRE_SELEC02 = '2'
--ORDER BY A.CODIGO_EMPRESA,A.TIPO_CONTRATO, A.CODIGO, A.DATA_INIC_SITUACAO DESC, A.COD_SIT_FUNCIONAL
-- FIM ---------------------BUSCAR ULTIMA SITUAÇÃO FUNCIONAL TIPO ATIVA ANTES DO ATESTADO
)UA ON UA.CODIGO_EMPRESA = X3.CODIGO_EMPRESA AND UA.TIPO_CONTRATO = X3.TIPO_CONTRATO AND UA.CODIGO = X3.CODIGO-- AND TRUNC(UA.DATA_INIC_SITUACAO) < TRUNC(X3.DATA_INICIO)


LEFT OUTER JOIN 
(SELECT SUBSTR(TEG1.DADO_DESTINO,1,4)COD_SIT_FUNC_TEG1 FROM RHINTE_ED_IT_CONV TEG1 WHERE TEG1.CODIGO_CONVERSAO ='TEG1' AND SUBSTR(TEG1.DADO_DESTINO,1,4)IS NOT NULL  GROUP BY SUBSTR(TEG1.DADO_DESTINO,1,4)
  UNION ALL SELECT SUBSTR(TEG1.DADO_DESTINO,17,4)COD_SIT_FUNC_TEG1 FROM RHINTE_ED_IT_CONV TEG1 WHERE TEG1.CODIGO_CONVERSAO ='TEG1'  AND SUBSTR(TEG1.DADO_DESTINO,17,4)IS NOT NULL GROUP BY SUBSTR(TEG1.DADO_DESTINO,17,4)
)TEG1 ON TEG1.COD_SIT_FUNC_TEG1 = X3.COD_SIT_FUNCIONAL

LEFT OUTER JOIN 
(SELECT DADO_ORIGEM SIT_FUNC, DADO_DESTINO TIPO_CESS FROM RHINTE_ED_IT_CONV X WHERE X.CODIGO_CONVERSAO = 'CESS' )CESS
ON CESS.SIT_FUNC = X3.COD_SIT_FUNCIONAL

WHERE X3.VINCULO <> '0050'--NOVO EM 14/11/23 A PEDIDO STEPHANIE GEVIF EMAIL (Sobre controle registros ALT SIT FUNC)

ORDER BY X3.TRATATIVA, X3.CENARIOS, X3.SIT_FUNC_CONTRATO_TIPO_ATIVO, X3.STATUS_LACUNAS, X3.ULTIMO_REGISTRO, X3.CONTROLE_FOLHA, X3.E_AFASTAMENTO, X3.SUSPENDE_REMUNERA, X3.TEM_QTDE_DIAS_PROXIMO, X3.TEM_DATA_FIM, X3.PROXIMO_CONTROLE_FOLHA, X3.PROXIMO_E_AFASTAMENTO, X3.PROXIMO_SUSPENDE_REMUNERA, X3.TEM_PROXIMA_DATA_FIM, X3.CODIGO_EMPRESA, X3.TIPO_CONTRATO, X3.CODIGO, X3.DATA_INICIO
--ANALITICO E SINTETICO
--)X4 GROUP BY CENARIO_2022 ORDER BY CENARIO_2022--SENTETICO DE CENARIO


)              
LOOP              

vCONTADOR :=vCONTADOR+1; 
dbms_output.put_line('--'||vCONTADOR);
dbms_output.put_line('--CODIGO_EMPRESA: '||C1.CODIGO_EMPRESA	||' TIPO_CONTRATO: '||C1.TIPO_CONTRATO||' CODIGO: '||C1.CODIGO|| ' COD_SIT_FUNCIONAL: '||C1.COD_SIT_FUNCIONAL||' SIT_FUNCIONAL: '||C1.SIT_FUNCIONAL|| ' DATA_INICIO: '||C1.DATA_INICIO||' DATA_FIM: '||C1.DATA_FIM|| ' PROXIMA_COD_SIT_FUNCIONAL: '||C1.PROXIMA_COD_SIT_FUNCIONAL||' 	PROXIMA_SIT_FUNCIONAL:' ||C1.PROXIMA_SIT_FUNCIONAL||' PROXIMA_DATA_INICIO: '||C1.PROXIMA_DATA_INICIO||'	PROXIMA_DATA_FIM: '||C1.PROXIMA_DATA_FIM);


-- INICIO ---------------------DEFINE SITUACAO ATIVA POR VINCULO
select CASE 
WHEN C1.ULT_SIT_FUNC_ATIVA IS NOT NULL THEN C1.ULT_SIT_FUNC_ATIVA
WHEN C1.ULT_SIT_FUNC_ATIVA IS NULL AND C1.VINCULO IN ('0000','0001','0002','0007','0013','0015','0023','0033') THEN '1000'
WHEN C1.ULT_SIT_FUNC_ATIVA IS NULL AND C1.VINCULO IN ('0010','0012','0030') THEN '1012'
ELSE '0000'
END
INTO V_SIT_FUNC_ATIVA_VINCULO 
FROM DUAL ;
-- FIM ---------------------DEFINE SITUACAO ATIVA POR VINCULO



dbms_output.put_line('--V_SIT_FUNC_ATIVA_VINCULO: '||V_SIT_FUNC_ATIVA_VINCULO|| ' C1.SIT_FUNC_PADRAO_VINCULO: '|| C1.SIT_FUNC_PADRAO_VINCULO);

BEGIN --EXCEPTION

---INICIO -------------------------------------------------------------IF GERAL DE AJUSTES 2022-------------------------------------------------------------------------
IF C1.CENARIO_2022 = 'SITUACAO FUNCIONAL CAMPO SO_GERA_SIT_PONTO DIFERENTE QUE NAO' THEN
dbms_output.put_line('--SITUACAO FUNCIONAL CAMPO SO_GERA_SIT_PONTO DIFERENTE QUE NAO');
INSERT INTO SUGESP_AJUSTE_LOTE_CAMPO_HIST(CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, CAMPO_VALOR_1, CONSIDERACOES, CAMPO_VALOR_2, CAMPO_VALOR_3, CAMPO_VALOR_4, CAMPO_VALOR_5, CAMPO_VALOR_6, CAMPO_VALOR_7, CAMPO_VALOR_8, CAMPO_VALOR_9, CAMPO_VALOR_10, DATA_DADOS)VALUES(C1.CODIGO_EMPRESA,C1.TIPO_CONTRATO,C1.CODIGO,'LOG EXECUCAO PROCEDURE PR_ACERTO_LACUNAS_SIT_FUNC_2022',C1.CENARIO_2022,C1.COD_SIT_FUNCIONAL,C1.SIT_FUNCIONAL,C1.DATA_INICIO,C1.DATA_FIM,C1.PROXIMA_COD_SIT_FUNCIONAL,C1.PROXIMA_SIT_FUNCIONAL,C1.PROXIMA_DATA_INICIO,C1.PROXIMA_DATA_FIM,V_SIT_FUNC_ATIVA_VINCULO, SYSDATE);COMMIT;

ELSIF C1.CENARIO_2022 = 'SITUACAO FUNCIONAL DE CESSAO' THEN
dbms_output.put_line('--SITUACAO FUNCIONAL DE CESSAO');
INSERT INTO SUGESP_AJUSTE_LOTE_CAMPO_HIST(CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, CAMPO_VALOR_1, CONSIDERACOES, CAMPO_VALOR_2, CAMPO_VALOR_3, CAMPO_VALOR_4, CAMPO_VALOR_5, CAMPO_VALOR_6, CAMPO_VALOR_7, CAMPO_VALOR_8, CAMPO_VALOR_9, CAMPO_VALOR_10, DATA_DADOS)VALUES(C1.CODIGO_EMPRESA,C1.TIPO_CONTRATO,C1.CODIGO,'LOG EXECUCAO PROCEDURE PR_ACERTO_LACUNAS_SIT_FUNC_2022',C1.CENARIO_2022,C1.COD_SIT_FUNCIONAL,C1.SIT_FUNCIONAL,C1.DATA_INICIO,C1.DATA_FIM,C1.PROXIMA_COD_SIT_FUNCIONAL,C1.PROXIMA_SIT_FUNCIONAL,C1.PROXIMA_DATA_INICIO,C1.PROXIMA_DATA_FIM,V_SIT_FUNC_ATIVA_VINCULO, SYSDATE);COMMIT;

ELSIF C1.CENARIO_2022 = '1-DIMINUI DT FIM DA SIT FUNC CONTROLE FOLHA IGUAL A NORMAL (ATIVO)' THEN
dbms_output.put_line('--1-DIMINUI DT FIM DA SIT FUNC CONTROLE FOLHA IGUAL A NORMAL (ATIVO)');
UPDATE RHCGED_ALT_SIT_FUN SET LOGIN_USUARIO = 'script_acerto_alt_sit_func' , DT_ULT_ALTER_USUA = SYSDATE, DATA_FIM_SITUACAO = TO_DATE(C1.PROXIMA_DATA_INICIO,'DD/MM/YYYY')-1 WHERE CODIGO_EMPRESA = C1.CODIGO_EMPRESA  AND TIPO_CONTRATO = C1.TIPO_CONTRATO AND CODIGO =  C1.CODIGO  AND TRUNC(DATA_INIC_SITUACAO) = TO_DATE(C1.DATA_INICIO,'DD/MM/YYYY');COMMIT;
INSERT INTO SUGESP_AJUSTE_LOTE_CAMPO_HIST(CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, CAMPO_VALOR_1, CONSIDERACOES, CAMPO_VALOR_2, CAMPO_VALOR_3, CAMPO_VALOR_4, CAMPO_VALOR_5, CAMPO_VALOR_6, CAMPO_VALOR_7, CAMPO_VALOR_8, CAMPO_VALOR_9, CAMPO_VALOR_10, DATA_DADOS)VALUES(C1.CODIGO_EMPRESA,C1.TIPO_CONTRATO,C1.CODIGO,'LOG EXECUCAO PROCEDURE PR_ACERTO_LACUNAS_SIT_FUNC_2022',C1.CENARIO_2022,C1.COD_SIT_FUNCIONAL,C1.SIT_FUNCIONAL,C1.DATA_INICIO,C1.DATA_FIM,C1.PROXIMA_COD_SIT_FUNCIONAL,C1.PROXIMA_SIT_FUNCIONAL,C1.PROXIMA_DATA_INICIO,C1.PROXIMA_DATA_FIM,V_SIT_FUNC_ATIVA_VINCULO, SYSDATE);COMMIT;

ELSIF C1.CENARIO_2022 = '2-CRIA PERIODO ENTRE SIT FUNC DE LICENCA COM CONTROLE FOLHA IGUAL A NORMAL (ATIVO)' THEN
dbms_output.put_line('--2-CRIA PERIODO ENTRE SIT FUNC DE LICENCA COM CONTROLE FOLHA IGUAL A NORMAL (ATIVO)');
INSERT INTO RHCGED_ALT_SIT_FUN (IND_EF_RETRO_ESOCIAL, TEXTO_ASSOCIADO, LOGIN_USUARIO, DT_ULT_ALTER_USUA, CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO, DATA_INIC_SITUACAO, COD_SIT_FUNCIONAL, DATA_FIM_SITUACAO ) VALUES ('N', 'Registro criado automaticamente pela rotina PR_ACERTO_LACUNAS_SIT_FUNC_2022.', 'script_acerto_alt_sit_func' ,SYSDATE, C1.CODIGO_EMPRESA , C1.TIPO_CONTRATO , C1.CODIGO, TO_DATE(C1.DATA_FIM,'DD/MM/YYYY')+1, V_SIT_FUNC_ATIVA_VINCULO, TO_DATE(C1.PROXIMA_DATA_INICIO,'DD/MM/YYYY')-1); COMMIT;
INSERT INTO SUGESP_AJUSTE_LOTE_CAMPO_HIST(CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, CAMPO_VALOR_1, CONSIDERACOES, CAMPO_VALOR_2, CAMPO_VALOR_3, CAMPO_VALOR_4, CAMPO_VALOR_5, CAMPO_VALOR_6, CAMPO_VALOR_7, CAMPO_VALOR_8, CAMPO_VALOR_9, CAMPO_VALOR_10, DATA_DADOS)VALUES(C1.CODIGO_EMPRESA,C1.TIPO_CONTRATO,C1.CODIGO,'LOG EXECUCAO PROCEDURE PR_ACERTO_LACUNAS_SIT_FUNC_2022',C1.CENARIO_2022,C1.COD_SIT_FUNCIONAL,C1.SIT_FUNCIONAL,C1.DATA_INICIO,C1.DATA_FIM,C1.PROXIMA_COD_SIT_FUNCIONAL,C1.PROXIMA_SIT_FUNCIONAL,C1.PROXIMA_DATA_INICIO,C1.PROXIMA_DATA_FIM,V_SIT_FUNC_ATIVA_VINCULO, SYSDATE);COMMIT;

ELSIF C1.CENARIO_2022 = '3-CRIA PERIODO ENTRE SIT FUNC DE LICENCA E MATERNIDADE COM CONTROLE FOLHA IGUAL A NORMAL (ATIVO)' THEN
dbms_output.put_line('--3-CRIA PERIODO ENTRE SIT FUNC DE LICENCA E MATERNIDADE COM CONTROLE FOLHA IGUAL A NORMAL (ATIVO)');
INSERT INTO RHCGED_ALT_SIT_FUN (IND_EF_RETRO_ESOCIAL, TEXTO_ASSOCIADO, LOGIN_USUARIO, DT_ULT_ALTER_USUA, CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO, DATA_INIC_SITUACAO, COD_SIT_FUNCIONAL, DATA_FIM_SITUACAO ) VALUES ('N', 'Registro criado automaticamente pela rotina PR_ACERTO_LACUNAS_SIT_FUNC_2022.', 'script_acerto_alt_sit_func' ,SYSDATE, C1.CODIGO_EMPRESA, C1.TIPO_CONTRATO, C1.CODIGO, TO_DATE(C1.DATA_FIM,'DD/MM/YYYY')+1, V_SIT_FUNC_ATIVA_VINCULO, TO_DATE(C1.PROXIMA_DATA_INICIO,'DD/MM/YYYY')-1); COMMIT;
INSERT INTO SUGESP_AJUSTE_LOTE_CAMPO_HIST(CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, CAMPO_VALOR_1, CONSIDERACOES, CAMPO_VALOR_2, CAMPO_VALOR_3, CAMPO_VALOR_4, CAMPO_VALOR_5, CAMPO_VALOR_6, CAMPO_VALOR_7, CAMPO_VALOR_8, CAMPO_VALOR_9, CAMPO_VALOR_10, DATA_DADOS)VALUES(C1.CODIGO_EMPRESA,C1.TIPO_CONTRATO,C1.CODIGO,'LOG EXECUCAO PROCEDURE PR_ACERTO_LACUNAS_SIT_FUNC_2022',C1.CENARIO_2022,C1.COD_SIT_FUNCIONAL,C1.SIT_FUNCIONAL,C1.DATA_INICIO,C1.DATA_FIM,C1.PROXIMA_COD_SIT_FUNCIONAL,C1.PROXIMA_SIT_FUNCIONAL,C1.PROXIMA_DATA_INICIO,C1.PROXIMA_DATA_FIM,V_SIT_FUNC_ATIVA_VINCULO, SYSDATE);COMMIT;

ELSIF C1.CENARIO_2022 = '4-CRIA PERIODO ENTRE SIT FUNC DE PRORROGACAO MATERNIDADE E LICENCA COM CONTROLE FOLHA IGUAL A NORMAL (ATIVO)' THEN
dbms_output.put_line('--4-CRIA PERIODO ENTRE SIT FUNC DE PRORROGACAO MATERNIDADE E LICENCA COM CONTROLE FOLHA IGUAL A NORMAL (ATIVO)');
INSERT INTO RHCGED_ALT_SIT_FUN (IND_EF_RETRO_ESOCIAL, TEXTO_ASSOCIADO, LOGIN_USUARIO, DT_ULT_ALTER_USUA, CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO, DATA_INIC_SITUACAO, COD_SIT_FUNCIONAL, DATA_FIM_SITUACAO ) VALUES ('N', 'Registro criado automaticamente pela rotina PR_ACERTO_LACUNAS_SIT_FUNC_2022.', 'script_acerto_alt_sit_func' ,SYSDATE, C1.CODIGO_EMPRESA, C1.TIPO_CONTRATO, C1.CODIGO, TO_DATE(C1.DATA_FIM,'DD/MM/YYYY')+1, V_SIT_FUNC_ATIVA_VINCULO, TO_DATE(C1.PROXIMA_DATA_INICIO,'DD/MM/YYYY')-1); COMMIT;
INSERT INTO SUGESP_AJUSTE_LOTE_CAMPO_HIST(CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, CAMPO_VALOR_1, CONSIDERACOES, CAMPO_VALOR_2, CAMPO_VALOR_3, CAMPO_VALOR_4, CAMPO_VALOR_5, CAMPO_VALOR_6, CAMPO_VALOR_7, CAMPO_VALOR_8, CAMPO_VALOR_9, CAMPO_VALOR_10, DATA_DADOS)VALUES(C1.CODIGO_EMPRESA,C1.TIPO_CONTRATO,C1.CODIGO,'LOG EXECUCAO PROCEDURE PR_ACERTO_LACUNAS_SIT_FUNC_2022',C1.CENARIO_2022,C1.COD_SIT_FUNCIONAL,C1.SIT_FUNCIONAL,C1.DATA_INICIO,C1.DATA_FIM,C1.PROXIMA_COD_SIT_FUNCIONAL,C1.PROXIMA_SIT_FUNCIONAL,C1.PROXIMA_DATA_INICIO,C1.PROXIMA_DATA_FIM,V_SIT_FUNC_ATIVA_VINCULO, SYSDATE);COMMIT;

ELSIF C1.CENARIO_2022 = '5-AVISAR GETED- NAO FOI LANCADA PRORROGACAO MATERNIDADE E TEM LACUNA ENTRE A MATERNIDADE E LICENCA' THEN
dbms_output.put_line('--5-AVISAR GETED- NAO FOI LANCADA PRORROGACAO MATERNIDADE E TEM LACUNA ENTRE A MATERNIDADE E LICENCA');
INSERT INTO SUGESP_AJUSTE_LOTE_CAMPO_HIST(CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, CAMPO_VALOR_1, CONSIDERACOES, CAMPO_VALOR_2, CAMPO_VALOR_3, CAMPO_VALOR_4, CAMPO_VALOR_5, CAMPO_VALOR_6, CAMPO_VALOR_7, CAMPO_VALOR_8, CAMPO_VALOR_9, CAMPO_VALOR_10, DATA_DADOS)VALUES(C1.CODIGO_EMPRESA,C1.TIPO_CONTRATO,C1.CODIGO,'LOG EXECUCAO PROCEDURE PR_ACERTO_LACUNAS_SIT_FUNC_2022',C1.CENARIO_2022,C1.COD_SIT_FUNCIONAL,C1.SIT_FUNCIONAL,C1.DATA_INICIO,C1.DATA_FIM,C1.PROXIMA_COD_SIT_FUNCIONAL,C1.PROXIMA_SIT_FUNCIONAL,C1.PROXIMA_DATA_INICIO,C1.PROXIMA_DATA_FIM,V_SIT_FUNC_ATIVA_VINCULO, SYSDATE);COMMIT;

ELSIF C1.CENARIO_2022 = '6-GRAVA DATA FIM SIT FUNC COM CONTROLE FOLHA IGUAL A NORMAL (ATIVO)' THEN
dbms_output.put_line('--6-GRAVA DATA FIM SIT FUNC COM CONTROLE FOLHA IGUAL A NORMAL (ATIVO)');
UPDATE RHCGED_ALT_SIT_FUN SET LOGIN_USUARIO = 'script_acerto_alt_sit_func' , DT_ULT_ALTER_USUA = SYSDATE, DATA_FIM_SITUACAO = TO_DATE(C1.PROXIMA_DATA_INICIO,'DD/MM/YYYY')-1 WHERE CODIGO_EMPRESA = C1.CODIGO_EMPRESA AND TIPO_CONTRATO = C1.TIPO_CONTRATO AND CODIGO = C1.CODIGO AND TRUNC(DATA_INIC_SITUACAO) = TO_DATE(C1.DATA_INICIO,'DD/MM/YYYY');COMMIT;
INSERT INTO SUGESP_AJUSTE_LOTE_CAMPO_HIST(CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, CAMPO_VALOR_1, CONSIDERACOES, CAMPO_VALOR_2, CAMPO_VALOR_3, CAMPO_VALOR_4, CAMPO_VALOR_5, CAMPO_VALOR_6, CAMPO_VALOR_7, CAMPO_VALOR_8, CAMPO_VALOR_9, CAMPO_VALOR_10, DATA_DADOS)VALUES(C1.CODIGO_EMPRESA,C1.TIPO_CONTRATO,C1.CODIGO,'LOG EXECUCAO PROCEDURE PR_ACERTO_LACUNAS_SIT_FUNC_2022',C1.CENARIO_2022,C1.COD_SIT_FUNCIONAL,C1.SIT_FUNCIONAL,C1.DATA_INICIO,C1.DATA_FIM,C1.PROXIMA_COD_SIT_FUNCIONAL,C1.PROXIMA_SIT_FUNCIONAL,C1.PROXIMA_DATA_INICIO,C1.PROXIMA_DATA_FIM,V_SIT_FUNC_ATIVA_VINCULO, SYSDATE);COMMIT;

ELSIF C1.CENARIO_2022 = '7-AUMENTA DATA FIM SIT FUNC COM CONTROLE FOLHA IGUAL A NORMAL (ATIVO)' THEN
dbms_output.put_line('--7-AUMENTA DATA FIM SIT FUNC COM CONTROLE FOLHA IGUAL A NORMAL (ATIVO)');
UPDATE RHCGED_ALT_SIT_FUN SET LOGIN_USUARIO = 'script_acerto_alt_sit_func' , DT_ULT_ALTER_USUA = SYSDATE, DATA_FIM_SITUACAO = TO_DATE(C1.PROXIMA_DATA_INICIO,'DD/MM/YYYY')-1 WHERE CODIGO_EMPRESA = C1.CODIGO_EMPRESA AND TIPO_CONTRATO = C1.TIPO_CONTRATO AND CODIGO = C1.CODIGO AND TRUNC(DATA_INIC_SITUACAO) = TO_DATE(C1.DATA_INICIO,'DD/MM/YYYY');COMMIT;
INSERT INTO SUGESP_AJUSTE_LOTE_CAMPO_HIST(CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, CAMPO_VALOR_1, CONSIDERACOES, CAMPO_VALOR_2, CAMPO_VALOR_3, CAMPO_VALOR_4, CAMPO_VALOR_5, CAMPO_VALOR_6, CAMPO_VALOR_7, CAMPO_VALOR_8, CAMPO_VALOR_9, CAMPO_VALOR_10, DATA_DADOS)VALUES(C1.CODIGO_EMPRESA,C1.TIPO_CONTRATO,C1.CODIGO,'LOG EXECUCAO PROCEDURE PR_ACERTO_LACUNAS_SIT_FUNC_2022',C1.CENARIO_2022,C1.COD_SIT_FUNCIONAL,C1.SIT_FUNCIONAL,C1.DATA_INICIO,C1.DATA_FIM,C1.PROXIMA_COD_SIT_FUNCIONAL,C1.PROXIMA_SIT_FUNCIONAL,C1.PROXIMA_DATA_INICIO,C1.PROXIMA_DATA_FIM,V_SIT_FUNC_ATIVA_VINCULO, SYSDATE);COMMIT;

ELSIF C1.CENARIO_2022 = '8-ULTIMO REGISTRO LICENCA JA ACABOU VOLTAR CRIAR SIT FUNC COM CONTROLE FOLHA IGUAL A NORMAL (ATIVO)' THEN
dbms_output.put_line('--8-ULTIMO REGISTRO LICENCA JA ACABOU VOLTAR CRIAR SIT FUNC COM CONTROLE FOLHA IGUAL A NORMAL (ATIVO)');
INSERT INTO RHCGED_ALT_SIT_FUN (IND_EF_RETRO_ESOCIAL, TEXTO_ASSOCIADO, LOGIN_USUARIO, DT_ULT_ALTER_USUA, CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO, DATA_INIC_SITUACAO, COD_SIT_FUNCIONAL) VALUES ('N', 'Registro criado automaticamente pela rotina PR_ACERTO_LACUNAS_SIT_FUNC_2022.', 'script_acerto_alt_sit_func' ,SYSDATE, C1.CODIGO_EMPRESA , C1.TIPO_CONTRATO , C1.CODIGO, TO_DATE(C1.DATA_FIM,'DD/MM/YYYY')+1, V_SIT_FUNC_ATIVA_VINCULO); COMMIT;
INSERT INTO SUGESP_AJUSTE_LOTE_CAMPO_HIST(CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, CAMPO_VALOR_1, CONSIDERACOES, CAMPO_VALOR_2, CAMPO_VALOR_3, CAMPO_VALOR_4, CAMPO_VALOR_5, CAMPO_VALOR_6, CAMPO_VALOR_7, CAMPO_VALOR_8, CAMPO_VALOR_9, CAMPO_VALOR_10, DATA_DADOS)VALUES(C1.CODIGO_EMPRESA,C1.TIPO_CONTRATO,C1.CODIGO,'LOG EXECUCAO PROCEDURE PR_ACERTO_LACUNAS_SIT_FUNC_2022',C1.CENARIO_2022,C1.COD_SIT_FUNCIONAL,C1.SIT_FUNCIONAL,C1.DATA_INICIO,C1.DATA_FIM,C1.PROXIMA_COD_SIT_FUNCIONAL,C1.PROXIMA_SIT_FUNCIONAL,C1.PROXIMA_DATA_INICIO,C1.PROXIMA_DATA_FIM,V_SIT_FUNC_ATIVA_VINCULO, SYSDATE);COMMIT;
SUGESP_ALT_SIT_FUNC_ULT_CONTRA(C1.CODIGO_EMPRESA,C1.TIPO_CONTRATO,C1.CODIGO ,'script_acerto_alt_sit_func');

ELSIF C1.CENARIO_2022 = '9-ULTIMO REGISTRO PRORROGACAO MATERNIDADE ACABOU VOLTAR CRIAR SIT FUNC COM CONTROLE FOLHA IGUAL A NORMAL (ATIVO)' THEN
dbms_output.put_line('--9-ULTIMO REGISTRO PRORROGACAO MATERNIDADE ACABOU VOLTAR CRIAR SIT FUNC COM CONTROLE FOLHA IGUAL A NORMAL (ATIVO)');
INSERT INTO RHCGED_ALT_SIT_FUN (IND_EF_RETRO_ESOCIAL, TEXTO_ASSOCIADO, LOGIN_USUARIO, DT_ULT_ALTER_USUA, CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO, DATA_INIC_SITUACAO, COD_SIT_FUNCIONAL) VALUES ('N', 'Registro criado automaticamente pela rotina PR_ACERTO_LACUNAS_SIT_FUNC_2022.', 'script_acerto_alt_sit_func' ,SYSDATE, C1.CODIGO_EMPRESA , C1.TIPO_CONTRATO, C1.CODIGO, TO_DATE(C1.DATA_FIM,'DD/MM/YYYY')+1, V_SIT_FUNC_ATIVA_VINCULO); COMMIT;
INSERT INTO SUGESP_AJUSTE_LOTE_CAMPO_HIST(CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, CAMPO_VALOR_1, CONSIDERACOES, CAMPO_VALOR_2, CAMPO_VALOR_3, CAMPO_VALOR_4, CAMPO_VALOR_5, CAMPO_VALOR_6, CAMPO_VALOR_7, CAMPO_VALOR_8, CAMPO_VALOR_9, CAMPO_VALOR_10, DATA_DADOS)VALUES(C1.CODIGO_EMPRESA,C1.TIPO_CONTRATO,C1.CODIGO,'LOG EXECUCAO PROCEDURE PR_ACERTO_LACUNAS_SIT_FUNC_2022',C1.CENARIO_2022,C1.COD_SIT_FUNCIONAL,C1.SIT_FUNCIONAL,C1.DATA_INICIO,C1.DATA_FIM,C1.PROXIMA_COD_SIT_FUNCIONAL,C1.PROXIMA_SIT_FUNCIONAL,C1.PROXIMA_DATA_INICIO,C1.PROXIMA_DATA_FIM,V_SIT_FUNC_ATIVA_VINCULO, SYSDATE);COMMIT;
SUGESP_ALT_SIT_FUNC_ULT_CONTRA(C1.CODIGO_EMPRESA, C1.TIPO_CONTRATO, C1.CODIGO,'script_acerto_alt_sit_func');

ELSIF C1.CENARIO_2022 = '10-AVISAR GETED - NAO FOI LANCADA PRORROGACAO MATERNIDADE E NENHUMA SIT FUNC APOS FIM MATERNIDADE' THEN
dbms_output.put_line('--10-AVISAR GETED - NAO FOI LANCADA PRORROGACAO MATERNIDADE E NENHUMA SIT FUNC APOS FIM MATERNIDADE');
INSERT INTO SUGESP_AJUSTE_LOTE_CAMPO_HIST(CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, CAMPO_VALOR_1, CONSIDERACOES, CAMPO_VALOR_2, CAMPO_VALOR_3, CAMPO_VALOR_4, CAMPO_VALOR_5, CAMPO_VALOR_6, CAMPO_VALOR_7, CAMPO_VALOR_8, CAMPO_VALOR_9, CAMPO_VALOR_10, DATA_DADOS)VALUES(C1.CODIGO_EMPRESA,C1.TIPO_CONTRATO,C1.CODIGO,'LOG EXECUCAO PROCEDURE PR_ACERTO_LACUNAS_SIT_FUNC_2022',C1.CENARIO_2022,C1.COD_SIT_FUNCIONAL,C1.SIT_FUNCIONAL,C1.DATA_INICIO,C1.DATA_FIM,C1.PROXIMA_COD_SIT_FUNCIONAL,C1.PROXIMA_SIT_FUNCIONAL,C1.PROXIMA_DATA_INICIO,C1.PROXIMA_DATA_FIM,V_SIT_FUNC_ATIVA_VINCULO, SYSDATE);COMMIT;

ELSIF C1.CENARIO_2022 = '11-AUMENTAR DATA FIM DA SIT FUNC 6008 RECEM EMPOSSADO' THEN
dbms_output.put_line('--11-AUMENTAR DATA FIM DA SIT FUNC 6008 RECEM EMPOSSADO');
UPDATE RHCGED_ALT_SIT_FUN SET LOGIN_USUARIO = 'script_acerto_alt_sit_func' , DT_ULT_ALTER_USUA = SYSDATE, DATA_FIM_SITUACAO = TO_DATE(C1.PROXIMA_DATA_INICIO,'DD/MM/YYYY')-1 WHERE CODIGO_EMPRESA = C1.CODIGO_EMPRESA AND TIPO_CONTRATO = C1.TIPO_CONTRATO AND CODIGO = C1.CODIGO AND TRUNC(DATA_INIC_SITUACAO) = TO_DATE(C1.DATA_INICIO,'DD/MM/YYYY');COMMIT;
INSERT INTO SUGESP_AJUSTE_LOTE_CAMPO_HIST(CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, CAMPO_VALOR_1, CONSIDERACOES, CAMPO_VALOR_2, CAMPO_VALOR_3, CAMPO_VALOR_4, CAMPO_VALOR_5, CAMPO_VALOR_6, CAMPO_VALOR_7, CAMPO_VALOR_8, CAMPO_VALOR_9, CAMPO_VALOR_10, DATA_DADOS)VALUES(C1.CODIGO_EMPRESA,C1.TIPO_CONTRATO,C1.CODIGO,'LOG EXECUCAO PROCEDURE PR_ACERTO_LACUNAS_SIT_FUNC_2022',C1.CENARIO_2022,C1.COD_SIT_FUNCIONAL,C1.SIT_FUNCIONAL,C1.DATA_INICIO,C1.DATA_FIM,C1.PROXIMA_COD_SIT_FUNCIONAL,C1.PROXIMA_SIT_FUNCIONAL,C1.PROXIMA_DATA_INICIO,C1.PROXIMA_DATA_FIM,V_SIT_FUNC_ATIVA_VINCULO, SYSDATE);COMMIT;

ELSIF C1.CENARIO_2022 = '12-AVISAR GEVIF - CONCOMITA LINCENCAS AJUSTE MANUAL' THEN
dbms_output.put_line('--12-AVISAR GEVIF - CONCOMITA LINCENCAS AJUSTE MANUAL');
INSERT INTO SUGESP_AJUSTE_LOTE_CAMPO_HIST(CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, CAMPO_VALOR_1, CONSIDERACOES, CAMPO_VALOR_2, CAMPO_VALOR_3, CAMPO_VALOR_4, CAMPO_VALOR_5, CAMPO_VALOR_6, CAMPO_VALOR_7, CAMPO_VALOR_8, CAMPO_VALOR_9, CAMPO_VALOR_10, DATA_DADOS)VALUES(C1.CODIGO_EMPRESA,C1.TIPO_CONTRATO,C1.CODIGO,'LOG EXECUCAO PROCEDURE PR_ACERTO_LACUNAS_SIT_FUNC_2022',C1.CENARIO_2022,C1.COD_SIT_FUNCIONAL,C1.SIT_FUNCIONAL,C1.DATA_INICIO,C1.DATA_FIM,C1.PROXIMA_COD_SIT_FUNCIONAL,C1.PROXIMA_SIT_FUNCIONAL,C1.PROXIMA_DATA_INICIO,C1.PROXIMA_DATA_FIM,V_SIT_FUNC_ATIVA_VINCULO, SYSDATE);COMMIT;

ELSIF C1.CENARIO_2022 = '13-AVISAR GEVIF - ERRO LOGICA - ALTERAR DT INICIO DA SIT FUNC CONTROLE FOLHA IGUAL A NORMAL (ATIVO)' THEN
dbms_output.put_line('--13-AVISAR GEVIF - ERRO LOGICA - ALTERAR DT INICIO DA SIT FUNC CONTROLE FOLHA IGUAL A NORMAL (ATIVO)');
--dbms_output.put_line('UPDATE RHCGED_ALT_SIT_FUN SET LOGIN_USUARIO = ''script_acerto_alt_sit_func'' , DT_ULT_ALTER_USUA = SYSDATE, DATA_INIC_SITUACAO = TO_DATE('''||C1.DATA_FIM||''',''DD/MM/YYYY'')+1 WHERE CODIGO_EMPRESA = '''||C1.CODIGO_EMPRESA ||''' AND TIPO_CONTRATO = '''||C1.TIPO_CONTRATO ||''' AND CODIGO = '''|| C1.CODIGO ||''' AND TRUNC(DATA_INIC_SITUACAO) = TO_DATE('''||C1.PROXIMA_DATA_INICIO ||''',''DD/MM/YYYY'')' ||';COMMIT;' );
INSERT INTO SUGESP_AJUSTE_LOTE_CAMPO_HIST(CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, CAMPO_VALOR_1, CONSIDERACOES, CAMPO_VALOR_2, CAMPO_VALOR_3, CAMPO_VALOR_4, CAMPO_VALOR_5, CAMPO_VALOR_6, CAMPO_VALOR_7, CAMPO_VALOR_8, CAMPO_VALOR_9, CAMPO_VALOR_10, DATA_DADOS)VALUES(C1.CODIGO_EMPRESA,C1.TIPO_CONTRATO,C1.CODIGO,'LOG EXECUCAO PROCEDURE PR_ACERTO_LACUNAS_SIT_FUNC_2022',C1.CENARIO_2022,C1.COD_SIT_FUNCIONAL,C1.SIT_FUNCIONAL,C1.DATA_INICIO,C1.DATA_FIM,C1.PROXIMA_COD_SIT_FUNCIONAL,C1.PROXIMA_SIT_FUNCIONAL,C1.PROXIMA_DATA_INICIO,C1.PROXIMA_DATA_FIM,V_SIT_FUNC_ATIVA_VINCULO, SYSDATE);COMMIT;

ELSIF C1.CENARIO_2022 = '14-DIMINUI DT FIM DA PRIMEIRA SIT FUNC CONTROLE FOLHA IGUAL A NORMAL (ATIVO)' THEN
dbms_output.put_line('--14-DIMINUI DT FIM DA PRIMEIRA SIT FUNC CONTROLE FOLHA IGUAL A NORMAL (ATIVO)');
UPDATE RHCGED_ALT_SIT_FUN SET LOGIN_USUARIO = 'script_acerto_alt_sit_func' , DT_ULT_ALTER_USUA = SYSDATE, DATA_FIM_SITUACAO = TO_DATE(C1.PROXIMA_DATA_INICIO,'DD/MM/YYYY')-1 WHERE CODIGO_EMPRESA = C1.CODIGO_EMPRESA AND TIPO_CONTRATO = C1.TIPO_CONTRATO AND CODIGO = C1.CODIGO AND TRUNC(DATA_INIC_SITUACAO) = TO_DATE(C1.DATA_INICIO,'DD/MM/YYYY');COMMIT;
INSERT INTO SUGESP_AJUSTE_LOTE_CAMPO_HIST(CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, CAMPO_VALOR_1, CONSIDERACOES, CAMPO_VALOR_2, CAMPO_VALOR_3, CAMPO_VALOR_4, CAMPO_VALOR_5, CAMPO_VALOR_6, CAMPO_VALOR_7, CAMPO_VALOR_8, CAMPO_VALOR_9, CAMPO_VALOR_10, DATA_DADOS)VALUES(C1.CODIGO_EMPRESA,C1.TIPO_CONTRATO,C1.CODIGO,'LOG EXECUCAO PROCEDURE PR_ACERTO_LACUNAS_SIT_FUNC_2022',C1.CENARIO_2022,C1.COD_SIT_FUNCIONAL,C1.SIT_FUNCIONAL,C1.DATA_INICIO,C1.DATA_FIM,C1.PROXIMA_COD_SIT_FUNCIONAL,C1.PROXIMA_SIT_FUNCIONAL,C1.PROXIMA_DATA_INICIO,C1.PROXIMA_DATA_FIM,V_SIT_FUNC_ATIVA_VINCULO, SYSDATE);COMMIT;

ELSIF C1.CENARIO_2022 = '15-AVISAR GETED - LACUNA ENTRE RECESSO E INFREQUENCIA AJUSTAR MANUALMENTE' THEN
dbms_output.put_line('--15-AVISAR GETED - LACUNA ENTRE RECESSO E INFREQUENCIA AJUSTAR MANUALMENTE');
INSERT INTO SUGESP_AJUSTE_LOTE_CAMPO_HIST(CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, CAMPO_VALOR_1, CONSIDERACOES, CAMPO_VALOR_2, CAMPO_VALOR_3, CAMPO_VALOR_4, CAMPO_VALOR_5, CAMPO_VALOR_6, CAMPO_VALOR_7, CAMPO_VALOR_8, CAMPO_VALOR_9, CAMPO_VALOR_10, DATA_DADOS)VALUES(C1.CODIGO_EMPRESA,C1.TIPO_CONTRATO,C1.CODIGO,'LOG EXECUCAO PROCEDURE PR_ACERTO_LACUNAS_SIT_FUNC_2022',C1.CENARIO_2022,C1.COD_SIT_FUNCIONAL,C1.SIT_FUNCIONAL,C1.DATA_INICIO,C1.DATA_FIM,C1.PROXIMA_COD_SIT_FUNCIONAL,C1.PROXIMA_SIT_FUNCIONAL,C1.PROXIMA_DATA_INICIO,C1.PROXIMA_DATA_FIM,V_SIT_FUNC_ATIVA_VINCULO, SYSDATE);COMMIT;

ELSIF C1.CENARIO_2022 = '16-AVISAR GETED - LACUNA ENTRE INFREQUENCIAS AJUSTAR MANUALMENTE' THEN
dbms_output.put_line('--16-AVISAR GETED - LACUNA ENTRE INFREQUENCIAS AJUSTAR MANUALMENTE');
INSERT INTO SUGESP_AJUSTE_LOTE_CAMPO_HIST(CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, CAMPO_VALOR_1, CONSIDERACOES, CAMPO_VALOR_2, CAMPO_VALOR_3, CAMPO_VALOR_4, CAMPO_VALOR_5, CAMPO_VALOR_6, CAMPO_VALOR_7, CAMPO_VALOR_8, CAMPO_VALOR_9, CAMPO_VALOR_10, DATA_DADOS)VALUES(C1.CODIGO_EMPRESA,C1.TIPO_CONTRATO,C1.CODIGO,'LOG EXECUCAO PROCEDURE PR_ACERTO_LACUNAS_SIT_FUNC_2022',C1.CENARIO_2022,C1.COD_SIT_FUNCIONAL,C1.SIT_FUNCIONAL,C1.DATA_INICIO,C1.DATA_FIM,C1.PROXIMA_COD_SIT_FUNCIONAL,C1.PROXIMA_SIT_FUNCIONAL,C1.PROXIMA_DATA_INICIO,C1.PROXIMA_DATA_FIM,V_SIT_FUNC_ATIVA_VINCULO, SYSDATE);COMMIT;

ELSIF C1.CENARIO_2022 = '17-AVISAR GETED - LACUNA ENTRE INFREQUENCIA E LICENCA AJUSTAR MANUALMENTE' THEN
dbms_output.put_line('--17-AVISAR GETED - LACUNA ENTRE INFREQUENCIA E LICENCA AJUSTAR MANUALMENTE');
INSERT INTO SUGESP_AJUSTE_LOTE_CAMPO_HIST(CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, CAMPO_VALOR_1, CONSIDERACOES, CAMPO_VALOR_2, CAMPO_VALOR_3, CAMPO_VALOR_4, CAMPO_VALOR_5, CAMPO_VALOR_6, CAMPO_VALOR_7, CAMPO_VALOR_8, CAMPO_VALOR_9, CAMPO_VALOR_10, DATA_DADOS)VALUES(C1.CODIGO_EMPRESA,C1.TIPO_CONTRATO,C1.CODIGO,'LOG EXECUCAO PROCEDURE PR_ACERTO_LACUNAS_SIT_FUNC_2022',C1.CENARIO_2022,C1.COD_SIT_FUNCIONAL,C1.SIT_FUNCIONAL,C1.DATA_INICIO,C1.DATA_FIM,C1.PROXIMA_COD_SIT_FUNCIONAL,C1.PROXIMA_SIT_FUNCIONAL,C1.PROXIMA_DATA_INICIO,C1.PROXIMA_DATA_FIM,V_SIT_FUNC_ATIVA_VINCULO, SYSDATE);COMMIT;

ELSIF C1.CENARIO_2022 = '18-AVISAR GETED - LACUNA ENTRE INFREQUENCIA E ATIVO AJUSTAR MANUALMENTE' THEN
dbms_output.put_line('--18-AVISAR GETED - LACUNA ENTRE INFREQUENCIA E ATIVO AJUSTAR MANUALMENTE');
INSERT INTO SUGESP_AJUSTE_LOTE_CAMPO_HIST(CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, CAMPO_VALOR_1, CONSIDERACOES, CAMPO_VALOR_2, CAMPO_VALOR_3, CAMPO_VALOR_4, CAMPO_VALOR_5, CAMPO_VALOR_6, CAMPO_VALOR_7, CAMPO_VALOR_8, CAMPO_VALOR_9, CAMPO_VALOR_10, DATA_DADOS)VALUES(C1.CODIGO_EMPRESA,C1.TIPO_CONTRATO,C1.CODIGO,'LOG EXECUCAO PROCEDURE PR_ACERTO_LACUNAS_SIT_FUNC_2022',C1.CENARIO_2022,C1.COD_SIT_FUNCIONAL,C1.SIT_FUNCIONAL,C1.DATA_INICIO,C1.DATA_FIM,C1.PROXIMA_COD_SIT_FUNCIONAL,C1.PROXIMA_SIT_FUNCIONAL,C1.PROXIMA_DATA_INICIO,C1.PROXIMA_DATA_FIM,V_SIT_FUNC_ATIVA_VINCULO, SYSDATE);COMMIT;

ELSIF C1.CENARIO_2022 = '19-AVISAR GETED - LACUNA ENTRE INFREQUENCIAS AJUSTAR MANUALMENTE' THEN
dbms_output.put_line('--19-AVISAR GETED - LACUNA ENTRE INFREQUENCIAS AJUSTAR MANUALMENTE');
INSERT INTO SUGESP_AJUSTE_LOTE_CAMPO_HIST(CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, CAMPO_VALOR_1, CONSIDERACOES, CAMPO_VALOR_2, CAMPO_VALOR_3, CAMPO_VALOR_4, CAMPO_VALOR_5, CAMPO_VALOR_6, CAMPO_VALOR_7, CAMPO_VALOR_8, CAMPO_VALOR_9, CAMPO_VALOR_10, DATA_DADOS)VALUES(C1.CODIGO_EMPRESA,C1.TIPO_CONTRATO,C1.CODIGO,'LOG EXECUCAO PROCEDURE PR_ACERTO_LACUNAS_SIT_FUNC_2022',C1.CENARIO_2022,C1.COD_SIT_FUNCIONAL,C1.SIT_FUNCIONAL,C1.DATA_INICIO,C1.DATA_FIM,C1.PROXIMA_COD_SIT_FUNCIONAL,C1.PROXIMA_SIT_FUNCIONAL,C1.PROXIMA_DATA_INICIO,C1.PROXIMA_DATA_FIM,V_SIT_FUNC_ATIVA_VINCULO, SYSDATE);COMMIT;

ELSIF C1.CENARIO_2022 = '20-AVISAR GETED - LACUNA ENTRE INFREQUENCIA E AFAST INSS AJUSTAR MANUALMENTE' THEN
dbms_output.put_line('--20-AVISAR GETED - LACUNA ENTRE INFREQUENCIA E AFAST INSS AJUSTAR MANUALMENTE');
INSERT INTO SUGESP_AJUSTE_LOTE_CAMPO_HIST(CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, CAMPO_VALOR_1, CONSIDERACOES, CAMPO_VALOR_2, CAMPO_VALOR_3, CAMPO_VALOR_4, CAMPO_VALOR_5, CAMPO_VALOR_6, CAMPO_VALOR_7, CAMPO_VALOR_8, CAMPO_VALOR_9, CAMPO_VALOR_10, DATA_DADOS)VALUES(C1.CODIGO_EMPRESA,C1.TIPO_CONTRATO,C1.CODIGO,'LOG EXECUCAO PROCEDURE PR_ACERTO_LACUNAS_SIT_FUNC_2022',C1.CENARIO_2022,C1.COD_SIT_FUNCIONAL,C1.SIT_FUNCIONAL,C1.DATA_INICIO,C1.DATA_FIM,C1.PROXIMA_COD_SIT_FUNCIONAL,C1.PROXIMA_SIT_FUNCIONAL,C1.PROXIMA_DATA_INICIO,C1.PROXIMA_DATA_FIM,V_SIT_FUNC_ATIVA_VINCULO, SYSDATE);COMMIT;

ELSIF C1.CENARIO_2022 = '21-CRIA PERIODO ENTRE SIT FUNC DE LICENCA E RECESSO COM CONTROLE FOLHA IGUAL A NORMAL (ATIVO)' THEN
dbms_output.put_line('--21-CRIA PERIODO ENTRE SIT FUNC DE LICENCA E RECESSO COM CONTROLE FOLHA IGUAL A NORMAL (ATIVO)');
INSERT INTO RHCGED_ALT_SIT_FUN (IND_EF_RETRO_ESOCIAL, TEXTO_ASSOCIADO, LOGIN_USUARIO, DT_ULT_ALTER_USUA, CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO, DATA_INIC_SITUACAO, COD_SIT_FUNCIONAL, DATA_FIM_SITUACAO ) VALUES ('N', 'Registro criado automaticamente pela rotina PR_ACERTO_LACUNAS_SIT_FUNC_2022.', 'script_acerto_alt_sit_func' ,SYSDATE, C1.CODIGO_EMPRESA , C1.TIPO_CONTRATO, C1.CODIGO, TO_DATE(C1.DATA_FIM,'DD/MM/YYYY')+1, V_SIT_FUNC_ATIVA_VINCULO, TO_DATE(C1.PROXIMA_DATA_INICIO ,'DD/MM/YYYY')-1); COMMIT;
INSERT INTO SUGESP_AJUSTE_LOTE_CAMPO_HIST(CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, CAMPO_VALOR_1, CONSIDERACOES, CAMPO_VALOR_2, CAMPO_VALOR_3, CAMPO_VALOR_4, CAMPO_VALOR_5, CAMPO_VALOR_6, CAMPO_VALOR_7, CAMPO_VALOR_8, CAMPO_VALOR_9, CAMPO_VALOR_10, DATA_DADOS)VALUES(C1.CODIGO_EMPRESA,C1.TIPO_CONTRATO,C1.CODIGO,'LOG EXECUCAO PROCEDURE PR_ACERTO_LACUNAS_SIT_FUNC_2022',C1.CENARIO_2022,C1.COD_SIT_FUNCIONAL,C1.SIT_FUNCIONAL,C1.DATA_INICIO,C1.DATA_FIM,C1.PROXIMA_COD_SIT_FUNCIONAL,C1.PROXIMA_SIT_FUNCIONAL,C1.PROXIMA_DATA_INICIO,C1.PROXIMA_DATA_FIM,V_SIT_FUNC_ATIVA_VINCULO, SYSDATE);COMMIT;

ELSIF C1.CENARIO_2022 = '22-AVISAR GEVIF - LACUNA ENTRE LICENCA E INFREQUENCIA AJUSTAR MANUALMENTE' THEN
dbms_output.put_line('--22-AVISAR GEVIF - LACUNA ENTRE LICENCA E INFREQUENCIA AJUSTAR MANUALMENTE');
INSERT INTO SUGESP_AJUSTE_LOTE_CAMPO_HIST(CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, CAMPO_VALOR_1, CONSIDERACOES, CAMPO_VALOR_2, CAMPO_VALOR_3, CAMPO_VALOR_4, CAMPO_VALOR_5, CAMPO_VALOR_6, CAMPO_VALOR_7, CAMPO_VALOR_8, CAMPO_VALOR_9, CAMPO_VALOR_10, DATA_DADOS)VALUES(C1.CODIGO_EMPRESA,C1.TIPO_CONTRATO,C1.CODIGO,'LOG EXECUCAO PROCEDURE PR_ACERTO_LACUNAS_SIT_FUNC_2022',C1.CENARIO_2022,C1.COD_SIT_FUNCIONAL,C1.SIT_FUNCIONAL,C1.DATA_INICIO,C1.DATA_FIM,C1.PROXIMA_COD_SIT_FUNCIONAL,C1.PROXIMA_SIT_FUNCIONAL,C1.PROXIMA_DATA_INICIO,C1.PROXIMA_DATA_FIM,V_SIT_FUNC_ATIVA_VINCULO, SYSDATE);COMMIT;

ELSIF C1.CENARIO_2022 = '23-AVISAR GEVIF - LACUNA ENTRE LICENCAS DIFERENTES AJUSTAR MANUALMENTE' THEN
dbms_output.put_line('--23-AVISAR GEVIF - LACUNA ENTRE LICENCAS DIFERENTES AJUSTAR MANUALMENTE');
INSERT INTO SUGESP_AJUSTE_LOTE_CAMPO_HIST(CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, CAMPO_VALOR_1, CONSIDERACOES, CAMPO_VALOR_2, CAMPO_VALOR_3, CAMPO_VALOR_4, CAMPO_VALOR_5, CAMPO_VALOR_6, CAMPO_VALOR_7, CAMPO_VALOR_8, CAMPO_VALOR_9, CAMPO_VALOR_10, DATA_DADOS)VALUES(C1.CODIGO_EMPRESA,C1.TIPO_CONTRATO,C1.CODIGO,'LOG EXECUCAO PROCEDURE PR_ACERTO_LACUNAS_SIT_FUNC_2022',C1.CENARIO_2022,C1.COD_SIT_FUNCIONAL,C1.SIT_FUNCIONAL,C1.DATA_INICIO,C1.DATA_FIM,C1.PROXIMA_COD_SIT_FUNCIONAL,C1.PROXIMA_SIT_FUNCIONAL,C1.PROXIMA_DATA_INICIO,C1.PROXIMA_DATA_FIM,V_SIT_FUNC_ATIVA_VINCULO, SYSDATE);COMMIT;

ELSIF C1.CENARIO_2022 = '24-AVISAR GEVIF - LACUNA ENTRE LICENCAS DIFERENTES AJUSTAR MANUALMENTE' THEN
dbms_output.put_line('--24-AVISAR GEVIF - LACUNA ENTRE LICENCAS DIFERENTES AJUSTAR MANUALMENTE');
INSERT INTO SUGESP_AJUSTE_LOTE_CAMPO_HIST(CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, CAMPO_VALOR_1, CONSIDERACOES, CAMPO_VALOR_2, CAMPO_VALOR_3, CAMPO_VALOR_4, CAMPO_VALOR_5, CAMPO_VALOR_6, CAMPO_VALOR_7, CAMPO_VALOR_8, CAMPO_VALOR_9, CAMPO_VALOR_10, DATA_DADOS)VALUES(C1.CODIGO_EMPRESA,C1.TIPO_CONTRATO,C1.CODIGO,'LOG EXECUCAO PROCEDURE PR_ACERTO_LACUNAS_SIT_FUNC_2022',C1.CENARIO_2022,C1.COD_SIT_FUNCIONAL,C1.SIT_FUNCIONAL,C1.DATA_INICIO,C1.DATA_FIM,C1.PROXIMA_COD_SIT_FUNCIONAL,C1.PROXIMA_SIT_FUNCIONAL,C1.PROXIMA_DATA_INICIO,C1.PROXIMA_DATA_FIM,V_SIT_FUNC_ATIVA_VINCULO, SYSDATE);COMMIT;

ELSIF C1.CENARIO_2022 = '25-AVISAR GEVIF - LACUNA ENTRE LICENCA E AFAST INSS/SUSPENSAO AJUSTAR MANUALMENTE' THEN
dbms_output.put_line('--25-AVISAR GEVIF - LACUNA ENTRE LICENCA E AFAST INSS/SUSPENSAO AJUSTAR MANUALMENTE');
INSERT INTO SUGESP_AJUSTE_LOTE_CAMPO_HIST(CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, CAMPO_VALOR_1, CONSIDERACOES, CAMPO_VALOR_2, CAMPO_VALOR_3, CAMPO_VALOR_4, CAMPO_VALOR_5, CAMPO_VALOR_6, CAMPO_VALOR_7, CAMPO_VALOR_8, CAMPO_VALOR_9, CAMPO_VALOR_10, DATA_DADOS)VALUES(C1.CODIGO_EMPRESA,C1.TIPO_CONTRATO,C1.CODIGO,'LOG EXECUCAO PROCEDURE PR_ACERTO_LACUNAS_SIT_FUNC_2022',C1.CENARIO_2022,C1.COD_SIT_FUNCIONAL,C1.SIT_FUNCIONAL,C1.DATA_INICIO,C1.DATA_FIM,C1.PROXIMA_COD_SIT_FUNCIONAL,C1.PROXIMA_SIT_FUNCIONAL,C1.PROXIMA_DATA_INICIO,C1.PROXIMA_DATA_FIM,V_SIT_FUNC_ATIVA_VINCULO, SYSDATE);COMMIT;

ELSIF C1.CENARIO_2022 = '26-AVISAR GEVIF - LACUNA ENTRE PRORROG MATERNIDADE E AFAST INSS AJUSTAR MANUALMENTE' THEN
dbms_output.put_line('--26-AVISAR GEVIF - LACUNA ENTRE PRORROG MATERNIDADE E AFAST INSS AJUSTAR MANUALMENTE');
INSERT INTO SUGESP_AJUSTE_LOTE_CAMPO_HIST(CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, CAMPO_VALOR_1, CONSIDERACOES, CAMPO_VALOR_2, CAMPO_VALOR_3, CAMPO_VALOR_4, CAMPO_VALOR_5, CAMPO_VALOR_6, CAMPO_VALOR_7, CAMPO_VALOR_8, CAMPO_VALOR_9, CAMPO_VALOR_10, DATA_DADOS)VALUES(C1.CODIGO_EMPRESA,C1.TIPO_CONTRATO,C1.CODIGO,'LOG EXECUCAO PROCEDURE PR_ACERTO_LACUNAS_SIT_FUNC_2022',C1.CENARIO_2022,C1.COD_SIT_FUNCIONAL,C1.SIT_FUNCIONAL,C1.DATA_INICIO,C1.DATA_FIM,C1.PROXIMA_COD_SIT_FUNCIONAL,C1.PROXIMA_SIT_FUNCIONAL,C1.PROXIMA_DATA_INICIO,C1.PROXIMA_DATA_FIM,V_SIT_FUNC_ATIVA_VINCULO, SYSDATE);COMMIT;

ELSIF C1.CENARIO_2022 = '27-AVISAR GETED - LACUNA ENTRE LICENCAS ADMINISTRATIVAS AJUSTAR MANUALMENTE' THEN
dbms_output.put_line('--27-AVISAR GETED - LACUNA ENTRE LICENCAS ADMINISTRATIVAS AJUSTAR MANUALMENTE');
INSERT INTO SUGESP_AJUSTE_LOTE_CAMPO_HIST(CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, CAMPO_VALOR_1, CONSIDERACOES, CAMPO_VALOR_2, CAMPO_VALOR_3, CAMPO_VALOR_4, CAMPO_VALOR_5, CAMPO_VALOR_6, CAMPO_VALOR_7, CAMPO_VALOR_8, CAMPO_VALOR_9, CAMPO_VALOR_10, DATA_DADOS)VALUES(C1.CODIGO_EMPRESA,C1.TIPO_CONTRATO,C1.CODIGO,'LOG EXECUCAO PROCEDURE PR_ACERTO_LACUNAS_SIT_FUNC_2022',C1.CENARIO_2022,C1.COD_SIT_FUNCIONAL,C1.SIT_FUNCIONAL,C1.DATA_INICIO,C1.DATA_FIM,C1.PROXIMA_COD_SIT_FUNCIONAL,C1.PROXIMA_SIT_FUNCIONAL,C1.PROXIMA_DATA_INICIO,C1.PROXIMA_DATA_FIM,V_SIT_FUNC_ATIVA_VINCULO, SYSDATE);COMMIT;

ELSIF C1.CENARIO_2022 = '28-ALTERAR DT INICIO DA SIT FUNC CONTROLE FOLHA IGUAL A NORMAL (ATIVO)' THEN
dbms_output.put_line('--28-ALTERAR DT INICIO DA SIT FUNC CONTROLE FOLHA IGUAL A NORMAL (ATIVO)');
UPDATE RHCGED_ALT_SIT_FUN SET LOGIN_USUARIO = 'script_acerto_alt_sit_func' , DT_ULT_ALTER_USUA = SYSDATE, DATA_INIC_SITUACAO = TO_DATE(C1.DATA_FIM,'DD/MM/YYYY')+1 WHERE CODIGO_EMPRESA = C1.CODIGO_EMPRESA AND TIPO_CONTRATO = C1.TIPO_CONTRATO AND CODIGO = C1.CODIGO AND TRUNC(DATA_INIC_SITUACAO) = TO_DATE(C1.PROXIMA_DATA_INICIO,'DD/MM/YYYY');COMMIT;
INSERT INTO SUGESP_AJUSTE_LOTE_CAMPO_HIST(CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, CAMPO_VALOR_1, CONSIDERACOES, CAMPO_VALOR_2, CAMPO_VALOR_3, CAMPO_VALOR_4, CAMPO_VALOR_5, CAMPO_VALOR_6, CAMPO_VALOR_7, CAMPO_VALOR_8, CAMPO_VALOR_9, CAMPO_VALOR_10, DATA_DADOS)VALUES(C1.CODIGO_EMPRESA,C1.TIPO_CONTRATO,C1.CODIGO,'LOG EXECUCAO PROCEDURE PR_ACERTO_LACUNAS_SIT_FUNC_2022',C1.CENARIO_2022,C1.COD_SIT_FUNCIONAL,C1.SIT_FUNCIONAL,C1.DATA_INICIO,C1.DATA_FIM,C1.PROXIMA_COD_SIT_FUNCIONAL,C1.PROXIMA_SIT_FUNCIONAL,C1.PROXIMA_DATA_INICIO,C1.PROXIMA_DATA_FIM,V_SIT_FUNC_ATIVA_VINCULO, SYSDATE);COMMIT;

ELSIF C1.CENARIO_2022 = '29-ALTERAR DT INICIO DA SIT FUNC CONTROLE FOLHA IGUAL A NORMAL (ATIVO)' THEN
dbms_output.put_line('--29-ALTERAR DT INICIO DA SIT FUNC CONTROLE FOLHA IGUAL A NORMAL (ATIVO)');
UPDATE RHCGED_ALT_SIT_FUN SET LOGIN_USUARIO = 'script_acerto_alt_sit_func' , DT_ULT_ALTER_USUA = SYSDATE, DATA_INIC_SITUACAO = TO_DATE(C1.DATA_FIM,'DD/MM/YYYY')+1 WHERE CODIGO_EMPRESA = C1.CODIGO_EMPRESA AND TIPO_CONTRATO = C1.TIPO_CONTRATO AND CODIGO = C1.CODIGO AND TRUNC(DATA_INIC_SITUACAO) = TO_DATE(C1.PROXIMA_DATA_INICIO,'DD/MM/YYYY');COMMIT;
INSERT INTO SUGESP_AJUSTE_LOTE_CAMPO_HIST(CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, CAMPO_VALOR_1, CONSIDERACOES, CAMPO_VALOR_2, CAMPO_VALOR_3, CAMPO_VALOR_4, CAMPO_VALOR_5, CAMPO_VALOR_6, CAMPO_VALOR_7, CAMPO_VALOR_8, CAMPO_VALOR_9, CAMPO_VALOR_10, DATA_DADOS)VALUES(C1.CODIGO_EMPRESA,C1.TIPO_CONTRATO,C1.CODIGO,'LOG EXECUCAO PROCEDURE PR_ACERTO_LACUNAS_SIT_FUNC_2022',C1.CENARIO_2022,C1.COD_SIT_FUNCIONAL,C1.SIT_FUNCIONAL,C1.DATA_INICIO,C1.DATA_FIM,C1.PROXIMA_COD_SIT_FUNCIONAL,C1.PROXIMA_SIT_FUNCIONAL,C1.PROXIMA_DATA_INICIO,C1.PROXIMA_DATA_FIM,V_SIT_FUNC_ATIVA_VINCULO, SYSDATE);COMMIT;

ELSIF C1.CENARIO_2022 = '30-CRIA PERIODO ENTRE SIT FUNC DE PRORROG MATERNIDADE E RECESSO COM CONTROLE FOLHA IGUAL A NORMAL (ATIVO)' THEN
dbms_output.put_line('--30-CRIA PERIODO ENTRE SIT FUNC DE PRORROG MATERNIDADE E RECESSO COM CONTROLE FOLHA IGUAL A NORMAL (ATIVO)');
INSERT INTO RHCGED_ALT_SIT_FUN (IND_EF_RETRO_ESOCIAL, TEXTO_ASSOCIADO, LOGIN_USUARIO, DT_ULT_ALTER_USUA, CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO, DATA_INIC_SITUACAO, COD_SIT_FUNCIONAL, DATA_FIM_SITUACAO ) VALUES ('N', 'Registro criado automaticamente pela rotina PR_ACERTO_LACUNAS_SIT_FUNC_2022.', 'script_acerto_alt_sit_func' ,SYSDATE, C1.CODIGO_EMPRESA, C1.TIPO_CONTRATO, C1.CODIGO, TO_DATE(C1.DATA_FIM,'DD/MM/YYYY')+1, V_SIT_FUNC_ATIVA_VINCULO, TO_DATE(C1.PROXIMA_DATA_INICIO,'DD/MM/YYYY')-1); COMMIT;
INSERT INTO SUGESP_AJUSTE_LOTE_CAMPO_HIST(CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, CAMPO_VALOR_1, CONSIDERACOES, CAMPO_VALOR_2, CAMPO_VALOR_3, CAMPO_VALOR_4, CAMPO_VALOR_5, CAMPO_VALOR_6, CAMPO_VALOR_7, CAMPO_VALOR_8, CAMPO_VALOR_9, CAMPO_VALOR_10, DATA_DADOS)VALUES(C1.CODIGO_EMPRESA,C1.TIPO_CONTRATO,C1.CODIGO,'LOG EXECUCAO PROCEDURE PR_ACERTO_LACUNAS_SIT_FUNC_2022',C1.CENARIO_2022,C1.COD_SIT_FUNCIONAL,C1.SIT_FUNCIONAL,C1.DATA_INICIO,C1.DATA_FIM,C1.PROXIMA_COD_SIT_FUNCIONAL,C1.PROXIMA_SIT_FUNCIONAL,C1.PROXIMA_DATA_INICIO,C1.PROXIMA_DATA_FIM,V_SIT_FUNC_ATIVA_VINCULO, SYSDATE);COMMIT;

ELSIF C1.CENARIO_2022 = '31-CRIA PERIODO ENTRE SIT FUNC DE PRORROG MATERNIDADE E CESSAO COM CONTROLE FOLHA IGUAL A NORMAL (ATIVO)' THEN
dbms_output.put_line('--31-CRIA PERIODO ENTRE SIT FUNC DE PRORROG MATERNIDADE E CESSAO COM CONTROLE FOLHA IGUAL A NORMAL (ATIVO)');
INSERT INTO RHCGED_ALT_SIT_FUN (IND_EF_RETRO_ESOCIAL, TEXTO_ASSOCIADO, LOGIN_USUARIO, DT_ULT_ALTER_USUA, CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO, DATA_INIC_SITUACAO, COD_SIT_FUNCIONAL, DATA_FIM_SITUACAO ) VALUES ('N', 'Registro criado automaticamente pela rotina PR_ACERTO_LACUNAS_SIT_FUNC_2022.', 'script_acerto_alt_sit_func' ,SYSDATE, C1.CODIGO_EMPRESA , C1.TIPO_CONTRATO ,C1.CODIGO, TO_DATE(C1.DATA_FIM,'DD/MM/YYYY')+1, V_SIT_FUNC_ATIVA_VINCULO, TO_DATE(C1.PROXIMA_DATA_INICIO,'DD/MM/YYYY')-1); COMMIT;
INSERT INTO SUGESP_AJUSTE_LOTE_CAMPO_HIST(CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, CAMPO_VALOR_1, CONSIDERACOES, CAMPO_VALOR_2, CAMPO_VALOR_3, CAMPO_VALOR_4, CAMPO_VALOR_5, CAMPO_VALOR_6, CAMPO_VALOR_7, CAMPO_VALOR_8, CAMPO_VALOR_9, CAMPO_VALOR_10, DATA_DADOS)VALUES(C1.CODIGO_EMPRESA,C1.TIPO_CONTRATO,C1.CODIGO,'LOG EXECUCAO PROCEDURE PR_ACERTO_LACUNAS_SIT_FUNC_2022',C1.CENARIO_2022,C1.COD_SIT_FUNCIONAL,C1.SIT_FUNCIONAL,C1.DATA_INICIO,C1.DATA_FIM,C1.PROXIMA_COD_SIT_FUNCIONAL,C1.PROXIMA_SIT_FUNCIONAL,C1.PROXIMA_DATA_INICIO,C1.PROXIMA_DATA_FIM,V_SIT_FUNC_ATIVA_VINCULO, SYSDATE);COMMIT;

ELSIF C1.CENARIO_2022 = '32-AUMENTAR DT FIM DA SIT FUNC CONTROLE FOLHA IGUAL A NORMAL (ATIVO)' THEN
dbms_output.put_line('--32-AUMENTAR DT FIM DA SIT FUNC CONTROLE FOLHA IGUAL A NORMAL (ATIVO)');
UPDATE RHCGED_ALT_SIT_FUN SET LOGIN_USUARIO = 'script_acerto_alt_sit_func' , DT_ULT_ALTER_USUA = SYSDATE, DATA_FIM_SITUACAO = TO_DATE(C1.PROXIMA_DATA_INICIO,'DD/MM/YYYY')-1 WHERE CODIGO_EMPRESA = C1.CODIGO_EMPRESA AND TIPO_CONTRATO = C1.TIPO_CONTRATO AND CODIGO =  C1.CODIGO AND TRUNC(DATA_INIC_SITUACAO) = TO_DATE(C1.DATA_INICIO,'DD/MM/YYYY');COMMIT;
INSERT INTO SUGESP_AJUSTE_LOTE_CAMPO_HIST(CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, CAMPO_VALOR_1, CONSIDERACOES, CAMPO_VALOR_2, CAMPO_VALOR_3, CAMPO_VALOR_4, CAMPO_VALOR_5, CAMPO_VALOR_6, CAMPO_VALOR_7, CAMPO_VALOR_8, CAMPO_VALOR_9, CAMPO_VALOR_10, DATA_DADOS)VALUES(C1.CODIGO_EMPRESA,C1.TIPO_CONTRATO,C1.CODIGO,'LOG EXECUCAO PROCEDURE PR_ACERTO_LACUNAS_SIT_FUNC_2022',C1.CENARIO_2022,C1.COD_SIT_FUNCIONAL,C1.SIT_FUNCIONAL,C1.DATA_INICIO,C1.DATA_FIM,C1.PROXIMA_COD_SIT_FUNCIONAL,C1.PROXIMA_SIT_FUNCIONAL,C1.PROXIMA_DATA_INICIO,C1.PROXIMA_DATA_FIM,V_SIT_FUNC_ATIVA_VINCULO, SYSDATE);COMMIT;

ELSIF C1.CENARIO_2022 = '33-AUMENTAR DT FIM DA SIT FUNC CONTROLE FOLHA IGUAL A NORMAL (ATIVO)' THEN
dbms_output.put_line('--33-AUMENTAR DT FIM DA SIT FUNC CONTROLE FOLHA IGUAL A NORMAL (ATIVO)');
UPDATE RHCGED_ALT_SIT_FUN SET LOGIN_USUARIO = 'script_acerto_alt_sit_func' , DT_ULT_ALTER_USUA = SYSDATE, DATA_FIM_SITUACAO = TO_DATE(C1.PROXIMA_DATA_INICIO,'DD/MM/YYYY')-1 WHERE CODIGO_EMPRESA = C1.CODIGO_EMPRESA AND TIPO_CONTRATO =C1.TIPO_CONTRATO  AND CODIGO = C1.CODIGO AND TRUNC(DATA_INIC_SITUACAO) = TO_DATE(C1.DATA_INICIO,'DD/MM/YYYY');COMMIT;
INSERT INTO SUGESP_AJUSTE_LOTE_CAMPO_HIST(CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, CAMPO_VALOR_1, CONSIDERACOES, CAMPO_VALOR_2, CAMPO_VALOR_3, CAMPO_VALOR_4, CAMPO_VALOR_5, CAMPO_VALOR_6, CAMPO_VALOR_7, CAMPO_VALOR_8, CAMPO_VALOR_9, CAMPO_VALOR_10, DATA_DADOS)VALUES(C1.CODIGO_EMPRESA,C1.TIPO_CONTRATO,C1.CODIGO,'LOG EXECUCAO PROCEDURE PR_ACERTO_LACUNAS_SIT_FUNC_2022',C1.CENARIO_2022,C1.COD_SIT_FUNCIONAL,C1.SIT_FUNCIONAL,C1.DATA_INICIO,C1.DATA_FIM,C1.PROXIMA_COD_SIT_FUNCIONAL,C1.PROXIMA_SIT_FUNCIONAL,C1.PROXIMA_DATA_INICIO,C1.PROXIMA_DATA_FIM,V_SIT_FUNC_ATIVA_VINCULO, SYSDATE);COMMIT;

ELSIF C1.CENARIO_2022 = '34-CRIA PERIODO ENTRE SIT FUNC L.M.INDEFERIDA E RECESSO COM CONTROLE FOLHA IGUAL A NORMAL (ATIVO)' THEN
dbms_output.put_line('--34-CRIA PERIODO ENTRE SIT FUNC L.M.INDEFERIDA E RECESSO COM CONTROLE FOLHA IGUAL A NORMAL (ATIVO)');
INSERT INTO RHCGED_ALT_SIT_FUN (IND_EF_RETRO_ESOCIAL, TEXTO_ASSOCIADO, LOGIN_USUARIO, DT_ULT_ALTER_USUA, CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO, DATA_INIC_SITUACAO, COD_SIT_FUNCIONAL, DATA_FIM_SITUACAO ) VALUES ('N', 'Registro criado automaticamente pela rotina PR_ACERTO_LACUNAS_SIT_FUNC_2022.', 'script_acerto_alt_sit_func' ,SYSDATE, C1.CODIGO_EMPRESA ,C1.TIPO_CONTRATO, C1.CODIGO, TO_DATE(C1.DATA_FIM,'DD/MM/YYYY')+1, V_SIT_FUNC_ATIVA_VINCULO, TO_DATE(C1.PROXIMA_DATA_INICIO,'DD/MM/YYYY')-1); COMMIT;
INSERT INTO SUGESP_AJUSTE_LOTE_CAMPO_HIST(CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, CAMPO_VALOR_1, CONSIDERACOES, CAMPO_VALOR_2, CAMPO_VALOR_3, CAMPO_VALOR_4, CAMPO_VALOR_5, CAMPO_VALOR_6, CAMPO_VALOR_7, CAMPO_VALOR_8, CAMPO_VALOR_9, CAMPO_VALOR_10, DATA_DADOS)VALUES(C1.CODIGO_EMPRESA,C1.TIPO_CONTRATO,C1.CODIGO,'LOG EXECUCAO PROCEDURE PR_ACERTO_LACUNAS_SIT_FUNC_2022',C1.CENARIO_2022,C1.COD_SIT_FUNCIONAL,C1.SIT_FUNCIONAL,C1.DATA_INICIO,C1.DATA_FIM,C1.PROXIMA_COD_SIT_FUNCIONAL,C1.PROXIMA_SIT_FUNCIONAL,C1.PROXIMA_DATA_INICIO,C1.PROXIMA_DATA_FIM,V_SIT_FUNC_ATIVA_VINCULO, SYSDATE);COMMIT;

ELSIF C1.CENARIO_2022 = '35-AVISAR GETED - LACUNA ENTRE INFREQUENCIAS AJUSTAR MANUALMENTE' THEN
dbms_output.put_line('--35-AVISAR GETED - LACUNA ENTRE INFREQUENCIAS AJUSTAR MANUALMENTE');
INSERT INTO SUGESP_AJUSTE_LOTE_CAMPO_HIST(CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, CAMPO_VALOR_1, CONSIDERACOES, CAMPO_VALOR_2, CAMPO_VALOR_3, CAMPO_VALOR_4, CAMPO_VALOR_5, CAMPO_VALOR_6, CAMPO_VALOR_7, CAMPO_VALOR_8, CAMPO_VALOR_9, CAMPO_VALOR_10, DATA_DADOS)VALUES(C1.CODIGO_EMPRESA,C1.TIPO_CONTRATO,C1.CODIGO,'LOG EXECUCAO PROCEDURE PR_ACERTO_LACUNAS_SIT_FUNC_2022',C1.CENARIO_2022,C1.COD_SIT_FUNCIONAL,C1.SIT_FUNCIONAL,C1.DATA_INICIO,C1.DATA_FIM,C1.PROXIMA_COD_SIT_FUNCIONAL,C1.PROXIMA_SIT_FUNCIONAL,C1.PROXIMA_DATA_INICIO,C1.PROXIMA_DATA_FIM,V_SIT_FUNC_ATIVA_VINCULO, SYSDATE);COMMIT;

ELSIF C1.CENARIO_2022 = '36-CRIA PERIODO ENTRE SIT FUNC LICENCAS COM CONTROLE FOLHA IGUAL A NORMAL (ATIVO)' THEN
dbms_output.put_line('--36-CRIA PERIODO ENTRE SIT FUNC LICENCAS COM CONTROLE FOLHA IGUAL A NORMAL (ATIVO)');
INSERT INTO RHCGED_ALT_SIT_FUN (IND_EF_RETRO_ESOCIAL, TEXTO_ASSOCIADO, LOGIN_USUARIO, DT_ULT_ALTER_USUA, CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO, DATA_INIC_SITUACAO, COD_SIT_FUNCIONAL, DATA_FIM_SITUACAO ) VALUES ('N', 'Registro criado automaticamente pela rotina PR_ACERTO_LACUNAS_SIT_FUNC_2022.', 'script_acerto_alt_sit_func' ,SYSDATE,C1.CODIGO_EMPRESA , C1.TIPO_CONTRATO , C1.CODIGO, TO_DATE(C1.DATA_FIM,'DD/MM/YYYY')+1, V_SIT_FUNC_ATIVA_VINCULO, TO_DATE(C1.PROXIMA_DATA_INICIO,'DD/MM/YYYY')-1); COMMIT;
INSERT INTO SUGESP_AJUSTE_LOTE_CAMPO_HIST(CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, CAMPO_VALOR_1, CONSIDERACOES, CAMPO_VALOR_2, CAMPO_VALOR_3, CAMPO_VALOR_4, CAMPO_VALOR_5, CAMPO_VALOR_6, CAMPO_VALOR_7, CAMPO_VALOR_8, CAMPO_VALOR_9, CAMPO_VALOR_10, DATA_DADOS)VALUES(C1.CODIGO_EMPRESA,C1.TIPO_CONTRATO,C1.CODIGO,'LOG EXECUCAO PROCEDURE PR_ACERTO_LACUNAS_SIT_FUNC_2022',C1.CENARIO_2022,C1.COD_SIT_FUNCIONAL,C1.SIT_FUNCIONAL,C1.DATA_INICIO,C1.DATA_FIM,C1.PROXIMA_COD_SIT_FUNCIONAL,C1.PROXIMA_SIT_FUNCIONAL,C1.PROXIMA_DATA_INICIO,C1.PROXIMA_DATA_FIM,V_SIT_FUNC_ATIVA_VINCULO, SYSDATE);COMMIT;

ELSIF C1.CENARIO_2022 = '37-CRIA PERIODO ENTRE SIT LM INDEF E MATERNIDADE COM CONTROLE FOLHA IGUAL A NORMAL (ATIVO)' THEN
dbms_output.put_line('--37-CRIA PERIODO ENTRE SIT LM INDEF E MATERNIDADE COM CONTROLE FOLHA IGUAL A NORMAL (ATIVO)');
INSERT INTO RHCGED_ALT_SIT_FUN (IND_EF_RETRO_ESOCIAL, TEXTO_ASSOCIADO, LOGIN_USUARIO, DT_ULT_ALTER_USUA, CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO, DATA_INIC_SITUACAO, COD_SIT_FUNCIONAL, DATA_FIM_SITUACAO ) VALUES ('N', 'Registro criado automaticamente pela rotina PR_ACERTO_LACUNAS_SIT_FUNC_2022.', 'script_acerto_alt_sit_func' ,SYSDATE, C1.CODIGO_EMPRESA ,C1.TIPO_CONTRATO ,C1.CODIGO, TO_DATE(C1.DATA_FIM ,'DD/MM/YYYY')+1, V_SIT_FUNC_ATIVA_VINCULO, TO_DATE(C1.PROXIMA_DATA_INICIO,'DD/MM/YYYY')-1); COMMIT;
INSERT INTO SUGESP_AJUSTE_LOTE_CAMPO_HIST(CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, CAMPO_VALOR_1, CONSIDERACOES, CAMPO_VALOR_2, CAMPO_VALOR_3, CAMPO_VALOR_4, CAMPO_VALOR_5, CAMPO_VALOR_6, CAMPO_VALOR_7, CAMPO_VALOR_8, CAMPO_VALOR_9, CAMPO_VALOR_10, DATA_DADOS)VALUES(C1.CODIGO_EMPRESA,C1.TIPO_CONTRATO,C1.CODIGO,'LOG EXECUCAO PROCEDURE PR_ACERTO_LACUNAS_SIT_FUNC_2022',C1.CENARIO_2022,C1.COD_SIT_FUNCIONAL,C1.SIT_FUNCIONAL,C1.DATA_INICIO,C1.DATA_FIM,C1.PROXIMA_COD_SIT_FUNCIONAL,C1.PROXIMA_SIT_FUNCIONAL,C1.PROXIMA_DATA_INICIO,C1.PROXIMA_DATA_FIM,V_SIT_FUNC_ATIVA_VINCULO, SYSDATE);COMMIT;

ELSIF C1.CENARIO_2022 = '38-CRIA PERIODO ENTRE SIT LICENCA E MATERNIDADE COM CONTROLE FOLHA IGUAL A NORMAL (ATIVO)' THEN
dbms_output.put_line('--38-CRIA PERIODO ENTRE SIT LICENCA E MATERNIDADE COM CONTROLE FOLHA IGUAL A NORMAL (ATIVO)');
INSERT INTO RHCGED_ALT_SIT_FUN (IND_EF_RETRO_ESOCIAL, TEXTO_ASSOCIADO, LOGIN_USUARIO, DT_ULT_ALTER_USUA, CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO, DATA_INIC_SITUACAO, COD_SIT_FUNCIONAL, DATA_FIM_SITUACAO ) VALUES ('N', 'Registro criado automaticamente pela rotina PR_ACERTO_LACUNAS_SIT_FUNC_2022.', 'script_acerto_alt_sit_func' ,SYSDATE, C1.CODIGO_EMPRESA ,C1.TIPO_CONTRATO ,C1.CODIGO, TO_DATE(C1.DATA_FIM,'DD/MM/YYYY')+1, V_SIT_FUNC_ATIVA_VINCULO, TO_DATE(C1.PROXIMA_DATA_INICIO,'DD/MM/YYYY')-1); COMMIT;
INSERT INTO SUGESP_AJUSTE_LOTE_CAMPO_HIST(CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, CAMPO_VALOR_1, CONSIDERACOES, CAMPO_VALOR_2, CAMPO_VALOR_3, CAMPO_VALOR_4, CAMPO_VALOR_5, CAMPO_VALOR_6, CAMPO_VALOR_7, CAMPO_VALOR_8, CAMPO_VALOR_9, CAMPO_VALOR_10, DATA_DADOS)VALUES(C1.CODIGO_EMPRESA,C1.TIPO_CONTRATO,C1.CODIGO,'LOG EXECUCAO PROCEDURE PR_ACERTO_LACUNAS_SIT_FUNC_2022',C1.CENARIO_2022,C1.COD_SIT_FUNCIONAL,C1.SIT_FUNCIONAL,C1.DATA_INICIO,C1.DATA_FIM,C1.PROXIMA_COD_SIT_FUNCIONAL,C1.PROXIMA_SIT_FUNCIONAL,C1.PROXIMA_DATA_INICIO,C1.PROXIMA_DATA_FIM,V_SIT_FUNC_ATIVA_VINCULO, SYSDATE);COMMIT;

ELSIF C1.CENARIO_2022 = '39-AVISAR GEVIF - LACUNA ENTRE INFREQUENCIA E ATIVO AJUSTAR MANUALMENTE' THEN
dbms_output.put_line('--39-AVISAR GEVIF - LACUNA ENTRE INFREQUENCIA E ATIVO AJUSTAR MANUALMENTE');
INSERT INTO SUGESP_AJUSTE_LOTE_CAMPO_HIST(CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, CAMPO_VALOR_1, CONSIDERACOES, CAMPO_VALOR_2, CAMPO_VALOR_3, CAMPO_VALOR_4, CAMPO_VALOR_5, CAMPO_VALOR_6, CAMPO_VALOR_7, CAMPO_VALOR_8, CAMPO_VALOR_9, CAMPO_VALOR_10, DATA_DADOS)VALUES(C1.CODIGO_EMPRESA,C1.TIPO_CONTRATO,C1.CODIGO,'LOG EXECUCAO PROCEDURE PR_ACERTO_LACUNAS_SIT_FUNC_2022',C1.CENARIO_2022,C1.COD_SIT_FUNCIONAL,C1.SIT_FUNCIONAL,C1.DATA_INICIO,C1.DATA_FIM,C1.PROXIMA_COD_SIT_FUNCIONAL,C1.PROXIMA_SIT_FUNCIONAL,C1.PROXIMA_DATA_INICIO,C1.PROXIMA_DATA_FIM,V_SIT_FUNC_ATIVA_VINCULO, SYSDATE);COMMIT;

ELSIF C1.CENARIO_2022 = '40-AVISAR GEVIF - LACUNA ENTRE INFREQUENCIA/LM INDEF E ATIVO AJUSTAR MANUALMENTE' THEN
dbms_output.put_line('--40-AVISAR GEVIF - LACUNA ENTRE INFREQUENCIA/LM INDEF E ATIVO AJUSTAR MANUALMENTE');
INSERT INTO SUGESP_AJUSTE_LOTE_CAMPO_HIST(CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, CAMPO_VALOR_1, CONSIDERACOES, CAMPO_VALOR_2, CAMPO_VALOR_3, CAMPO_VALOR_4, CAMPO_VALOR_5, CAMPO_VALOR_6, CAMPO_VALOR_7, CAMPO_VALOR_8, CAMPO_VALOR_9, CAMPO_VALOR_10, DATA_DADOS)VALUES(C1.CODIGO_EMPRESA,C1.TIPO_CONTRATO,C1.CODIGO,'LOG EXECUCAO PROCEDURE PR_ACERTO_LACUNAS_SIT_FUNC_2022',C1.CENARIO_2022,C1.COD_SIT_FUNCIONAL,C1.SIT_FUNCIONAL,C1.DATA_INICIO,C1.DATA_FIM,C1.PROXIMA_COD_SIT_FUNCIONAL,C1.PROXIMA_SIT_FUNCIONAL,C1.PROXIMA_DATA_INICIO,C1.PROXIMA_DATA_FIM,V_SIT_FUNC_ATIVA_VINCULO, SYSDATE);COMMIT;

ELSIF C1.CENARIO_2022 = '41-AVISAR GETED - LACUNA ENTRE INFREQUENCIAS AJUSTAR MANUALMENTE' THEN
dbms_output.put_line('--41-AVISAR GETED - LACUNA ENTRE INFREQUENCIAS AJUSTAR MANUALMENTE');
INSERT INTO SUGESP_AJUSTE_LOTE_CAMPO_HIST(CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, CAMPO_VALOR_1, CONSIDERACOES, CAMPO_VALOR_2, CAMPO_VALOR_3, CAMPO_VALOR_4, CAMPO_VALOR_5, CAMPO_VALOR_6, CAMPO_VALOR_7, CAMPO_VALOR_8, CAMPO_VALOR_9, CAMPO_VALOR_10, DATA_DADOS)VALUES(C1.CODIGO_EMPRESA,C1.TIPO_CONTRATO,C1.CODIGO,'LOG EXECUCAO PROCEDURE PR_ACERTO_LACUNAS_SIT_FUNC_2022',C1.CENARIO_2022,C1.COD_SIT_FUNCIONAL,C1.SIT_FUNCIONAL,C1.DATA_INICIO,C1.DATA_FIM,C1.PROXIMA_COD_SIT_FUNCIONAL,C1.PROXIMA_SIT_FUNCIONAL,C1.PROXIMA_DATA_INICIO,C1.PROXIMA_DATA_FIM,V_SIT_FUNC_ATIVA_VINCULO, SYSDATE);COMMIT;

ELSIF C1.CENARIO_2022 = '42-AVISAR GEVIF - LACUNA ENTRE INFREQUENCIAS/LM INDEF AJUSTAR MANUALMENTE' THEN
dbms_output.put_line('--42-AVISAR GEVIF - LACUNA ENTRE INFREQUENCIAS/LM INDEF AJUSTAR MANUALMENTE');
INSERT INTO SUGESP_AJUSTE_LOTE_CAMPO_HIST(CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, CAMPO_VALOR_1, CONSIDERACOES, CAMPO_VALOR_2, CAMPO_VALOR_3, CAMPO_VALOR_4, CAMPO_VALOR_5, CAMPO_VALOR_6, CAMPO_VALOR_7, CAMPO_VALOR_8, CAMPO_VALOR_9, CAMPO_VALOR_10, DATA_DADOS)VALUES(C1.CODIGO_EMPRESA,C1.TIPO_CONTRATO,C1.CODIGO,'LOG EXECUCAO PROCEDURE PR_ACERTO_LACUNAS_SIT_FUNC_2022',C1.CENARIO_2022,C1.COD_SIT_FUNCIONAL,C1.SIT_FUNCIONAL,C1.DATA_INICIO,C1.DATA_FIM,C1.PROXIMA_COD_SIT_FUNCIONAL,C1.PROXIMA_SIT_FUNCIONAL,C1.PROXIMA_DATA_INICIO,C1.PROXIMA_DATA_FIM,V_SIT_FUNC_ATIVA_VINCULO, SYSDATE);COMMIT;

ELSIF C1.CENARIO_2022 = '43-CRIA PERIODO ENTRE SIT LICENCAS COM CONTROLE FOLHA IGUAL A NORMAL (ATIVO)' THEN
dbms_output.put_line('--43-CRIA PERIODO ENTRE SIT LICENCAS COM CONTROLE FOLHA IGUAL A NORMAL (ATIVO)');
INSERT INTO RHCGED_ALT_SIT_FUN (IND_EF_RETRO_ESOCIAL, TEXTO_ASSOCIADO, LOGIN_USUARIO, DT_ULT_ALTER_USUA, CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO, DATA_INIC_SITUACAO, COD_SIT_FUNCIONAL, DATA_FIM_SITUACAO ) VALUES ('N','Registro criado automaticamente pela rotina PR_ACERTO_LACUNAS_SIT_FUNC_2022.', 'script_acerto_alt_sit_func' ,SYSDATE, C1.CODIGO_EMPRESA ,C1.TIPO_CONTRATO ,C1.CODIGO, TO_DATE(C1.DATA_FIM,'DD/MM/YYYY')+1,V_SIT_FUNC_ATIVA_VINCULO, TO_DATE(C1.PROXIMA_DATA_INICIO,'DD/MM/YYYY')-1); COMMIT;
INSERT INTO SUGESP_AJUSTE_LOTE_CAMPO_HIST(CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, CAMPO_VALOR_1, CONSIDERACOES, CAMPO_VALOR_2, CAMPO_VALOR_3, CAMPO_VALOR_4, CAMPO_VALOR_5, CAMPO_VALOR_6, CAMPO_VALOR_7, CAMPO_VALOR_8, CAMPO_VALOR_9, CAMPO_VALOR_10, DATA_DADOS)VALUES(C1.CODIGO_EMPRESA,C1.TIPO_CONTRATO,C1.CODIGO,'LOG EXECUCAO PROCEDURE PR_ACERTO_LACUNAS_SIT_FUNC_2022',C1.CENARIO_2022,C1.COD_SIT_FUNCIONAL,C1.SIT_FUNCIONAL,C1.DATA_INICIO,C1.DATA_FIM,C1.PROXIMA_COD_SIT_FUNCIONAL,C1.PROXIMA_SIT_FUNCIONAL,C1.PROXIMA_DATA_INICIO,C1.PROXIMA_DATA_FIM,V_SIT_FUNC_ATIVA_VINCULO, SYSDATE);COMMIT;

ELSIF C1.CENARIO_2022 = '44-CRIA PERIODO ENTRE SIT LICENCA E RECESSO COM CONTROLE FOLHA IGUAL A NORMAL (ATIVO)' THEN
dbms_output.put_line('--44-CRIA PERIODO ENTRE SIT LICENCA E RECESSO COM CONTROLE FOLHA IGUAL A NORMAL (ATIVO)');
INSERT INTO RHCGED_ALT_SIT_FUN (IND_EF_RETRO_ESOCIAL, TEXTO_ASSOCIADO, LOGIN_USUARIO, DT_ULT_ALTER_USUA, CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO, DATA_INIC_SITUACAO, COD_SIT_FUNCIONAL, DATA_FIM_SITUACAO ) VALUES ('N', 'Registro criado automaticamente pela rotina PR_ACERTO_LACUNAS_SIT_FUNC_2022.', 'script_acerto_alt_sit_func' ,SYSDATE,C1.CODIGO_EMPRESA ,C1.TIPO_CONTRATO ,C1.CODIGO, TO_DATE(C1.DATA_FIM,'DD/MM/YYYY')+1, V_SIT_FUNC_ATIVA_VINCULO, TO_DATE(C1.PROXIMA_DATA_INICIO,'DD/MM/YYYY')-1); COMMIT;
INSERT INTO SUGESP_AJUSTE_LOTE_CAMPO_HIST(CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, CAMPO_VALOR_1, CONSIDERACOES, CAMPO_VALOR_2, CAMPO_VALOR_3, CAMPO_VALOR_4, CAMPO_VALOR_5, CAMPO_VALOR_6, CAMPO_VALOR_7, CAMPO_VALOR_8, CAMPO_VALOR_9, CAMPO_VALOR_10, DATA_DADOS)VALUES(C1.CODIGO_EMPRESA,C1.TIPO_CONTRATO,C1.CODIGO,'LOG EXECUCAO PROCEDURE PR_ACERTO_LACUNAS_SIT_FUNC_2022',C1.CENARIO_2022,C1.COD_SIT_FUNCIONAL,C1.SIT_FUNCIONAL,C1.DATA_INICIO,C1.DATA_FIM,C1.PROXIMA_COD_SIT_FUNCIONAL,C1.PROXIMA_SIT_FUNCIONAL,C1.PROXIMA_DATA_INICIO,C1.PROXIMA_DATA_FIM,V_SIT_FUNC_ATIVA_VINCULO, SYSDATE);COMMIT;

ELSIF C1.CENARIO_2022 = '45-CRIA PERIODO ENTRE SIT LICENCA ADM E LICENCA COM CONTROLE FOLHA IGUAL A NORMAL (ATIVO)' THEN
dbms_output.put_line('--45-CRIA PERIODO ENTRE SIT LICENCA ADM E LICENCA COM CONTROLE FOLHA IGUAL A NORMAL (ATIVO)');
INSERT INTO RHCGED_ALT_SIT_FUN (IND_EF_RETRO_ESOCIAL, TEXTO_ASSOCIADO, LOGIN_USUARIO, DT_ULT_ALTER_USUA, CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO, DATA_INIC_SITUACAO, COD_SIT_FUNCIONAL, DATA_FIM_SITUACAO ) VALUES ('N', 'Registro criado automaticamente pela rotina PR_ACERTO_LACUNAS_SIT_FUNC_2022.', 'script_acerto_alt_sit_func' ,SYSDATE,C1.CODIGO_EMPRESA ,C1.TIPO_CONTRATO ,C1.CODIGO, TO_DATE(C1.DATA_FIM ,'DD/MM/YYYY')+1, V_SIT_FUNC_ATIVA_VINCULO, TO_DATE(C1.PROXIMA_DATA_INICIO,'DD/MM/YYYY')-1); COMMIT;
INSERT INTO SUGESP_AJUSTE_LOTE_CAMPO_HIST(CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, CAMPO_VALOR_1, CONSIDERACOES, CAMPO_VALOR_2, CAMPO_VALOR_3, CAMPO_VALOR_4, CAMPO_VALOR_5, CAMPO_VALOR_6, CAMPO_VALOR_7, CAMPO_VALOR_8, CAMPO_VALOR_9, CAMPO_VALOR_10, DATA_DADOS)VALUES(C1.CODIGO_EMPRESA,C1.TIPO_CONTRATO,C1.CODIGO,'LOG EXECUCAO PROCEDURE PR_ACERTO_LACUNAS_SIT_FUNC_2022',C1.CENARIO_2022,C1.COD_SIT_FUNCIONAL,C1.SIT_FUNCIONAL,C1.DATA_INICIO,C1.DATA_FIM,C1.PROXIMA_COD_SIT_FUNCIONAL,C1.PROXIMA_SIT_FUNCIONAL,C1.PROXIMA_DATA_INICIO,C1.PROXIMA_DATA_FIM,V_SIT_FUNC_ATIVA_VINCULO, SYSDATE);COMMIT;

ELSIF C1.CENARIO_2022 = '46-AVISAR GEVIF - LACUNA ENTRE SUSPENSAO PAG E LICENCA ADM AJUSTAR MANUALMENTE' THEN
dbms_output.put_line('--46-AVISAR GEVIF - LACUNA ENTRE SUSPENSAO PAG E LICENCA ADM AJUSTAR MANUALMENTE');
INSERT INTO SUGESP_AJUSTE_LOTE_CAMPO_HIST(CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, CAMPO_VALOR_1, CONSIDERACOES, CAMPO_VALOR_2, CAMPO_VALOR_3, CAMPO_VALOR_4, CAMPO_VALOR_5, CAMPO_VALOR_6, CAMPO_VALOR_7, CAMPO_VALOR_8, CAMPO_VALOR_9, CAMPO_VALOR_10, DATA_DADOS)VALUES(C1.CODIGO_EMPRESA,C1.TIPO_CONTRATO,C1.CODIGO,'LOG EXECUCAO PROCEDURE PR_ACERTO_LACUNAS_SIT_FUNC_2022',C1.CENARIO_2022,C1.COD_SIT_FUNCIONAL,C1.SIT_FUNCIONAL,C1.DATA_INICIO,C1.DATA_FIM,C1.PROXIMA_COD_SIT_FUNCIONAL,C1.PROXIMA_SIT_FUNCIONAL,C1.PROXIMA_DATA_INICIO,C1.PROXIMA_DATA_FIM,V_SIT_FUNC_ATIVA_VINCULO, SYSDATE);COMMIT;

ELSIF C1.CENARIO_2022 = '47-CRIA CONTROLE FOLHA IGUAL A NORMAL (ATIVO) COMO ULTIMA NO HISTORICO' THEN
dbms_output.put_line('--47-CRIA CONTROLE FOLHA IGUAL A NORMAL (ATIVO) COMO ULTIMA NO HISTORICO');
INSERT INTO RHCGED_ALT_SIT_FUN (IND_EF_RETRO_ESOCIAL, TEXTO_ASSOCIADO, LOGIN_USUARIO, DT_ULT_ALTER_USUA, CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO, DATA_INIC_SITUACAO, COD_SIT_FUNCIONAL) VALUES ('N', 'Registro criado automaticamente pela rotina PR_ACERTO_LACUNAS_SIT_FUNC_2022.', 'script_acerto_alt_sit_func' ,SYSDATE, C1.CODIGO_EMPRESA ,C1.TIPO_CONTRATO ,C1.CODIGO , TO_DATE(C1.DATA_FIM,'DD/MM/YYYY')+1, V_SIT_FUNC_ATIVA_VINCULO); COMMIT;
INSERT INTO SUGESP_AJUSTE_LOTE_CAMPO_HIST(CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, CAMPO_VALOR_1, CONSIDERACOES, CAMPO_VALOR_2, CAMPO_VALOR_3, CAMPO_VALOR_4, CAMPO_VALOR_5, CAMPO_VALOR_6, CAMPO_VALOR_7, CAMPO_VALOR_8, CAMPO_VALOR_9, CAMPO_VALOR_10, DATA_DADOS)VALUES(C1.CODIGO_EMPRESA,C1.TIPO_CONTRATO,C1.CODIGO,'LOG EXECUCAO PROCEDURE PR_ACERTO_LACUNAS_SIT_FUNC_2022',C1.CENARIO_2022,C1.COD_SIT_FUNCIONAL,C1.SIT_FUNCIONAL,C1.DATA_INICIO,C1.DATA_FIM,C1.PROXIMA_COD_SIT_FUNCIONAL,C1.PROXIMA_SIT_FUNCIONAL,C1.PROXIMA_DATA_INICIO,C1.PROXIMA_DATA_FIM,V_SIT_FUNC_ATIVA_VINCULO, SYSDATE);COMMIT;
SUGESP_ALT_SIT_FUNC_ULT_CONTRA(C1.CODIGO_EMPRESA ,C1.TIPO_CONTRATO ,C1.CODIGO,'script_acerto_alt_sit_func' );

ELSIF C1.CENARIO_2022 = '48-AVISAR GETED - INFREQUENCIA E SEM NADA LANCADO DEPOIS AJUSTAR MANUALMENTE' THEN
dbms_output.put_line('--48-AVISAR GETED - INFREQUENCIA E SEM NADA LANCADO DEPOIS AJUSTAR MANUALMENTE');
INSERT INTO SUGESP_AJUSTE_LOTE_CAMPO_HIST(CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, CAMPO_VALOR_1, CONSIDERACOES, CAMPO_VALOR_2, CAMPO_VALOR_3, CAMPO_VALOR_4, CAMPO_VALOR_5, CAMPO_VALOR_6, CAMPO_VALOR_7, CAMPO_VALOR_8, CAMPO_VALOR_9, CAMPO_VALOR_10, DATA_DADOS)VALUES(C1.CODIGO_EMPRESA,C1.TIPO_CONTRATO,C1.CODIGO,'LOG EXECUCAO PROCEDURE PR_ACERTO_LACUNAS_SIT_FUNC_2022',C1.CENARIO_2022,C1.COD_SIT_FUNCIONAL,C1.SIT_FUNCIONAL,C1.DATA_INICIO,C1.DATA_FIM,C1.PROXIMA_COD_SIT_FUNCIONAL,C1.PROXIMA_SIT_FUNCIONAL,C1.PROXIMA_DATA_INICIO,C1.PROXIMA_DATA_FIM,V_SIT_FUNC_ATIVA_VINCULO, SYSDATE);COMMIT;

ELSIF C1.CENARIO_2022 = '49-AVISAR GETED - INFREQUENCIA E SEM NADA LANCADO DEPOIS AJUSTAR MANUALMENTE' THEN
dbms_output.put_line('--49-AVISAR GETED - INFREQUENCIA E SEM NADA LANCADO DEPOIS AJUSTAR MANUALMENTE');
INSERT INTO SUGESP_AJUSTE_LOTE_CAMPO_HIST(CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, CAMPO_VALOR_1, CONSIDERACOES, CAMPO_VALOR_2, CAMPO_VALOR_3, CAMPO_VALOR_4, CAMPO_VALOR_5, CAMPO_VALOR_6, CAMPO_VALOR_7, CAMPO_VALOR_8, CAMPO_VALOR_9, CAMPO_VALOR_10, DATA_DADOS)VALUES(C1.CODIGO_EMPRESA,C1.TIPO_CONTRATO,C1.CODIGO,'LOG EXECUCAO PROCEDURE PR_ACERTO_LACUNAS_SIT_FUNC_2022',C1.CENARIO_2022,C1.COD_SIT_FUNCIONAL,C1.SIT_FUNCIONAL,C1.DATA_INICIO,C1.DATA_FIM,C1.PROXIMA_COD_SIT_FUNCIONAL,C1.PROXIMA_SIT_FUNCIONAL,C1.PROXIMA_DATA_INICIO,C1.PROXIMA_DATA_FIM,V_SIT_FUNC_ATIVA_VINCULO, SYSDATE);COMMIT;

ELSIF C1.CENARIO_2022 = '50-CRIA CONTROLE FOLHA IGUAL A NORMAL (ATIVO) COMO ULTIMA NO HISTORICO' THEN
dbms_output.put_line('--50-CRIA CONTROLE FOLHA IGUAL A NORMAL (ATIVO) COMO ULTIMA NO HISTORICO');
INSERT INTO RHCGED_ALT_SIT_FUN (IND_EF_RETRO_ESOCIAL, TEXTO_ASSOCIADO, LOGIN_USUARIO, DT_ULT_ALTER_USUA, CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO, DATA_INIC_SITUACAO, COD_SIT_FUNCIONAL) VALUES ('N', 'Registro criado automaticamente pela rotina PR_ACERTO_LACUNAS_SIT_FUNC_2022.', 'script_acerto_alt_sit_func' ,SYSDATE,C1.CODIGO_EMPRESA,C1.TIPO_CONTRATO,C1.CODIGO, TO_DATE(C1.DATA_FIM ,'DD/MM/YYYY')+1, V_SIT_FUNC_ATIVA_VINCULO); COMMIT;
INSERT INTO SUGESP_AJUSTE_LOTE_CAMPO_HIST(CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, CAMPO_VALOR_1, CONSIDERACOES, CAMPO_VALOR_2, CAMPO_VALOR_3, CAMPO_VALOR_4, CAMPO_VALOR_5, CAMPO_VALOR_6, CAMPO_VALOR_7, CAMPO_VALOR_8, CAMPO_VALOR_9, CAMPO_VALOR_10, DATA_DADOS)VALUES(C1.CODIGO_EMPRESA,C1.TIPO_CONTRATO,C1.CODIGO,'LOG EXECUCAO PROCEDURE PR_ACERTO_LACUNAS_SIT_FUNC_2022',C1.CENARIO_2022,C1.COD_SIT_FUNCIONAL,C1.SIT_FUNCIONAL,C1.DATA_INICIO,C1.DATA_FIM,C1.PROXIMA_COD_SIT_FUNCIONAL,C1.PROXIMA_SIT_FUNCIONAL,C1.PROXIMA_DATA_INICIO,C1.PROXIMA_DATA_FIM,V_SIT_FUNC_ATIVA_VINCULO, SYSDATE);COMMIT;
SUGESP_ALT_SIT_FUNC_ULT_CONTRA(C1.CODIGO_EMPRESA ,C1.TIPO_CONTRATO ,C1.CODIGO ,'script_acerto_alt_sit_func' );

ELSIF C1.CENARIO_2022 = '51-TIRAR DATA FIM CONTROLE FOLHA IGUAL A NORMAL (ATIVO) COMO ULTIMA NO HISTORICO' THEN
dbms_output.put_line('--51-TIRAR DATA FIM CONTROLE FOLHA IGUAL A NORMAL (ATIVO) COMO ULTIMA NO HISTORICO');
UPDATE RHCGED_ALT_SIT_FUN SET LOGIN_USUARIO = 'script_acerto_alt_sit_func' , DT_ULT_ALTER_USUA = SYSDATE, DATA_FIM_SITUACAO = NULL WHERE CODIGO_EMPRESA = C1.CODIGO_EMPRESA AND TIPO_CONTRATO = C1.TIPO_CONTRATO AND CODIGO = C1.CODIGO AND TRUNC(DATA_INIC_SITUACAO) = TO_DATE(C1.DATA_INICIO,'DD/MM/YYYY');COMMIT;
INSERT INTO SUGESP_AJUSTE_LOTE_CAMPO_HIST(CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, CAMPO_VALOR_1, CONSIDERACOES, CAMPO_VALOR_2, CAMPO_VALOR_3, CAMPO_VALOR_4, CAMPO_VALOR_5, CAMPO_VALOR_6, CAMPO_VALOR_7, CAMPO_VALOR_8, CAMPO_VALOR_9, CAMPO_VALOR_10, DATA_DADOS)VALUES(C1.CODIGO_EMPRESA,C1.TIPO_CONTRATO,C1.CODIGO,'LOG EXECUCAO PROCEDURE PR_ACERTO_LACUNAS_SIT_FUNC_2022',C1.CENARIO_2022,C1.COD_SIT_FUNCIONAL,C1.SIT_FUNCIONAL,C1.DATA_INICIO,C1.DATA_FIM,C1.PROXIMA_COD_SIT_FUNCIONAL,C1.PROXIMA_SIT_FUNCIONAL,C1.PROXIMA_DATA_INICIO,C1.PROXIMA_DATA_FIM,V_SIT_FUNC_ATIVA_VINCULO, SYSDATE);COMMIT;

ELSIF C1.CENARIO_2022 = '52-AVISAR GESFO - SITUAÇÃO FUNCIONAL DE DESLIGAMENTO COM DATA FIM'  THEN
dbms_output.put_line('--52-AVISAR GESFO - SITUAÇÃO FUNCIONAL DE DESLIGAMENTO COM DATA FIM');
--comentado em 4/4/22--UPDATE RHCGED_ALT_SIT_FUN SET LOGIN_USUARIO = 'script_acerto_alt_sit_func' , DT_ULT_ALTER_USUA = SYSDATE, DATA_FIM_SITUACAO = NULL WHERE CODIGO_EMPRESA = C1.CODIGO_EMPRESA AND TIPO_CONTRATO = C1.TIPO_CONTRATO AND CODIGO = C1.CODIGO AND TRUNC(DATA_INIC_SITUACAO) = TO_DATE(C1.DATA_INICIO,'DD/MM/YYYY');COMMIT;
INSERT INTO SUGESP_AJUSTE_LOTE_CAMPO_HIST(CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, CAMPO_VALOR_1, CONSIDERACOES, CAMPO_VALOR_2, CAMPO_VALOR_3, CAMPO_VALOR_4, CAMPO_VALOR_5, CAMPO_VALOR_6, CAMPO_VALOR_7, CAMPO_VALOR_8, CAMPO_VALOR_9, CAMPO_VALOR_10, DATA_DADOS)VALUES(C1.CODIGO_EMPRESA,C1.TIPO_CONTRATO,C1.CODIGO,'LOG EXECUCAO PROCEDURE PR_ACERTO_LACUNAS_SIT_FUNC_2022',C1.CENARIO_2022,C1.COD_SIT_FUNCIONAL,C1.SIT_FUNCIONAL,C1.DATA_INICIO,C1.DATA_FIM,C1.PROXIMA_COD_SIT_FUNCIONAL,C1.PROXIMA_SIT_FUNCIONAL,C1.PROXIMA_DATA_INICIO,C1.PROXIMA_DATA_FIM,V_SIT_FUNC_ATIVA_VINCULO, SYSDATE);COMMIT;

ELSIF C1.CENARIO_2022 = '53- AVISAR GEVIF (COORD. INGRESSO E MOVIMENTACAO) LICENÇA COM DATA FIM SEM LANCAMENTO POSTERIOR' THEN
dbms_output.put_line('--53- AVISAR GEVIF (COORD. INGRESSO E MOVIMENTACAO) LICENÇA COM DATA FIM SEM LANCAMENTO POSTERIOR');
--comentado em 4/4/22--UPDATE RHCGED_ALT_SIT_FUN SET LOGIN_USUARIO = 'script_acerto_alt_sit_func' , DT_ULT_ALTER_USUA = SYSDATE, DATA_FIM_SITUACAO = NULL WHERE CODIGO_EMPRESA = C1.CODIGO_EMPRESA AND TIPO_CONTRATO = C1.TIPO_CONTRATO AND CODIGO = C1.CODIGO AND TRUNC(DATA_INIC_SITUACAO) = TO_DATE(C1.DATA_INICIO,'DD/MM/YYYY');COMMIT;
INSERT INTO SUGESP_AJUSTE_LOTE_CAMPO_HIST(CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, CAMPO_VALOR_1, CONSIDERACOES, CAMPO_VALOR_2, CAMPO_VALOR_3, CAMPO_VALOR_4, CAMPO_VALOR_5, CAMPO_VALOR_6, CAMPO_VALOR_7, CAMPO_VALOR_8, CAMPO_VALOR_9, CAMPO_VALOR_10, DATA_DADOS)VALUES(C1.CODIGO_EMPRESA,C1.TIPO_CONTRATO,C1.CODIGO,'LOG EXECUCAO PROCEDURE PR_ACERTO_LACUNAS_SIT_FUNC_2022',C1.CENARIO_2022,C1.COD_SIT_FUNCIONAL,C1.SIT_FUNCIONAL,C1.DATA_INICIO,C1.DATA_FIM,C1.PROXIMA_COD_SIT_FUNCIONAL,C1.PROXIMA_SIT_FUNCIONAL,C1.PROXIMA_DATA_INICIO,C1.PROXIMA_DATA_FIM,V_SIT_FUNC_ATIVA_VINCULO, SYSDATE);COMMIT;

ELSIF C1.CENARIO_2022 = '54- AVISAR GEVIF (COORD. INGRESSO E MOVIMENTACAO)  APÓS SIT FUNC DE INGRESSO LACUNA COM PROXIMA SITUACAO' THEN
dbms_output.put_line('--54- AVISAR GEVIF (COORD. INGRESSO E MOVIMENTACAO)  APÓS SIT FUNC DE INGRESSO LACUNA COM PROXIMA SITUACAO');
--comentado em 4/4/22--UPDATE RHCGED_ALT_SIT_FUN SET LOGIN_USUARIO = 'script_acerto_alt_sit_func' , DT_ULT_ALTER_USUA = SYSDATE, DATA_FIM_SITUACAO = NULL WHERE CODIGO_EMPRESA = C1.CODIGO_EMPRESA AND TIPO_CONTRATO = C1.TIPO_CONTRATO AND CODIGO = C1.CODIGO AND TRUNC(DATA_INIC_SITUACAO) = TO_DATE(C1.DATA_INICIO,'DD/MM/YYYY');COMMIT;
INSERT INTO SUGESP_AJUSTE_LOTE_CAMPO_HIST(CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, CAMPO_VALOR_1, CONSIDERACOES, CAMPO_VALOR_2, CAMPO_VALOR_3, CAMPO_VALOR_4, CAMPO_VALOR_5, CAMPO_VALOR_6, CAMPO_VALOR_7, CAMPO_VALOR_8, CAMPO_VALOR_9, CAMPO_VALOR_10, DATA_DADOS)VALUES(C1.CODIGO_EMPRESA,C1.TIPO_CONTRATO,C1.CODIGO,'LOG EXECUCAO PROCEDURE PR_ACERTO_LACUNAS_SIT_FUNC_2022',C1.CENARIO_2022,C1.COD_SIT_FUNCIONAL,C1.SIT_FUNCIONAL,C1.DATA_INICIO,C1.DATA_FIM,C1.PROXIMA_COD_SIT_FUNCIONAL,C1.PROXIMA_SIT_FUNCIONAL,C1.PROXIMA_DATA_INICIO,C1.PROXIMA_DATA_FIM,V_SIT_FUNC_ATIVA_VINCULO, SYSDATE);COMMIT;


ELSE dbms_output.put_line('--NAO_MAPEADO_AINDA');
INSERT INTO SUGESP_AJUSTE_LOTE_CAMPO_HIST(CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, CAMPO_VALOR_1, CONSIDERACOES, CAMPO_VALOR_2, CAMPO_VALOR_3, CAMPO_VALOR_4, CAMPO_VALOR_5, CAMPO_VALOR_6, CAMPO_VALOR_7, CAMPO_VALOR_8, CAMPO_VALOR_9, CAMPO_VALOR_10, DATA_DADOS)VALUES(C1.CODIGO_EMPRESA,C1.TIPO_CONTRATO,C1.CODIGO,'LOG EXECUCAO PROCEDURE PR_ACERTO_LACUNAS_SIT_FUNC_2022',C1.CENARIO_2022,C1.COD_SIT_FUNCIONAL,C1.SIT_FUNCIONAL,C1.DATA_INICIO,C1.DATA_FIM,C1.PROXIMA_COD_SIT_FUNCIONAL,C1.PROXIMA_SIT_FUNCIONAL,C1.PROXIMA_DATA_INICIO,C1.PROXIMA_DATA_FIM,V_SIT_FUNC_ATIVA_VINCULO, SYSDATE);COMMIT;

END IF;
---FIM-------------------------------------------------------------IF GERAL DE AJUSTES 2022-------------------------------------------------------------------------

EXCEPTION WHEN OTHERS THEN
err_msg := SQLCODE||' '||SUBSTR(SQLERRM, 1, 4000);
dbms_output.put_line('err_msg:' ||err_msg);

INSERT INTO SUGESP_AJUSTE_LOTE_CAMPO_HIST(CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, CAMPO_VALOR_2, CAMPO_VALOR_20, CAMPO_VALOR_1,  DATA_DADOS, CONSIDERACOES)
VALUES(C1.CODIGO_EMPRESA,C1.TIPO_CONTRATO,C1.CODIGO,C1.DATA_INICIO,'ERRO_EXCEPTION','LOG EXECUCAO PROCEDURE PR_ACERTO_LACUNAS_SIT_FUNC_2022', SYSDATE, err_msg
);COMMIT;
END;--BEGIN EXCEPTION


V_SIT_FUNC_ATIVA_VINCULO := NULL;
--V_SIT_FUNC_PADRAO_VINCULO := NULL;
err_msg := NULL;

END LOOP;

ELSE 
dbms_output.put_line('--HISTORICO ALT SIT FUNC POSSUI REGISTROS COM PERIODO NEGATIVO, ERRO QUE DEVE SER VERIFICADO PARA EXECUTAR A PROCEDURE: ARTERH.PR_ACERTOS_ALT_SIT_FUNC_2022');
INSERT INTO SUGESP_AJUSTE_LOTE_CAMPO_HIST
(CAMPO_VALOR_1, CONSIDERACOES, DATA_DADOS)
VALUES('LOG EXECUCAO PROCEDURE PR_ACERTO_LACUNAS_SIT_FUNC_2022','HISTORICO ALT SIT FUNC POSSUI REGISTROS COM PERIODO NEGATIVO, ERRO QUE DEVE SER VERIFICADO PARA EXECUTAR A PROCEDURE: ARTERH.PR_ACERTOS_ALT_SIT_FUNC_2022', SYSDATE);COMMIT;

END IF;
---FIM-------------------------------------------------------------------------PRIMEIRA PARTE------------------------------LOCALIZAR OS REGISTROS E ACERTAR-----------------------------------------------------------------------------------

---INICIO-------------------------------------------------------------------------SEGUNDA PARTE------------------------------GERAR O RELATORIO (relat_PR_ACERTOS_ALT_SIT_FUNC_2022.sql)-----------------------------------------------------------------------------------
INSERT INTO SUGESP_AJUSTE_LOTE_CAMPO_HIST
(CAMPO_VALOR_1, DATA_DADOS, CONSIDERACOES)
VALUES('RELATORIO EXECUCAO PROCEDURE PR_ACERTO_LACUNAS_SIT_FUNC_2022',SYSDATE
,'1_OBS_PARA_KELLYSSON|OBS_CRF|ORDEM_REGISTRO|DADOS_ALT_SIT_FUNC|TIPO_REGISTRO|IDADE_REG_EM_DIAS|CODIGO_EMPRESA|TIPO_CONTRATO|CODIGO_CONTRATO|CENARIO_EXECUTADO|COD_SIT_FUNCIONAL|SIT_FUNCIONAL|DATA_INICIO|DATA_FIM|PROXIMA_COD_SIT_FUNCIONAL|PROXIMA_SIT_FUNCIONAL|PROXIMA_DATA_INICIO|PROXIMA_DATA_FIM|V_SIT_FUNC_ATIVA_VINCULO|DADOS_MOVIMENTACAO|TIPO_CESSAO|COD_MOVIMENTACAO|DESCRICAO|DT_INICIO_MOVIMENT|DT_FIM_MOVIMENT|ORGAO|COD_LOTACAO_ATUAL1|COD_LOTACAO_ATUAL2|COD_LOTACAO_ATUAL3|COD_LOTACAO_ATUAL4|COD_LOTACAO_ATUAL5|COD_LOTACAO_ATUAL6|LOTACAO|COD_UNIDADE_ATUAL1|COD_UNIDADE_ATUAL2|COD_UNIDADE_ATUAL3|COD_UNIDADE_ATUAL4|COD_UNIDADE_ATUAL5|COD_UNIDADE_ATUAL6|UNIDADE|COD_CCONTAB_ATUAL1|COD_CCONTAB_ATUAL2|COD_CCONTAB_ATUAL3|COD_CCONTAB_ATUAL4|COD_CCONTAB_ATUAL5|COD_CCONTAB_ATUAL6|CUSTO_CONTABIL|COD_CGERENC_ATUAL1|COD_CGERENC_ATUAL2|COD_CGERENC_ATUAL3|COD_CGERENC_ATUAL4|COD_CGERENC_ATUAL5|COD_CGERENC_ATUAL6|CUSTO_GERENCIAL|COLUNAS_PARA_FAZER_MAPEAMENTO|SO_GERA_SIT_PONTO|CONTROLE_FOLHA|E_AFASTAMENTO|SUSPENDE_REMUNERA|QTDE_DIAS_PROXIMO|PROXIMO_CONTROLE_FOLHA|PROXIMO_E_AFASTAMENTO|PROXIMO_SUSPENDE_REMUNERA'
);COMMIT;

FOR C2 IN
(

--SELECT X3.TIPO_REGISTRO, X3.CENARIO_EXECUTADO, COUNT(1)QUANT FROM (--SINTETICO
--relatorio analitico com quantidade dias do registro
SELECT 
OBS.OBS_PARA_KELLYSSON, OBS.OBS_CRF,
ROW_NUMBER() OVER(PARTITION BY X2.CODIGO_EMPRESA, X2.TIPO_CONTRATO, X2.CODIGO_CONTRATO, X2.DATA_INICIO ORDER BY X2.CODIGO_EMPRESA, X2.TIPO_CONTRATO, X2.CODIGO_CONTRATO, X2.DATA_INICIO )ORDEM_REGISTRO,
X2.*
,'DADOS_MOVIMENTACAO' DADOS_MOVIMENTACAO,  C.DADO_DESTINO TIPO_CESSAO, M.COD_MOVIMENTACAO, CM.DESCRICAO, M.DT_ALT_UNID_CUSTO DT_INICIO_MOVIMENT,  M.dt_fim_temp DT_FIM_MOVIMENT 
,M.c_livre_descr01 ORGAO, 
M.COD_LOTACAO_ATUAL1, M.COD_LOTACAO_ATUAL2, M.COD_LOTACAO_ATUAL3, M.COD_LOTACAO_ATUAL4, M.COD_LOTACAO_ATUAL5, M.COD_LOTACAO_ATUAL6, LT.DESCRICAO LOTACAO, 
M.COD_UNIDADE_ATUAL1, M.COD_UNIDADE_ATUAL2, M.COD_UNIDADE_ATUAL3, M.COD_UNIDADE_ATUAL4, M.COD_UNIDADE_ATUAL5, M.COD_UNIDADE_ATUAL6, UN.DESCRICAO UNIDADE, 
M.COD_CCONTAB_ATUAL1, M.COD_CCONTAB_ATUAL2, M.COD_CCONTAB_ATUAL3, M.COD_CCONTAB_ATUAL4, M.COD_CCONTAB_ATUAL5, M.COD_CCONTAB_ATUAL6, CC.DESCRICAO CUSTO_CONTABIL, 
M.COD_CGERENC_ATUAL1, M.COD_CGERENC_ATUAL2, M.COD_CGERENC_ATUAL3, M.COD_CGERENC_ATUAL4, M.COD_CGERENC_ATUAL5, M.COD_CGERENC_ATUAL6, CG.DESCRICAO CUSTO_GERENCIAL 
,'COLUNAS_PARA_FAZER_MAPEAMENTO' COLUNAS_PARA_FAZER_MAPEAMENTO
,SF.c_livre_selec02 SO_GERA_SIT_PONTO,	SF.CONTROLE_FOLHA, SF.E_AFASTAMENTO, SF.SUSPENDE_REMUNERA, SF.QTDE_DIAS_PROXIMO	
,SFP.CONTROLE_FOLHA PROXIMO_CONTROLE_FOLHA	,SFP.E_AFASTAMENTO PROXIMO_E_AFASTAMENTO, SFP.SUSPENDE_REMUNERA PROXIMO_SUSPENDE_REMUNERA
--SO_GERA_SIT_PONTO	CONTROLE_FOLHA	E_AFASTAMENTO	SUSPENDE_REMUNERA	TEM_QTDE_DIAS_PROXIMO	
--SO_GERA_SIT_PONTO	ULTIMO_REGISTRO	CONTROLE_FOLHA	E_AFASTAMENTO	SUSPENDE_REMUNERA	TEM_QTDE_DIAS_PROXIMO	TEM_PROXIMA_SIT_FUNC_NO_CAD	TEM_DATA_FIM	PROXIMO_CONTROLE_FOLHA	PROXIMO_E_AFASTAMENTO	PROXIMO_SUSPENDE_REMUNERA	TEM_PROXIMA_DATA_FIM	CONDICAO_ESPECIFICA

FROM(
-------INICIO-------------------------------NUCLEO RELATORIO
SELECT 
--ROW_NUMBER() OVER(PARTITION BY X.CODIGO_EMPRESA, X.TIPO_CONTRATO, X.CODIGO_CONTRATO, X.DATA_INICIO ORDER BY X.CODIGO_EMPRESA, X.TIPO_CONTRATO, X.CODIGO_CONTRATO, X.DATA_INICIO )ORDEM_REGISTRO,
'DADOS_ALT_SIT_FUNC'DADOS_ALT_SIT_FUNC,
CASE WHEN SUM(X.IDADE_REG_EM_DIAS) = 1 THEN 'NOVO' ELSE 'VELHO' END TIPO_REGISTRO,
--X.ORDEM_REGISTRO, X.TIPO_REGISTRO, 
SUM(X.IDADE_REG_EM_DIAS)IDADE_REG_EM_DIAS, 
X.CODIGO_EMPRESA, X.TIPO_CONTRATO, X.CODIGO_CONTRATO, X.CENARIO_EXECUTADO, X.COD_SIT_FUNCIONAL, X.SIT_FUNCIONAL, X.DATA_INICIO, X.DATA_FIM, X.PROXIMA_COD_SIT_FUNCIONAL, X.PROXIMA_SIT_FUNCIONAL, X.PROXIMA_DATA_INICIO, X.PROXIMA_DATA_FIM, X.V_SIT_FUNC_ATIVA_VINCULO
FROM (
SELECT 
--ROW_NUMBER() OVER(PARTITION BY D.CODIGO_EMPRESA, D.TIPO_CONTRATO, D.CODIGO_CONTRATO, D.DATA_INICIO ORDER BY D.CODIGO_EMPRESA, D.TIPO_CONTRATO, D.CODIGO_CONTRATO, D.DATA_INICIO )ORDEM_REGISTRO,
--CASE WHEN H.QTD_DIAS = 1 THEN 'NOVO' ELSE 'VELHO' END TIPO_REGISTRO,
H.QTD_DIAS IDADE_REG_EM_DIAS, D.* FROM(
SELECT CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, CONSIDERACOES CENARIO_EXECUTADO, CAMPO_VALOR_2 COD_SIT_FUNCIONAL, CAMPO_VALOR_3 SIT_FUNCIONAL, CAMPO_VALOR_4 DATA_INICIO, CAMPO_VALOR_5 DATA_FIM, 
CAMPO_VALOR_6 PROXIMA_COD_SIT_FUNCIONAL, CAMPO_VALOR_7 PROXIMA_SIT_FUNCIONAL, CAMPO_VALOR_8 PROXIMA_DATA_INICIO, CAMPO_VALOR_9 PROXIMA_DATA_FIM , CAMPO_VALOR_10 V_SIT_FUNC_ATIVA_VINCULO, CAMPO_VALOR_20 ERRO_EXCEPTION
FROM SUGESP_AJUSTE_LOTE_CAMPO_HIST WHERE CODIGO_EMPRESA IN ('0001','0002','0003','0013','0014') AND CAMPO_VALOR_1 = 'LOG EXECUCAO PROCEDURE PR_ACERTO_LACUNAS_SIT_FUNC_2022' AND CAMPO_VALOR_20 IS NULL
AND TRUNC(DATA_DADOS) = TRUNC(SYSDATE) -----------------------------trocando data
GROUP BY CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, CONSIDERACOES, CAMPO_VALOR_2, CAMPO_VALOR_3, CAMPO_VALOR_4 , CAMPO_VALOR_5, CAMPO_VALOR_6, CAMPO_VALOR_7, CAMPO_VALOR_8, CAMPO_VALOR_9 , CAMPO_VALOR_10, CAMPO_VALOR_20
ORDER BY CONSIDERACOES, CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, CAMPO_VALOR_4
)D
LEFT OUTER JOIN 
(
SELECT COUNT(1)QTD_DIAS, CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, /*CONSIDERACOES CENARIO_EXECUTADO,*/ CAMPO_VALOR_2 COD_SIT_FUNCIONAL, CAMPO_VALOR_3 SIT_FUNCIONAL, CAMPO_VALOR_4 DATA_INICIO, CAMPO_VALOR_5 DATA_FIM, 
CAMPO_VALOR_6 PROXIMA_COD_SIT_FUNCIONAL, CAMPO_VALOR_7 PROXIMA_SIT_FUNCIONAL, CAMPO_VALOR_8 PROXIMA_DATA_INICIO, CAMPO_VALOR_9 PROXIMA_DATA_FIM , CAMPO_VALOR_10 V_SIT_FUNC_ATIVA_VINCULO
FROM SUGESP_AJUSTE_LOTE_CAMPO_HIST WHERE CODIGO_EMPRESA IN('0001','0002','0003','0013','0014') AND CAMPO_VALOR_1 = 'LOG EXECUCAO PROCEDURE PR_ACERTO_LACUNAS_SIT_FUNC_2022' 
GROUP BY CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO/*, CONSIDERACOES*/, CAMPO_VALOR_2, CAMPO_VALOR_3, CAMPO_VALOR_4, CAMPO_VALOR_5, CAMPO_VALOR_6, CAMPO_VALOR_7, CAMPO_VALOR_8, CAMPO_VALOR_9, CAMPO_VALOR_10
ORDER BY CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO/*, CONSIDERACOES*/, CAMPO_VALOR_2, CAMPO_VALOR_3, CAMPO_VALOR_4, CAMPO_VALOR_5, CAMPO_VALOR_6, CAMPO_VALOR_7, CAMPO_VALOR_8, CAMPO_VALOR_9, CAMPO_VALOR_10
)H ON D.CODIGO_EMPRESA = H.CODIGO_EMPRESA AND D.TIPO_CONTRATO = H.TIPO_CONTRATO AND D.CODIGO_CONTRATO = H.CODIGO_CONTRATO AND D.DATA_INICIO = H.DATA_INICIO
)X
GROUP BY --X.ORDEM_REGISTRO, X.TIPO_REGISTRO, X.IDADE_REG_EM_DIAS,  
X.CODIGO_EMPRESA, X.TIPO_CONTRATO, X.CODIGO_CONTRATO, X.CENARIO_EXECUTADO, X.COD_SIT_FUNCIONAL, X.SIT_FUNCIONAL, X.DATA_INICIO, X.DATA_FIM, X.PROXIMA_COD_SIT_FUNCIONAL, X.PROXIMA_SIT_FUNCIONAL, X.PROXIMA_DATA_INICIO, X.PROXIMA_DATA_FIM, X.V_SIT_FUNC_ATIVA_VINCULO
ORDER BY X.CODIGO_EMPRESA, X.TIPO_CONTRATO, X.CODIGO_CONTRATO, X.DATA_INICIO, X.DATA_FIM, X.PROXIMA_COD_SIT_FUNCIONAL, X.PROXIMA_SIT_FUNCIONAL, X.PROXIMA_DATA_INICIO, X.PROXIMA_DATA_FIM, X.V_SIT_FUNC_ATIVA_VINCULO
-------FIM-------------------------------NUCLEO RELATORIO
)X2
LEFT OUTER JOIN RHPESS_CONTRATO CT ON CT.CODIGO_EMPRESA = X2.CODIGO_EMPRESA AND X2.TIPO_CONTRATO = CT.TIPO_CONTRATO AND X2.CODIGO_CONTRATO = CT.CODIGO 
LEFT OUTER JOIN RHPARM_SIT_FUNC SC ON SC.CODIGO = CT.SITUACAO_FUNCIONAL
LEFT OUTER JOIN (SELECT DADO_ORIGEM, DADO_DESTINO from RHINTE_ED_IT_CONV  where codigo_conversao = 'CESS') C ON C.DADO_ORIGEM = X2.COD_SIT_FUNCIONAL 
LEFT OUTER JOIN RHPARM_SIT_FUNC S ON S.CODIGO = C.DADO_ORIGEM 
LEFT OUTER JOIN RHPONT_SITUACAO SP ON SP.CODIGO = S.SITUACAO_PONTO 
LEFT OUTER JOIN (SELECT * FROM RHCGED_TRANSFERENC WHERE CODIGO_EMPRESA IN ('0001','0002','0003','0013','0014'))M ON M.CODIGO_EMPRESA = X2.CODIGO_EMPRESA AND M.TIPO_CONTRATO = X2.TIPO_CONTRATO AND M.CODIGO = X2.CODIGO_CONTRATO AND TRUNC(M.DT_ALT_UNID_CUSTO) = TO_DATE(X2.DATA_INICIO,'DD/MM/RRRR') 
LEFT OUTER JOIN RHTABS_MOVIMENT CM ON CM.CODIGO = M.COD_MOVIMENTACAO 
LEFT OUTER JOIN RHORGA_LOTACAO LT ON LT.CODIGO_EMPRESA = M.CODIGO_EMPRESA AND LT.cod_lotacao1 = M.COD_LOTACAO_ATUAL1 AND LT.cod_lotacao2 = M.COD_LOTACAO_ATUAL2 AND LT.cod_lotacao3 = M.COD_LOTACAO_ATUAL3 AND LT.cod_lotacao4 = M.COD_LOTACAO_ATUAL4 AND LT.cod_lotacao5 = M.COD_LOTACAO_ATUAL5 and LT.cod_lotacao6 = M.COD_LOTACAO_ATUAL6 
LEFT OUTER JOIN RHORGA_UNIDADE UN ON UN.CODIGO_EMPRESA = M.CODIGO_EMPRESA AND UN.cod_unidade1 = M.COD_UNIDADE_ATUAL1 AND UN.cod_unidade2 = M.COD_UNIDADE_ATUAL2 AND UN.cod_unidade3 = M.COD_UNIDADE_ATUAL3 AND UN.cod_unidade4 = M.COD_UNIDADE_ATUAL4 AND UN.cod_unidade5 = M.COD_UNIDADE_ATUAL5 AND UN.cod_unidade6 = M.COD_UNIDADE_ATUAL6 
LEFT OUTER JOIN RHORGA_CUSTO_CONT CC ON CC.CODIGO_EMPRESA = M.CODIGO_EMPRESA AND CC.cod_ccontab1 = M.COD_CCONTAB_ATUAL1 AND CC.cod_ccontab2 = M.COD_CCONTAB_ATUAL2 AND CC.cod_ccontab3 = M.COD_CCONTAB_ATUAL3 AND CC.cod_ccontab4 = M.COD_CCONTAB_ATUAL4 AND CC.cod_ccontab5 = M.COD_CCONTAB_ATUAL5 AND CC.cod_ccontab6 =  M.COD_CCONTAB_ATUAL6 
LEFT OUTER JOIN RHORGA_CUSTO_GEREN CG ON CG.CODIGO_EMPRESA = M.CODIGO_EMPRESA AND CG.cod_cgerenc1 = M.COD_CGERENC_ATUAL1 AND CG.cod_cgerenc2 = M.COD_CGERENC_ATUAL2 AND CG.cod_cgerenc3 = M.COD_CGERENC_ATUAL3 AND CG.cod_cgerenc4 = M.COD_CGERENC_ATUAL4 AND CG.cod_cgerenc5 = M.COD_CGERENC_ATUAL5 AND CG.cod_cgerenc6 = M.COD_CGERENC_ATUAL6 

LEFT OUTER JOIN
(
SELECT 
CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO_CONTRATO, CONSIDERACOES CENARIO_EXECUTADO, CAMPO_VALOR_2 COD_SIT_FUNCIONAL, CAMPO_VALOR_3 SIT_FUNCIONAL, CAMPO_VALOR_4 DATA_INICIO, CAMPO_VALOR_5 DATA_FIM, CAMPO_VALOR_6 PROXIMA_COD_SIT_FUNCIONAL, CAMPO_VALOR_7 PROXIMA_SIT_FUNCIONAL, CAMPO_VALOR_8 PROXIMA_DATA_INICIO, CAMPO_VALOR_9 PROXIMA_DATA_FIM , CAMPO_VALOR_10 V_SIT_FUNC_ATIVA_VINCULO
,CAMPO_VALOR_11 OBS_PARA_KELLYSSON, CAMPO_VALOR_12 OBS_CRF
FROM SUGESP_AJUSTE_LOTE_CAMPO_HIST WHERE CODIGO_EMPRESA IN('0001','0002','0003','0013','0014') AND CAMPO_VALOR_1 = 'LOG EXECUCAO PROCEDURE PR_ACERTO_LACUNAS_SIT_FUNC_2022' 
AND (CAMPO_VALOR_11 IS NOT NULL OR CAMPO_VALOR_12 IS NOT NULL)
AND TRUNC(DATA_DADOS) = 
(SELECT TRUNC(MAX(DATA_DADOS)) FROM SUGESP_AJUSTE_LOTE_CAMPO_HIST WHERE CAMPO_VALOR_1 = 'LOG EXECUCAO PROCEDURE PR_ACERTO_LACUNAS_SIT_FUNC_2022'
AND CAMPO_VALOR_1 = 'LOG EXECUCAO PROCEDURE PR_ACERTO_LACUNAS_SIT_FUNC_2022' AND (CAMPO_VALOR_11 IS NOT NULL OR CAMPO_VALOR_12 IS NOT NULL))
)OBS ON OBS.CODIGO_EMPRESA = X2.CODIGO_EMPRESA AND OBS.TIPO_CONTRATO = X2.TIPO_CONTRATO AND OBS.CODIGO_CONTRATO = X2.CODIGO_CONTRATO AND OBS.DATA_INICIO = X2.DATA_INICIO

--SO_GERA_SIT_PONTO	CONTROLE_FOLHA	E_AFASTAMENTO	SUSPENDE_REMUNERA	TEM_QTDE_DIAS_PROXIMO	
LEFT OUTER JOIN RHPARM_SIT_FUNC SF ON SF.CODIGO = X2.COD_SIT_FUNCIONAL
--PROXIMO_CONTROLE_FOLHA	PROXIMO_E_AFASTAMENTO	PROXIMO_SUSPENDE_REMUNERA	
LEFT OUTER JOIN RHPARM_SIT_FUNC SFP ON SFP.CODIGO = X2.PROXIMA_COD_SIT_FUNCIONAL

WHERE
CT.ANO_MES_REFERENCIA = (SELECT MAX(AUX.ANO_MES_REFERENCIA) FROM RHPESS_CONTRATO AUX  WHERE AUX.CODIGO_EMPRESA = CT.CODIGO_EMPRESA AND AUX.TIPO_CONTRATO = CT.TIPO_CONTRATO AND AUX.CODIGO = CT.CODIGO)  
ORDER BY OBS.OBS_PARA_KELLYSSON, OBS.OBS_CRF, X2.CODIGO_EMPRESA, X2.TIPO_CONTRATO, X2.CODIGO_CONTRATO, X2.DATA_INICIO

--)X3 GROUP BY X3.TIPO_REGISTRO, X3.CENARIO_EXECUTADO ORDER BY X3.TIPO_REGISTRO, X3.CENARIO_EXECUTADO--sintetico


)
LOOP

INSERT INTO SUGESP_AJUSTE_LOTE_CAMPO_HIST
(CAMPO_VALOR_1, DATA_DADOS, CONSIDERACOES)
VALUES('RELATORIO EXECUCAO PROCEDURE PR_ACERTO_LACUNAS_SIT_FUNC_2022',SYSDATE,
--'OBS_PARA_KELLYSSON|OBS_CRF|ORDEM_REGISTRO|DADOS_ALT_SIT_FUNC|TIPO_REGISTRO|IDADE_REG_EM_DIAS|CODIGO_EMPRESA|TIPO_CONTRATO|CODIGO_CONTRATO|CENARIO_EXECUTADO|COD_SIT_FUNCIONAL|SIT_FUNCIONAL|DATA_INICIO|DATA_FIM|PROXIMA_COD_SIT_FUNCIONAL|PROXIMA_SIT_FUNCIONAL|PROXIMA_DATA_INICIO|PROXIMA_DATA_FIM|V_SIT_FUNC_ATIVA_VINCULO|DADOS_MOVIMENTACAO|TIPO_CESSAO|COD_MOVIMENTACAO|DESCRICAO|DT_INICIO_MOVIMENT|DT_FIM_MOVIMENT|ORGAO|COD_LOTACAO_ATUAL1|COD_LOTACAO_ATUAL2|COD_LOTACAO_ATUAL3|COD_LOTACAO_ATUAL4|COD_LOTACAO_ATUAL5|COD_LOTACAO_ATUAL6|LOTACAO|COD_UNIDADE_ATUAL1|COD_UNIDADE_ATUAL2|COD_UNIDADE_ATUAL3|COD_UNIDADE_ATUAL4|COD_UNIDADE_ATUAL5|COD_UNIDADE_ATUAL6|UNIDADE|COD_CCONTAB_ATUAL1|COD_CCONTAB_ATUAL2|COD_CCONTAB_ATUAL3|COD_CCONTAB_ATUAL4|COD_CCONTAB_ATUAL5|COD_CCONTAB_ATUAL6|CUSTO_CONTABIL|COD_CGERENC_ATUAL1|COD_CGERENC_ATUAL2|COD_CGERENC_ATUAL3|COD_CGERENC_ATUAL4|COD_CGERENC_ATUAL5|COD_CGERENC_ATUAL6|CUSTO_GERENCIAL'
C2.OBS_PARA_KELLYSSON||'|'||C2.OBS_CRF||'|'||C2.ORDEM_REGISTRO||'|'||C2.DADOS_ALT_SIT_FUNC||'|'||C2.TIPO_REGISTRO||'|'||C2.IDADE_REG_EM_DIAS||'|'||C2.CODIGO_EMPRESA||'|'||C2.TIPO_CONTRATO||'|'||C2.CODIGO_CONTRATO||'|'||C2.CENARIO_EXECUTADO||'|'||C2.COD_SIT_FUNCIONAL||'|'||C2.SIT_FUNCIONAL||'|'||C2.DATA_INICIO||'|'||C2.DATA_FIM||'|'||C2.PROXIMA_COD_SIT_FUNCIONAL||'|'||C2.PROXIMA_SIT_FUNCIONAL||'|'||C2.PROXIMA_DATA_INICIO||'|'||C2.PROXIMA_DATA_FIM||'|'||C2.V_SIT_FUNC_ATIVA_VINCULO||'|'||C2.DADOS_MOVIMENTACAO||'|'||C2.TIPO_CESSAO||'|'||C2.COD_MOVIMENTACAO||'|'||C2.DESCRICAO||'|'||C2.DT_INICIO_MOVIMENT||'|'||C2.DT_FIM_MOVIMENT||'|'||C2.ORGAO||'|'||C2.COD_LOTACAO_ATUAL1||'|'||C2.COD_LOTACAO_ATUAL2||'|'||C2.COD_LOTACAO_ATUAL3||'|'||C2.COD_LOTACAO_ATUAL4||'|'||C2.COD_LOTACAO_ATUAL5||'|'||C2.COD_LOTACAO_ATUAL6||'|'||C2.LOTACAO||'|'||C2.COD_UNIDADE_ATUAL1||'|'||C2.COD_UNIDADE_ATUAL2||'|'||C2.COD_UNIDADE_ATUAL3||'|'||C2.COD_UNIDADE_ATUAL4||'|'||C2.COD_UNIDADE_ATUAL5||'|'||C2.COD_UNIDADE_ATUAL6||'|'||C2.UNIDADE||'|'||C2.COD_CCONTAB_ATUAL1||'|'||C2.COD_CCONTAB_ATUAL2||'|'||C2.COD_CCONTAB_ATUAL3||'|'||C2.COD_CCONTAB_ATUAL4||'|'||C2.COD_CCONTAB_ATUAL5||'|'||C2.COD_CCONTAB_ATUAL6||'|'||C2.CUSTO_CONTABIL||'|'||C2.COD_CGERENC_ATUAL1||'|'||C2.COD_CGERENC_ATUAL2||'|'||C2.COD_CGERENC_ATUAL3||'|'||C2.COD_CGERENC_ATUAL4||'|'||C2.COD_CGERENC_ATUAL5||'|'||C2.COD_CGERENC_ATUAL6||'|'||C2.CUSTO_GERENCIAL||'|'||C2.COLUNAS_PARA_FAZER_MAPEAMENTO||'|'||C2.SO_GERA_SIT_PONTO||'|'||C2.CONTROLE_FOLHA||'|'||C2.E_AFASTAMENTO||'|'||C2.SUSPENDE_REMUNERA||'|'||C2.QTDE_DIAS_PROXIMO||'|'||C2.PROXIMO_CONTROLE_FOLHA||'|'||C2.PROXIMO_E_AFASTAMENTO||'|'||C2.PROXIMO_SUSPENDE_REMUNERA
);COMMIT;

END LOOP; --FIM C2
---FIM-------------------------------------------------------------------------PRIMEIRA PARTE------------------------------GERAR O RELATORIO (relat_PR_ACERTOS_ALT_SIT_FUNC_2022.sql)-----------------------------------------------------------------------------------


END;


END;

--/SHOW ERRORS;