
  CREATE OR REPLACE EDITIONABLE PROCEDURE "ARTERH"."PR_CARGA_INICIAL_USER_P_SIST" (vCOD_EMPRESA IN CHAR)
/*
  Descricao.....: PROCEDURE RESPONSÁVEL PELA GERAÇÃO DA CARGA INICIAL NA TABELA DO ARTERH RHUSER_P_SIST
  Autor.........: MARCELO SOARES
  Data.........: 06/04/2022
  Parametros....: INFORMAR QUAL É O CODIGO DA EMPRESA QUE DESEJA EXECUTAR A CARGA INICIAL
*/
IS
    -- DECLARAÇÃO DE VARIÁVEIS
	V_LOGIN_PADRAO			 	VARCHAR(15);
	V_STATUS_PADRAO			 	VARCHAR(1);
	V_COD_GRUPO_PADRAO		 	VARCHAR(4);
	V_USUARIO_PADRAO         	VARCHAR(40);

	V_QTD_REGISTRO           	INTEGER;
    V_EXISTE                 	INTEGER;		

	V_SENHA_USUARIO_P_SIST	 	VARCHAR(60);
	V_INSERE					BOOLEAN;

    V_CONTRATO_USUARIO          VARCHAR(15); 
    V_PESSOA_USUARIO            VARCHAR(15);
    V_NOME_USUARIO              VARCHAR(70);
    V_STATUS_USUARIO            VARCHAR(1);
    V_SENHA_USUARIO             VARCHAR(60);
BEGIN    
	FOR I IN (  SELECT 	DISTINCT CNT.CODIGO_EMPRESA,
                        CNT.TIPO_CONTRATO,
                        CNT.CODIGO AS MATRICULA,
						CASE 
							-- PBH LOGIN COM 6 DIGITOS
							WHEN CNT.CODIGO_EMPRESA = '0001' AND CNT.TIPO_CONTRATO = '0001' AND CNT.VINCULO <> '0009' THEN 'pr' || LOWER(SUBSTR(CNT.CODIGO,9,6))
							-- PBH LOGIN ESTAGIÁRIO COM 6 DIGITOS
							WHEN CNT.CODIGO_EMPRESA = '0001' AND CNT.TIPO_CONTRATO = '0001' AND CNT.VINCULO = '0009' THEN 'pres' || LOWER(SUBSTR(CNT.CODIGO,9,6))
							-- CONTRATOS PBH LOGIN COM 7 DIGITOS INCLUINDO O DV
							WHEN CNT.CODIGO_EMPRESA = '0001' AND CNT.TIPO_CONTRATO = '0098' THEN 'prcp' || LOWER(SUBSTR(CNT.CODIGO,9,7))
							-- CONTRATOS SA LOGIN COM 7 DIGITOS INCLUINDO O DV
							WHEN CNT.CODIGO_EMPRESA = '0001' AND NVL(CNT.C_LIVRE_SELEC02,0) IN (21,0) AND CNT.TIPO_CONTRATO <> '0015' THEN 'prct' || LOWER(SUBSTR(CNT.CODIGO,9,7))
							-- ZOONOZES LOGIN COM 7 DIGITOS INCLUINDO O DV
							WHEN CNT.CODIGO_EMPRESA = '0001' AND NVL(CNT.C_LIVRE_SELEC02,0) =  32     AND CNT.TIPO_CONTRATO <> '0015' THEN 'przo' || LOWER(SUBSTR(CNT.CODIGO,9,7))
							-- SAUDE LOGIN COM 7 DIGITOS INCLUINDO O DV
							WHEN CNT.CODIGO_EMPRESA = '0001' AND NVL(CNT.C_LIVRE_SELEC02,0) =  0      AND CNT.TIPO_CONTRATO  = '0015' THEN 'prsa' || LOWER(SUBSTR(CNT.CODIGO,9,7))

							-- PRODABEL LOGIN COM 6 DIGITOS
							WHEN CNT.CODIGO_EMPRESA = '0002' AND CNT.VINCULO <> '0009' THEN 'pb' || LOWER(SUBSTR(CNT.CODIGO,9,6))
							-- PRODABEL LOGIN ESTAGIÁRIO COM 6 DIGITOS
							WHEN CNT.CODIGO_EMPRESA = '0002' AND CNT.VINCULO = '0009' THEN 'pbes' || LOWER(SUBSTR(CNT.CODIGO,9,6))

							-- SUDECAP LOGIN COM 6 DIGITOS
							WHEN CNT.CODIGO_EMPRESA = '0003' AND CNT.VINCULO <> '0009' THEN 'st' || LOWER(SUBSTR(CNT.CODIGO,9,6))
							-- SUDECAP LOGIN ESTAGIÁRIO COM 6 DIGITOS
							WHEN CNT.CODIGO_EMPRESA = '0003' AND CNT.VINCULO = '0009' THEN 'stes' || LOWER(SUBSTR(CNT.CODIGO,9,6))

							-- SLU LOGIN COM 6 DIGITOS
							WHEN CNT.CODIGO_EMPRESA = '0007' AND CNT.VINCULO <> '0009' THEN 'lu' || LOWER(SUBSTR(CNT.CODIGO,9,6))
							-- SLU LOGIN ESTAGIÁRIO COM 6 DIGITOS
							WHEN CNT.CODIGO_EMPRESA = '0007' AND CNT.VINCULO = '0009' THEN 'lues' || LOWER(SUBSTR(CNT.CODIGO,9,6))

							-- BELOTUR LOGIN COM 6 DIGITOS
							WHEN CNT.CODIGO_EMPRESA = '0009' AND CNT.VINCULO <> '0009' THEN 'bl' || LOWER(SUBSTR(CNT.CODIGO,9,6))
							-- BELOTUR LOGIN ESTAGIÁRIO COM 6 DIGITOS
							WHEN CNT.CODIGO_EMPRESA = '0009' AND CNT.VINCULO = '0009' THEN 'bles' || LOWER(SUBSTR(CNT.CODIGO,9,6))

							-- URBEL LOGIN COM 6 DIGITOS
							WHEN CNT.CODIGO_EMPRESA = '0010' AND CNT.VINCULO <> '0009' THEN 'ur' || LOWER(SUBSTR(CNT.CODIGO,9,6))
							-- URBEL LOGIN ESTAGIÁRIO COM 6 DIGITOS
							WHEN CNT.CODIGO_EMPRESA = '0010' AND CNT.VINCULO = '0009' THEN 'ures' || LOWER(SUBSTR(CNT.CODIGO,9,6))

							-- FMC LOGIN COM 6 DIGITOS
							WHEN CNT.CODIGO_EMPRESA = '0013' AND CNT.VINCULO <> '0009' THEN 'fc' || LOWER(SUBSTR(CNT.CODIGO,9,6))
							-- FMC LOGIN ESTAGIÁRIO COM 6 DIGITOS
							WHEN CNT.CODIGO_EMPRESA = '0013' AND CNT.VINCULO = '0009' THEN 'fces' || LOWER(SUBSTR(CNT.CODIGO,9,6))

							-- FMP LOGIN COM 6 DIGITOS
							WHEN CNT.CODIGO_EMPRESA = '0014' AND CNT.VINCULO <> '0009' THEN 'fp' || LOWER(SUBSTR(CNT.CODIGO,9,6))
							-- FMP LOGIN ESTAGIÁRIO COM 6 DIGITOS
							WHEN CNT.CODIGO_EMPRESA = '0014' AND CNT.VINCULO = '0009' THEN 'fpes' || LOWER(SUBSTR(CNT.CODIGO,9,6))
						ELSE
							'NÃO DEFINIDA'
						END LOGIN_6,
						CASE
							-- PBH LOGIN COM 6 DIGITOS + DV
							WHEN CNT.CODIGO_EMPRESA = '0001' AND CNT.TIPO_CONTRATO = '0001' AND CNT.VINCULO <> '0009' THEN 'pr' || LOWER(SUBSTR(CNT.CODIGO,9,7))
							-- PBH LOGIN ESTAGIÁRIO COM 6 DIGITOS + DV
							WHEN CNT.CODIGO_EMPRESA = '0001' AND CNT.TIPO_CONTRATO = '0001' AND CNT.VINCULO = '0009' THEN 'pres' || LOWER(SUBSTR(CNT.CODIGO,9,7))
							-- CONTRATOS PBH LOGIN COM 6 DIGITOS + DV
							WHEN CNT.CODIGO_EMPRESA = '0001' AND CNT.TIPO_CONTRATO = '0098' THEN 'prcp' || LOWER(SUBSTR(CNT.CODIGO,9,7))
							-- CONTRATOS SA LOGIN COM 6 DIGITOS + DV
							WHEN CNT.CODIGO_EMPRESA = '0001' AND NVL(CNT.C_LIVRE_SELEC02,0) IN (21,0) AND CNT.TIPO_CONTRATO <> '0015' THEN 'prct' || LOWER(SUBSTR(CNT.CODIGO,9,7))
							-- ZOONOZES LOGIN COM 6 DIGITOS + DV
							WHEN CNT.CODIGO_EMPRESA = '0001' AND NVL(CNT.C_LIVRE_SELEC02,0) =  32     AND CNT.TIPO_CONTRATO <> '0015' THEN 'przo' || LOWER(SUBSTR(CNT.CODIGO,9,7))
							-- SAUDE LOGIN COM 6 DIGITOS + DV
							WHEN CNT.CODIGO_EMPRESA = '0001' AND NVL(CNT.C_LIVRE_SELEC02,0) =  0      AND CNT.TIPO_CONTRATO  = '0015' THEN 'prsa' || LOWER(SUBSTR(CNT.CODIGO,9,7))

							-- PRODABEL LOGIN COM 6 DIGITOS + DV
							WHEN CNT.CODIGO_EMPRESA = '0002' AND CNT.VINCULO <> '0009' THEN 'pb' || LOWER(SUBSTR(CNT.CODIGO,9,7))
							-- PRODABEL LOGIN ESTAGIÁRIO 6 DIGITOS + DV
							WHEN CNT.CODIGO_EMPRESA = '0002' AND CNT.VINCULO = '0009' THEN 'pbes' || LOWER(SUBSTR(CNT.CODIGO,9,7))

							-- SUDECAP LOGIN COM 6 DIGITOS + DV
							WHEN CNT.CODIGO_EMPRESA = '0003' AND CNT.VINCULO <> '0009' THEN 'st' || LOWER(SUBSTR(CNT.CODIGO,9,7))
							-- SUDECAP LOGIN ESTAGIÁRIO 6 DIGITOS + DV
							WHEN CNT.CODIGO_EMPRESA = '0003' AND CNT.VINCULO = '0009' THEN 'stes' || LOWER(SUBSTR(CNT.CODIGO,9,7))

							-- SLU LOGIN COM 6 DIGITOS + DV
							WHEN CNT.CODIGO_EMPRESA = '0007' AND CNT.VINCULO <> '0009' THEN 'lu' || LOWER(SUBSTR(CNT.CODIGO,9,7))
							-- SLU LOGIN ESTAGIÁRIO COM 6 DIGITOS + DV
							WHEN CNT.CODIGO_EMPRESA = '0007' AND CNT.VINCULO = '0009' THEN 'lues' || LOWER(SUBSTR(CNT.CODIGO,9,7))

							-- BELOTUR LOGIN COM 6 DIGITOS + DV
							WHEN CNT.CODIGO_EMPRESA = '0009' AND CNT.VINCULO <> '0009' THEN 'bl' || LOWER(SUBSTR(CNT.CODIGO,9,7))
							-- BELOTUR LOGIN ESTAGIÁRIO COM 6 DIGITOS + DV
							WHEN CNT.CODIGO_EMPRESA = '0009' AND CNT.VINCULO = '0009' THEN 'bles' || LOWER(SUBSTR(CNT.CODIGO,9,7))

							-- URBEL LOGIN COM 6 DIGITOS + DV
							WHEN CNT.CODIGO_EMPRESA = '0010' AND CNT.VINCULO <> '0009' THEN 'ur' || LOWER(SUBSTR(CNT.CODIGO,9,7))
							-- URBEL LOGIN ESTAGIÁRIO COM 6 DIGITOS + DV
							WHEN CNT.CODIGO_EMPRESA = '0010' AND CNT.VINCULO = '0009' THEN 'ures' || LOWER(SUBSTR(CNT.CODIGO,9,7))

							-- FMC LOGIN COM 6 DIGITOS + DV
							WHEN CNT.CODIGO_EMPRESA = '0013' AND CNT.VINCULO <> '0009' THEN 'fc' || LOWER(SUBSTR(CNT.CODIGO,9,7))
							-- FMC LOGIN ESTAGIÁRIO COM 6 DIGITOS + DV
							WHEN CNT.CODIGO_EMPRESA = '0013' AND CNT.VINCULO = '0009' THEN 'fces' || LOWER(SUBSTR(CNT.CODIGO,9,7))

							-- FMP LOGIN COM 6 DIGITOS + DV
							WHEN CNT.CODIGO_EMPRESA = '0014' AND CNT.VINCULO <> '0009' THEN 'fp' || LOWER(SUBSTR(CNT.CODIGO,9,7))
							-- FMP LOGIN ESTAGIÁRIO COM 6 DIGITOS + DV
							WHEN CNT.CODIGO_EMPRESA = '0014' AND CNT.VINCULO = '0009' THEN 'fpes' || LOWER(SUBSTR(CNT.CODIGO,9,7))
						ELSE
							'NÃO DEFINIDA'
						END LOGIN_DV,
						CASE
							-- PBH LOGIN COM 8 DIGITOS
							WHEN CNT.CODIGO_EMPRESA = '0001' AND CNT.TIPO_CONTRATO = '0001' AND CNT.VINCULO <> '0009' THEN 'pr' || LOWER(SUBSTR(CNT.CODIGO,7,8))
							-- PBH LOGIN ESTAGIÁRIO COM 8 DIGITOS
							WHEN CNT.CODIGO_EMPRESA = '0001' AND CNT.TIPO_CONTRATO = '0001' AND CNT.VINCULO = '0009' THEN 'pres' || LOWER(SUBSTR(CNT.CODIGO,7,8))        
						ELSE
							'NÃO DEFINIDA'
						END LOGIN_8,						
						PS.CODIGO_USUARIO AS USUARIO_P_SIST,
						PS.C_LIVRE_OPCAO01 AS GERADO_NOVO_PROC,
						CNT.CODIGO_PESSOA,
						CNT.NOME,
						PE.CPF,						
						CNT.SITUACAO_FUNCIONAL as CODIGO_SITUACAO_FUNCIONAL,
						SF.DESCRICAO AS SITUACAO_FUNCIONAL,
						CNT.VINCULO,
						CNT.DATA_ADMISSAO,
						CNT.DATA_RESCISAO
				FROM 	RHPESS_CONTRATO CNT 
						INNER JOIN RHPESS_PESSOA PE ON PE.CODIGO = CNT.CODIGO_PESSOA 
												   AND PE.CODIGO_EMPRESA = CNT.CODIGO_EMPRESA
						LEFT JOIN RHPARM_SIT_FUNC SF ON CNT.SITUACAO_FUNCIONAL = SF.CODIGO
						LEFT JOIN ( SELECT * 
									FROM  RHUSER_P_SIST
									WHERE RHUSER_P_SIST.CODIGO_USUARIO NOT LIKE '%apb'
									AND   RHUSER_P_SIST.CODIGO_USUARIO NOT LIKE '%recadastramento'
									AND   RHUSER_P_SIST.CODIGO_USUARIO NOT LIKE '%b' ) PS ON CNT.CODIGO         = PS.CONTRATO_USUARIO  
																						 AND CNT.CODIGO_EMPRESA = PS.EMPRESA_USUARIO 
																						 AND CNT.TIPO_CONTRATO  = PS.TP_CONTR_USUARIO 
				WHERE CNT.ANO_MES_REFERENCIA = ( SELECT MAX(ANO_MES_REFERENCIA)
												 FROM  RHPESS_CONTRATO AUX
												 WHERE AUX.CODIGO_EMPRESA = CNT.CODIGO_EMPRESA
												 AND   AUX.TIPO_CONTRATO  = CNT.TIPO_CONTRATO
												 AND   AUX.CODIGO         = CNT.CODIGO)
				AND CNT.CODIGO_EMPRESA = vCOD_EMPRESA
				AND (   CNT.TIPO_CONTRATO = (CASE WHEN vCOD_EMPRESA	= '0001' THEN '0001' ELSE '0' END)
					 OR CNT.TIPO_CONTRATO = (CASE WHEN vCOD_EMPRESA = '0001' THEN '0015' ELSE '0' END)
					 OR CNT.TIPO_CONTRATO = (CASE WHEN vCOD_EMPRESA = '0001' THEN '0098' ELSE '0' END)
					 OR CNT.TIPO_CONTRATO = (CASE WHEN vCOD_EMPRESA = '0001' THEN '0211' ELSE '0' END)
					 OR CNT.TIPO_CONTRATO = (CASE WHEN vCOD_EMPRESA = '0001' THEN '0212' ELSE '0' END)
					 OR CNT.TIPO_CONTRATO = (CASE WHEN vCOD_EMPRESA = '0001' THEN '0213' ELSE '0' END)
					 OR CNT.TIPO_CONTRATO = (CASE WHEN vCOD_EMPRESA = '0001' THEN '0214' ELSE '0' END)
					 OR CNT.TIPO_CONTRATO = (CASE WHEN vCOD_EMPRESA = '0001' THEN '0215' ELSE '0' END)     
					 OR CNT.TIPO_CONTRATO = (CASE WHEN vCOD_EMPRESA = '0002' THEN '0001' ELSE '0' END)
					 OR CNT.TIPO_CONTRATO = (CASE WHEN vCOD_EMPRESA = '0002' THEN '0003' ELSE '0' END)     
					 OR CNT.TIPO_CONTRATO = (CASE WHEN vCOD_EMPRESA = '0003' THEN '0001' ELSE '0' END)
					 OR CNT.TIPO_CONTRATO = (CASE WHEN vCOD_EMPRESA = '0003' THEN '0002' ELSE '0' END)     
					 OR CNT.TIPO_CONTRATO = (CASE WHEN vCOD_EMPRESA = '0007' THEN '0001' ELSE '0' END)
					 OR CNT.TIPO_CONTRATO = (CASE WHEN vCOD_EMPRESA = '0007' THEN '0002' ELSE '0' END)     
					 OR CNT.TIPO_CONTRATO = (CASE WHEN vCOD_EMPRESA = '0007' THEN '0003' ELSE '0' END)     
					 OR CNT.TIPO_CONTRATO = (CASE WHEN vCOD_EMPRESA = '0009' THEN '0001' ELSE '0' END)
					 OR CNT.TIPO_CONTRATO = (CASE WHEN vCOD_EMPRESA = '0009' THEN '0003' ELSE '0' END)     
					 OR CNT.TIPO_CONTRATO = (CASE WHEN vCOD_EMPRESA = '0010' THEN '0001' ELSE '0' END)
					 OR CNT.TIPO_CONTRATO = (CASE WHEN vCOD_EMPRESA = '0010' THEN '0003' ELSE '0' END)     
					 OR CNT.TIPO_CONTRATO = (CASE WHEN vCOD_EMPRESA = '0010' THEN '0098' ELSE '0' END)     
					 OR CNT.TIPO_CONTRATO = (CASE WHEN vCOD_EMPRESA = '0013' THEN '0001' ELSE '0' END)
					 OR CNT.TIPO_CONTRATO = (CASE WHEN vCOD_EMPRESA = '0013' THEN '0003' ELSE '0' END)     
					 OR CNT.TIPO_CONTRATO = (CASE WHEN vCOD_EMPRESA = '0014' THEN '0001' ELSE '0' END)
					 OR CNT.TIPO_CONTRATO = (CASE WHEN vCOD_EMPRESA = '0014' THEN '0003' ELSE '0' END))
				AND PS.CODIGO_USUARIO is null
				AND CNT.CODIGO > (CASE WHEN vCOD_EMPRESA = '0001' THEN '000000000000016' ELSE '0' END)
				ORDER BY 2,3)
	LOOP
		-- VALIDA O LOGIN PADRAO A SER GRAVADO NA RHUSER_P_SIST
		IF vCOD_EMPRESA = '0001' AND I.TIPO_CONTRATO = '0001' THEN
			-- VERIFICA SE A ADMISSÃO É MENOR QUE 2019 PARA UTILIZAR O LOGIN COM 6 DIGITOS
			IF TRUNC(I.DATA_ADMISSAO) < TO_DATE('01/01/2019','DD/MM/YYYY') THEN
				V_LOGIN_PADRAO := I.LOGIN_6;
            ELSE
				V_LOGIN_PADRAO := I.LOGIN_8;
			END IF;
        ELSE
			V_LOGIN_PADRAO := I.LOGIN_6;
		END IF;

        -- VALIDA DATA RESCISAO PARA GRAVAR INFORMACAO NO CAMPO STATUS DA RHUSER_P_SIST 
		IF I.DATA_RESCISAO IS NULL THEN 
			V_STATUS_PADRAO    := 'A'; 
			V_COD_GRUPO_PADRAO := 'SOGD'; 
		ELSE 
			V_STATUS_PADRAO    := 'E'; 
			V_COD_GRUPO_PADRAO := '0070'; 
		END IF;

		V_LOGIN_PADRAO   := LOWER(TRIM(V_LOGIN_PADRAO));
		V_USUARIO_PADRAO := 'CARGA_INICIAL_MARCELO';
		V_INSERE		 := FALSE;

		-- VALIDA SE O LOGIN EXISTE NA RHUSER_P_SIST E SE É DO MESMO FUNCIONARIO
		SELECT COUNT(*) INTO V_QTD_REGISTRO FROM ARTERH.RHUSER_P_SIST U WHERE LOWER(U.CODIGO_USUARIO) = V_LOGIN_PADRAO; 

        IF V_QTD_REGISTRO = 0 THEN
            V_INSERE := TRUE;
        ELSE
           SELECT DISTINCT CONTRATO_USUARIO, PESSOA_USUARIO, NOME_USUARIO, STATUS_USUARIO,SENHA_USUARIO INTO
                         V_CONTRATO_USUARIO, V_PESSOA_USUARIO, V_NOME_USUARIO, V_STATUS_USUARIO, V_SENHA_USUARIO
           FROM ARTERH.RHUSER_P_SIST U WHERE LOWER(U.CODIGO_USUARIO) = V_LOGIN_PADRAO;

           CASE
               WHEN TRIM(I.MATRICULA) <> TRIM(V_CONTRATO_USUARIO) AND TRIM(I.CODIGO_PESSOA) <> TRIM(V_PESSOA_USUARIO) AND TRIM(I.NOME) <> TRIM(V_NOME_USUARIO) THEN
                   -- MESMO LOGIN PARA PESSOAS DIFERENTES -> INSERIR UTILIZANDO LOGIN + DV
			       V_LOGIN_PADRAO  := LOWER(TRIM(I.LOGIN_DV));
				   V_INSERE 		:= TRUE;
               WHEN TRIM(I.MATRICULA) <> TRIM(V_CONTRATO_USUARIO) AND TRIM(I.CODIGO_PESSOA) <> TRIM(V_PESSOA_USUARIO) AND TRIM(I.NOME) = TRIM(V_NOME_USUARIO) THEN
                   -- MESMA PESSOA PARA LOGIN DIFERENTES -> INSERIR UTILIZANDO LOGIN + DV
			       V_LOGIN_PADRAO  := LOWER(TRIM(I.LOGIN_DV));
				   V_INSERE 		:= TRUE;
               WHEN TRIM(I.MATRICULA) <> TRIM(V_CONTRATO_USUARIO) AND TRIM(I.CODIGO_PESSOA) = TRIM(V_PESSOA_USUARIO) AND TRIM(I.NOME) = TRIM(V_NOME_USUARIO) THEN
                   -- MESMA PESSOA PARA LOGIN DIFERENTES -> INSERIR UTILIZANDO LOGIN + DV
			       V_LOGIN_PADRAO  := LOWER(TRIM(I.LOGIN_DV));
				   V_INSERE 		:= TRUE;

           ELSE    
		     	-- LOGIN QUE PRECISA SER ALTERADO
				V_INSERE := FALSE;
				IF V_STATUS_USUARIO = 'E' THEN 
					V_SENHA_USUARIO_P_SIST := 'gap'; 
				ELSE 
					V_SENHA_USUARIO_P_SIST := V_SENHA_USUARIO;
				END IF;
           END CASE;
        END IF;

        IF V_INSERE THEN
            -- INCLUI NOVO REGISTRO
            INSERT INTO ARTERH.RHUSER_P_SIST (CODIGO_USUARIO,          GERA_LOG,                USA_JANELA_ACOMP,        DT_M_OPER_PROPRIO,       DATA_SISTEMA,
                                              ANO_BASE,                USA_SAL_PRINCIPAL,       MODO_OPER_MOVI,          CTRL_OPER_AUXILIAR,      MODO_OPER_TSAL,
                                              MODO_OPER_PONTO,         EMPR_TP_CONTR_PROP,      EMPRESA_SELEC,           TIPO_CONTR_SELEC,        LOGIN_USUARIO,
		    								  DT_ULT_ALTER_USUA,       ALT_MOV_LIQUIDO,         COD_PAD_CONTRATO,        MSG_PARA_ARQ_TEXTO,      EXIBE_IDENT_TABELA,
                                              USA_DELIMIT_EXPORT,      DELIMITADOR_EXPORT,      EXPORT_NRO_REAL,         ALT_MV_PT_DT_RETRO,      USA_COD_ALTER_VERB,
                                              CODIGO_GRUPO,            GRUPO_SEL_CONTRATO,      GRUPO_SEL_PESSOA,        COD_SEL_PESSOA,          GRUPO_SEL_CAND,
		    								  COD_SEL_CANDIDATO,       GRUPO_SEL_VERBA,         COD_SEL_VERBA,           ALT_PROPRIEDADES,        QTDE_MIN_ATIVO,
		    								  PERMITE_INCLUSAO,        PERMITE_EXCLUSAO,        PERMITE_ALTERACAO,       PERMITE_EXECUCAO,        GRUPO_SEL_UNID,
		    								  COD_SEL_UNID,            GRUPO_SEL_CCONT,         COD_SEL_CCONT,           GRUPO_SEL_CGER,          COD_SEL_CGER,
		    								  EMPRESA_USUARIO,         TP_CONTR_USUARIO,        CONTRATO_USUARIO,        PESSOA_USUARIO,          GRUPO_SEL_LOC,
		    								  COD_SEL_LOC,             USA_DT_MAQUINA,          CTRL_ATIVO,              NRO_MOD_SIMULT,          QTDE_REG_AUTO,
		    								  CONSISTE_LANC_VERB,      INSERE_LIQUIDO,          BLOQUEIA_CONTRATO,       BLOQUEIA_PESSOA,         EXIBE_DICA,
		    								  ALT_CONT_DT_RETRO,       ALT_PESS_DT_RETRO,       ALT_DATA_GERAL,          COD_PERIODO,             EDITA_SALARIO,
		    								  NATUR_PROC_SELEC,        GRUPO_SEGURANCA,         MENU_DEF_ENABLED,        MENU_DEF_VISIBLE,        SENHA_USUARIO,
		    								  STATUS_USUARIO,          DT_ULT_TROCA_SENHA,      CODIGO_SGBD_PADRAO,      DIAS_EXPIRA_SENHA,       PW_QTDE_POSIC,
		    								  PW_ALFANUM,              PW_SUBSET_USUA,          PW_QTDE_TENTA,           PW_COMECA_VOGAL,         APLIC_PROPRIEDADES,
		    								  NOME_USUARIO,            CODIGO_IDIOMA,           DIAS_EXP_SEM_ACESS,      DT_ULT_ACESSO,           CT_APLIC_PSEL_CONT,
		    								  CT_APLIC_PSEL_PESS,      C_LIVRE_SELEC01,         C_LIVRE_SELEC02,         C_LIVRE_SELEC03,         C_LIVRE_VALOR01,
		    								  C_LIVRE_VALOR02,         C_LIVRE_VALOR03,         C_LIVRE_DESCR01,         C_LIVRE_DESCR02,         C_LIVRE_DESCR03,
		    								  C_LIVRE_OPCAO01,         C_LIVRE_OPCAO02,         C_LIVRE_OPCAO03,         C_LIVRE_DATA01,          C_LIVRE_DATA02,
		    								  C_LIVRE_DATA03,          ALT_MOV_LIQ_AGRUP,       EXPAND_CAMINHO,          EDITA_GRUPO,             GRAVA_TEMPO_FORM,
		    								  MIN_TESTE_ESCALONA,      ACERTO_BASE_HIST,        MODULO_ACESSADO,         ALT_PONTO_DT_RETRO,      CTRL_ACESSO_IND,
		    								  APELIDO,                 TIPO_AGRUP_USUARIO,      PERMITE_TPAGR_ESP,       DEPURA,                  PW_SUBSET_NOME,
		    								  PW_DATAS_PESSOAIS,       PW_DOCS_PESSOAIS,        USUARIO_LDAP,            TIPO_LOGIN,              CODIGO_SERV_AUTENT,
		    								  INS_MOV_MEST_CONTR,      INS_MOV_MEST_AGRUP,      INS_MOV_MEST_VAGA,       ACESSA_OUTRO_USUA,       MODULO_ACES_WEB,
		    								  ESTACAO_REDE,            LOG_DETALHADO,           PERSISTE_ARG_SEL,        DATA_CRIACAO,            EXEC_INST_ESCALONA,
		    								  PERMITE_EFETIVAR_SQL,    CONTROLE_BPM,            ULTIMO_PERFIL_ACESSO_AZC)
            SELECT 	V_LOGIN_PADRAO,               USR.GERA_LOG,                 USR.USA_JANELA_ACOMP,         USR.DT_M_OPER_PROPRIO,        USR.DATA_SISTEMA,
		    		USR.ANO_BASE,                 USR.USA_SAL_PRINCIPAL,        USR.MODO_OPER_MOVI,           USR.CTRL_OPER_AUXILIAR,       USR.MODO_OPER_TSAL,
		    		USR.MODO_OPER_PONTO,          USR.EMPR_TP_CONTR_PROP,       I.CODIGO_EMPRESA,             I.TIPO_CONTRATO,              V_USUARIO_PADRAO,
		    		USR.DT_ULT_ALTER_USUA,        USR.ALT_MOV_LIQUIDO,          USR.COD_PAD_CONTRATO,         USR.MSG_PARA_ARQ_TEXTO,       USR.EXIBE_IDENT_TABELA,
		    		USR.USA_DELIMIT_EXPORT,       USR.DELIMITADOR_EXPORT,       USR.EXPORT_NRO_REAL,          USR.ALT_MV_PT_DT_RETRO,       USR.USA_COD_ALTER_VERB,
		    		USR.CODIGO_GRUPO,             USR.GRUPO_SEL_CONTRATO,       USR.GRUPO_SEL_PESSOA,         USR.COD_SEL_PESSOA,           USR.GRUPO_SEL_CAND,
		    		USR.COD_SEL_CANDIDATO,        USR.GRUPO_SEL_VERBA,          USR.COD_SEL_VERBA,            USR.ALT_PROPRIEDADES,         USR.QTDE_MIN_ATIVO,
		    		USR.PERMITE_INCLUSAO,         USR.PERMITE_EXCLUSAO,         USR.PERMITE_ALTERACAO,        USR.PERMITE_EXECUCAO,         USR.GRUPO_SEL_UNID,
		    		USR.COD_SEL_UNID,             USR.GRUPO_SEL_CCONT,          USR.COD_SEL_CCONT,            USR.GRUPO_SEL_CGER,           USR.COD_SEL_CGER,
		    		I.CODIGO_EMPRESA,             I.TIPO_CONTRATO,              I.MATRICULA,                  I.CODIGO_PESSOA,              USR.GRUPO_SEL_LOC,
		    		USR.COD_SEL_LOC,              USR.USA_DT_MAQUINA,           USR.CTRL_ATIVO,               USR.NRO_MOD_SIMULT,           USR.QTDE_REG_AUTO,
		    		USR.CONSISTE_LANC_VERB,       USR.INSERE_LIQUIDO,           USR.BLOQUEIA_CONTRATO,        USR.BLOQUEIA_PESSOA,          USR.EXIBE_DICA,
		    		USR.ALT_CONT_DT_RETRO,        USR.ALT_PESS_DT_RETRO,        USR.ALT_DATA_GERAL,           USR.COD_PERIODO,              USR.EDITA_SALARIO,
		    		USR.NATUR_PROC_SELEC,         USR.GRUPO_SEGURANCA,          USR.MENU_DEF_ENABLED,         USR.MENU_DEF_VISIBLE,         USR.SENHA_USUARIO,
		    		V_STATUS_PADRAO,           	  USR.DT_ULT_TROCA_SENHA,       USR.CODIGO_SGBD_PADRAO,       USR.DIAS_EXPIRA_SENHA,        USR.PW_QTDE_POSIC,
		    		USR.PW_ALFANUM,               USR.PW_SUBSET_USUA,           USR.PW_QTDE_TENTA,            USR.PW_COMECA_VOGAL,          USR.APLIC_PROPRIEDADES,
		    		I.NOME,                       USR.CODIGO_IDIOMA,            USR.DIAS_EXP_SEM_ACESS,       USR.DT_ULT_ACESSO,            USR.CT_APLIC_PSEL_CONT,
		    		USR.CT_APLIC_PSEL_PESS,       USR.C_LIVRE_SELEC01,          USR.C_LIVRE_SELEC02,          USR.C_LIVRE_SELEC03,          USR.C_LIVRE_VALOR01,
		    		USR.C_LIVRE_VALOR02,          USR.C_LIVRE_VALOR03,          USR.C_LIVRE_DESCR01,          USR.C_LIVRE_DESCR02,          USR.C_LIVRE_DESCR03,
		    		USR.C_LIVRE_OPCAO01,          USR.C_LIVRE_OPCAO02,          USR.C_LIVRE_OPCAO03,          USR.C_LIVRE_DATA01,           USR.C_LIVRE_DATA02,
		    		USR.C_LIVRE_DATA03,           USR.ALT_MOV_LIQ_AGRUP,        USR.EXPAND_CAMINHO,           USR.EDITA_GRUPO,              USR.GRAVA_TEMPO_FORM,
		    		USR.MIN_TESTE_ESCALONA,       USR.ACERTO_BASE_HIST,         USR.MODULO_ACESSADO,          USR.ALT_PONTO_DT_RETRO,       USR.CTRL_ACESSO_IND,
		    		USR.APELIDO,                  USR.TIPO_AGRUP_USUARIO,       USR.PERMITE_TPAGR_ESP,        USR.DEPURA,                   USR.PW_SUBSET_NOME,
		    		USR.PW_DATAS_PESSOAIS,        USR.PW_DOCS_PESSOAIS,         V_LOGIN_PADRAO,               USR.TIPO_LOGIN,               USR.CODIGO_SERV_AUTENT,
		    		USR.INS_MOV_MEST_CONTR,       USR.INS_MOV_MEST_AGRUP,       USR.INS_MOV_MEST_VAGA,        USR.ACESSA_OUTRO_USUA,        USR.MODULO_ACES_WEB,
		    		USR.ESTACAO_REDE,             USR.LOG_DETALHADO,            USR.PERSISTE_ARG_SEL,         SYSDATE,                      USR.EXEC_INST_ESCALONA,
		    		USR.PERMITE_EFETIVAR_SQL,     USR.CONTROLE_BPM,             USR.ULTIMO_PERFIL_ACESSO_AZC
		    FROM   ARTERH.RHUSER_P_SIST USR
		    	WHERE  USR.CODIGO_USUARIO = 'MODELO';
        ELSE
		   	-- ALTERA REGISTRO EXISTENTE
		   	UPDATE ARTERH.RHUSER_P_SIST	SET	EMPRESA_USUARIO 	= I.CODIGO_EMPRESA,
		   									STATUS_USUARIO  	= V_STATUS_PADRAO,
		   									NOME_USUARIO		= I.NOME,
		   									TP_CONTR_USUARIO	= I.TIPO_CONTRATO,
		   									EMPRESA_SELEC		= I.CODIGO_EMPRESA,
		   									CONTRATO_USUARIO	= I.MATRICULA,
		   									USUARIO_LDAP		= V_LOGIN_PADRAO,
		   									TIPO_CONTR_SELEC	= I.TIPO_CONTRATO,
		   									PESSOA_USUARIO		= I.CODIGO_PESSOA,
		   									DATA_CRIACAO		= TO_DATE(SYSDATE,'DD/MM/YYYY'),
		   									LOGIN_USUARIO		= V_USUARIO_PADRAO,
		   									SENHA_USUARIO		= V_SENHA_USUARIO_P_SIST,
		   									DT_ULT_TROCA_SENHA	= TO_DATE(SYSDATE,'DD/MM/YYYY')											
		   	WHERE  LOWER(CODIGO_USUARIO) = V_LOGIN_PADRAO;
		END IF;

		--  INSERIR REGISTRO NA TABELA: RHUSER_RL_USR_GRP        
        DELETE FROM ARTERH.RHUSER_RL_USR_GRP 
        WHERE LOWER(CODIGO_USUARIO) = V_LOGIN_PADRAO;

        INSERT INTO ARTERH.RHUSER_RL_USR_GRP (CODIGO_USUARIO, CODIGO_GRUPO, LOGIN_USUARIO, DT_ULT_ALTER_USUA)
        VALUES(V_LOGIN_PADRAO, V_COD_GRUPO_PADRAO, V_USUARIO_PADRAO, SYSDATE);

        --  INSERIR REGISTRO NA TABELA: RHUSER_RL_USR_EMP

        DELETE FROM   ARTERH.RHUSER_RL_USR_EMP
        WHERE  LOWER(CODIGO_USUARIO) = V_LOGIN_PADRAO;

        INSERT INTO ARTERH.RHUSER_RL_USR_EMP (CODIGO_USUARIO, CODIGO_EMPRESA, LOGIN_USUARIO, DT_ULT_ALTER_USUA)
        VALUES(V_LOGIN_PADRAO,I.CODIGO_EMPRESA,V_USUARIO_PADRAO, SYSDATE);

        --  INSERIR REGISTRO NA TABELA: RHUSER_USR_TPCONT        
        DELETE FROM   ARTERH.RHUSER_USR_TPCONT
        WHERE  LOWER(CODIGO_USUARIO) = V_LOGIN_PADRAO;

        INSERT INTO ARTERH.RHUSER_USR_TPCONT (CODIGO_USUARIO, TIPO_CONTRATO, LOGIN_USUARIO, DT_ULT_ALTER_USUA)
        VALUES(V_LOGIN_PADRAO, I.TIPO_CONTRATO, V_USUARIO_PADRAO, SYSDATE);
	END LOOP;
    COMMIT;
END PR_CARGA_INICIAL_USER_P_SIST;
