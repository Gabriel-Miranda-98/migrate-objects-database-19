
  CREATE OR REPLACE EDITIONABLE PROCEDURE "PONTO_ELETRONICO"."SMARH_INT_CAD_FOTO_IFPONTO" (DATA_INICIO IN VARCHAR2,DATA_FIM    IN VARCHAR2) AS
BEGIN
DECLARE
vCONTADOR NUMBER;
vDATA_INICIO Varchar2(10);
vDATA_FIM Varchar2(10);
BEGIN
EXECUTE IMMEDIATE ('DELETE FROM PONTO_ELETRONICO.FOTOS_SURICATO_P');
COMMIT;
EXECUTE IMMEDIATE ('INSERT INTO PONTO_ELETRONICO.FOTOS_SURICATO_P  SELECT * FROM SURICATO.TBFOTO@LK_PROD_SUR.PBH');
 COMMIT;
dbms_output.enable(null);
vCONTADOR :=0;
vDATA_INICIO := DATA_INICIO;
vDATA_FIM := DATA_FIM;
FOR C1 IN (
SELECT LPAD(P.CODIEMPR,4,0)   AS CODIGO_EMPRESA ,
  LPAD(P.TIPOCONT,4,0)        AS TIPO_CONTRATO,
  LPAD(P.INTEGRACODIMATR,15,0) AS CODIGO_CONTRATO,
  P.NUMECPF         AS CPF,
  P.APELCOLA        AS NOME,
CASE WHEN FOTO IS NOT NULL AND FOTOP IS NOT NULL THEN FOTOP
 WHEN FOTO IS NOT NULL AND FOTOP IS NULL THEN FOTO
 ELSE NULL
 END AS FOTO ,
FOTO.INCLUSAO AS DATA_INCLUSAO,
  SYSDATE AS DT_SAIU_ARTE,
  NULL AS DT_ENVIADO_IFPONTO_SURICATO
 FROM  SURICATO.TBCOLAB@LK_PROD_SUR.PBH P
 LEFT OUTER JOIN PONTO_ELETRONICO.FOTOS_SURICATO_P FOTO
 ON  P.IDPESSOA=FOTO.IDPESSOA
 WHERE FOTO.FOTO IS NOT NULL
 AND TRUNC(FOTO.INCLUSAO) BETWEEN  vDATA_INICIO AND vDATA_FIM
)LOOP
vCONTADOR:=vCONTADOR+1;
INSERT INTO PONTO_ELETRONICO.FOTOS_SURICATO
(
CODIGO_EMPRESA,
TIPO_CONTRATO,
CODIGO_CONTRATO,
CPF,
NOME,
FOTO,
DATA_INCLUSAO,
DT_SAIU_ARTE,
DT_ENVIADO_IFPONTO_SURICATO
)
VALUES
(C1.CODIGO_EMPRESA,
C1.TIPO_CONTRATO,
C1.CODIGO_CONTRATO,
C1.CPF,
C1.NOME,
C1.FOTO,
C1.DATA_INCLUSAO,
SYSDATE,
NULL);
COMMIT;
END LOOP;

END;
END;