
  CREATE OR REPLACE EDITIONABLE PROCEDURE "ARTERH"."PR_ACERTO_LACUNAS_SIT_FUNC" 
AS
BEGIN


--KELLYSSON EM 6/12/19
DECLARE   
vCONTADOR NUMBER (10); 

BEGIN  
dbms_output.enable(null);
vCONTADOR :=0;
FOR C1 IN ( 


select x2.* from(
SELECT CASE  
WHEN X.CENARIOS = '1-DIMINUI DT FIM DA NORMAL' THEN 'AVISAR GEVIF/GETED: 1-DIMINUI DT FIM DA NORMAL' 
WHEN X.CENARIOS = '2-CRIA PERIODO ENTRE SIT COM 1000' THEN '2-CRIA PERIODO ENTRE SIT COM 1000'
WHEN X.CENARIOS = '3-AUMENTA DATA FIM DA PRIMEIRA 1000' THEN '3-CRIA PERIODO ENTRE SIT COM 1000'
WHEN X.CENARIOS = '4-ALTERA DATA FIM DA NORMAL-AUMENTA' THEN 'AVISAR GEVIF/GETED: 4-ALTERA DATA FIM DA NORMAL-AUMENTA'
WHEN X.CENARIOS = '4-ALTERA DATA FIM DA NORMAL-DIMINUI' THEN 'AVISAR GEVIF/GETED: 4-ALTERA DATA FIM DA NORMAL-DIMINUI'
WHEN X.CENARIOS = '5-FAZER NADA LICENCA AINDA NAO ACABOU' THEN '5-FAZER NADA LICENCA AINDA NAO ACABOU'
WHEN X.CENARIOS = '6-ULTIMO REGISTRO LICENCA JÁ ACABOU VOLTAR PARA 1000-INSERT' THEN '6-ULTIMO REGISTRO LICENCA JÁ ACABOU VOLTAR PARA 1000-INSERT'
WHEN X.CENARIOS = '6-ULTIMO REGISTRO LICENCA JÁ ACABOU VOLTAR PARA 1000-SINALIZAR' THEN 'AVISAR GEVIF/GETED: 6-ULTIMO REGISTRO LICENCA JÁ ACABOU VOLTAR PARA 1000-SINALIZAR' 
WHEN X.CENARIOS = '7-CRIA PERIODO ENTRE SIT COM 1000' THEN '7-CRIA PERIODO ENTRE SIT COM 1000'
WHEN X.CENARIOS = '7-AUMENTAR DATA FIM DA 6008' THEN '7-AUMENTAR DATA FIM DA 6008'
WHEN X.CENARIOS = '8-CONCOMITANCIA DE LICENCAS DEFINIR QUAL ALTERAR' THEN 'AVISAR GEVIF/GETED: 8-CONCOMITANCIA DE LICENCAS DEFINIR QUAL ALTERAR'
WHEN X.CENARIOS = '9-LACUNA DE LICENCAS GRAVAR 1000' THEN '9-LACUNA DE LICENCAS GRAVAR 1000'
WHEN X.CENARIOS = '10-ULTIMO REGISTRO LICENCA JÁ ACABOU VOLTAR PARA ULTIMA ATIVA' THEN '10-ULTIMO REGISTRO LICENCA JÁ ACABOU VOLTAR PARA ULTIMA ATIVA'
WHEN X.CENARIOS = '11-ULTIMO REGISTRO NORMAL COM DATA FIM, TIRAR DATA FIM' THEN '11-ULTIMO REGISTRO NORMAL COM DATA FIM, TIRAR DATA FIM'
WHEN X.CENARIOS = '12-ULTIMA SIT SO_GERA_SIT_PONTO = NADA' THEN '12-RETIRAR DO SCRIPT DE LACUNAS '
WHEN X.CENARIOS = '13 -APAGAR DATA FIM DA ULTIMA SITUAÇÃO FUNCIONAL' THEN '13 -APAGAR DATA FIM DA ULTIMA SITUAÇÃO FUNCIONAL'
WHEN X.CENARIOS = '14- RETIRAR DO SCRIPT DE LACUNAS' THEN '14-RETIRAR DO SCRIPT DE LACUNAS '

WHEN X.CENARIOS = 'NÃO MAPEADO-FAZER AJUSTES MANUALMENTE' THEN 'AVISAR GEVIF/GETED: NÃO MAPEADO-FAZER AJUSTES MANUALMENTE'
END TRATATIVA,

X.* FROM (
SELECT 
S.* 
FROM (
select 
case 
WHEN k.lacunas < 0 and k.controle_folha = 'N' AND K.PROXIMO_CONTROLE_FOLHA IN ('L','M') AND K.TIPO_TRABALHADOR IN ('101','301') AND K.E_AFASTAMENTO = 'N' AND K.SUSPENDE_REMUNERA = 'N' AND K.PROXIMO_E_AFASTAMENTO = 'S' AND K.PROXIMO_SUSPENDE_REMUNERA = 'N'
then '1-DIMINUI DT FIM DA NORMAL'
WHEN 
k.lacunas > 0 and k.controle_folha IN ('L','M') AND K.PROXIMO_CONTROLE_FOLHA IN ('L','M') AND K.TIPO_TRABALHADOR IN ('101','301') AND K.SIT_FUNC_ULT_CONTR = '1000' AND K.E_AFASTAMENTO = 'S' AND K.SUSPENDE_REMUNERA = 'N' AND K.PROXIMO_E_AFASTAMENTO = 'S' AND K.PROXIMO_SUSPENDE_REMUNERA = 'N'
THEN '2-CRIA PERIODO ENTRE SIT COM 1000'
WHEN 
k.lacunas > 0 and k.controle_folha = 'N' AND K.PROXIMO_CONTROLE_FOLHA = 'N' AND K.TIPO_TRABALHADOR IN ('101','301') AND K.SIT_FUNC_ULT_CONTR = '1000' AND K.E_AFASTAMENTO = 'N' AND K.SUSPENDE_REMUNERA = 'N' AND K.PROXIMO_E_AFASTAMENTO = 'N' AND K.PROXIMO_SUSPENDE_REMUNERA = 'N'
THEN '3-AUMENTA DATA FIM DA PRIMEIRA 1000'
WHEN 
k.lacunas > 0 and k.controle_folha = 'N' AND K.PROXIMO_CONTROLE_FOLHA IN ('L','M') AND K.TIPO_TRABALHADOR IN ('101','301') AND K.SIT_FUNC_ULT_CONTR = '1000' AND K.ORDEM_BM <> 1 AND K.E_AFASTAMENTO = 'N' AND K.SUSPENDE_REMUNERA = 'N' AND K.PROXIMO_E_AFASTAMENTO = 'S' AND K.PROXIMO_SUSPENDE_REMUNERA = 'N'
THEN '4-ALTERA DATA FIM DA NORMAL-AUMENTA'
WHEN 
k.lacunas < 0 and k.controle_folha = 'N' AND K.PROXIMO_CONTROLE_FOLHA IN ('L','M') AND K.TIPO_TRABALHADOR IN ('101','301')  AND K.E_AFASTAMENTO = 'N' AND K.SUSPENDE_REMUNERA = 'N' AND K.PROXIMO_E_AFASTAMENTO = 'S' AND K.PROXIMO_SUSPENDE_REMUNERA = 'N'
THEN '4-ALTERA DATA FIM DA NORMAL-DIMINUI'
WHEN 
k.lacunas < 0 and k.controle_folha <> 'N' AND TRUNC(K.DATA_FIM) >= TRUNC(SYSDATE) 
then '5-FAZER NADA LICENCA AINDA NAO ACABOU'
WHEN 
k.lacunas > 0 and k.controle_folha IN ('L','M') AND K.TIPO_TRABALHADOR IN ('101','301') AND K.ORDEM_BM = 1 AND TRUNC(K.DATA_FIM) < TRUNC(SYSDATE) AND K.E_AFASTAMENTO = 'S' AND K.SUSPENDE_REMUNERA = 'N' AND K.PROXIMA_COD_SIT_FUNCIONAL IS NULL AND K.so_gera_sit_ponto = 'NÃO'
THEN '6-ULTIMO REGISTRO LICENCA JÁ ACABOU VOLTAR PARA 1000-INSERT'
WHEN 
k.lacunas > 0 and k.controle_folha IN ('L','M') AND K.TIPO_TRABALHADOR IN ('101','301') AND K.E_AFASTAMENTO = 'S' AND K.SUSPENDE_REMUNERA = 'N' AND K.PROXIMA_COD_SIT_FUNCIONAL IS NULL AND K.so_gera_sit_ponto <> 'NÃO'
THEN '6-ULTIMO REGISTRO LICENCA JÁ ACABOU VOLTAR PARA 1000-SINALIZAR'
WHEN 
k.lacunas > 0 and k.controle_folha IN ('L','M') AND K.PROXIMO_CONTROLE_FOLHA = 'N' AND K.TIPO_TRABALHADOR IN ('101','301') AND K.SIT_FUNC_ULT_CONTR = '1000' AND K.ORDEM_BM <> 1 AND K.DATA_FIM IS NOT NULL AND K.E_AFASTAMENTO = 'S' AND K.SUSPENDE_REMUNERA = 'N' AND K.PROXIMO_E_AFASTAMENTO = 'N' AND K.PROXIMO_SUSPENDE_REMUNERA = 'N'
THEN '7-CRIA PERIODO ENTRE SIT COM 1000'
WHEN 
k.lacunas > 0 and k.controle_folha = 'A' AND K.PROXIMO_CONTROLE_FOLHA = 'N' AND K.TIPO_TRABALHADOR IN ('101','301') AND K.E_AFASTAMENTO = 'N' AND K.SUSPENDE_REMUNERA = 'S' AND K.PROXIMO_E_AFASTAMENTO = 'N' AND K.PROXIMO_SUSPENDE_REMUNERA = 'N'
THEN '7-AUMENTAR DATA FIM DA 6008'
WHEN 
K.LACUNAS < 0 AND k.controle_folha <> 'N' AND k.PROXIMO_controle_folha <> 'N' AND K.ORDEM_BM <> 1  
THEN '8-CONCOMITANCIA DE LICENCAS DEFINIR QUAL ALTERAR'
WHEN 
k.lacunas > 0 and k.controle_folha IN ('L','M') AND K.PROXIMO_CONTROLE_FOLHA IN ('L','M') AND K.TIPO_TRABALHADOR IN ('101','301') AND K.ORDEM_BM <> 1 AND K.E_AFASTAMENTO = 'S' AND K.SUSPENDE_REMUNERA = 'N' AND K.PROXIMO_E_AFASTAMENTO = 'S' AND K.PROXIMO_SUSPENDE_REMUNERA = 'N'
THEN '9-LACUNA DE LICENCAS GRAVAR 1000'
WHEN 
K.LACUNAS > 0 AND k.controle_folha <> 'N' AND K.ORDEM_BM = 1 AND K.TIPO_TRABALHADOR = '309' AND K.ORDEM_BM = 1 AND K.so_gera_sit_ponto = 'NÃO'
THEN '10-ULTIMO REGISTRO LICENCA JÁ ACABOU VOLTAR PARA ULTIMA ATIVA'
WHEN 
K.LACUNAS > 0 AND k.controle_folha = 'N' AND K.ORDEM_BM = 1 AND K.TIPO_TRABALHADOR = '309' AND K.ORDEM_BM = 1 AND K.so_gera_sit_ponto = 'SIM'
THEN '11-ULTIMO REGISTRO NORMAL COM DATA FIM, TIRAR DATA FIM'
WHEN 
K.LACUNAS > 0 AND K.PROXIMA_COD_SIT_FUNCIONAL IS NULL AND K.so_gera_sit_ponto = 'NADA'
THEN '12-ULTIMA SIT SO_GERA_SIT_PONTO = NADA'
WHEN 
K.LACUNAS > 0 AND k.controle_folha = 'N' AND K.E_AFASTAMENTO = 'S' AND K.SUSPENDE_REMUNERA = 'S' AND K.PROXIMA_COD_SIT_FUNCIONAL IS NULL AND K.so_gera_sit_ponto = 'SIM'
THEN '13 -APAGAR DATA FIM DA ULTIMA SITUAÇÃO FUNCIONAL'
WHEN 
K.LACUNAS > 0 AND (
(k.controle_folha = 'L' AND K.E_AFASTAMENTO = 'N' AND K.SUSPENDE_REMUNERA = 'N')OR
(k.controle_folha = 'L' AND K.E_AFASTAMENTO = 'S' AND K.SUSPENDE_REMUNERA = 'N')OR
(k.controle_folha = 'N' AND K.E_AFASTAMENTO = 'N' AND K.SUSPENDE_REMUNERA = 'S' AND K.qtde_dias_proximo IS NULL )
)
AND K.PROXIMA_COD_SIT_FUNCIONAL IS NULL AND K.so_gera_sit_ponto = 'SIM'
THEN '14- RETIRAR DO SCRIPT DE LACUNAS'

ELSE 'NÃO MAPEADO-FAZER AJUSTES MANUALMENTE' end CENARIOS,

k.* from (
SELECT 
COD_CATEG.CONTEUDO_INICIAL TIPO_TRABALHADOR, C.SITUACAO_FUNCIONAL SIT_FUNC_ULT_CONTR,
TRUNC(Q.DATA_INICIO_COMPARAR) - TRUNC(Q.DATA_FIM_COMPARAR) -1 AS LACUNAS 
,Q.* 
FROM(
SELECT 
T.* 
,CASE 
WHEN T.ORDEM_BM = 1 THEN to_date(to_char(SYSDATE,'dd/mm/yyyy'),'dd/mm/yyyy')+1 
ELSE to_date(to_char(T.PROXIMA_DATA_INICIO,'dd/mm/yyyy'),'dd/mm/yyyy') END DATA_INICIO_COMPARAR
,CASE 
WHEN T.CONTROLE_FOLHA NOT IN ('L','M') AND T.DATA_FIM IS NULL AND T.ORDEM_BM = 1 THEN to_date(to_char(SYSDATE,'dd/mm/yyyy'),'dd/mm/yyyy')
WHEN T.CONTROLE_FOLHA NOT IN ('L','M') AND T.DATA_FIM IS NULL AND T.ORDEM_BM <> 1 THEN to_date(to_char(T.DATA_INICIO,'dd/mm/yyyy'),'dd/mm/yyyy')-1--em 27/8/21 incluir -1 para dar diferença 
ELSE to_date(to_char(T.DATA_FIM,'dd/mm/yyyy'),'dd/mm/yyyy') END DATA_FIM_COMPARAR
FROM (
SELECT 
ROW_NUMBER() OVER (PARTITION BY A.CODIGO_EMPRESA, A.TIPO_CONTRATO, A.CODIGO ORDER BY A.DATA_INIC_SITUACAO DESC) AS ORDEM_BM,
A.CODIGO_EMPRESA, A.TIPO_CONTRATO, A.CODIGO, A.COD_SIT_FUNCIONAL, S.DESCRICAO SIT_FUNCIONAL, S.CONTROLE_FOLHA, 
S.E_AFASTAMENTO, S.SUSPENDE_REMUNERA, S.qtde_dias_proximo,
case when S.c_livre_selec02 = '0' THEN 'NADA' when S.c_livre_selec02 = '1' then 'SIM' when S.c_livre_selec02 = '2' then 'NÃO' ELSE 'ERRO' END SO_GERA_SIT_PONTO, 
to_date(to_char(A.DATA_INIC_SITUACAO,'dd/mm/yyyy'),'dd/mm/yyyy') DATA_INICIO, to_date(to_char(A.DATA_FIM_SITUACAO,'dd/mm/yyyy'),'dd/mm/yyyy') DATA_FIM--, A.PROXIMA_SITUACAO 
,a.login_usuario, a.dt_ult_alter_usua
,LEAD(A.COD_SIT_FUNCIONAL, 1, NULL) OVER (PARTITION BY A.CODIGO_EMPRESA, A.TIPO_CONTRATO, A.CODIGO ORDER BY A.DATA_INIC_SITUACAO ) AS PROXIMA_COD_SIT_FUNCIONAL
,LEAD(S.DESCRICAO, 1, NULL) OVER (PARTITION BY A.CODIGO_EMPRESA, A.TIPO_CONTRATO, A.CODIGO ORDER BY A.DATA_INIC_SITUACAO ) AS PROXIMA_SIT_FUNCIONAL
,LEAD(S.CONTROLE_FOLHA, 1, NULL) OVER (PARTITION BY A.CODIGO_EMPRESA, A.TIPO_CONTRATO, A.CODIGO ORDER BY A.DATA_INIC_SITUACAO ) AS PROXIMO_CONTROLE_FOLHA
,LEAD(S.E_AFASTAMENTO, 1, NULL) OVER (PARTITION BY A.CODIGO_EMPRESA, A.TIPO_CONTRATO, A.CODIGO ORDER BY A.DATA_INIC_SITUACAO ) AS PROXIMO_E_AFASTAMENTO
,LEAD(S.SUSPENDE_REMUNERA, 1, NULL) OVER (PARTITION BY A.CODIGO_EMPRESA, A.TIPO_CONTRATO, A.CODIGO ORDER BY A.DATA_INIC_SITUACAO ) AS PROXIMO_SUSPENDE_REMUNERA
,LEAD(case when S.c_livre_selec02 = '0' THEN 'NADA' when S.c_livre_selec02 = '1' then 'SIM' when S.c_livre_selec02 = '2' then 'NÃO' ELSE 'ERRO' END, 1, NULL) OVER (PARTITION BY A.CODIGO_EMPRESA, A.TIPO_CONTRATO, A.CODIGO ORDER BY A.DATA_INIC_SITUACAO ) AS PROXIMO_SO_GERA_SIT_PONTO
,LEAD(to_date(to_char(A.DATA_INIC_SITUACAO,'dd/mm/yyyy'),'dd/mm/yyyy'), 1, NULL) OVER (PARTITION BY A.CODIGO_EMPRESA, A.TIPO_CONTRATO, A.CODIGO  ORDER BY A.DATA_INIC_SITUACAO) AS PROXIMA_DATA_INICIO
,LEAD(to_date(to_char(A.DATA_FIM_SITUACAO,'dd/mm/yyyy'),'dd/mm/yyyy'), 1, NULL) OVER (PARTITION BY A.CODIGO_EMPRESA, A.TIPO_CONTRATO, A.CODIGO  ORDER BY A.DATA_INIC_SITUACAO ) AS PROXIMA_DATA_FIM
,LEAD(a.login_usuario, 1, NULL) OVER (PARTITION BY A.CODIGO_EMPRESA, A.TIPO_CONTRATO, A.CODIGO ORDER BY A.DATA_INIC_SITUACAO ) AS PROXIMO_login_usuario
,LEAD( a.dt_ult_alter_usua, 1, NULL) OVER (PARTITION BY A.CODIGO_EMPRESA, A.TIPO_CONTRATO, A.CODIGO ORDER BY A.DATA_INIC_SITUACAO ) AS PROXIMa_dt_ult_alter_usua

FROM RHCGED_ALT_SIT_FUN A
LEFT OUTER JOIN RHPARM_SIT_FUNC S ON S.CODIGO = A.COD_SIT_FUNCIONAL
WHERE 
--A.CODIGO IN ('000000000883291','00000000021005X','000000000239597', '00000000028777X', '000000000297562', '000000000302450') AND
A.CODIGO_EMPRESA IN ('0001','0098','0003','0013','0014')-- '1' 
                                                                            -- and trunc(A.DT_ULT_ALTER_USUA) >= to_date('19/12/2019','dd/mm/yyyy')--1291
and trunc(A.DATA_INIC_SITUACAO) >= to_date('30/09/2019','dd/mm/yyyy')--281
)T
)Q
LEFT OUTER JOIN rhpess_contrato c ON C.CODIGO_EMPRESA = q.CODIGO_EMPRESA AND C.TIPO_CONTRATO = q.TIPO_CONTRATO AND C.CODIGO = q.CODIGO
left outer join RHTABS_VINCULO_EMP V ON V.CODIGO = c.VINCULO
LEFT OUTER JOIN (select * from rhtabs_itds_sist WHERE CODIGO_DOMINIO IN (select CODIGO_DOMINIO from RHTABS_COLS_SIST  where codigo_tabela = 'RHTABS_VINCULO_EMP' and codigo_coluna = 'TP_REGIME_TRAB_ESOCIAL'))RG_TRAB
ON RG_TRAB.CONTEUDO_INICIAL = V.TP_REGIME_TRAB_ESOCIAL
LEFT OUTER JOIN (select * from rhtabs_itds_sist WHERE CODIGO_DOMINIO IN (select CODIGO_DOMINIO from RHTABS_COLS_SIST  where codigo_tabela = 'RHTABS_VINCULO_EMP' and codigo_coluna = 'TP_REGIME_PREV_ESOCIAL'))RG_PREV
ON RG_PREV.CONTEUDO_INICIAL = V.TP_REGIME_PREV_ESOCIAL
LEFT OUTER JOIN (select * from rhtabs_itds_sist WHERE CODIGO_DOMINIO IN (select CODIGO_DOMINIO from RHTABS_COLS_SIST  where codigo_tabela = 'RHTABS_VINCULO_EMP' and codigo_coluna = 'COD_CATEG_ESOCIAL'))COD_CATEG
ON COD_CATEG.CONTEUDO_INICIAL = V.COD_CATEG_ESOCIAL
WHERE 
C.ANO_MES_REFERENCIA = (SELECT MAX(AUX.ANO_MES_REFERENCIA)FROM RHPESS_CONTRATO AUX WHERE C.CODIGO_EMPRESA = AUX.CODIGO_EMPRESA AND C.TIPO_CONTRATO = AUX.TIPO_CONTRATO AND C.CODIGO = AUX.CODIGO)
and c.data_rescisao is null and c.CODIGO_EMPRESA IN ('0001','0098','0003','0013','0014')-----------------------para todos bm ativos em geral
)k
WHERE k.lacunas <> 0
order by  K.CODIGO_EMPRESA , K.TIPO_CONTRATO , K.CODIGO , K.data_inicIO
)S
--where trunc(s.data_fim) < trunc(sysdate) --COMENTADO EM 27/8/21
where trunc(s.data_fim_COMPARAR) < trunc(sysdate) --NOVO EM 27/8/21
)X 

)x2 
--where trunc(x2.dt_ult_alter_usua) >= to_date('27/01/20','dd/mm/yy') or trunc(x2.proxima_dt_ult_alter_usua) >= to_date('27/01/20','dd/mm/yy')


order by  x2.tratativa, x2.CODIGO_EMPRESA , x2.TIPO_CONTRATO , x2.CODIGO , x2.data_inicIO 

--where x.cenarios = '11-ULTIMO REGISTRO NORMAL COM DATA FIM, TIRAR DATA FIM' 
/*  
----PARTE PARA TIRAR DO RELATORIO CONFORME ANALISE GEVIF EM 20/1/20    
where  
X.CONTROLE_FOLHA	= 'S' AND X.E_AFASTAMENTO	= 'N' AND SUSPENDE_REMUNERA	= 'N' AND X.SO_GERA_SIT_PONTO = 'NADA' AND X.PROXIMA_COD_SIT_FUNCIONAL IS NULL--APONSETADORIA 
AND  X.CONTROLE_FOLHA	= 'S' AND X.E_AFASTAMENTO	= 'N' AND SUSPENDE_REMUNERA	= 'N' AND X.SO_GERA_SIT_PONTO = 'NADA' AND X.PROXIMA_COD_SIT_FUNCIONAL IS NULL--
----PARTE PARA TIRAR DO RELATORIO CONFORME ANALISE GEVIF EM 20/1/20
*/  


)              
LOOP              

vCONTADOR :=vCONTADOR+1; 
dbms_output.put_line('--'||vCONTADOR);

IF C1.CENARIOS = '1-DIMINUI DT FIM DA NORMAL'  
THEN
dbms_output.put_line('--1-DIMINUI DT FIM DA NORMAL');
dbms_output.put_line('--AVISAR GEVIF/GETED: 1-DIMINUI DT FIM DA NORMAL');
dbms_output.put_line('--CODIGO_EMPRESA: '||C1.CODIGO_EMPRESA	||' TIPO_CONTRATO: '||C1.TIPO_CONTRATO||' CODIGO: '||C1.CODIGO|| ' COD_SIT_FUNCIONAL: '||C1.COD_SIT_FUNCIONAL|| ' DATA_INICIO: '||C1.DATA_INICIO||' DATA_FIM: '||C1.DATA_FIM);
--dbms_output.put_line('UPDATE RHCGED_ALT_SIT_FUN SET LOGIN_USUARIO = ''script_ajuste_lacunas'' , DT_ULT_ALTER_USUA = SYSDATE, data_fim_situacao = to_date('''||trunc(C1.PROXIMA_DATA_INICIO) ||''',''dd/mm/yy'')-1'||' where CODIGO_EMPRESA = '''||C1.CODIGO_EMPRESA ||''' AND TIPO_CONTRATO = '''||C1.TIPO_CONTRATO ||''' AND CODIGO = '''|| C1.CODIGO ||''' AND TRUNC(data_inic_situacao) = to_date('''||trunc(C1.DATA_INICIO) ||''',''dd/mm/yy'')' ||';COMMIT;' );
--dbms_output.put_line('EXECUTE SUGESP_ALT_SIT_FUNC_ULT_CONTRA('''||C1.CODIGO_EMPRESA ||''','''|| C1.TIPO_CONTRATO ||''','''|| C1.CODIGO ||''',''script_ajuste_lacunas'' );');

ELSIF C1.CENARIOS = '2-CRIA PERIODO ENTRE SIT COM 1000'
THEN
dbms_output.put_line('--2-CRIA PERIODO ENTRE SIT COM 1000');
--dbms_output.put_line('INSERT INTO RHCGED_ALT_SIT_FUN (ind_ef_retro_esocial, TEXTO_ASSOCIADO, LOGIN_USUARIO, DT_ULT_ALTER_USUA, CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO, DATA_INIC_SITUACAO, COD_SIT_FUNCIONAL, DATA_FIM_SITUACAO ) values (''N'', ''Registro criado automaticamente pela rotina correcao de lacunas.'', ''script_ajuste_lacunas'' ,sysdate,'''|| C1.CODIGO_EMPRESA ||''','''|| C1.TIPO_CONTRATO ||''','''|| C1.codigo|| ''', TO_DATE(''' || TRUNC(C1.DATA_FIM) || ''',''dd/mm/yy'')+1, ''1000'', TO_DATE('''|| TRUNC(C1.PROXIMA_DATA_INICIO) || ''',''dd/mm/yy'')-1); COMMIT;'  );
INSERT INTO RHCGED_ALT_SIT_FUN (ind_ef_retro_esocial, TEXTO_ASSOCIADO, LOGIN_USUARIO, DT_ULT_ALTER_USUA, CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO, DATA_INIC_SITUACAO, COD_SIT_FUNCIONAL, DATA_FIM_SITUACAO ) values ('N', 'Registro criado automaticamente pela rotina correcao de lacunas.', 'script_ajuste_lacunas' ,sysdate, C1.CODIGO_EMPRESA, C1.TIPO_CONTRATO, C1.codigo, TO_DATE(TRUNC(C1.DATA_FIM),'dd/mm/yy')+1, '1000', TO_DATE(TRUNC(C1.PROXIMA_DATA_INICIO),'dd/mm/yy')-1); COMMIT;

--dbms_output.put_line('EXECUTE SUGESP_ALT_SIT_FUNC_ULT_CONTRA('''||C1.CODIGO_EMPRESA ||''','''|| C1.TIPO_CONTRATO ||''','''|| C1.CODIGO ||''',''script_ajuste_lacunas'' );');

ELSIF C1.CENARIOS = '3-AUMENTA DATA FIM DA PRIMEIRA 1000'
THEN
dbms_output.put_line('--3-CRIA PERIODO ENTRE SIT COM 1000');
--dbms_output.put_line('INSERT INTO RHCGED_ALT_SIT_FUN (ind_ef_retro_esocial, TEXTO_ASSOCIADO, LOGIN_USUARIO, DT_ULT_ALTER_USUA, CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO, DATA_INIC_SITUACAO, COD_SIT_FUNCIONAL, DATA_FIM_SITUACAO ) values (''N'', ''Registro criado automaticamente pela rotina correcao de lacunas.'', ''script_ajuste_lacunas'' ,sysdate,'''|| C1.CODIGO_EMPRESA ||''','''|| C1.TIPO_CONTRATO ||''','''|| C1.codigo|| ''', TO_DATE(''' || TRUNC(C1.DATA_FIM) || ''',''dd/mm/yy'')+1, ''1000'', TO_DATE('''|| TRUNC(C1.PROXIMA_DATA_INICIO) || ''',''dd/mm/yy'')-1); COMMIT;'  );
INSERT INTO RHCGED_ALT_SIT_FUN (ind_ef_retro_esocial, TEXTO_ASSOCIADO, LOGIN_USUARIO, DT_ULT_ALTER_USUA, CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO, DATA_INIC_SITUACAO, COD_SIT_FUNCIONAL, DATA_FIM_SITUACAO ) values ('N', 'Registro criado automaticamente pela rotina correcao de lacunas.', 'script_ajuste_lacunas' ,sysdate, C1.CODIGO_EMPRESA, C1.TIPO_CONTRATO, C1.codigo, TO_DATE(TRUNC(C1.DATA_FIM),'dd/mm/yy')+1, '1000', TO_DATE(TRUNC(C1.PROXIMA_DATA_INICIO),'dd/mm/yy')-1); COMMIT;
--dbms_output.put_line('EXECUTE SUGESP_ALT_SIT_FUNC_ULT_CONTRA('''||C1.CODIGO_EMPRESA ||''','''|| C1.TIPO_CONTRATO ||''','''|| C1.CODIGO ||''',''script_ajuste_lacunas'' );');
--dbms_output.put_line('--3-AUMENTA DATA FIM DA PRIMEIRA 1000');
--dbms_output.put_line('UPDATE RHCGED_ALT_SIT_FUN SET LOGIN_USUARIO = ''script_ajuste_lacunas'' , DT_ULT_ALTER_USUA = SYSDATE, data_fim_situacao = to_date('''||trunc(C1.PROXIMA_DATA_INICIO) ||''',''dd/mm/yy'')-1'||' where CODIGO_EMPRESA = '''||C1.CODIGO_EMPRESA ||''' AND TIPO_CONTRATO = '''||C1.TIPO_CONTRATO ||''' AND CODIGO = '''|| C1.CODIGO ||''' AND TRUNC(data_inic_situacao) = to_date('''||trunc(C1.DATA_INICIO) ||''',''dd/mm/yy'')' ||';COMMIT;' );
--dbms_output.put_line('EXECUTE SUGESP_ALT_SIT_FUNC_ULT_CONTRA('''||C1.CODIGO_EMPRESA ||''','''|| C1.TIPO_CONTRATO ||''','''|| C1.CODIGO ||''',''script_ajuste_lacunas'' );');

ELSIF C1.CENARIOS = '4-ALTERA DATA FIM DA NORMAL-AUMENTA'
THEN
dbms_output.put_line('--4-ALTERA DATA FIM DA NORMAL-AUMENTA');
dbms_output.put_line('--AVISAR GEVIF/GETED: 4-ALTERA DATA FIM DA NORMAL-AUMENTA');
dbms_output.put_line('--CODIGO_EMPRESA: '||C1.CODIGO_EMPRESA	||' TIPO_CONTRATO: '||C1.TIPO_CONTRATO||' CODIGO: '||C1.CODIGO|| ' COD_SIT_FUNCIONAL: '||C1.COD_SIT_FUNCIONAL|| ' DATA_INICIO: '||C1.DATA_INICIO||' DATA_FIM: '||C1.DATA_FIM);
--dbms_output.put_line('UPDATE RHCGED_ALT_SIT_FUN SET LOGIN_USUARIO = ''script_ajuste_lacunas'' , DT_ULT_ALTER_USUA = SYSDATE, data_fim_situacao = to_date('''||trunc(C1.PROXIMA_DATA_INICIO) ||''',''dd/mm/yy'')-1'||' where CODIGO_EMPRESA = '''||C1.CODIGO_EMPRESA ||''' AND TIPO_CONTRATO = '''||C1.TIPO_CONTRATO ||''' AND CODIGO = '''|| C1.CODIGO ||''' AND TRUNC(data_inic_situacao) = to_date('''||trunc(C1.DATA_INICIO) ||''',''dd/mm/yy'')' ||';COMMIT;' );
--dbms_output.put_line('EXECUTE SUGESP_ALT_SIT_FUNC_ULT_CONTRA('''||C1.CODIGO_EMPRESA ||''','''|| C1.TIPO_CONTRATO ||''','''|| C1.CODIGO ||''',''script_ajuste_lacunas'' );');

ELSIF C1.CENARIOS = '4-ALTERA DATA FIM DA NORMAL-DIMINUI'
THEN
dbms_output.put_line('--4-ALTERA DATA FIM DA NORMAL-DIMINUI');
dbms_output.put_line('--AVISAR GEVIF/GETED: 4-ALTERA DATA FIM DA NORMAL-DIMINUI');
dbms_output.put_line('--CODIGO_EMPRESA: '||C1.CODIGO_EMPRESA	||' TIPO_CONTRATO: '||C1.TIPO_CONTRATO||' CODIGO: '||C1.CODIGO|| ' COD_SIT_FUNCIONAL: '||C1.COD_SIT_FUNCIONAL|| ' DATA_INICIO: '||C1.DATA_INICIO||' DATA_FIM: '||C1.DATA_FIM);
--dbms_output.put_line('UPDATE RHCGED_ALT_SIT_FUN SET LOGIN_USUARIO = ''script_ajuste_lacunas'' , DT_ULT_ALTER_USUA = SYSDATE, data_fim_situacao = to_date('''||trunc(C1.PROXIMA_DATA_INICIO) ||''',''dd/mm/yy'')-1'||' where CODIGO_EMPRESA = '''||C1.CODIGO_EMPRESA ||''' AND TIPO_CONTRATO = '''||C1.TIPO_CONTRATO ||''' AND CODIGO = '''|| C1.CODIGO ||''' AND TRUNC(data_inic_situacao) = to_date('''||trunc(C1.DATA_INICIO) ||''',''dd/mm/yy'')' ||';COMMIT;' );
--dbms_output.put_line('EXECUTE SUGESP_ALT_SIT_FUNC_ULT_CONTRA('''||C1.CODIGO_EMPRESA ||''','''|| C1.TIPO_CONTRATO ||''','''|| C1.CODIGO ||''',''script_ajuste_lacunas'' );');

ELSIF C1.CENARIOS = '5-FAZER NADA LICENCA AINDA NAO ACABOU' THEN
dbms_output.put_line('--5-FAZER NADA LICENCA AINDA NAO ACABOU');
dbms_output.put_line('--CODIGO_EMPRESA: '||C1.CODIGO_EMPRESA	||' TIPO_CONTRATO: '||C1.TIPO_CONTRATO||' CODIGO: '||C1.CODIGO|| ' COD_SIT_FUNCIONAL: '||C1.COD_SIT_FUNCIONAL|| ' DATA_INICIO: '||C1.DATA_INICIO||' DATA_FIM: '||C1.DATA_FIM);

ELSIF C1.CENARIOS = '6-ULTIMO REGISTRO LICENCA JÁ ACABOU VOLTAR PARA 1000-INSERT' 
THEN
dbms_output.put_line('--6-ULTIMO REGISTRO LICENCA JÁ ACABOU VOLTAR PARA 1000-INSERT');
--dbms_output.put_line('INSERT INTO RHCGED_ALT_SIT_FUN (ind_ef_retro_esocial, TEXTO_ASSOCIADO, LOGIN_USUARIO, DT_ULT_ALTER_USUA, CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO, DATA_INIC_SITUACAO, COD_SIT_FUNCIONAL ) values (''N'', ''Registro criado automaticamente pela rotina correcao de lacunas.'', ''script_ajuste_lacunas'' ,sysdate,'''|| C1.CODIGO_EMPRESA ||''','''|| C1.TIPO_CONTRATO ||''','''|| C1.codigo|| ''', TO_DATE(''' || TRUNC(C1.DATA_FIM) || ''',''dd/mm/yy'')+1, ''1000''); COMMIT;'  );
--dbms_output.put_line('EXECUTE SUGESP_ALT_SIT_FUNC_ULT_CONTRA('''||C1.CODIGO_EMPRESA ||''','''|| C1.TIPO_CONTRATO ||''','''|| C1.CODIGO ||''',''script_ajuste_lacunas'' );');
INSERT INTO RHCGED_ALT_SIT_FUN (ind_ef_retro_esocial, TEXTO_ASSOCIADO, LOGIN_USUARIO, DT_ULT_ALTER_USUA, CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO, DATA_INIC_SITUACAO, COD_SIT_FUNCIONAL ) values ('N', 'Registro criado automaticamente pela rotina correcao de lacunas.', 'script_ajuste_lacunas' ,sysdate, C1.CODIGO_EMPRESA, C1.TIPO_CONTRATO, C1.codigo, TO_DATE(TRUNC(C1.DATA_FIM),'dd/mm/yy')+1, '1000'); COMMIT;
SUGESP_ALT_SIT_FUNC_ULT_CONTRA(C1.CODIGO_EMPRESA, C1.TIPO_CONTRATO, C1.CODIGO,'script_ajuste_lacunas' );


ELSIF C1.CENARIOS = '6-ULTIMO REGISTRO LICENCA JÁ ACABOU VOLTAR PARA 1000-SINALIZAR'
THEN
dbms_output.put_line('--6-ULTIMO REGISTRO LICENCA JÁ ACABOU VOLTAR PARA 1000-AVISAR');
dbms_output.put_line('--AVISAR GEVIF/GETED: 6-ULTIMO REGISTRO LICENCA JÁ ACABOU VOLTAR PARA 1000-SINALIZAR');
dbms_output.put_line('--CODIGO_EMPRESA: '||C1.CODIGO_EMPRESA	||' TIPO_CONTRATO: '||C1.TIPO_CONTRATO||' CODIGO: '||C1.CODIGO|| ' COD_SIT_FUNCIONAL: '||C1.COD_SIT_FUNCIONAL|| ' DATA_INICIO: '||C1.DATA_INICIO||' DATA_FIM: '||C1.DATA_FIM);

ELSIF C1.CENARIOS = '7-CRIA PERIODO ENTRE SIT COM 1000' 
THEN
dbms_output.put_line('--7-CRIA PERIODO ENTRE SIT COM 1000');
--dbms_output.put_line('UPDATE RHCGED_ALT_SIT_FUN SET LOGIN_USUARIO = ''script_ajuste_lacunas'' , DT_ULT_ALTER_USUA = SYSDATE, data_INIC_situacao = to_date('''||trunc(C1.DATA_FIM)/*--CORRIGIDO EM 15/1/20 trunc(C1.DATA_INICIO)*/ ||''',''dd/mm/yy'')+1'||' where CODIGO_EMPRESA = '''||C1.CODIGO_EMPRESA ||''' AND TIPO_CONTRATO = '''||C1.TIPO_CONTRATO ||''' AND CODIGO = '''|| C1.CODIGO ||''' AND TRUNC(data_inic_situacao) = to_date('''||trunc(C1.PROXIMA_DATA_INICIO) ||''',''dd/mm/yy'')' ||';COMMIT;' );
--dbms_output.put_line('INSERT INTO RHCGED_ALT_SIT_FUN (ind_ef_retro_esocial, TEXTO_ASSOCIADO, LOGIN_USUARIO, DT_ULT_ALTER_USUA, CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO, DATA_INIC_SITUACAO, COD_SIT_FUNCIONAL, DATA_FIM_SITUACAO ) values (''N'', ''Registro criado automaticamente pela rotina correcao de lacunas.'', ''script_ajuste_lacunas'' ,sysdate,'''|| C1.CODIGO_EMPRESA ||''','''|| C1.TIPO_CONTRATO ||''','''|| C1.codigo|| ''', TO_DATE(''' || TRUNC(C1.DATA_FIM) || ''',''dd/mm/yy'')+1, ''1000'', TO_DATE('''|| TRUNC(C1.PROXIMA_DATA_INICIO) || ''',''dd/mm/yy'')-1); COMMIT;'  );
INSERT INTO RHCGED_ALT_SIT_FUN (ind_ef_retro_esocial, TEXTO_ASSOCIADO, LOGIN_USUARIO, DT_ULT_ALTER_USUA, CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO, DATA_INIC_SITUACAO, COD_SIT_FUNCIONAL, DATA_FIM_SITUACAO ) values ('N', 'Registro criado automaticamente pela rotina correcao de lacunas.', 'script_ajuste_lacunas' ,sysdate, C1.CODIGO_EMPRESA, C1.TIPO_CONTRATO, C1.codigo, TO_DATE(TRUNC(C1.DATA_FIM),'dd/mm/yy')+1, '1000', TO_DATE(TRUNC(C1.PROXIMA_DATA_INICIO),'dd/mm/yy')-1); COMMIT;
--dbms_output.put_line('EXECUTE SUGESP_ALT_SIT_FUNC_ULT_CONTRA('''||C1.CODIGO_EMPRESA ||''','''|| C1.TIPO_CONTRATO ||''','''|| C1.CODIGO ||''',''script_ajuste_lacunas'' );');

ELSIF C1.CENARIOS = '7-AUMENTAR DATA FIM DA 6008'
THEN
dbms_output.put_line('--7-AUMENTAR DATA FIM DA 6008');
--dbms_output.put_line('UPDATE RHCGED_ALT_SIT_FUN SET LOGIN_USUARIO = ''script_ajuste_lacunas'' , DT_ULT_ALTER_USUA = SYSDATE, data_FIM_situacao = to_date('''||trunc(C1.PROXIMA_DATA_INICIO) ||''',''dd/mm/yy'')-1'||' where CODIGO_EMPRESA = '''||C1.CODIGO_EMPRESA ||''' AND TIPO_CONTRATO = '''||C1.TIPO_CONTRATO ||''' AND CODIGO = '''|| C1.CODIGO ||''' AND TRUNC(data_inic_situacao) = to_date('''||trunc(C1.DATA_INICIO) ||''',''dd/mm/yy'')' ||';COMMIT;' );
UPDATE RHCGED_ALT_SIT_FUN SET LOGIN_USUARIO = 'script_ajuste_lacunas' , DT_ULT_ALTER_USUA = SYSDATE, data_FIM_situacao = to_date(trunc(C1.PROXIMA_DATA_INICIO),'dd/mm/yy')-1 where CODIGO_EMPRESA = C1.CODIGO_EMPRESA AND TIPO_CONTRATO = C1.TIPO_CONTRATO AND CODIGO = C1.CODIGO AND TRUNC(data_inic_situacao) = to_date(trunc(C1.DATA_INICIO),'dd/mm/yy');COMMIT;
--dbms_output.put_line('EXECUTE SUGESP_ALT_SIT_FUNC_ULT_CONTRA('''||C1.CODIGO_EMPRESA ||''','''|| C1.TIPO_CONTRATO ||''','''|| C1.CODIGO ||''',''script_ajuste_lacunas'' );');

ELSIF C1.CENARIOS = '8-CONCOMITANCIA DE LICENCAS DEFINIR QUAL ALTERAR' THEN
--dbms_output.put_line('--FAZER AJUSTES MANUALMENTE-8-CONCOMITANCIA DE LICENCAS DEFINIR QUAL ALTERAR');
dbms_output.put_line('--AVISAR GEVIF/GETED: 8-CONCOMITANCIA DE LICENCAS DEFINIR QUAL ALTERAR');
dbms_output.put_line('--CODIGO_EMPRESA: '||C1.CODIGO_EMPRESA	||' TIPO_CONTRATO: '||C1.TIPO_CONTRATO||' CODIGO: '||C1.CODIGO|| ' COD_SIT_FUNCIONAL: '||C1.COD_SIT_FUNCIONAL|| ' DATA_INICIO: '||C1.DATA_INICIO||' DATA_FIM: '||C1.DATA_FIM);


ELSIF C1.CENARIOS = '9-LACUNA DE LICENCAS GRAVAR 1000'
THEN
dbms_output.put_line('--9-LACUNA DE LICENCAS GRAVAR 1000');
--dbms_output.put_line('INSERT INTO RHCGED_ALT_SIT_FUN (ind_ef_retro_esocial, TEXTO_ASSOCIADO, LOGIN_USUARIO, DT_ULT_ALTER_USUA, CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO, DATA_INIC_SITUACAO, COD_SIT_FUNCIONAL, DATA_FIM_SITUACAO ) values (''N'', ''Registro criado automaticamente pela rotina correcao de lacunas.'', ''script_ajuste_lacunas'' ,sysdate,'''|| C1.CODIGO_EMPRESA ||''','''|| C1.TIPO_CONTRATO ||''','''|| C1.codigo|| ''', TO_DATE(''' || TRUNC(C1.DATA_FIM) || ''',''dd/mm/yy'')+1, ''1000'', TO_DATE(''' || TRUNC(C1.PROXIMA_DATA_INICIO) || ''',''dd/mm/yy'')-1); COMMIT;'  );
INSERT INTO RHCGED_ALT_SIT_FUN (ind_ef_retro_esocial, TEXTO_ASSOCIADO, LOGIN_USUARIO, DT_ULT_ALTER_USUA, CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO, DATA_INIC_SITUACAO, COD_SIT_FUNCIONAL, DATA_FIM_SITUACAO ) values ('N', 'Registro criado automaticamente pela rotina correcao de lacunas.', 'script_ajuste_lacunas' ,sysdate, C1.CODIGO_EMPRESA, C1.TIPO_CONTRATO, C1.codigo, TO_DATE(TRUNC(C1.DATA_FIM),'dd/mm/yy')+1, '1000', TO_DATE(TRUNC(C1.PROXIMA_DATA_INICIO),'dd/mm/yy')-1); COMMIT;
--dbms_output.put_line('EXECUTE SUGESP_ALT_SIT_FUNC_ULT_CONTRA('''||C1.CODIGO_EMPRESA ||''','''|| C1.TIPO_CONTRATO ||''','''|| C1.CODIGO ||''',''script_ajuste_lacunas'' );');

ELSIF C1.CENARIOS = '10-ULTIMO REGISTRO LICENCA JÁ ACABOU VOLTAR PARA ULTIMA ATIVA'
THEN
dbms_output.put_line('--10-ULTIMO REGISTRO LICENCA JÁ ACABOU VOLTAR PARA ULTIMA ATIVA');
--dbms_output.put_line('INSERT INTO RHCGED_ALT_SIT_FUN (ind_ef_retro_esocial, TEXTO_ASSOCIADO, LOGIN_USUARIO, DT_ULT_ALTER_USUA, CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO, DATA_INIC_SITUACAO, COD_SIT_FUNCIONAL) values (''N'', ''Registro criado automaticamente pela rotina correcao de lacunas.'', ''script_ajuste_lacunas'' ,sysdate,'''|| C1.CODIGO_EMPRESA ||''','''|| C1.TIPO_CONTRATO ||''','''|| C1.codigo|| ''', TO_DATE(''' || TRUNC(C1.DATA_FIM) || ''',''dd/mm/yy'')+1, ''1000''); COMMIT;'  );
--dbms_output.put_line('EXECUTE SUGESP_ALT_SIT_FUNC_ULT_CONTRA('''||C1.CODIGO_EMPRESA ||''','''|| C1.TIPO_CONTRATO ||''','''|| C1.CODIGO ||''',''script_ajuste_lacunas'' );');
INSERT INTO RHCGED_ALT_SIT_FUN (ind_ef_retro_esocial, TEXTO_ASSOCIADO, LOGIN_USUARIO, DT_ULT_ALTER_USUA, CODIGO_EMPRESA, TIPO_CONTRATO, CODIGO, DATA_INIC_SITUACAO, COD_SIT_FUNCIONAL) values ('N', 'Registro criado automaticamente pela rotina correcao de lacunas.', 'script_ajuste_lacunas', sysdate, C1.CODIGO_EMPRESA, C1.TIPO_CONTRATO, C1.codigo, TO_DATE(TRUNC(C1.DATA_FIM),'dd/mm/yy')+1, '1000'); COMMIT;
SUGESP_ALT_SIT_FUNC_ULT_CONTRA(C1.CODIGO_EMPRESA, C1.TIPO_CONTRATO, C1.CODIGO,'script_ajuste_lacunas');


ELSIF C1.CENARIOS = '11-ULTIMO REGISTRO NORMAL COM DATA FIM, TIRAR DATA FIM'
THEN
dbms_output.put_line('--11-ULTIMO REGISTRO NORMAL COM DATA FIM, TIRAR DATA FIM');
--dbms_output.put_line('UPDATE RHCGED_ALT_SIT_FUN SET LOGIN_USUARIO = ''script_ajuste_lacunas'' , DT_ULT_ALTER_USUA = SYSDATE, data_FIM_situacao = NULL where CODIGO_EMPRESA = '''||C1.CODIGO_EMPRESA ||''' AND TIPO_CONTRATO = '''||C1.TIPO_CONTRATO ||''' AND CODIGO = '''|| C1.CODIGO ||''' AND TRUNC(data_inic_situacao) = to_date('''||trunc(C1.DATA_INICIO) ||''',''dd/mm/yy'')' ||';COMMIT;' );
--dbms_output.put_line('EXECUTE SUGESP_ALT_SIT_FUNC_ULT_CONTRA('''||C1.CODIGO_EMPRESA ||''','''|| C1.TIPO_CONTRATO ||''','''|| C1.CODIGO ||''',''script_ajuste_lacunas'' );');
UPDATE RHCGED_ALT_SIT_FUN SET LOGIN_USUARIO = 'script_ajuste_lacunas' , DT_ULT_ALTER_USUA = SYSDATE, data_FIM_situacao = NULL where CODIGO_EMPRESA = C1.CODIGO_EMPRESA AND TIPO_CONTRATO = C1.TIPO_CONTRATO AND CODIGO = C1.CODIGO AND TRUNC(data_inic_situacao) = to_date(trunc(C1.DATA_INICIO),'dd/mm/yy');COMMIT;
SUGESP_ALT_SIT_FUNC_ULT_CONTRA(C1.CODIGO_EMPRESA, C1.TIPO_CONTRATO, C1.CODIGO, 'script_ajuste_lacunas' );


ELSIF C1.CENARIOS = '12-ULTIMA SIT SO_GERA_SIT_PONTO = NADA' THEN
--dbms_output.put_line('--FAZER AJUSTES MANUALMENTE-8-CONCOMITANCIA DE LICENCAS DEFINIR QUAL ALTERAR');
dbms_output.put_line('--12-ULTIMA SIT SO_GERA_SIT_PONTO = NADA');
dbms_output.put_line('--CODIGO_EMPRESA: '||C1.CODIGO_EMPRESA	||' TIPO_CONTRATO: '||C1.TIPO_CONTRATO||' CODIGO: '||C1.CODIGO|| ' COD_SIT_FUNCIONAL: '||C1.COD_SIT_FUNCIONAL|| ' DATA_INICIO: '||C1.DATA_INICIO||' DATA_FIM: '||C1.DATA_FIM);

ELSIF C1.CENARIOS = '13 -APAGAR DATA FIM DA ULTIMA SITUAÇÃO FUNCIONAL' THEN
--dbms_output.put_line('--FAZER AJUSTES MANUALMENTE-8-CONCOMITANCIA DE LICENCAS DEFINIR QUAL ALTERAR');
dbms_output.put_line('--13 -APAGAR DATA FIM DA ULTIMA SITUAÇÃO FUNCIONAL');
--dbms_output.put_line('UPDATE RHCGED_ALT_SIT_FUN SET LOGIN_USUARIO = ''script_ajuste_lacunas'' , DT_ULT_ALTER_USUA = SYSDATE, data_FIM_situacao = NULL where CODIGO_EMPRESA = '''||C1.CODIGO_EMPRESA ||''' AND TIPO_CONTRATO = '''||C1.TIPO_CONTRATO ||''' AND CODIGO = '''|| C1.CODIGO ||''' AND TRUNC(data_inic_situacao) = to_date('''||trunc(C1.DATA_INICIO) ||''',''dd/mm/yy'')' ||';COMMIT;' );
--dbms_output.put_line('EXECUTE SUGESP_ALT_SIT_FUNC_ULT_CONTRA('''||C1.CODIGO_EMPRESA ||''','''|| C1.TIPO_CONTRATO ||''','''|| C1.CODIGO ||''',''script_ajuste_lacunas'' );');
UPDATE RHCGED_ALT_SIT_FUN SET LOGIN_USUARIO = 'script_ajuste_lacunas' , DT_ULT_ALTER_USUA = SYSDATE, data_FIM_situacao = NULL where CODIGO_EMPRESA = C1.CODIGO_EMPRESA AND TIPO_CONTRATO = C1.TIPO_CONTRATO AND CODIGO = C1.CODIGO AND TRUNC(data_inic_situacao) = to_date(trunc(C1.DATA_INICIO),'dd/mm/yy');COMMIT;
SUGESP_ALT_SIT_FUNC_ULT_CONTRA(C1.CODIGO_EMPRESA, C1.TIPO_CONTRATO, C1.CODIGO, 'script_ajuste_lacunas' );


ELSIF C1.CENARIOS = '14- RETIRAR DO SCRIPT DE LACUNAS' THEN
--dbms_output.put_line('--FAZER AJUSTES MANUALMENTE-8-CONCOMITANCIA DE LICENCAS DEFINIR QUAL ALTERAR');
dbms_output.put_line('--14- RETIRAR DO SCRIPT DE LACUNAS');
dbms_output.put_line('--CODIGO_EMPRESA: '||C1.CODIGO_EMPRESA	||' TIPO_CONTRATO: '||C1.TIPO_CONTRATO||' CODIGO: '||C1.CODIGO|| ' COD_SIT_FUNCIONAL: '||C1.COD_SIT_FUNCIONAL|| ' DATA_INICIO: '||C1.DATA_INICIO||' DATA_FIM: '||C1.DATA_FIM);


ELSE
dbms_output.put_line('--AVISAR GEVIF/GETED: NÃO MAPEADO-FAZER AJUSTES MANUALMENTE');
dbms_output.put_line('--CODIGO_EMPRESA: '||C1.CODIGO_EMPRESA	||' TIPO_CONTRATO: '||C1.TIPO_CONTRATO||' CODIGO: '||C1.CODIGO|| ' COD_SIT_FUNCIONAL: '||C1.COD_SIT_FUNCIONAL|| ' DATA_INICIO: '||C1.DATA_INICIO||' DATA_FIM: '||C1.DATA_FIM);

END IF;

END LOOP;

END;

END;