
  CREATE OR REPLACE EDITIONABLE PROCEDURE "ARTERH"."PR_UPDATE_SIT_FUNC" AS

REGISTROS_AFETADOS NUMBER DEFAULT 0;
HORA_INICIO DATE;
HORA_FIM    DATE;
TEMPO_TOTAL NUMBER;
ULTIMA_ALTERACAO DATE;

PROCEDURE PR_GRAVA_LOG_SIT_FUNC(QTDE_REGISTROS NUMBER, HORA_INICIO VARCHAR2, HORA_FIM VARCHAR2, TEMPO_TOTAL NUMBER, MENSAGEM VARCHAR2) AS
  BEGIN
    INSERT INTO ARTERH.UTILIT_LOG_SIT_FUNC("DATA", QTDE_REGISTROS, HORA_INICIO, HORA_FIM, TEMPO_TOTAL_MS, MENSAGEM)
    VALUES(SYSDATE, QTDE_REGISTROS, HORA_INICIO, HORA_FIM, TEMPO_TOTAL, MENSAGEM);
    COMMIT;
END PR_GRAVA_LOG_SIT_FUNC;

BEGIN
  SELECT MAX(TRUNC(DATA_ULTIMA_ALTERACAO)) INTO ULTIMA_ALTERACAO FROM ARTERH.UTILIT_SIT_FUNC;
  
  IF ULTIMA_ALTERACAO IS NULL 
	THEN ULTIMA_ALTERACAO := TO_DATE('01/01/1900'); 
	END IF;
  
  HORA_INICIO := SYSDATE;

  INSERT INTO ARTERH.UTILIT_SIT_FUNC (ANO_MES_REFERENCIA,CODIGO_PLANO,CODIGO_EMPRESA,MATRICULA,DIGITO,NOME,CPF,PIS_PASEP,CODIGO_CARGO,DATA_ADMISSAO_POSSE,SITUACAO_FUNCIONAL,TIPO_OCORRENCIA,DATA_INICIO,DATA_FIM,DIAS,CID, DATA_ULTIMA_ALTERACAO)
  SELECT ANO_MES_REFERENCIA,CODIGO_PLANO,CODIGO_EMPRESA,MATRICULA,DIGITO,NOME,CPF,PIS_PASEP,CODIGO_CARGO,DATA_ADMISSAO_POSSE,SITUACAO_FUNCIONAL,
      CASE 
        WHEN SITUACAO_FUNCIONAL IN ('0525', '0503', '1140') THEN 2
        WHEN SITUACAO_FUNCIONAL IN ('0020', '0514', '0528', '0529', '0542', '0546', '0535') THEN 12
        WHEN SITUACAO_FUNCIONAL IN ('0510', '0500', '0552') THEN 22
        WHEN SITUACAO_FUNCIONAL IN ('1145') THEN 40
        WHEN SITUACAO_FUNCIONAL IN ('0534') THEN 47 
        WHEN SITUACAO_FUNCIONAL IN ('0526', '0509') THEN 50 
        WHEN SITUACAO_FUNCIONAL IN ('0506', '1148', '1168', '1149', '1136') THEN 59
        WHEN SITUACAO_FUNCIONAL IN ('1004', '1015', '0515', '1124') THEN 64
        ELSE 25
      END AS TIPO_OCORRENCIA,DATA_INICIO,DATA_FIM,DIAS,CID, DATA_ULTIMA_ALTERACAO
    FROM (
      SELECT 
        TO_CHAR(MIN(FR.DATA), 'YYYYMM') AS ANO_MES_REFERENCIA, FR.CODIGO_PLANO,FR.SITUACAO_FUNCIONAL,FR.CODIGO_EMPRESA,
        FR.MATRICULA,FR.DIGITO,FR.NOME,FR.CPF,FR.PIS_PASEP,FR.CODIGO_CARGO,FR.DATA_ADMISSAO_POSSE, 
        TO_CHAR(MIN(FR.DATA), 'RRRRMMDD') AS DATA_INICIO, TO_CHAR(MAX(FR.DATA), 'YYYYMMDD') AS DATA_FIM, COUNT(FR.DATA) DIAS,FR.CID, FR.DT_ULT_ALTER_USUA AS DATA_ULTIMA_ALTERACAO
      FROM (
        SELECT 
          TO_DATE(TO_CHAR(RHPONT_RES_SIT_DIA.DATA, 'DD/MM/YYYY'), 'DD/MM/YYYY') AS DATA,
          RHPONT_RES_SIT_DIA.DATA - ROW_NUMBER() OVER(ORDER BY RHPESS_CONTRATO.COD_UNIDADE1, RHPESS_CONTRATO.COD_UNIDADE2, RHPESS_CONTRATO.COD_UNIDADE3, RHPESS_CONTRATO.COD_UNIDADE4, RHPESS_CONTRATO.COD_UNIDADE5, RHPESS_CONTRATO.COD_UNIDADE6, RHPESS_CONTRATO.CODIGO, RHPONT_RES_SIT_DIA.CODIGO_SITUACAO, RHPONT_RES_SIT_DIA.DATA) AS DISTANCE,
          RHPONT_RES_SIT_DIA.CODIGO_SITUACAO, TO_NUMBER(RHPESS_CONTRATO.CODIGO_EMPRESA) AS CODIGO_EMPRESA, RHPONT_SITUACAO.DESCRICAO DESCRICAO_SITUACAO,
          TO_NUMBER(SUBSTR(RHPESS_CONTRATO.CODIGO, 5, 10)) AS MATRICULA, 
          CASE WHEN SUBSTR(RHPESS_CONTRATO.CODIGO, 15, 1) = 'X' THEN 7 ELSE TO_NUMBER(SUBSTR(RHPESS_CONTRATO.CODIGO, 15, 1)) END AS DIGITO,
          SUBSTR(TRIM(RHPESS_CONTRATO.NOME), 1, 80) AS NOME, SUBSTR(TRIM(RHPESS_PESSOA.CPF), 1, 11) AS CPF, TO_NUMBER(NVL(TRIM(RHPESS_PESSOA.PIS_PASEP), 0)) AS PIS_PASEP,
          CASE WHEN RHPESS_CONTRATO.DATA_ADMISSAO <= TO_DATE('30/12/2011', 'DD/MM/YYYY') THEN 1 ELSE 2 END AS CODIGO_PLANO,
          TO_NUMBER(SUBSTR(TRIM(RHPESS_CONTRATO.COD_CARGO_EFETIVO), 12, 4)) AS CODIGO_CARGO,
          CASE
            WHEN RHPESS_CONTRATO.DATA_EFETIVO_EXERC IS NOT NULL THEN TO_CHAR(RHPESS_CONTRATO.DATA_EFETIVO_EXERC, 'YYYYMMDD')
            ELSE TO_CHAR(RHPESS_CONTRATO.DATA_ADMISSAO, 'YYYYMMDD')
          END AS DATA_ADMISSAO_POSSE, RHPONT_RES_SIT_DIA.CODIGO_SITUACAO AS SITUACAO_FUNCIONAL, NULL AS CID, RHPONT_RES_SIT_DIA.DT_ULT_ALTER_USUA
         FROM RHPONT_RES_SIT_DIA,RHPONT_SITUACAO,RHPESS_CONTRATO,RHPESS_PESSOA,RHORGA_UNIDADE,RHPARM_SIT_FUNC,RHPLCS_CARGO
        WHERE RHPONT_RES_SIT_DIA.DT_ULT_ALTER_USUA > ULTIMA_ALTERACAO
          AND RHPESS_CONTRATO.TIPO_CONTRATO = '0001' AND RHPESS_CONTRATO.CODIGO_EMPRESA = '0001' AND (RHPESS_CONTRATO.SITUACAO_FUNCIONAL <= '7000' OR RHPESS_CONTRATO.SITUACAO_FUNCIONAL IN ('8000','8001')) 
          AND RHPESS_CONTRATO.COD_CARGO_PAGTO NOT IN ('000000000002006','000000000002007')
          AND RHPESS_CONTRATO.ANO_MES_REFERENCIA = (
              SELECT MAX(ARTERH_CONTRATO.ANO_MES_REFERENCIA) 
                FROM RHPESS_CONTRATO ARTERH_CONTRATO
               WHERE RHPESS_CONTRATO.CODIGO_EMPRESA = ARTERH_CONTRATO.CODIGO_EMPRESA
                 AND RHPESS_CONTRATO.TIPO_CONTRATO = ARTERH_CONTRATO.TIPO_CONTRATO
                 AND RHPESS_CONTRATO.CODIGO = ARTERH_CONTRATO.CODIGO
                 AND ARTERH_CONTRATO.ANO_MES_REFERENCIA <= SYSDATE )
          AND RHPESS_CONTRATO.CODIGO_EMPRESA = RHPONT_RES_SIT_DIA.CODIGO_EMPRESA AND RHPESS_CONTRATO.TIPO_CONTRATO = RHPONT_RES_SIT_DIA.TIPO_CONTRATO AND RHPESS_CONTRATO.CODIGO = RHPONT_RES_SIT_DIA.CODIGO_CONTRATO 
          AND RHPONT_RES_SIT_DIA.CODIGO_SITUACAO = RHPONT_SITUACAO.CODIGO AND RHPESS_PESSOA.CODIGO_EMPRESA = RHPESS_CONTRATO.CODIGO_EMPRESA AND RHPESS_PESSOA.CODIGO = RHPESS_CONTRATO.CODIGO_PESSOA
          AND RHPESS_CONTRATO.COD_UNIDADE1 = RHORGA_UNIDADE.COD_UNIDADE1 AND RHPESS_CONTRATO.COD_UNIDADE2 = RHORGA_UNIDADE.COD_UNIDADE2 AND RHPESS_CONTRATO.COD_UNIDADE3 = RHORGA_UNIDADE.COD_UNIDADE3 
          AND RHPESS_CONTRATO.COD_UNIDADE4 = RHORGA_UNIDADE.COD_UNIDADE4 AND RHPESS_CONTRATO.COD_UNIDADE5 = RHORGA_UNIDADE.COD_UNIDADE5 AND RHPESS_CONTRATO.COD_UNIDADE6 = RHORGA_UNIDADE.COD_UNIDADE6 
          AND RHPESS_CONTRATO.CODIGO_EMPRESA = RHORGA_UNIDADE.CODIGO_EMPRESA AND RHPESS_CONTRATO.SITUACAO_FUNCIONAL = RHPARM_SIT_FUNC.CODIGO AND RHPESS_CONTRATO.CODIGO_EMPRESA = RHPLCS_CARGO.CODIGO_EMPRESA (+)
          AND RHPESS_CONTRATO.COD_CARGO_EFETIVO = RHPLCS_CARGO.CODIGO (+) AND RHPONT_RES_SIT_DIA.TIPO_APURACAO = 'F' 
          AND RHPONT_RES_SIT_DIA.CODIGO_SITUACAO IN ('0020')) FR
      GROUP BY FR.DISTANCE, FR.CODIGO_EMPRESA, FR.CODIGO_PLANO, FR.CODIGO_SITUACAO, FR.DESCRICAO_SITUACAO, FR.MATRICULA, FR.DIGITO, FR.NOME, FR.CPF, FR.PIS_PASEP,FR.CODIGO_CARGO, FR.DATA_ADMISSAO_POSSE, FR.SITUACAO_FUNCIONAL, FR.CID, FR.DT_ULT_ALTER_USUA 
      UNION ALL ( 
        SELECT 
          TO_CHAR(MIN(FR.DATA), 'YYYYMM') AS ANO_MES_REFERENCIA, FR.CODIGO_PLANO,FR.SITUACAO_FUNCIONAL,FR.CODIGO_EMPRESA,
          FR.MATRICULA,FR.DIGITO,FR.NOME,FR.CPF,FR.PIS_PASEP,FR.CODIGO_CARGO,FR.DATA_ADMISSAO_POSSE, 
          TO_CHAR(MIN(FR.DATA), 'RRRRMMDD') AS DATA_INICIO, TO_CHAR(MAX(FR.DATA), 'YYYYMMDD') AS DATA_FIM, COUNT(FR.DATA) DIAS,FR.CID, FR.DT_ULT_ALTER_USUA
        FROM (
          SELECT 
            TO_DATE(TO_CHAR(RHPONT_RES_SIT_DIA.DATA, 'DD/MM/YYYY'), 'DD/MM/YYYY') AS DATA,
            RHPONT_RES_SIT_DIA.DATA - ROW_NUMBER() OVER(ORDER BY RHPESS_CONTRATO.COD_UNIDADE1, RHPESS_CONTRATO.COD_UNIDADE2, RHPESS_CONTRATO.COD_UNIDADE3, RHPESS_CONTRATO.COD_UNIDADE4, RHPESS_CONTRATO.COD_UNIDADE5, RHPESS_CONTRATO.COD_UNIDADE6, RHPESS_CONTRATO.CODIGO, RHPONT_RES_SIT_DIA.CODIGO_SITUACAO, RHPONT_RES_SIT_DIA.DATA) AS DISTANCE,
            RHPONT_RES_SIT_DIA.CODIGO_SITUACAO, TO_NUMBER(RHPESS_CONTRATO.CODIGO_EMPRESA) AS CODIGO_EMPRESA, RHPONT_SITUACAO.DESCRICAO DESCRICAO_SITUACAO,
            TO_NUMBER(SUBSTR(RHPESS_CONTRATO.CODIGO, 5, 10)) AS MATRICULA, 
            CASE WHEN SUBSTR(RHPESS_CONTRATO.CODIGO, 15, 1) = 'X' THEN 7 ELSE TO_NUMBER(SUBSTR(RHPESS_CONTRATO.CODIGO, 15, 1)) END AS DIGITO,
            SUBSTR(TRIM(RHPESS_CONTRATO.NOME), 1, 80) AS NOME, SUBSTR(TRIM(RHPESS_PESSOA.CPF), 1, 11) AS CPF, TO_NUMBER(NVL(TRIM(RHPESS_PESSOA.PIS_PASEP), 0)) AS PIS_PASEP,
            CASE WHEN RHPESS_CONTRATO.DATA_ADMISSAO <= TO_DATE('30/12/2011', 'DD/MM/YYYY') THEN 1 ELSE 2 END AS CODIGO_PLANO,
            TO_NUMBER(SUBSTR(TRIM(RHPESS_CONTRATO.COD_CARGO_EFETIVO), 12, 4)) AS CODIGO_CARGO,
            CASE
              WHEN RHPESS_CONTRATO.DATA_EFETIVO_EXERC IS NOT NULL THEN TO_CHAR(RHPESS_CONTRATO.DATA_EFETIVO_EXERC, 'YYYYMMDD')
              ELSE TO_CHAR(RHPESS_CONTRATO.DATA_ADMISSAO, 'YYYYMMDD')
            END AS DATA_ADMISSAO_POSSE, RHPONT_RES_SIT_DIA.CODIGO_SITUACAO AS SITUACAO_FUNCIONAL, NULL AS CID, RHPONT_RES_SIT_DIA.DT_ULT_ALTER_USUA
           FROM RHPONT_RES_SIT_DIA,RHPONT_SITUACAO,RHPESS_CONTRATO,RHPESS_PESSOA,RHORGA_UNIDADE,RHPARM_SIT_FUNC,RHPLCS_CARGO
          WHERE RHPONT_RES_SIT_DIA.DT_ULT_ALTER_USUA > ULTIMA_ALTERACAO
            AND RHPESS_CONTRATO.TIPO_CONTRATO = '0001' AND RHPESS_CONTRATO.CODIGO_EMPRESA = '0001' AND (RHPESS_CONTRATO.SITUACAO_FUNCIONAL <= '7000' OR RHPESS_CONTRATO.SITUACAO_FUNCIONAL IN ('8000','8001')) 
            AND RHPESS_CONTRATO.COD_CARGO_PAGTO NOT IN ('000000000002006','000000000002007')
            AND RHPESS_CONTRATO.ANO_MES_REFERENCIA = (
                SELECT MAX(ARTERH_CONTRATO.ANO_MES_REFERENCIA) 
                  FROM RHPESS_CONTRATO ARTERH_CONTRATO
                 WHERE RHPESS_CONTRATO.CODIGO_EMPRESA = ARTERH_CONTRATO.CODIGO_EMPRESA
                   AND RHPESS_CONTRATO.TIPO_CONTRATO = ARTERH_CONTRATO.TIPO_CONTRATO
                   AND RHPESS_CONTRATO.CODIGO = ARTERH_CONTRATO.CODIGO
                   AND ARTERH_CONTRATO.ANO_MES_REFERENCIA <= SYSDATE )
            AND RHPESS_CONTRATO.CODIGO_EMPRESA = RHPONT_RES_SIT_DIA.CODIGO_EMPRESA AND RHPESS_CONTRATO.TIPO_CONTRATO = RHPONT_RES_SIT_DIA.TIPO_CONTRATO AND RHPESS_CONTRATO.CODIGO = RHPONT_RES_SIT_DIA.CODIGO_CONTRATO 
            AND RHPONT_RES_SIT_DIA.CODIGO_SITUACAO = RHPONT_SITUACAO.CODIGO AND RHPESS_PESSOA.CODIGO_EMPRESA = RHPESS_CONTRATO.CODIGO_EMPRESA AND RHPESS_PESSOA.CODIGO = RHPESS_CONTRATO.CODIGO_PESSOA
            AND RHPESS_CONTRATO.COD_UNIDADE1 = RHORGA_UNIDADE.COD_UNIDADE1 AND RHPESS_CONTRATO.COD_UNIDADE2 = RHORGA_UNIDADE.COD_UNIDADE2 AND RHPESS_CONTRATO.COD_UNIDADE3 = RHORGA_UNIDADE.COD_UNIDADE3 
            AND RHPESS_CONTRATO.COD_UNIDADE4 = RHORGA_UNIDADE.COD_UNIDADE4 AND RHPESS_CONTRATO.COD_UNIDADE5 = RHORGA_UNIDADE.COD_UNIDADE5 AND RHPESS_CONTRATO.COD_UNIDADE6 = RHORGA_UNIDADE.COD_UNIDADE6 
            AND RHPESS_CONTRATO.CODIGO_EMPRESA = RHORGA_UNIDADE.CODIGO_EMPRESA AND RHPESS_CONTRATO.SITUACAO_FUNCIONAL = RHPARM_SIT_FUNC.CODIGO AND RHPESS_CONTRATO.CODIGO_EMPRESA = RHPLCS_CARGO.CODIGO_EMPRESA (+)
            AND RHPESS_CONTRATO.COD_CARGO_EFETIVO = RHPLCS_CARGO.CODIGO (+) AND RHPONT_RES_SIT_DIA.TIPO_APURACAO = 'F' 
            AND RHPONT_RES_SIT_DIA.CODIGO_SITUACAO IN ('0500')) FR
        GROUP BY FR.DISTANCE, FR.CODIGO_EMPRESA, FR.CODIGO_PLANO, FR.CODIGO_SITUACAO, FR.DESCRICAO_SITUACAO, FR.MATRICULA, FR.DIGITO, FR.NOME, FR.CPF, FR.PIS_PASEP,FR.CODIGO_CARGO, FR.DATA_ADMISSAO_POSSE, FR.SITUACAO_FUNCIONAL, FR.CID, FR.DT_ULT_ALTER_USUA)
      UNION ALL ( 
      SELECT 
        TO_CHAR(MIN(FR.DATA), 'YYYYMM') AS ANO_MES_REFERENCIA, FR.CODIGO_PLANO,FR.SITUACAO_FUNCIONAL,FR.CODIGO_EMPRESA,
        FR.MATRICULA,FR.DIGITO,FR.NOME,FR.CPF,FR.PIS_PASEP,FR.CODIGO_CARGO,FR.DATA_ADMISSAO_POSSE, 
        TO_CHAR(MIN(FR.DATA), 'RRRRMMDD') AS DATA_INICIO, TO_CHAR(MAX(FR.DATA), 'YYYYMMDD') AS DATA_FIM, COUNT(FR.DATA) DIAS,FR.CID, FR.DT_ULT_ALTER_USUA
      FROM (
        SELECT 
          TO_DATE(TO_CHAR(RHPONT_RES_SIT_DIA.DATA, 'DD/MM/YYYY'), 'DD/MM/YYYY') AS DATA,
          RHPONT_RES_SIT_DIA.DATA - ROW_NUMBER() OVER(ORDER BY RHPESS_CONTRATO.COD_UNIDADE1, RHPESS_CONTRATO.COD_UNIDADE2, RHPESS_CONTRATO.COD_UNIDADE3, RHPESS_CONTRATO.COD_UNIDADE4, RHPESS_CONTRATO.COD_UNIDADE5, RHPESS_CONTRATO.COD_UNIDADE6, RHPESS_CONTRATO.CODIGO, RHPONT_RES_SIT_DIA.CODIGO_SITUACAO, RHPONT_RES_SIT_DIA.DATA) AS DISTANCE,
          RHPONT_RES_SIT_DIA.CODIGO_SITUACAO, TO_NUMBER(RHPESS_CONTRATO.CODIGO_EMPRESA) AS CODIGO_EMPRESA, RHPONT_SITUACAO.DESCRICAO DESCRICAO_SITUACAO,
          TO_NUMBER(SUBSTR(RHPESS_CONTRATO.CODIGO, 5, 10)) AS MATRICULA, 
          CASE WHEN SUBSTR(RHPESS_CONTRATO.CODIGO, 15, 1) = 'X' THEN 7 ELSE TO_NUMBER(SUBSTR(RHPESS_CONTRATO.CODIGO, 15, 1)) END AS DIGITO,
          SUBSTR(TRIM(RHPESS_CONTRATO.NOME), 1, 80) AS NOME, SUBSTR(TRIM(RHPESS_PESSOA.CPF), 1, 11) AS CPF, TO_NUMBER(NVL(TRIM(RHPESS_PESSOA.PIS_PASEP), 0)) AS PIS_PASEP,
          CASE WHEN RHPESS_CONTRATO.DATA_ADMISSAO <= TO_DATE('30/12/2011', 'DD/MM/YYYY') THEN 1 ELSE 2 END AS CODIGO_PLANO,
          TO_NUMBER(SUBSTR(TRIM(RHPESS_CONTRATO.COD_CARGO_EFETIVO), 12, 4)) AS CODIGO_CARGO,
          CASE
            WHEN RHPESS_CONTRATO.DATA_EFETIVO_EXERC IS NOT NULL THEN TO_CHAR(RHPESS_CONTRATO.DATA_EFETIVO_EXERC, 'YYYYMMDD')
            ELSE TO_CHAR(RHPESS_CONTRATO.DATA_ADMISSAO, 'YYYYMMDD')
          END AS DATA_ADMISSAO_POSSE, RHPONT_RES_SIT_DIA.CODIGO_SITUACAO AS SITUACAO_FUNCIONAL, NULL AS CID, RHPONT_RES_SIT_DIA.DT_ULT_ALTER_USUA
         FROM RHPONT_RES_SIT_DIA,RHPONT_SITUACAO,RHPESS_CONTRATO,RHPESS_PESSOA,RHORGA_UNIDADE,RHPARM_SIT_FUNC,RHPLCS_CARGO
        WHERE RHPONT_RES_SIT_DIA.DT_ULT_ALTER_USUA > ULTIMA_ALTERACAO
          AND RHPESS_CONTRATO.TIPO_CONTRATO = '0001' AND RHPESS_CONTRATO.CODIGO_EMPRESA = '0001' AND (RHPESS_CONTRATO.SITUACAO_FUNCIONAL <= '7000' OR RHPESS_CONTRATO.SITUACAO_FUNCIONAL IN ('8000','8001')) 
          AND RHPESS_CONTRATO.COD_CARGO_PAGTO NOT IN ('000000000002006','000000000002007')
          AND RHPESS_CONTRATO.ANO_MES_REFERENCIA = (
              SELECT MAX(ARTERH_CONTRATO.ANO_MES_REFERENCIA) 
                FROM RHPESS_CONTRATO ARTERH_CONTRATO
               WHERE RHPESS_CONTRATO.CODIGO_EMPRESA = ARTERH_CONTRATO.CODIGO_EMPRESA
                 AND RHPESS_CONTRATO.TIPO_CONTRATO = ARTERH_CONTRATO.TIPO_CONTRATO
                 AND RHPESS_CONTRATO.CODIGO = ARTERH_CONTRATO.CODIGO
                 AND ARTERH_CONTRATO.ANO_MES_REFERENCIA <= SYSDATE )
          AND RHPESS_CONTRATO.CODIGO_EMPRESA = RHPONT_RES_SIT_DIA.CODIGO_EMPRESA AND RHPESS_CONTRATO.TIPO_CONTRATO = RHPONT_RES_SIT_DIA.TIPO_CONTRATO AND RHPESS_CONTRATO.CODIGO = RHPONT_RES_SIT_DIA.CODIGO_CONTRATO 
          AND RHPONT_RES_SIT_DIA.CODIGO_SITUACAO = RHPONT_SITUACAO.CODIGO AND RHPESS_PESSOA.CODIGO_EMPRESA = RHPESS_CONTRATO.CODIGO_EMPRESA AND RHPESS_PESSOA.CODIGO = RHPESS_CONTRATO.CODIGO_PESSOA
          AND RHPESS_CONTRATO.COD_UNIDADE1 = RHORGA_UNIDADE.COD_UNIDADE1 AND RHPESS_CONTRATO.COD_UNIDADE2 = RHORGA_UNIDADE.COD_UNIDADE2 AND RHPESS_CONTRATO.COD_UNIDADE3 = RHORGA_UNIDADE.COD_UNIDADE3 
          AND RHPESS_CONTRATO.COD_UNIDADE4 = RHORGA_UNIDADE.COD_UNIDADE4 AND RHPESS_CONTRATO.COD_UNIDADE5 = RHORGA_UNIDADE.COD_UNIDADE5 AND RHPESS_CONTRATO.COD_UNIDADE6 = RHORGA_UNIDADE.COD_UNIDADE6 
          AND RHPESS_CONTRATO.CODIGO_EMPRESA = RHORGA_UNIDADE.CODIGO_EMPRESA AND RHPESS_CONTRATO.SITUACAO_FUNCIONAL = RHPARM_SIT_FUNC.CODIGO AND RHPESS_CONTRATO.CODIGO_EMPRESA = RHPLCS_CARGO.CODIGO_EMPRESA (+)
          AND RHPESS_CONTRATO.COD_CARGO_EFETIVO = RHPLCS_CARGO.CODIGO (+) AND RHPONT_RES_SIT_DIA.TIPO_APURACAO = 'F' 
          AND RHPONT_RES_SIT_DIA.CODIGO_SITUACAO IN ('0503')) FR
      GROUP BY FR.DISTANCE, FR.CODIGO_EMPRESA, FR.CODIGO_PLANO, FR.CODIGO_SITUACAO, FR.DESCRICAO_SITUACAO, FR.MATRICULA, FR.DIGITO, FR.NOME, FR.CPF, FR.PIS_PASEP,FR.CODIGO_CARGO, FR.DATA_ADMISSAO_POSSE, FR.SITUACAO_FUNCIONAL, FR.CID, FR.DT_ULT_ALTER_USUA) 
      UNION ALL ( 
      SELECT 
        TO_CHAR(MIN(FR.DATA), 'YYYYMM') AS ANO_MES_REFERENCIA, FR.CODIGO_PLANO,FR.SITUACAO_FUNCIONAL,FR.CODIGO_EMPRESA,
        FR.MATRICULA,FR.DIGITO,FR.NOME,FR.CPF,FR.PIS_PASEP,FR.CODIGO_CARGO,FR.DATA_ADMISSAO_POSSE, 
        TO_CHAR(MIN(FR.DATA), 'RRRRMMDD') AS DATA_INICIO, TO_CHAR(MAX(FR.DATA), 'YYYYMMDD') AS DATA_FIM, COUNT(FR.DATA) DIAS,FR.CID, FR.DT_ULT_ALTER_USUA
      FROM (
        SELECT 
          TO_DATE(TO_CHAR(RHPONT_RES_SIT_DIA.DATA, 'DD/MM/YYYY'), 'DD/MM/YYYY') AS DATA,
          RHPONT_RES_SIT_DIA.DATA - ROW_NUMBER() OVER(ORDER BY RHPESS_CONTRATO.COD_UNIDADE1, RHPESS_CONTRATO.COD_UNIDADE2, RHPESS_CONTRATO.COD_UNIDADE3, RHPESS_CONTRATO.COD_UNIDADE4, RHPESS_CONTRATO.COD_UNIDADE5, RHPESS_CONTRATO.COD_UNIDADE6, RHPESS_CONTRATO.CODIGO, RHPONT_RES_SIT_DIA.CODIGO_SITUACAO, RHPONT_RES_SIT_DIA.DATA) AS DISTANCE,
          RHPONT_RES_SIT_DIA.CODIGO_SITUACAO, TO_NUMBER(RHPESS_CONTRATO.CODIGO_EMPRESA) AS CODIGO_EMPRESA, RHPONT_SITUACAO.DESCRICAO DESCRICAO_SITUACAO,
          TO_NUMBER(SUBSTR(RHPESS_CONTRATO.CODIGO, 5, 10)) AS MATRICULA, 
          CASE WHEN SUBSTR(RHPESS_CONTRATO.CODIGO, 15, 1) = 'X' THEN 7 ELSE TO_NUMBER(SUBSTR(RHPESS_CONTRATO.CODIGO, 15, 1)) END AS DIGITO,
          SUBSTR(TRIM(RHPESS_CONTRATO.NOME), 1, 80) AS NOME, SUBSTR(TRIM(RHPESS_PESSOA.CPF), 1, 11) AS CPF, TO_NUMBER(NVL(TRIM(RHPESS_PESSOA.PIS_PASEP), 0)) AS PIS_PASEP,
          CASE WHEN RHPESS_CONTRATO.DATA_ADMISSAO <= TO_DATE('30/12/2011', 'DD/MM/YYYY') THEN 1 ELSE 2 END AS CODIGO_PLANO,
          TO_NUMBER(SUBSTR(TRIM(RHPESS_CONTRATO.COD_CARGO_EFETIVO), 12, 4)) AS CODIGO_CARGO,
          CASE
            WHEN RHPESS_CONTRATO.DATA_EFETIVO_EXERC IS NOT NULL THEN TO_CHAR(RHPESS_CONTRATO.DATA_EFETIVO_EXERC, 'YYYYMMDD')
            ELSE TO_CHAR(RHPESS_CONTRATO.DATA_ADMISSAO, 'YYYYMMDD')
          END AS DATA_ADMISSAO_POSSE, RHPONT_RES_SIT_DIA.CODIGO_SITUACAO AS SITUACAO_FUNCIONAL, NULL AS CID, RHPONT_RES_SIT_DIA.DT_ULT_ALTER_USUA
         FROM RHPONT_RES_SIT_DIA,RHPONT_SITUACAO,RHPESS_CONTRATO,RHPESS_PESSOA,RHORGA_UNIDADE,RHPARM_SIT_FUNC,RHPLCS_CARGO
        WHERE RHPONT_RES_SIT_DIA.DT_ULT_ALTER_USUA > ULTIMA_ALTERACAO
          AND RHPESS_CONTRATO.TIPO_CONTRATO = '0001' AND RHPESS_CONTRATO.CODIGO_EMPRESA = '0001' AND (RHPESS_CONTRATO.SITUACAO_FUNCIONAL <= '7000' OR RHPESS_CONTRATO.SITUACAO_FUNCIONAL IN ('8000','8001')) 
          AND RHPESS_CONTRATO.COD_CARGO_PAGTO NOT IN ('000000000002006','000000000002007')
          AND RHPESS_CONTRATO.ANO_MES_REFERENCIA = (
              SELECT MAX(ARTERH_CONTRATO.ANO_MES_REFERENCIA) 
                FROM RHPESS_CONTRATO ARTERH_CONTRATO
               WHERE RHPESS_CONTRATO.CODIGO_EMPRESA = ARTERH_CONTRATO.CODIGO_EMPRESA
                 AND RHPESS_CONTRATO.TIPO_CONTRATO = ARTERH_CONTRATO.TIPO_CONTRATO
                 AND RHPESS_CONTRATO.CODIGO = ARTERH_CONTRATO.CODIGO
                 AND ARTERH_CONTRATO.ANO_MES_REFERENCIA <= SYSDATE )
          AND RHPESS_CONTRATO.CODIGO_EMPRESA = RHPONT_RES_SIT_DIA.CODIGO_EMPRESA AND RHPESS_CONTRATO.TIPO_CONTRATO = RHPONT_RES_SIT_DIA.TIPO_CONTRATO AND RHPESS_CONTRATO.CODIGO = RHPONT_RES_SIT_DIA.CODIGO_CONTRATO 
          AND RHPONT_RES_SIT_DIA.CODIGO_SITUACAO = RHPONT_SITUACAO.CODIGO AND RHPESS_PESSOA.CODIGO_EMPRESA = RHPESS_CONTRATO.CODIGO_EMPRESA AND RHPESS_PESSOA.CODIGO = RHPESS_CONTRATO.CODIGO_PESSOA
          AND RHPESS_CONTRATO.COD_UNIDADE1 = RHORGA_UNIDADE.COD_UNIDADE1 AND RHPESS_CONTRATO.COD_UNIDADE2 = RHORGA_UNIDADE.COD_UNIDADE2 AND RHPESS_CONTRATO.COD_UNIDADE3 = RHORGA_UNIDADE.COD_UNIDADE3 
          AND RHPESS_CONTRATO.COD_UNIDADE4 = RHORGA_UNIDADE.COD_UNIDADE4 AND RHPESS_CONTRATO.COD_UNIDADE5 = RHORGA_UNIDADE.COD_UNIDADE5 AND RHPESS_CONTRATO.COD_UNIDADE6 = RHORGA_UNIDADE.COD_UNIDADE6 
          AND RHPESS_CONTRATO.CODIGO_EMPRESA = RHORGA_UNIDADE.CODIGO_EMPRESA AND RHPESS_CONTRATO.SITUACAO_FUNCIONAL = RHPARM_SIT_FUNC.CODIGO AND RHPESS_CONTRATO.CODIGO_EMPRESA = RHPLCS_CARGO.CODIGO_EMPRESA (+)
          AND RHPESS_CONTRATO.COD_CARGO_EFETIVO = RHPLCS_CARGO.CODIGO (+) AND RHPONT_RES_SIT_DIA.TIPO_APURACAO = 'F' 
          AND RHPONT_RES_SIT_DIA.CODIGO_SITUACAO IN ('0506')) FR
      GROUP BY FR.DISTANCE, FR.CODIGO_EMPRESA, FR.CODIGO_PLANO, FR.CODIGO_SITUACAO, FR.DESCRICAO_SITUACAO, FR.MATRICULA, FR.DIGITO, FR.NOME, FR.CPF, FR.PIS_PASEP,FR.CODIGO_CARGO, FR.DATA_ADMISSAO_POSSE, FR.SITUACAO_FUNCIONAL, FR.CID, FR.DT_ULT_ALTER_USUA) 
      UNION ALL ( 
      SELECT 
        TO_CHAR(MIN(FR.DATA), 'YYYYMM') AS ANO_MES_REFERENCIA, FR.CODIGO_PLANO,FR.SITUACAO_FUNCIONAL,FR.CODIGO_EMPRESA,
        FR.MATRICULA,FR.DIGITO,FR.NOME,FR.CPF,FR.PIS_PASEP,FR.CODIGO_CARGO,FR.DATA_ADMISSAO_POSSE, 
        TO_CHAR(MIN(FR.DATA), 'RRRRMMDD') AS DATA_INICIO, TO_CHAR(MAX(FR.DATA), 'YYYYMMDD') AS DATA_FIM, COUNT(FR.DATA) DIAS,FR.CID, FR.DT_ULT_ALTER_USUA
      FROM (
        SELECT 
          TO_DATE(TO_CHAR(RHPONT_RES_SIT_DIA.DATA, 'DD/MM/YYYY'), 'DD/MM/YYYY') AS DATA,
          RHPONT_RES_SIT_DIA.DATA - ROW_NUMBER() OVER(ORDER BY RHPESS_CONTRATO.COD_UNIDADE1, RHPESS_CONTRATO.COD_UNIDADE2, RHPESS_CONTRATO.COD_UNIDADE3, RHPESS_CONTRATO.COD_UNIDADE4, RHPESS_CONTRATO.COD_UNIDADE5, RHPESS_CONTRATO.COD_UNIDADE6, RHPESS_CONTRATO.CODIGO, RHPONT_RES_SIT_DIA.CODIGO_SITUACAO, RHPONT_RES_SIT_DIA.DATA) AS DISTANCE,
          RHPONT_RES_SIT_DIA.CODIGO_SITUACAO, TO_NUMBER(RHPESS_CONTRATO.CODIGO_EMPRESA) AS CODIGO_EMPRESA, RHPONT_SITUACAO.DESCRICAO DESCRICAO_SITUACAO,
          TO_NUMBER(SUBSTR(RHPESS_CONTRATO.CODIGO, 5, 10)) AS MATRICULA, 
          CASE WHEN SUBSTR(RHPESS_CONTRATO.CODIGO, 15, 1) = 'X' THEN 7 ELSE TO_NUMBER(SUBSTR(RHPESS_CONTRATO.CODIGO, 15, 1)) END AS DIGITO,
          SUBSTR(TRIM(RHPESS_CONTRATO.NOME), 1, 80) AS NOME, SUBSTR(TRIM(RHPESS_PESSOA.CPF), 1, 11) AS CPF, TO_NUMBER(NVL(TRIM(RHPESS_PESSOA.PIS_PASEP), 0)) AS PIS_PASEP,
          CASE WHEN RHPESS_CONTRATO.DATA_ADMISSAO <= TO_DATE('30/12/2011', 'DD/MM/YYYY') THEN 1 ELSE 2 END AS CODIGO_PLANO,
          TO_NUMBER(SUBSTR(TRIM(RHPESS_CONTRATO.COD_CARGO_EFETIVO), 12, 4)) AS CODIGO_CARGO,
          CASE
            WHEN RHPESS_CONTRATO.DATA_EFETIVO_EXERC IS NOT NULL THEN TO_CHAR(RHPESS_CONTRATO.DATA_EFETIVO_EXERC, 'YYYYMMDD')
            ELSE TO_CHAR(RHPESS_CONTRATO.DATA_ADMISSAO, 'YYYYMMDD')
          END AS DATA_ADMISSAO_POSSE, RHPONT_RES_SIT_DIA.CODIGO_SITUACAO AS SITUACAO_FUNCIONAL, NULL AS CID, RHPONT_RES_SIT_DIA.DT_ULT_ALTER_USUA
         FROM RHPONT_RES_SIT_DIA,RHPONT_SITUACAO,RHPESS_CONTRATO,RHPESS_PESSOA,RHORGA_UNIDADE,RHPARM_SIT_FUNC,RHPLCS_CARGO
        WHERE RHPONT_RES_SIT_DIA.DT_ULT_ALTER_USUA > ULTIMA_ALTERACAO
          AND RHPESS_CONTRATO.TIPO_CONTRATO = '0001' AND RHPESS_CONTRATO.CODIGO_EMPRESA = '0001' AND (RHPESS_CONTRATO.SITUACAO_FUNCIONAL <= '7000' OR RHPESS_CONTRATO.SITUACAO_FUNCIONAL IN ('8000','8001')) 
          AND RHPESS_CONTRATO.COD_CARGO_PAGTO NOT IN ('000000000002006','000000000002007')
          AND RHPESS_CONTRATO.ANO_MES_REFERENCIA = (
              SELECT MAX(ARTERH_CONTRATO.ANO_MES_REFERENCIA) 
                FROM RHPESS_CONTRATO ARTERH_CONTRATO
               WHERE RHPESS_CONTRATO.CODIGO_EMPRESA = ARTERH_CONTRATO.CODIGO_EMPRESA
                 AND RHPESS_CONTRATO.TIPO_CONTRATO = ARTERH_CONTRATO.TIPO_CONTRATO
                 AND RHPESS_CONTRATO.CODIGO = ARTERH_CONTRATO.CODIGO
                 AND ARTERH_CONTRATO.ANO_MES_REFERENCIA <= SYSDATE )
          AND RHPESS_CONTRATO.CODIGO_EMPRESA = RHPONT_RES_SIT_DIA.CODIGO_EMPRESA AND RHPESS_CONTRATO.TIPO_CONTRATO = RHPONT_RES_SIT_DIA.TIPO_CONTRATO AND RHPESS_CONTRATO.CODIGO = RHPONT_RES_SIT_DIA.CODIGO_CONTRATO 
          AND RHPONT_RES_SIT_DIA.CODIGO_SITUACAO = RHPONT_SITUACAO.CODIGO AND RHPESS_PESSOA.CODIGO_EMPRESA = RHPESS_CONTRATO.CODIGO_EMPRESA AND RHPESS_PESSOA.CODIGO = RHPESS_CONTRATO.CODIGO_PESSOA
          AND RHPESS_CONTRATO.COD_UNIDADE1 = RHORGA_UNIDADE.COD_UNIDADE1 AND RHPESS_CONTRATO.COD_UNIDADE2 = RHORGA_UNIDADE.COD_UNIDADE2 AND RHPESS_CONTRATO.COD_UNIDADE3 = RHORGA_UNIDADE.COD_UNIDADE3 
          AND RHPESS_CONTRATO.COD_UNIDADE4 = RHORGA_UNIDADE.COD_UNIDADE4 AND RHPESS_CONTRATO.COD_UNIDADE5 = RHORGA_UNIDADE.COD_UNIDADE5 AND RHPESS_CONTRATO.COD_UNIDADE6 = RHORGA_UNIDADE.COD_UNIDADE6 
          AND RHPESS_CONTRATO.CODIGO_EMPRESA = RHORGA_UNIDADE.CODIGO_EMPRESA AND RHPESS_CONTRATO.SITUACAO_FUNCIONAL = RHPARM_SIT_FUNC.CODIGO AND RHPESS_CONTRATO.CODIGO_EMPRESA = RHPLCS_CARGO.CODIGO_EMPRESA (+)
          AND RHPESS_CONTRATO.COD_CARGO_EFETIVO = RHPLCS_CARGO.CODIGO (+) AND RHPONT_RES_SIT_DIA.TIPO_APURACAO = 'F' 
          AND RHPONT_RES_SIT_DIA.CODIGO_SITUACAO IN ('0509')) FR
      GROUP BY FR.DISTANCE, FR.CODIGO_EMPRESA, FR.CODIGO_PLANO, FR.CODIGO_SITUACAO, FR.DESCRICAO_SITUACAO, FR.MATRICULA, FR.DIGITO, FR.NOME, FR.CPF, FR.PIS_PASEP,FR.CODIGO_CARGO, FR.DATA_ADMISSAO_POSSE, FR.SITUACAO_FUNCIONAL, FR.CID, FR.DT_ULT_ALTER_USUA)
      UNION ALL ( 
      SELECT 
        TO_CHAR(MIN(FR.DATA), 'YYYYMM') AS ANO_MES_REFERENCIA, FR.CODIGO_PLANO,FR.SITUACAO_FUNCIONAL,FR.CODIGO_EMPRESA,
        FR.MATRICULA,FR.DIGITO,FR.NOME,FR.CPF,FR.PIS_PASEP,FR.CODIGO_CARGO,FR.DATA_ADMISSAO_POSSE, 
        TO_CHAR(MIN(FR.DATA), 'RRRRMMDD') AS DATA_INICIO, TO_CHAR(MAX(FR.DATA), 'YYYYMMDD') AS DATA_FIM, COUNT(FR.DATA) DIAS,FR.CID, FR.DT_ULT_ALTER_USUA
      FROM (
        SELECT 
          TO_DATE(TO_CHAR(RHPONT_RES_SIT_DIA.DATA, 'DD/MM/YYYY'), 'DD/MM/YYYY') AS DATA,
          RHPONT_RES_SIT_DIA.DATA - ROW_NUMBER() OVER(ORDER BY RHPESS_CONTRATO.COD_UNIDADE1, RHPESS_CONTRATO.COD_UNIDADE2, RHPESS_CONTRATO.COD_UNIDADE3, RHPESS_CONTRATO.COD_UNIDADE4, RHPESS_CONTRATO.COD_UNIDADE5, RHPESS_CONTRATO.COD_UNIDADE6, RHPESS_CONTRATO.CODIGO, RHPONT_RES_SIT_DIA.CODIGO_SITUACAO, RHPONT_RES_SIT_DIA.DATA) AS DISTANCE,
          RHPONT_RES_SIT_DIA.CODIGO_SITUACAO, TO_NUMBER(RHPESS_CONTRATO.CODIGO_EMPRESA) AS CODIGO_EMPRESA, RHPONT_SITUACAO.DESCRICAO DESCRICAO_SITUACAO,
          TO_NUMBER(SUBSTR(RHPESS_CONTRATO.CODIGO, 5, 10)) AS MATRICULA, 
          CASE WHEN SUBSTR(RHPESS_CONTRATO.CODIGO, 15, 1) = 'X' THEN 7 ELSE TO_NUMBER(SUBSTR(RHPESS_CONTRATO.CODIGO, 15, 1)) END AS DIGITO,
          SUBSTR(TRIM(RHPESS_CONTRATO.NOME), 1, 80) AS NOME, SUBSTR(TRIM(RHPESS_PESSOA.CPF), 1, 11) AS CPF, TO_NUMBER(NVL(TRIM(RHPESS_PESSOA.PIS_PASEP), 0)) AS PIS_PASEP,
          CASE WHEN RHPESS_CONTRATO.DATA_ADMISSAO <= TO_DATE('30/12/2011', 'DD/MM/YYYY') THEN 1 ELSE 2 END AS CODIGO_PLANO,
          TO_NUMBER(SUBSTR(TRIM(RHPESS_CONTRATO.COD_CARGO_EFETIVO), 12, 4)) AS CODIGO_CARGO,
          CASE
            WHEN RHPESS_CONTRATO.DATA_EFETIVO_EXERC IS NOT NULL THEN TO_CHAR(RHPESS_CONTRATO.DATA_EFETIVO_EXERC, 'YYYYMMDD')
            ELSE TO_CHAR(RHPESS_CONTRATO.DATA_ADMISSAO, 'YYYYMMDD')
          END AS DATA_ADMISSAO_POSSE, RHPONT_RES_SIT_DIA.CODIGO_SITUACAO AS SITUACAO_FUNCIONAL, NULL AS CID, RHPONT_RES_SIT_DIA.DT_ULT_ALTER_USUA
         FROM RHPONT_RES_SIT_DIA,RHPONT_SITUACAO,RHPESS_CONTRATO,RHPESS_PESSOA,RHORGA_UNIDADE,RHPARM_SIT_FUNC,RHPLCS_CARGO
        WHERE RHPONT_RES_SIT_DIA.DT_ULT_ALTER_USUA > ULTIMA_ALTERACAO
          AND RHPESS_CONTRATO.TIPO_CONTRATO = '0001' AND RHPESS_CONTRATO.CODIGO_EMPRESA = '0001' AND (RHPESS_CONTRATO.SITUACAO_FUNCIONAL <= '7000' OR RHPESS_CONTRATO.SITUACAO_FUNCIONAL IN ('8000','8001')) 
          AND RHPESS_CONTRATO.COD_CARGO_PAGTO NOT IN ('000000000002006','000000000002007')
          AND RHPESS_CONTRATO.ANO_MES_REFERENCIA = (
              SELECT MAX(ARTERH_CONTRATO.ANO_MES_REFERENCIA) 
                FROM RHPESS_CONTRATO ARTERH_CONTRATO
               WHERE RHPESS_CONTRATO.CODIGO_EMPRESA = ARTERH_CONTRATO.CODIGO_EMPRESA
                 AND RHPESS_CONTRATO.TIPO_CONTRATO = ARTERH_CONTRATO.TIPO_CONTRATO
                 AND RHPESS_CONTRATO.CODIGO = ARTERH_CONTRATO.CODIGO
                 AND ARTERH_CONTRATO.ANO_MES_REFERENCIA <= SYSDATE )
          AND RHPESS_CONTRATO.CODIGO_EMPRESA = RHPONT_RES_SIT_DIA.CODIGO_EMPRESA AND RHPESS_CONTRATO.TIPO_CONTRATO = RHPONT_RES_SIT_DIA.TIPO_CONTRATO AND RHPESS_CONTRATO.CODIGO = RHPONT_RES_SIT_DIA.CODIGO_CONTRATO 
          AND RHPONT_RES_SIT_DIA.CODIGO_SITUACAO = RHPONT_SITUACAO.CODIGO AND RHPESS_PESSOA.CODIGO_EMPRESA = RHPESS_CONTRATO.CODIGO_EMPRESA AND RHPESS_PESSOA.CODIGO = RHPESS_CONTRATO.CODIGO_PESSOA
          AND RHPESS_CONTRATO.COD_UNIDADE1 = RHORGA_UNIDADE.COD_UNIDADE1 AND RHPESS_CONTRATO.COD_UNIDADE2 = RHORGA_UNIDADE.COD_UNIDADE2 AND RHPESS_CONTRATO.COD_UNIDADE3 = RHORGA_UNIDADE.COD_UNIDADE3 
          AND RHPESS_CONTRATO.COD_UNIDADE4 = RHORGA_UNIDADE.COD_UNIDADE4 AND RHPESS_CONTRATO.COD_UNIDADE5 = RHORGA_UNIDADE.COD_UNIDADE5 AND RHPESS_CONTRATO.COD_UNIDADE6 = RHORGA_UNIDADE.COD_UNIDADE6 
          AND RHPESS_CONTRATO.CODIGO_EMPRESA = RHORGA_UNIDADE.CODIGO_EMPRESA AND RHPESS_CONTRATO.SITUACAO_FUNCIONAL = RHPARM_SIT_FUNC.CODIGO AND RHPESS_CONTRATO.CODIGO_EMPRESA = RHPLCS_CARGO.CODIGO_EMPRESA (+)
          AND RHPESS_CONTRATO.COD_CARGO_EFETIVO = RHPLCS_CARGO.CODIGO (+) AND RHPONT_RES_SIT_DIA.TIPO_APURACAO = 'F' 
          AND RHPONT_RES_SIT_DIA.CODIGO_SITUACAO IN ('0514')) FR
      GROUP BY FR.DISTANCE, FR.CODIGO_EMPRESA, FR.CODIGO_PLANO, FR.CODIGO_SITUACAO, FR.DESCRICAO_SITUACAO, FR.MATRICULA, FR.DIGITO, FR.NOME, FR.CPF, FR.PIS_PASEP,FR.CODIGO_CARGO, FR.DATA_ADMISSAO_POSSE, FR.SITUACAO_FUNCIONAL, FR.CID, FR.DT_ULT_ALTER_USUA) 
      UNION ALL ( 
      SELECT 
        TO_CHAR(MIN(FR.DATA), 'YYYYMM') AS ANO_MES_REFERENCIA, FR.CODIGO_PLANO,FR.SITUACAO_FUNCIONAL,FR.CODIGO_EMPRESA,
        FR.MATRICULA,FR.DIGITO,FR.NOME,FR.CPF,FR.PIS_PASEP,FR.CODIGO_CARGO,FR.DATA_ADMISSAO_POSSE, 
        TO_CHAR(MIN(FR.DATA), 'RRRRMMDD') AS DATA_INICIO, TO_CHAR(MAX(FR.DATA), 'YYYYMMDD') AS DATA_FIM, COUNT(FR.DATA) DIAS,FR.CID, FR.DT_ULT_ALTER_USUA
      FROM (
        SELECT 
          TO_DATE(TO_CHAR(RHPONT_RES_SIT_DIA.DATA, 'DD/MM/YYYY'), 'DD/MM/YYYY') AS DATA,
          RHPONT_RES_SIT_DIA.DATA - ROW_NUMBER() OVER(ORDER BY RHPESS_CONTRATO.COD_UNIDADE1, RHPESS_CONTRATO.COD_UNIDADE2, RHPESS_CONTRATO.COD_UNIDADE3, RHPESS_CONTRATO.COD_UNIDADE4, RHPESS_CONTRATO.COD_UNIDADE5, RHPESS_CONTRATO.COD_UNIDADE6, RHPESS_CONTRATO.CODIGO, RHPONT_RES_SIT_DIA.CODIGO_SITUACAO, RHPONT_RES_SIT_DIA.DATA) AS DISTANCE,
          RHPONT_RES_SIT_DIA.CODIGO_SITUACAO, TO_NUMBER(RHPESS_CONTRATO.CODIGO_EMPRESA) AS CODIGO_EMPRESA, RHPONT_SITUACAO.DESCRICAO DESCRICAO_SITUACAO,
          TO_NUMBER(SUBSTR(RHPESS_CONTRATO.CODIGO, 5, 10)) AS MATRICULA, 
          CASE WHEN SUBSTR(RHPESS_CONTRATO.CODIGO, 15, 1) = 'X' THEN 7 ELSE TO_NUMBER(SUBSTR(RHPESS_CONTRATO.CODIGO, 15, 1)) END AS DIGITO,
          SUBSTR(TRIM(RHPESS_CONTRATO.NOME), 1, 80) AS NOME, SUBSTR(TRIM(RHPESS_PESSOA.CPF), 1, 11) AS CPF, TO_NUMBER(NVL(TRIM(RHPESS_PESSOA.PIS_PASEP), 0)) AS PIS_PASEP,
          CASE WHEN RHPESS_CONTRATO.DATA_ADMISSAO <= TO_DATE('30/12/2011', 'DD/MM/YYYY') THEN 1 ELSE 2 END AS CODIGO_PLANO,
          TO_NUMBER(SUBSTR(TRIM(RHPESS_CONTRATO.COD_CARGO_EFETIVO), 12, 4)) AS CODIGO_CARGO,
          CASE
            WHEN RHPESS_CONTRATO.DATA_EFETIVO_EXERC IS NOT NULL THEN TO_CHAR(RHPESS_CONTRATO.DATA_EFETIVO_EXERC, 'YYYYMMDD')
            ELSE TO_CHAR(RHPESS_CONTRATO.DATA_ADMISSAO, 'YYYYMMDD')
          END AS DATA_ADMISSAO_POSSE, RHPONT_RES_SIT_DIA.CODIGO_SITUACAO AS SITUACAO_FUNCIONAL, NULL AS CID, RHPONT_RES_SIT_DIA.DT_ULT_ALTER_USUA
         FROM RHPONT_RES_SIT_DIA,RHPONT_SITUACAO,RHPESS_CONTRATO,RHPESS_PESSOA,RHORGA_UNIDADE,RHPARM_SIT_FUNC,RHPLCS_CARGO
        WHERE RHPONT_RES_SIT_DIA.DT_ULT_ALTER_USUA > ULTIMA_ALTERACAO
          AND RHPESS_CONTRATO.TIPO_CONTRATO = '0001' AND RHPESS_CONTRATO.CODIGO_EMPRESA = '0001' AND (RHPESS_CONTRATO.SITUACAO_FUNCIONAL <= '7000' OR RHPESS_CONTRATO.SITUACAO_FUNCIONAL IN ('8000','8001')) 
          AND RHPESS_CONTRATO.COD_CARGO_PAGTO NOT IN ('000000000002006','000000000002007')
          AND RHPESS_CONTRATO.ANO_MES_REFERENCIA = (
              SELECT MAX(ARTERH_CONTRATO.ANO_MES_REFERENCIA) 
                FROM RHPESS_CONTRATO ARTERH_CONTRATO
               WHERE RHPESS_CONTRATO.CODIGO_EMPRESA = ARTERH_CONTRATO.CODIGO_EMPRESA
                 AND RHPESS_CONTRATO.TIPO_CONTRATO = ARTERH_CONTRATO.TIPO_CONTRATO
                 AND RHPESS_CONTRATO.CODIGO = ARTERH_CONTRATO.CODIGO
                 AND ARTERH_CONTRATO.ANO_MES_REFERENCIA <= SYSDATE )
          AND RHPESS_CONTRATO.CODIGO_EMPRESA = RHPONT_RES_SIT_DIA.CODIGO_EMPRESA AND RHPESS_CONTRATO.TIPO_CONTRATO = RHPONT_RES_SIT_DIA.TIPO_CONTRATO AND RHPESS_CONTRATO.CODIGO = RHPONT_RES_SIT_DIA.CODIGO_CONTRATO 
          AND RHPONT_RES_SIT_DIA.CODIGO_SITUACAO = RHPONT_SITUACAO.CODIGO AND RHPESS_PESSOA.CODIGO_EMPRESA = RHPESS_CONTRATO.CODIGO_EMPRESA AND RHPESS_PESSOA.CODIGO = RHPESS_CONTRATO.CODIGO_PESSOA
          AND RHPESS_CONTRATO.COD_UNIDADE1 = RHORGA_UNIDADE.COD_UNIDADE1 AND RHPESS_CONTRATO.COD_UNIDADE2 = RHORGA_UNIDADE.COD_UNIDADE2 AND RHPESS_CONTRATO.COD_UNIDADE3 = RHORGA_UNIDADE.COD_UNIDADE3 
          AND RHPESS_CONTRATO.COD_UNIDADE4 = RHORGA_UNIDADE.COD_UNIDADE4 AND RHPESS_CONTRATO.COD_UNIDADE5 = RHORGA_UNIDADE.COD_UNIDADE5 AND RHPESS_CONTRATO.COD_UNIDADE6 = RHORGA_UNIDADE.COD_UNIDADE6 
          AND RHPESS_CONTRATO.CODIGO_EMPRESA = RHORGA_UNIDADE.CODIGO_EMPRESA AND RHPESS_CONTRATO.SITUACAO_FUNCIONAL = RHPARM_SIT_FUNC.CODIGO AND RHPESS_CONTRATO.CODIGO_EMPRESA = RHPLCS_CARGO.CODIGO_EMPRESA (+)
          AND RHPESS_CONTRATO.COD_CARGO_EFETIVO = RHPLCS_CARGO.CODIGO (+) AND RHPONT_RES_SIT_DIA.TIPO_APURACAO = 'F' 
          AND RHPONT_RES_SIT_DIA.CODIGO_SITUACAO IN ('0515')) FR
      GROUP BY FR.DISTANCE, FR.CODIGO_EMPRESA, FR.CODIGO_PLANO, FR.CODIGO_SITUACAO, FR.DESCRICAO_SITUACAO, FR.MATRICULA, FR.DIGITO, FR.NOME, FR.CPF, FR.PIS_PASEP,FR.CODIGO_CARGO, FR.DATA_ADMISSAO_POSSE, FR.SITUACAO_FUNCIONAL, FR.CID, FR.DT_ULT_ALTER_USUA)
      UNION ALL ( 
      SELECT 
        TO_CHAR(MIN(FR.DATA), 'YYYYMM') AS ANO_MES_REFERENCIA, FR.CODIGO_PLANO,FR.SITUACAO_FUNCIONAL,FR.CODIGO_EMPRESA,
        FR.MATRICULA,FR.DIGITO,FR.NOME,FR.CPF,FR.PIS_PASEP,FR.CODIGO_CARGO,FR.DATA_ADMISSAO_POSSE, 
        TO_CHAR(MIN(FR.DATA), 'RRRRMMDD') AS DATA_INICIO, TO_CHAR(MAX(FR.DATA), 'YYYYMMDD') AS DATA_FIM, COUNT(FR.DATA) DIAS,FR.CID, FR.DT_ULT_ALTER_USUA
      FROM (
        SELECT 
          TO_DATE(TO_CHAR(RHPONT_RES_SIT_DIA.DATA, 'DD/MM/YYYY'), 'DD/MM/YYYY') AS DATA,
          RHPONT_RES_SIT_DIA.DATA - ROW_NUMBER() OVER(ORDER BY RHPESS_CONTRATO.COD_UNIDADE1, RHPESS_CONTRATO.COD_UNIDADE2, RHPESS_CONTRATO.COD_UNIDADE3, RHPESS_CONTRATO.COD_UNIDADE4, RHPESS_CONTRATO.COD_UNIDADE5, RHPESS_CONTRATO.COD_UNIDADE6, RHPESS_CONTRATO.CODIGO, RHPONT_RES_SIT_DIA.CODIGO_SITUACAO, RHPONT_RES_SIT_DIA.DATA) AS DISTANCE,
          RHPONT_RES_SIT_DIA.CODIGO_SITUACAO, TO_NUMBER(RHPESS_CONTRATO.CODIGO_EMPRESA) AS CODIGO_EMPRESA, RHPONT_SITUACAO.DESCRICAO DESCRICAO_SITUACAO,
          TO_NUMBER(SUBSTR(RHPESS_CONTRATO.CODIGO, 5, 10)) AS MATRICULA, 
          CASE WHEN SUBSTR(RHPESS_CONTRATO.CODIGO, 15, 1) = 'X' THEN 7 ELSE TO_NUMBER(SUBSTR(RHPESS_CONTRATO.CODIGO, 15, 1)) END AS DIGITO,
          SUBSTR(TRIM(RHPESS_CONTRATO.NOME), 1, 80) AS NOME, SUBSTR(TRIM(RHPESS_PESSOA.CPF), 1, 11) AS CPF, TO_NUMBER(NVL(TRIM(RHPESS_PESSOA.PIS_PASEP), 0)) AS PIS_PASEP,
          CASE WHEN RHPESS_CONTRATO.DATA_ADMISSAO <= TO_DATE('30/12/2011', 'DD/MM/YYYY') THEN 1 ELSE 2 END AS CODIGO_PLANO,
          TO_NUMBER(SUBSTR(TRIM(RHPESS_CONTRATO.COD_CARGO_EFETIVO), 12, 4)) AS CODIGO_CARGO,
          CASE
            WHEN RHPESS_CONTRATO.DATA_EFETIVO_EXERC IS NOT NULL THEN TO_CHAR(RHPESS_CONTRATO.DATA_EFETIVO_EXERC, 'YYYYMMDD')
            ELSE TO_CHAR(RHPESS_CONTRATO.DATA_ADMISSAO, 'YYYYMMDD')
          END AS DATA_ADMISSAO_POSSE, RHPONT_RES_SIT_DIA.CODIGO_SITUACAO AS SITUACAO_FUNCIONAL, NULL AS CID, RHPONT_RES_SIT_DIA.DT_ULT_ALTER_USUA
         FROM RHPONT_RES_SIT_DIA,RHPONT_SITUACAO,RHPESS_CONTRATO,RHPESS_PESSOA,RHORGA_UNIDADE,RHPARM_SIT_FUNC,RHPLCS_CARGO
        WHERE RHPONT_RES_SIT_DIA.DT_ULT_ALTER_USUA > ULTIMA_ALTERACAO
          AND RHPESS_CONTRATO.TIPO_CONTRATO = '0001' AND RHPESS_CONTRATO.CODIGO_EMPRESA = '0001' AND (RHPESS_CONTRATO.SITUACAO_FUNCIONAL <= '7000' OR RHPESS_CONTRATO.SITUACAO_FUNCIONAL IN ('8000','8001')) 
          AND RHPESS_CONTRATO.COD_CARGO_PAGTO NOT IN ('000000000002006','000000000002007')
          AND RHPESS_CONTRATO.ANO_MES_REFERENCIA = (
              SELECT MAX(ARTERH_CONTRATO.ANO_MES_REFERENCIA) 
                FROM RHPESS_CONTRATO ARTERH_CONTRATO
               WHERE RHPESS_CONTRATO.CODIGO_EMPRESA = ARTERH_CONTRATO.CODIGO_EMPRESA
                 AND RHPESS_CONTRATO.TIPO_CONTRATO = ARTERH_CONTRATO.TIPO_CONTRATO
                 AND RHPESS_CONTRATO.CODIGO = ARTERH_CONTRATO.CODIGO
                 AND ARTERH_CONTRATO.ANO_MES_REFERENCIA <= SYSDATE )
          AND RHPESS_CONTRATO.CODIGO_EMPRESA = RHPONT_RES_SIT_DIA.CODIGO_EMPRESA AND RHPESS_CONTRATO.TIPO_CONTRATO = RHPONT_RES_SIT_DIA.TIPO_CONTRATO AND RHPESS_CONTRATO.CODIGO = RHPONT_RES_SIT_DIA.CODIGO_CONTRATO 
          AND RHPONT_RES_SIT_DIA.CODIGO_SITUACAO = RHPONT_SITUACAO.CODIGO AND RHPESS_PESSOA.CODIGO_EMPRESA = RHPESS_CONTRATO.CODIGO_EMPRESA AND RHPESS_PESSOA.CODIGO = RHPESS_CONTRATO.CODIGO_PESSOA
          AND RHPESS_CONTRATO.COD_UNIDADE1 = RHORGA_UNIDADE.COD_UNIDADE1 AND RHPESS_CONTRATO.COD_UNIDADE2 = RHORGA_UNIDADE.COD_UNIDADE2 AND RHPESS_CONTRATO.COD_UNIDADE3 = RHORGA_UNIDADE.COD_UNIDADE3 
          AND RHPESS_CONTRATO.COD_UNIDADE4 = RHORGA_UNIDADE.COD_UNIDADE4 AND RHPESS_CONTRATO.COD_UNIDADE5 = RHORGA_UNIDADE.COD_UNIDADE5 AND RHPESS_CONTRATO.COD_UNIDADE6 = RHORGA_UNIDADE.COD_UNIDADE6 
          AND RHPESS_CONTRATO.CODIGO_EMPRESA = RHORGA_UNIDADE.CODIGO_EMPRESA AND RHPESS_CONTRATO.SITUACAO_FUNCIONAL = RHPARM_SIT_FUNC.CODIGO AND RHPESS_CONTRATO.CODIGO_EMPRESA = RHPLCS_CARGO.CODIGO_EMPRESA (+)
          AND RHPESS_CONTRATO.COD_CARGO_EFETIVO = RHPLCS_CARGO.CODIGO (+) AND RHPONT_RES_SIT_DIA.TIPO_APURACAO = 'F' 
          AND RHPONT_RES_SIT_DIA.CODIGO_SITUACAO IN ('0525')) FR
      GROUP BY FR.DISTANCE, FR.CODIGO_EMPRESA, FR.CODIGO_PLANO, FR.CODIGO_SITUACAO, FR.DESCRICAO_SITUACAO, FR.MATRICULA, FR.DIGITO, FR.NOME, FR.CPF, FR.PIS_PASEP,FR.CODIGO_CARGO, FR.DATA_ADMISSAO_POSSE, FR.SITUACAO_FUNCIONAL, FR.CID, FR.DT_ULT_ALTER_USUA) 
      UNION ALL ( 
      SELECT 
        TO_CHAR(MIN(FR.DATA), 'YYYYMM') AS ANO_MES_REFERENCIA, FR.CODIGO_PLANO,FR.SITUACAO_FUNCIONAL,FR.CODIGO_EMPRESA,
        FR.MATRICULA,FR.DIGITO,FR.NOME,FR.CPF,FR.PIS_PASEP,FR.CODIGO_CARGO,FR.DATA_ADMISSAO_POSSE, 
        TO_CHAR(MIN(FR.DATA), 'RRRRMMDD') AS DATA_INICIO, TO_CHAR(MAX(FR.DATA), 'YYYYMMDD') AS DATA_FIM, COUNT(FR.DATA) DIAS,FR.CID, FR.DT_ULT_ALTER_USUA
      FROM (
        SELECT 
          TO_DATE(TO_CHAR(RHPONT_RES_SIT_DIA.DATA, 'DD/MM/YYYY'), 'DD/MM/YYYY') AS DATA,
          RHPONT_RES_SIT_DIA.DATA - ROW_NUMBER() OVER(ORDER BY RHPESS_CONTRATO.COD_UNIDADE1, RHPESS_CONTRATO.COD_UNIDADE2, RHPESS_CONTRATO.COD_UNIDADE3, RHPESS_CONTRATO.COD_UNIDADE4, RHPESS_CONTRATO.COD_UNIDADE5, RHPESS_CONTRATO.COD_UNIDADE6, RHPESS_CONTRATO.CODIGO, RHPONT_RES_SIT_DIA.CODIGO_SITUACAO, RHPONT_RES_SIT_DIA.DATA) AS DISTANCE,
          RHPONT_RES_SIT_DIA.CODIGO_SITUACAO, TO_NUMBER(RHPESS_CONTRATO.CODIGO_EMPRESA) AS CODIGO_EMPRESA, RHPONT_SITUACAO.DESCRICAO DESCRICAO_SITUACAO,
          TO_NUMBER(SUBSTR(RHPESS_CONTRATO.CODIGO, 5, 10)) AS MATRICULA, 
          CASE WHEN SUBSTR(RHPESS_CONTRATO.CODIGO, 15, 1) = 'X' THEN 7 ELSE TO_NUMBER(SUBSTR(RHPESS_CONTRATO.CODIGO, 15, 1)) END AS DIGITO,
          SUBSTR(TRIM(RHPESS_CONTRATO.NOME), 1, 80) AS NOME, SUBSTR(TRIM(RHPESS_PESSOA.CPF), 1, 11) AS CPF, TO_NUMBER(NVL(TRIM(RHPESS_PESSOA.PIS_PASEP), 0)) AS PIS_PASEP,
          CASE WHEN RHPESS_CONTRATO.DATA_ADMISSAO <= TO_DATE('30/12/2011', 'DD/MM/YYYY') THEN 1 ELSE 2 END AS CODIGO_PLANO,
          TO_NUMBER(SUBSTR(TRIM(RHPESS_CONTRATO.COD_CARGO_EFETIVO), 12, 4)) AS CODIGO_CARGO,
          CASE
            WHEN RHPESS_CONTRATO.DATA_EFETIVO_EXERC IS NOT NULL THEN TO_CHAR(RHPESS_CONTRATO.DATA_EFETIVO_EXERC, 'YYYYMMDD')
            ELSE TO_CHAR(RHPESS_CONTRATO.DATA_ADMISSAO, 'YYYYMMDD')
          END AS DATA_ADMISSAO_POSSE, RHPONT_RES_SIT_DIA.CODIGO_SITUACAO AS SITUACAO_FUNCIONAL, NULL AS CID, RHPONT_RES_SIT_DIA.DT_ULT_ALTER_USUA
         FROM RHPONT_RES_SIT_DIA,RHPONT_SITUACAO,RHPESS_CONTRATO,RHPESS_PESSOA,RHORGA_UNIDADE,RHPARM_SIT_FUNC,RHPLCS_CARGO
        WHERE RHPONT_RES_SIT_DIA.DT_ULT_ALTER_USUA > ULTIMA_ALTERACAO
          AND RHPESS_CONTRATO.TIPO_CONTRATO = '0001' AND RHPESS_CONTRATO.CODIGO_EMPRESA = '0001' AND (RHPESS_CONTRATO.SITUACAO_FUNCIONAL <= '7000' OR RHPESS_CONTRATO.SITUACAO_FUNCIONAL IN ('8000','8001')) 
          AND RHPESS_CONTRATO.COD_CARGO_PAGTO NOT IN ('000000000002006','000000000002007')
          AND RHPESS_CONTRATO.ANO_MES_REFERENCIA = (
              SELECT MAX(ARTERH_CONTRATO.ANO_MES_REFERENCIA) 
                FROM RHPESS_CONTRATO ARTERH_CONTRATO
               WHERE RHPESS_CONTRATO.CODIGO_EMPRESA = ARTERH_CONTRATO.CODIGO_EMPRESA
                 AND RHPESS_CONTRATO.TIPO_CONTRATO = ARTERH_CONTRATO.TIPO_CONTRATO
                 AND RHPESS_CONTRATO.CODIGO = ARTERH_CONTRATO.CODIGO
                 AND ARTERH_CONTRATO.ANO_MES_REFERENCIA <= SYSDATE )
          AND RHPESS_CONTRATO.CODIGO_EMPRESA = RHPONT_RES_SIT_DIA.CODIGO_EMPRESA AND RHPESS_CONTRATO.TIPO_CONTRATO = RHPONT_RES_SIT_DIA.TIPO_CONTRATO AND RHPESS_CONTRATO.CODIGO = RHPONT_RES_SIT_DIA.CODIGO_CONTRATO 
          AND RHPONT_RES_SIT_DIA.CODIGO_SITUACAO = RHPONT_SITUACAO.CODIGO AND RHPESS_PESSOA.CODIGO_EMPRESA = RHPESS_CONTRATO.CODIGO_EMPRESA AND RHPESS_PESSOA.CODIGO = RHPESS_CONTRATO.CODIGO_PESSOA
          AND RHPESS_CONTRATO.COD_UNIDADE1 = RHORGA_UNIDADE.COD_UNIDADE1 AND RHPESS_CONTRATO.COD_UNIDADE2 = RHORGA_UNIDADE.COD_UNIDADE2 AND RHPESS_CONTRATO.COD_UNIDADE3 = RHORGA_UNIDADE.COD_UNIDADE3 
          AND RHPESS_CONTRATO.COD_UNIDADE4 = RHORGA_UNIDADE.COD_UNIDADE4 AND RHPESS_CONTRATO.COD_UNIDADE5 = RHORGA_UNIDADE.COD_UNIDADE5 AND RHPESS_CONTRATO.COD_UNIDADE6 = RHORGA_UNIDADE.COD_UNIDADE6 
          AND RHPESS_CONTRATO.CODIGO_EMPRESA = RHORGA_UNIDADE.CODIGO_EMPRESA AND RHPESS_CONTRATO.SITUACAO_FUNCIONAL = RHPARM_SIT_FUNC.CODIGO AND RHPESS_CONTRATO.CODIGO_EMPRESA = RHPLCS_CARGO.CODIGO_EMPRESA (+)
          AND RHPESS_CONTRATO.COD_CARGO_EFETIVO = RHPLCS_CARGO.CODIGO (+) AND RHPONT_RES_SIT_DIA.TIPO_APURACAO = 'F' 
          AND RHPONT_RES_SIT_DIA.CODIGO_SITUACAO IN ('0526')) FR
      GROUP BY FR.DISTANCE, FR.CODIGO_EMPRESA, FR.CODIGO_PLANO, FR.CODIGO_SITUACAO, FR.DESCRICAO_SITUACAO, FR.MATRICULA, FR.DIGITO, FR.NOME, FR.CPF, FR.PIS_PASEP,FR.CODIGO_CARGO, FR.DATA_ADMISSAO_POSSE, FR.SITUACAO_FUNCIONAL, FR.CID, FR.DT_ULT_ALTER_USUA) 
      UNION ALL ( 
      SELECT 
        TO_CHAR(MIN(FR.DATA), 'YYYYMM') AS ANO_MES_REFERENCIA, FR.CODIGO_PLANO,FR.SITUACAO_FUNCIONAL,FR.CODIGO_EMPRESA,
        FR.MATRICULA,FR.DIGITO,FR.NOME,FR.CPF,FR.PIS_PASEP,FR.CODIGO_CARGO,FR.DATA_ADMISSAO_POSSE, 
        TO_CHAR(MIN(FR.DATA), 'RRRRMMDD') AS DATA_INICIO, TO_CHAR(MAX(FR.DATA), 'YYYYMMDD') AS DATA_FIM, COUNT(FR.DATA) DIAS,FR.CID, FR.DT_ULT_ALTER_USUA
      FROM (
        SELECT 
          TO_DATE(TO_CHAR(RHPONT_RES_SIT_DIA.DATA, 'DD/MM/YYYY'), 'DD/MM/YYYY') AS DATA,
          RHPONT_RES_SIT_DIA.DATA - ROW_NUMBER() OVER(ORDER BY RHPESS_CONTRATO.COD_UNIDADE1, RHPESS_CONTRATO.COD_UNIDADE2, RHPESS_CONTRATO.COD_UNIDADE3, RHPESS_CONTRATO.COD_UNIDADE4, RHPESS_CONTRATO.COD_UNIDADE5, RHPESS_CONTRATO.COD_UNIDADE6, RHPESS_CONTRATO.CODIGO, RHPONT_RES_SIT_DIA.CODIGO_SITUACAO, RHPONT_RES_SIT_DIA.DATA) AS DISTANCE,
          RHPONT_RES_SIT_DIA.CODIGO_SITUACAO, TO_NUMBER(RHPESS_CONTRATO.CODIGO_EMPRESA) AS CODIGO_EMPRESA, RHPONT_SITUACAO.DESCRICAO DESCRICAO_SITUACAO,
          TO_NUMBER(SUBSTR(RHPESS_CONTRATO.CODIGO, 5, 10)) AS MATRICULA, 
          CASE WHEN SUBSTR(RHPESS_CONTRATO.CODIGO, 15, 1) = 'X' THEN 7 ELSE TO_NUMBER(SUBSTR(RHPESS_CONTRATO.CODIGO, 15, 1)) END AS DIGITO,
          SUBSTR(TRIM(RHPESS_CONTRATO.NOME), 1, 80) AS NOME, SUBSTR(TRIM(RHPESS_PESSOA.CPF), 1, 11) AS CPF, TO_NUMBER(NVL(TRIM(RHPESS_PESSOA.PIS_PASEP), 0)) AS PIS_PASEP,
          CASE WHEN RHPESS_CONTRATO.DATA_ADMISSAO <= TO_DATE('30/12/2011', 'DD/MM/YYYY') THEN 1 ELSE 2 END AS CODIGO_PLANO,
          TO_NUMBER(SUBSTR(TRIM(RHPESS_CONTRATO.COD_CARGO_EFETIVO), 12, 4)) AS CODIGO_CARGO,
          CASE
            WHEN RHPESS_CONTRATO.DATA_EFETIVO_EXERC IS NOT NULL THEN TO_CHAR(RHPESS_CONTRATO.DATA_EFETIVO_EXERC, 'YYYYMMDD')
            ELSE TO_CHAR(RHPESS_CONTRATO.DATA_ADMISSAO, 'YYYYMMDD')
          END AS DATA_ADMISSAO_POSSE, RHPONT_RES_SIT_DIA.CODIGO_SITUACAO AS SITUACAO_FUNCIONAL, NULL AS CID, RHPONT_RES_SIT_DIA.DT_ULT_ALTER_USUA
         FROM RHPONT_RES_SIT_DIA,RHPONT_SITUACAO,RHPESS_CONTRATO,RHPESS_PESSOA,RHORGA_UNIDADE,RHPARM_SIT_FUNC,RHPLCS_CARGO
        WHERE RHPONT_RES_SIT_DIA.DT_ULT_ALTER_USUA > ULTIMA_ALTERACAO
          AND RHPESS_CONTRATO.TIPO_CONTRATO = '0001' AND RHPESS_CONTRATO.CODIGO_EMPRESA = '0001' AND (RHPESS_CONTRATO.SITUACAO_FUNCIONAL <= '7000' OR RHPESS_CONTRATO.SITUACAO_FUNCIONAL IN ('8000','8001')) 
          AND RHPESS_CONTRATO.COD_CARGO_PAGTO NOT IN ('000000000002006','000000000002007')
          AND RHPESS_CONTRATO.ANO_MES_REFERENCIA = (
              SELECT MAX(ARTERH_CONTRATO.ANO_MES_REFERENCIA) 
                FROM RHPESS_CONTRATO ARTERH_CONTRATO
               WHERE RHPESS_CONTRATO.CODIGO_EMPRESA = ARTERH_CONTRATO.CODIGO_EMPRESA
                 AND RHPESS_CONTRATO.TIPO_CONTRATO = ARTERH_CONTRATO.TIPO_CONTRATO
                 AND RHPESS_CONTRATO.CODIGO = ARTERH_CONTRATO.CODIGO
                 AND ARTERH_CONTRATO.ANO_MES_REFERENCIA <= SYSDATE )
          AND RHPESS_CONTRATO.CODIGO_EMPRESA = RHPONT_RES_SIT_DIA.CODIGO_EMPRESA AND RHPESS_CONTRATO.TIPO_CONTRATO = RHPONT_RES_SIT_DIA.TIPO_CONTRATO AND RHPESS_CONTRATO.CODIGO = RHPONT_RES_SIT_DIA.CODIGO_CONTRATO 
          AND RHPONT_RES_SIT_DIA.CODIGO_SITUACAO = RHPONT_SITUACAO.CODIGO AND RHPESS_PESSOA.CODIGO_EMPRESA = RHPESS_CONTRATO.CODIGO_EMPRESA AND RHPESS_PESSOA.CODIGO = RHPESS_CONTRATO.CODIGO_PESSOA
          AND RHPESS_CONTRATO.COD_UNIDADE1 = RHORGA_UNIDADE.COD_UNIDADE1 AND RHPESS_CONTRATO.COD_UNIDADE2 = RHORGA_UNIDADE.COD_UNIDADE2 AND RHPESS_CONTRATO.COD_UNIDADE3 = RHORGA_UNIDADE.COD_UNIDADE3 
          AND RHPESS_CONTRATO.COD_UNIDADE4 = RHORGA_UNIDADE.COD_UNIDADE4 AND RHPESS_CONTRATO.COD_UNIDADE5 = RHORGA_UNIDADE.COD_UNIDADE5 AND RHPESS_CONTRATO.COD_UNIDADE6 = RHORGA_UNIDADE.COD_UNIDADE6 
          AND RHPESS_CONTRATO.CODIGO_EMPRESA = RHORGA_UNIDADE.CODIGO_EMPRESA AND RHPESS_CONTRATO.SITUACAO_FUNCIONAL = RHPARM_SIT_FUNC.CODIGO AND RHPESS_CONTRATO.CODIGO_EMPRESA = RHPLCS_CARGO.CODIGO_EMPRESA (+)
          AND RHPESS_CONTRATO.COD_CARGO_EFETIVO = RHPLCS_CARGO.CODIGO (+) AND RHPONT_RES_SIT_DIA.TIPO_APURACAO = 'F' 
          AND RHPONT_RES_SIT_DIA.CODIGO_SITUACAO IN ('0528')) FR
      GROUP BY FR.DISTANCE, FR.CODIGO_EMPRESA, FR.CODIGO_PLANO, FR.CODIGO_SITUACAO, FR.DESCRICAO_SITUACAO, FR.MATRICULA, FR.DIGITO, FR.NOME, FR.CPF, FR.PIS_PASEP,FR.CODIGO_CARGO, FR.DATA_ADMISSAO_POSSE, FR.SITUACAO_FUNCIONAL, FR.CID, FR.DT_ULT_ALTER_USUA) 
      UNION ALL ( 
      SELECT 
        TO_CHAR(MIN(FR.DATA), 'YYYYMM') AS ANO_MES_REFERENCIA, FR.CODIGO_PLANO,FR.SITUACAO_FUNCIONAL,FR.CODIGO_EMPRESA,
        FR.MATRICULA,FR.DIGITO,FR.NOME,FR.CPF,FR.PIS_PASEP,FR.CODIGO_CARGO,FR.DATA_ADMISSAO_POSSE, 
        TO_CHAR(MIN(FR.DATA), 'RRRRMMDD') AS DATA_INICIO, TO_CHAR(MAX(FR.DATA), 'YYYYMMDD') AS DATA_FIM, COUNT(FR.DATA) DIAS,FR.CID, FR.DT_ULT_ALTER_USUA
      FROM (
        SELECT 
          TO_DATE(TO_CHAR(RHPONT_RES_SIT_DIA.DATA, 'DD/MM/YYYY'), 'DD/MM/YYYY') AS DATA,
          RHPONT_RES_SIT_DIA.DATA - ROW_NUMBER() OVER(ORDER BY RHPESS_CONTRATO.COD_UNIDADE1, RHPESS_CONTRATO.COD_UNIDADE2, RHPESS_CONTRATO.COD_UNIDADE3, RHPESS_CONTRATO.COD_UNIDADE4, RHPESS_CONTRATO.COD_UNIDADE5, RHPESS_CONTRATO.COD_UNIDADE6, RHPESS_CONTRATO.CODIGO, RHPONT_RES_SIT_DIA.CODIGO_SITUACAO, RHPONT_RES_SIT_DIA.DATA) AS DISTANCE,
          RHPONT_RES_SIT_DIA.CODIGO_SITUACAO, TO_NUMBER(RHPESS_CONTRATO.CODIGO_EMPRESA) AS CODIGO_EMPRESA, RHPONT_SITUACAO.DESCRICAO DESCRICAO_SITUACAO,
          TO_NUMBER(SUBSTR(RHPESS_CONTRATO.CODIGO, 5, 10)) AS MATRICULA, 
          CASE WHEN SUBSTR(RHPESS_CONTRATO.CODIGO, 15, 1) = 'X' THEN 7 ELSE TO_NUMBER(SUBSTR(RHPESS_CONTRATO.CODIGO, 15, 1)) END AS DIGITO,
          SUBSTR(TRIM(RHPESS_CONTRATO.NOME), 1, 80) AS NOME, SUBSTR(TRIM(RHPESS_PESSOA.CPF), 1, 11) AS CPF, TO_NUMBER(NVL(TRIM(RHPESS_PESSOA.PIS_PASEP), 0)) AS PIS_PASEP,
          CASE WHEN RHPESS_CONTRATO.DATA_ADMISSAO <= TO_DATE('30/12/2011', 'DD/MM/YYYY') THEN 1 ELSE 2 END AS CODIGO_PLANO,
          TO_NUMBER(SUBSTR(TRIM(RHPESS_CONTRATO.COD_CARGO_EFETIVO), 12, 4)) AS CODIGO_CARGO,
          CASE
            WHEN RHPESS_CONTRATO.DATA_EFETIVO_EXERC IS NOT NULL THEN TO_CHAR(RHPESS_CONTRATO.DATA_EFETIVO_EXERC, 'YYYYMMDD')
            ELSE TO_CHAR(RHPESS_CONTRATO.DATA_ADMISSAO, 'YYYYMMDD')
          END AS DATA_ADMISSAO_POSSE, RHPONT_RES_SIT_DIA.CODIGO_SITUACAO AS SITUACAO_FUNCIONAL, NULL AS CID, RHPONT_RES_SIT_DIA.DT_ULT_ALTER_USUA
         FROM RHPONT_RES_SIT_DIA,RHPONT_SITUACAO,RHPESS_CONTRATO,RHPESS_PESSOA,RHORGA_UNIDADE,RHPARM_SIT_FUNC,RHPLCS_CARGO
        WHERE RHPONT_RES_SIT_DIA.DT_ULT_ALTER_USUA > ULTIMA_ALTERACAO
          AND RHPESS_CONTRATO.TIPO_CONTRATO = '0001' AND RHPESS_CONTRATO.CODIGO_EMPRESA = '0001' AND (RHPESS_CONTRATO.SITUACAO_FUNCIONAL <= '7000' OR RHPESS_CONTRATO.SITUACAO_FUNCIONAL IN ('8000','8001')) 
          AND RHPESS_CONTRATO.COD_CARGO_PAGTO NOT IN ('000000000002006','000000000002007')
          AND RHPESS_CONTRATO.ANO_MES_REFERENCIA = (
              SELECT MAX(ARTERH_CONTRATO.ANO_MES_REFERENCIA) 
                FROM RHPESS_CONTRATO ARTERH_CONTRATO
               WHERE RHPESS_CONTRATO.CODIGO_EMPRESA = ARTERH_CONTRATO.CODIGO_EMPRESA
                 AND RHPESS_CONTRATO.TIPO_CONTRATO = ARTERH_CONTRATO.TIPO_CONTRATO
                 AND RHPESS_CONTRATO.CODIGO = ARTERH_CONTRATO.CODIGO
                 AND ARTERH_CONTRATO.ANO_MES_REFERENCIA <= SYSDATE )
          AND RHPESS_CONTRATO.CODIGO_EMPRESA = RHPONT_RES_SIT_DIA.CODIGO_EMPRESA AND RHPESS_CONTRATO.TIPO_CONTRATO = RHPONT_RES_SIT_DIA.TIPO_CONTRATO AND RHPESS_CONTRATO.CODIGO = RHPONT_RES_SIT_DIA.CODIGO_CONTRATO 
          AND RHPONT_RES_SIT_DIA.CODIGO_SITUACAO = RHPONT_SITUACAO.CODIGO AND RHPESS_PESSOA.CODIGO_EMPRESA = RHPESS_CONTRATO.CODIGO_EMPRESA AND RHPESS_PESSOA.CODIGO = RHPESS_CONTRATO.CODIGO_PESSOA
          AND RHPESS_CONTRATO.COD_UNIDADE1 = RHORGA_UNIDADE.COD_UNIDADE1 AND RHPESS_CONTRATO.COD_UNIDADE2 = RHORGA_UNIDADE.COD_UNIDADE2 AND RHPESS_CONTRATO.COD_UNIDADE3 = RHORGA_UNIDADE.COD_UNIDADE3 
          AND RHPESS_CONTRATO.COD_UNIDADE4 = RHORGA_UNIDADE.COD_UNIDADE4 AND RHPESS_CONTRATO.COD_UNIDADE5 = RHORGA_UNIDADE.COD_UNIDADE5 AND RHPESS_CONTRATO.COD_UNIDADE6 = RHORGA_UNIDADE.COD_UNIDADE6 
          AND RHPESS_CONTRATO.CODIGO_EMPRESA = RHORGA_UNIDADE.CODIGO_EMPRESA AND RHPESS_CONTRATO.SITUACAO_FUNCIONAL = RHPARM_SIT_FUNC.CODIGO AND RHPESS_CONTRATO.CODIGO_EMPRESA = RHPLCS_CARGO.CODIGO_EMPRESA (+)
          AND RHPESS_CONTRATO.COD_CARGO_EFETIVO = RHPLCS_CARGO.CODIGO (+) AND RHPONT_RES_SIT_DIA.TIPO_APURACAO = 'F' 
          AND RHPONT_RES_SIT_DIA.CODIGO_SITUACAO IN ('0529')) FR
      GROUP BY FR.DISTANCE, FR.CODIGO_EMPRESA, FR.CODIGO_PLANO, FR.CODIGO_SITUACAO, FR.DESCRICAO_SITUACAO, FR.MATRICULA, FR.DIGITO, FR.NOME, FR.CPF, FR.PIS_PASEP,FR.CODIGO_CARGO, FR.DATA_ADMISSAO_POSSE, FR.SITUACAO_FUNCIONAL, FR.CID, FR.DT_ULT_ALTER_USUA) 
      UNION ALL ( 
      SELECT 
        TO_CHAR(MIN(FR.DATA), 'YYYYMM') AS ANO_MES_REFERENCIA, FR.CODIGO_PLANO,FR.SITUACAO_FUNCIONAL,FR.CODIGO_EMPRESA,
        FR.MATRICULA,FR.DIGITO,FR.NOME,FR.CPF,FR.PIS_PASEP,FR.CODIGO_CARGO,FR.DATA_ADMISSAO_POSSE, 
        TO_CHAR(MIN(FR.DATA), 'RRRRMMDD') AS DATA_INICIO, TO_CHAR(MAX(FR.DATA), 'YYYYMMDD') AS DATA_FIM, COUNT(FR.DATA) DIAS,FR.CID, FR.DT_ULT_ALTER_USUA
      FROM (
        SELECT 
          TO_DATE(TO_CHAR(RHPONT_RES_SIT_DIA.DATA, 'DD/MM/YYYY'), 'DD/MM/YYYY') AS DATA,
          RHPONT_RES_SIT_DIA.DATA - ROW_NUMBER() OVER(ORDER BY RHPESS_CONTRATO.COD_UNIDADE1, RHPESS_CONTRATO.COD_UNIDADE2, RHPESS_CONTRATO.COD_UNIDADE3, RHPESS_CONTRATO.COD_UNIDADE4, RHPESS_CONTRATO.COD_UNIDADE5, RHPESS_CONTRATO.COD_UNIDADE6, RHPESS_CONTRATO.CODIGO, RHPONT_RES_SIT_DIA.CODIGO_SITUACAO, RHPONT_RES_SIT_DIA.DATA) AS DISTANCE,
          RHPONT_RES_SIT_DIA.CODIGO_SITUACAO, TO_NUMBER(RHPESS_CONTRATO.CODIGO_EMPRESA) AS CODIGO_EMPRESA, RHPONT_SITUACAO.DESCRICAO DESCRICAO_SITUACAO,
          TO_NUMBER(SUBSTR(RHPESS_CONTRATO.CODIGO, 5, 10)) AS MATRICULA, 
          CASE WHEN SUBSTR(RHPESS_CONTRATO.CODIGO, 15, 1) = 'X' THEN 7 ELSE TO_NUMBER(SUBSTR(RHPESS_CONTRATO.CODIGO, 15, 1)) END AS DIGITO,
          SUBSTR(TRIM(RHPESS_CONTRATO.NOME), 1, 80) AS NOME, SUBSTR(TRIM(RHPESS_PESSOA.CPF), 1, 11) AS CPF, TO_NUMBER(NVL(TRIM(RHPESS_PESSOA.PIS_PASEP), 0)) AS PIS_PASEP,
          CASE WHEN RHPESS_CONTRATO.DATA_ADMISSAO <= TO_DATE('30/12/2011', 'DD/MM/YYYY') THEN 1 ELSE 2 END AS CODIGO_PLANO,
          TO_NUMBER(SUBSTR(TRIM(RHPESS_CONTRATO.COD_CARGO_EFETIVO), 12, 4)) AS CODIGO_CARGO,
          CASE
            WHEN RHPESS_CONTRATO.DATA_EFETIVO_EXERC IS NOT NULL THEN TO_CHAR(RHPESS_CONTRATO.DATA_EFETIVO_EXERC, 'YYYYMMDD')
            ELSE TO_CHAR(RHPESS_CONTRATO.DATA_ADMISSAO, 'YYYYMMDD')
          END AS DATA_ADMISSAO_POSSE, RHPONT_RES_SIT_DIA.CODIGO_SITUACAO AS SITUACAO_FUNCIONAL, NULL AS CID, RHPONT_RES_SIT_DIA.DT_ULT_ALTER_USUA
         FROM RHPONT_RES_SIT_DIA,RHPONT_SITUACAO,RHPESS_CONTRATO,RHPESS_PESSOA,RHORGA_UNIDADE,RHPARM_SIT_FUNC,RHPLCS_CARGO
        WHERE RHPONT_RES_SIT_DIA.DT_ULT_ALTER_USUA > ULTIMA_ALTERACAO
          AND RHPESS_CONTRATO.TIPO_CONTRATO = '0001' AND RHPESS_CONTRATO.CODIGO_EMPRESA = '0001' AND (RHPESS_CONTRATO.SITUACAO_FUNCIONAL <= '7000' OR RHPESS_CONTRATO.SITUACAO_FUNCIONAL IN ('8000','8001')) 
          AND RHPESS_CONTRATO.COD_CARGO_PAGTO NOT IN ('000000000002006','000000000002007')
          AND RHPESS_CONTRATO.ANO_MES_REFERENCIA = (
              SELECT MAX(ARTERH_CONTRATO.ANO_MES_REFERENCIA) 
                FROM RHPESS_CONTRATO ARTERH_CONTRATO
               WHERE RHPESS_CONTRATO.CODIGO_EMPRESA = ARTERH_CONTRATO.CODIGO_EMPRESA
                 AND RHPESS_CONTRATO.TIPO_CONTRATO = ARTERH_CONTRATO.TIPO_CONTRATO
                 AND RHPESS_CONTRATO.CODIGO = ARTERH_CONTRATO.CODIGO
                 AND ARTERH_CONTRATO.ANO_MES_REFERENCIA <= SYSDATE )
          AND RHPESS_CONTRATO.CODIGO_EMPRESA = RHPONT_RES_SIT_DIA.CODIGO_EMPRESA AND RHPESS_CONTRATO.TIPO_CONTRATO = RHPONT_RES_SIT_DIA.TIPO_CONTRATO AND RHPESS_CONTRATO.CODIGO = RHPONT_RES_SIT_DIA.CODIGO_CONTRATO 
          AND RHPONT_RES_SIT_DIA.CODIGO_SITUACAO = RHPONT_SITUACAO.CODIGO AND RHPESS_PESSOA.CODIGO_EMPRESA = RHPESS_CONTRATO.CODIGO_EMPRESA AND RHPESS_PESSOA.CODIGO = RHPESS_CONTRATO.CODIGO_PESSOA
          AND RHPESS_CONTRATO.COD_UNIDADE1 = RHORGA_UNIDADE.COD_UNIDADE1 AND RHPESS_CONTRATO.COD_UNIDADE2 = RHORGA_UNIDADE.COD_UNIDADE2 AND RHPESS_CONTRATO.COD_UNIDADE3 = RHORGA_UNIDADE.COD_UNIDADE3 
          AND RHPESS_CONTRATO.COD_UNIDADE4 = RHORGA_UNIDADE.COD_UNIDADE4 AND RHPESS_CONTRATO.COD_UNIDADE5 = RHORGA_UNIDADE.COD_UNIDADE5 AND RHPESS_CONTRATO.COD_UNIDADE6 = RHORGA_UNIDADE.COD_UNIDADE6 
          AND RHPESS_CONTRATO.CODIGO_EMPRESA = RHORGA_UNIDADE.CODIGO_EMPRESA AND RHPESS_CONTRATO.SITUACAO_FUNCIONAL = RHPARM_SIT_FUNC.CODIGO AND RHPESS_CONTRATO.CODIGO_EMPRESA = RHPLCS_CARGO.CODIGO_EMPRESA (+)
          AND RHPESS_CONTRATO.COD_CARGO_EFETIVO = RHPLCS_CARGO.CODIGO (+) AND RHPONT_RES_SIT_DIA.TIPO_APURACAO = 'F' 
          AND RHPONT_RES_SIT_DIA.CODIGO_SITUACAO IN ('0534')) FR
      GROUP BY FR.DISTANCE, FR.CODIGO_EMPRESA, FR.CODIGO_PLANO, FR.CODIGO_SITUACAO, FR.DESCRICAO_SITUACAO, FR.MATRICULA, FR.DIGITO, FR.NOME, FR.CPF, FR.PIS_PASEP,FR.CODIGO_CARGO, FR.DATA_ADMISSAO_POSSE, FR.SITUACAO_FUNCIONAL, FR.CID, FR.DT_ULT_ALTER_USUA) 
      UNION ALL ( 
      SELECT 
        TO_CHAR(MIN(FR.DATA), 'YYYYMM') AS ANO_MES_REFERENCIA, FR.CODIGO_PLANO,FR.SITUACAO_FUNCIONAL,FR.CODIGO_EMPRESA,
        FR.MATRICULA,FR.DIGITO,FR.NOME,FR.CPF,FR.PIS_PASEP,FR.CODIGO_CARGO,FR.DATA_ADMISSAO_POSSE, 
        TO_CHAR(MIN(FR.DATA), 'RRRRMMDD') AS DATA_INICIO, TO_CHAR(MAX(FR.DATA), 'YYYYMMDD') AS DATA_FIM, COUNT(FR.DATA) DIAS,FR.CID, FR.DT_ULT_ALTER_USUA
      FROM (
        SELECT 
          TO_DATE(TO_CHAR(RHPONT_RES_SIT_DIA.DATA, 'DD/MM/YYYY'), 'DD/MM/YYYY') AS DATA,
          RHPONT_RES_SIT_DIA.DATA - ROW_NUMBER() OVER(ORDER BY RHPESS_CONTRATO.COD_UNIDADE1, RHPESS_CONTRATO.COD_UNIDADE2, RHPESS_CONTRATO.COD_UNIDADE3, RHPESS_CONTRATO.COD_UNIDADE4, RHPESS_CONTRATO.COD_UNIDADE5, RHPESS_CONTRATO.COD_UNIDADE6, RHPESS_CONTRATO.CODIGO, RHPONT_RES_SIT_DIA.CODIGO_SITUACAO, RHPONT_RES_SIT_DIA.DATA) AS DISTANCE,
          RHPONT_RES_SIT_DIA.CODIGO_SITUACAO, TO_NUMBER(RHPESS_CONTRATO.CODIGO_EMPRESA) AS CODIGO_EMPRESA, RHPONT_SITUACAO.DESCRICAO DESCRICAO_SITUACAO,
          TO_NUMBER(SUBSTR(RHPESS_CONTRATO.CODIGO, 5, 10)) AS MATRICULA, 
          CASE WHEN SUBSTR(RHPESS_CONTRATO.CODIGO, 15, 1) = 'X' THEN 7 ELSE TO_NUMBER(SUBSTR(RHPESS_CONTRATO.CODIGO, 15, 1)) END AS DIGITO,
          SUBSTR(TRIM(RHPESS_CONTRATO.NOME), 1, 80) AS NOME, SUBSTR(TRIM(RHPESS_PESSOA.CPF), 1, 11) AS CPF, TO_NUMBER(NVL(TRIM(RHPESS_PESSOA.PIS_PASEP), 0)) AS PIS_PASEP,
          CASE WHEN RHPESS_CONTRATO.DATA_ADMISSAO <= TO_DATE('30/12/2011', 'DD/MM/YYYY') THEN 1 ELSE 2 END AS CODIGO_PLANO,
          TO_NUMBER(SUBSTR(TRIM(RHPESS_CONTRATO.COD_CARGO_EFETIVO), 12, 4)) AS CODIGO_CARGO,
          CASE
            WHEN RHPESS_CONTRATO.DATA_EFETIVO_EXERC IS NOT NULL THEN TO_CHAR(RHPESS_CONTRATO.DATA_EFETIVO_EXERC, 'YYYYMMDD')
            ELSE TO_CHAR(RHPESS_CONTRATO.DATA_ADMISSAO, 'YYYYMMDD')
          END AS DATA_ADMISSAO_POSSE, RHPONT_RES_SIT_DIA.CODIGO_SITUACAO AS SITUACAO_FUNCIONAL, NULL AS CID, RHPONT_RES_SIT_DIA.DT_ULT_ALTER_USUA
         FROM RHPONT_RES_SIT_DIA,RHPONT_SITUACAO,RHPESS_CONTRATO,RHPESS_PESSOA,RHORGA_UNIDADE,RHPARM_SIT_FUNC,RHPLCS_CARGO
        WHERE RHPONT_RES_SIT_DIA.DT_ULT_ALTER_USUA > ULTIMA_ALTERACAO
          AND RHPESS_CONTRATO.TIPO_CONTRATO = '0001' AND RHPESS_CONTRATO.CODIGO_EMPRESA = '0001' AND (RHPESS_CONTRATO.SITUACAO_FUNCIONAL <= '7000' OR RHPESS_CONTRATO.SITUACAO_FUNCIONAL IN ('8000','8001')) 
          AND RHPESS_CONTRATO.COD_CARGO_PAGTO NOT IN ('000000000002006','000000000002007')
          AND RHPESS_CONTRATO.ANO_MES_REFERENCIA = (
              SELECT MAX(ARTERH_CONTRATO.ANO_MES_REFERENCIA) 
                FROM RHPESS_CONTRATO ARTERH_CONTRATO
               WHERE RHPESS_CONTRATO.CODIGO_EMPRESA = ARTERH_CONTRATO.CODIGO_EMPRESA
                 AND RHPESS_CONTRATO.TIPO_CONTRATO = ARTERH_CONTRATO.TIPO_CONTRATO
                 AND RHPESS_CONTRATO.CODIGO = ARTERH_CONTRATO.CODIGO
                 AND ARTERH_CONTRATO.ANO_MES_REFERENCIA <= SYSDATE )
          AND RHPESS_CONTRATO.CODIGO_EMPRESA = RHPONT_RES_SIT_DIA.CODIGO_EMPRESA AND RHPESS_CONTRATO.TIPO_CONTRATO = RHPONT_RES_SIT_DIA.TIPO_CONTRATO AND RHPESS_CONTRATO.CODIGO = RHPONT_RES_SIT_DIA.CODIGO_CONTRATO 
          AND RHPONT_RES_SIT_DIA.CODIGO_SITUACAO = RHPONT_SITUACAO.CODIGO AND RHPESS_PESSOA.CODIGO_EMPRESA = RHPESS_CONTRATO.CODIGO_EMPRESA AND RHPESS_PESSOA.CODIGO = RHPESS_CONTRATO.CODIGO_PESSOA
          AND RHPESS_CONTRATO.COD_UNIDADE1 = RHORGA_UNIDADE.COD_UNIDADE1 AND RHPESS_CONTRATO.COD_UNIDADE2 = RHORGA_UNIDADE.COD_UNIDADE2 AND RHPESS_CONTRATO.COD_UNIDADE3 = RHORGA_UNIDADE.COD_UNIDADE3 
          AND RHPESS_CONTRATO.COD_UNIDADE4 = RHORGA_UNIDADE.COD_UNIDADE4 AND RHPESS_CONTRATO.COD_UNIDADE5 = RHORGA_UNIDADE.COD_UNIDADE5 AND RHPESS_CONTRATO.COD_UNIDADE6 = RHORGA_UNIDADE.COD_UNIDADE6 
          AND RHPESS_CONTRATO.CODIGO_EMPRESA = RHORGA_UNIDADE.CODIGO_EMPRESA AND RHPESS_CONTRATO.SITUACAO_FUNCIONAL = RHPARM_SIT_FUNC.CODIGO AND RHPESS_CONTRATO.CODIGO_EMPRESA = RHPLCS_CARGO.CODIGO_EMPRESA (+)
          AND RHPESS_CONTRATO.COD_CARGO_EFETIVO = RHPLCS_CARGO.CODIGO (+) AND RHPONT_RES_SIT_DIA.TIPO_APURACAO = 'F' 
          AND RHPONT_RES_SIT_DIA.CODIGO_SITUACAO IN ('0535')) FR
      GROUP BY FR.DISTANCE, FR.CODIGO_EMPRESA, FR.CODIGO_PLANO, FR.CODIGO_SITUACAO, FR.DESCRICAO_SITUACAO, FR.MATRICULA, FR.DIGITO, FR.NOME, FR.CPF, FR.PIS_PASEP,FR.CODIGO_CARGO, FR.DATA_ADMISSAO_POSSE, FR.SITUACAO_FUNCIONAL, FR.CID, FR.DT_ULT_ALTER_USUA) 
      UNION ALL ( 
      SELECT 
        TO_CHAR(MIN(FR.DATA), 'YYYYMM') AS ANO_MES_REFERENCIA, FR.CODIGO_PLANO,FR.SITUACAO_FUNCIONAL,FR.CODIGO_EMPRESA,
        FR.MATRICULA,FR.DIGITO,FR.NOME,FR.CPF,FR.PIS_PASEP,FR.CODIGO_CARGO,FR.DATA_ADMISSAO_POSSE, 
        TO_CHAR(MIN(FR.DATA), 'RRRRMMDD') AS DATA_INICIO, TO_CHAR(MAX(FR.DATA), 'YYYYMMDD') AS DATA_FIM, COUNT(FR.DATA) DIAS,FR.CID, FR.DT_ULT_ALTER_USUA
      FROM (
        SELECT 
          TO_DATE(TO_CHAR(RHPONT_RES_SIT_DIA.DATA, 'DD/MM/YYYY'), 'DD/MM/YYYY') AS DATA,
          RHPONT_RES_SIT_DIA.DATA - ROW_NUMBER() OVER(ORDER BY RHPESS_CONTRATO.COD_UNIDADE1, RHPESS_CONTRATO.COD_UNIDADE2, RHPESS_CONTRATO.COD_UNIDADE3, RHPESS_CONTRATO.COD_UNIDADE4, RHPESS_CONTRATO.COD_UNIDADE5, RHPESS_CONTRATO.COD_UNIDADE6, RHPESS_CONTRATO.CODIGO, RHPONT_RES_SIT_DIA.CODIGO_SITUACAO, RHPONT_RES_SIT_DIA.DATA) AS DISTANCE,
          RHPONT_RES_SIT_DIA.CODIGO_SITUACAO, TO_NUMBER(RHPESS_CONTRATO.CODIGO_EMPRESA) AS CODIGO_EMPRESA, RHPONT_SITUACAO.DESCRICAO DESCRICAO_SITUACAO,
          TO_NUMBER(SUBSTR(RHPESS_CONTRATO.CODIGO, 5, 10)) AS MATRICULA, 
          CASE WHEN SUBSTR(RHPESS_CONTRATO.CODIGO, 15, 1) = 'X' THEN 7 ELSE TO_NUMBER(SUBSTR(RHPESS_CONTRATO.CODIGO, 15, 1)) END AS DIGITO,
          SUBSTR(TRIM(RHPESS_CONTRATO.NOME), 1, 80) AS NOME, SUBSTR(TRIM(RHPESS_PESSOA.CPF), 1, 11) AS CPF, TO_NUMBER(NVL(TRIM(RHPESS_PESSOA.PIS_PASEP), 0)) AS PIS_PASEP,
          CASE WHEN RHPESS_CONTRATO.DATA_ADMISSAO <= TO_DATE('30/12/2011', 'DD/MM/YYYY') THEN 1 ELSE 2 END AS CODIGO_PLANO,
          TO_NUMBER(SUBSTR(TRIM(RHPESS_CONTRATO.COD_CARGO_EFETIVO), 12, 4)) AS CODIGO_CARGO,
          CASE
            WHEN RHPESS_CONTRATO.DATA_EFETIVO_EXERC IS NOT NULL THEN TO_CHAR(RHPESS_CONTRATO.DATA_EFETIVO_EXERC, 'YYYYMMDD')
            ELSE TO_CHAR(RHPESS_CONTRATO.DATA_ADMISSAO, 'YYYYMMDD')
          END AS DATA_ADMISSAO_POSSE, RHPONT_RES_SIT_DIA.CODIGO_SITUACAO AS SITUACAO_FUNCIONAL, NULL AS CID, RHPONT_RES_SIT_DIA.DT_ULT_ALTER_USUA
         FROM RHPONT_RES_SIT_DIA,RHPONT_SITUACAO,RHPESS_CONTRATO,RHPESS_PESSOA,RHORGA_UNIDADE,RHPARM_SIT_FUNC,RHPLCS_CARGO
        WHERE RHPONT_RES_SIT_DIA.DT_ULT_ALTER_USUA > ULTIMA_ALTERACAO
          AND RHPESS_CONTRATO.TIPO_CONTRATO = '0001' AND RHPESS_CONTRATO.CODIGO_EMPRESA = '0001' AND (RHPESS_CONTRATO.SITUACAO_FUNCIONAL <= '7000' OR RHPESS_CONTRATO.SITUACAO_FUNCIONAL IN ('8000','8001')) 
          AND RHPESS_CONTRATO.COD_CARGO_PAGTO NOT IN ('000000000002006','000000000002007')
          AND RHPESS_CONTRATO.ANO_MES_REFERENCIA = (
              SELECT MAX(ARTERH_CONTRATO.ANO_MES_REFERENCIA) 
                FROM RHPESS_CONTRATO ARTERH_CONTRATO
               WHERE RHPESS_CONTRATO.CODIGO_EMPRESA = ARTERH_CONTRATO.CODIGO_EMPRESA
                 AND RHPESS_CONTRATO.TIPO_CONTRATO = ARTERH_CONTRATO.TIPO_CONTRATO
                 AND RHPESS_CONTRATO.CODIGO = ARTERH_CONTRATO.CODIGO
                 AND ARTERH_CONTRATO.ANO_MES_REFERENCIA <= SYSDATE )
          AND RHPESS_CONTRATO.CODIGO_EMPRESA = RHPONT_RES_SIT_DIA.CODIGO_EMPRESA AND RHPESS_CONTRATO.TIPO_CONTRATO = RHPONT_RES_SIT_DIA.TIPO_CONTRATO AND RHPESS_CONTRATO.CODIGO = RHPONT_RES_SIT_DIA.CODIGO_CONTRATO 
          AND RHPONT_RES_SIT_DIA.CODIGO_SITUACAO = RHPONT_SITUACAO.CODIGO AND RHPESS_PESSOA.CODIGO_EMPRESA = RHPESS_CONTRATO.CODIGO_EMPRESA AND RHPESS_PESSOA.CODIGO = RHPESS_CONTRATO.CODIGO_PESSOA
          AND RHPESS_CONTRATO.COD_UNIDADE1 = RHORGA_UNIDADE.COD_UNIDADE1 AND RHPESS_CONTRATO.COD_UNIDADE2 = RHORGA_UNIDADE.COD_UNIDADE2 AND RHPESS_CONTRATO.COD_UNIDADE3 = RHORGA_UNIDADE.COD_UNIDADE3 
          AND RHPESS_CONTRATO.COD_UNIDADE4 = RHORGA_UNIDADE.COD_UNIDADE4 AND RHPESS_CONTRATO.COD_UNIDADE5 = RHORGA_UNIDADE.COD_UNIDADE5 AND RHPESS_CONTRATO.COD_UNIDADE6 = RHORGA_UNIDADE.COD_UNIDADE6 
          AND RHPESS_CONTRATO.CODIGO_EMPRESA = RHORGA_UNIDADE.CODIGO_EMPRESA AND RHPESS_CONTRATO.SITUACAO_FUNCIONAL = RHPARM_SIT_FUNC.CODIGO AND RHPESS_CONTRATO.CODIGO_EMPRESA = RHPLCS_CARGO.CODIGO_EMPRESA (+)
          AND RHPESS_CONTRATO.COD_CARGO_EFETIVO = RHPLCS_CARGO.CODIGO (+) AND RHPONT_RES_SIT_DIA.TIPO_APURACAO = 'F' 
          AND RHPONT_RES_SIT_DIA.CODIGO_SITUACAO IN ('0542')) FR
      GROUP BY FR.DISTANCE, FR.CODIGO_EMPRESA, FR.CODIGO_PLANO, FR.CODIGO_SITUACAO, FR.DESCRICAO_SITUACAO, FR.MATRICULA, FR.DIGITO, FR.NOME, FR.CPF, FR.PIS_PASEP,FR.CODIGO_CARGO, FR.DATA_ADMISSAO_POSSE, FR.SITUACAO_FUNCIONAL, FR.CID, FR.DT_ULT_ALTER_USUA)
      UNION ALL ( 
      SELECT 
        TO_CHAR(MIN(FR.DATA), 'YYYYMM') AS ANO_MES_REFERENCIA, FR.CODIGO_PLANO,FR.SITUACAO_FUNCIONAL,FR.CODIGO_EMPRESA,
        FR.MATRICULA,FR.DIGITO,FR.NOME,FR.CPF,FR.PIS_PASEP,FR.CODIGO_CARGO,FR.DATA_ADMISSAO_POSSE, 
        TO_CHAR(MIN(FR.DATA), 'RRRRMMDD') AS DATA_INICIO, TO_CHAR(MAX(FR.DATA), 'YYYYMMDD') AS DATA_FIM, COUNT(FR.DATA) DIAS,FR.CID, FR.DT_ULT_ALTER_USUA
      FROM (
        SELECT 
          TO_DATE(TO_CHAR(RHPONT_RES_SIT_DIA.DATA, 'DD/MM/YYYY'), 'DD/MM/YYYY') AS DATA,
          RHPONT_RES_SIT_DIA.DATA - ROW_NUMBER() OVER(ORDER BY RHPESS_CONTRATO.COD_UNIDADE1, RHPESS_CONTRATO.COD_UNIDADE2, RHPESS_CONTRATO.COD_UNIDADE3, RHPESS_CONTRATO.COD_UNIDADE4, RHPESS_CONTRATO.COD_UNIDADE5, RHPESS_CONTRATO.COD_UNIDADE6, RHPESS_CONTRATO.CODIGO, RHPONT_RES_SIT_DIA.CODIGO_SITUACAO, RHPONT_RES_SIT_DIA.DATA) AS DISTANCE,
          RHPONT_RES_SIT_DIA.CODIGO_SITUACAO, TO_NUMBER(RHPESS_CONTRATO.CODIGO_EMPRESA) AS CODIGO_EMPRESA, RHPONT_SITUACAO.DESCRICAO DESCRICAO_SITUACAO,
          TO_NUMBER(SUBSTR(RHPESS_CONTRATO.CODIGO, 5, 10)) AS MATRICULA, 
          CASE WHEN SUBSTR(RHPESS_CONTRATO.CODIGO, 15, 1) = 'X' THEN 7 ELSE TO_NUMBER(SUBSTR(RHPESS_CONTRATO.CODIGO, 15, 1)) END AS DIGITO,
          SUBSTR(TRIM(RHPESS_CONTRATO.NOME), 1, 80) AS NOME, SUBSTR(TRIM(RHPESS_PESSOA.CPF), 1, 11) AS CPF, TO_NUMBER(NVL(TRIM(RHPESS_PESSOA.PIS_PASEP), 0)) AS PIS_PASEP,
          CASE WHEN RHPESS_CONTRATO.DATA_ADMISSAO <= TO_DATE('30/12/2011', 'DD/MM/YYYY') THEN 1 ELSE 2 END AS CODIGO_PLANO,
          TO_NUMBER(SUBSTR(TRIM(RHPESS_CONTRATO.COD_CARGO_EFETIVO), 12, 4)) AS CODIGO_CARGO,
          CASE
            WHEN RHPESS_CONTRATO.DATA_EFETIVO_EXERC IS NOT NULL THEN TO_CHAR(RHPESS_CONTRATO.DATA_EFETIVO_EXERC, 'YYYYMMDD')
            ELSE TO_CHAR(RHPESS_CONTRATO.DATA_ADMISSAO, 'YYYYMMDD')
          END AS DATA_ADMISSAO_POSSE, RHPONT_RES_SIT_DIA.CODIGO_SITUACAO AS SITUACAO_FUNCIONAL, NULL AS CID, RHPONT_RES_SIT_DIA.DT_ULT_ALTER_USUA
         FROM RHPONT_RES_SIT_DIA,RHPONT_SITUACAO,RHPESS_CONTRATO,RHPESS_PESSOA,RHORGA_UNIDADE,RHPARM_SIT_FUNC,RHPLCS_CARGO
        WHERE RHPONT_RES_SIT_DIA.DT_ULT_ALTER_USUA > ULTIMA_ALTERACAO
          AND RHPESS_CONTRATO.TIPO_CONTRATO = '0001' AND RHPESS_CONTRATO.CODIGO_EMPRESA = '0001' AND (RHPESS_CONTRATO.SITUACAO_FUNCIONAL <= '7000' OR RHPESS_CONTRATO.SITUACAO_FUNCIONAL IN ('8000','8001')) 
          AND RHPESS_CONTRATO.COD_CARGO_PAGTO NOT IN ('000000000002006','000000000002007')
          AND RHPESS_CONTRATO.ANO_MES_REFERENCIA = (
              SELECT MAX(ARTERH_CONTRATO.ANO_MES_REFERENCIA) 
                FROM RHPESS_CONTRATO ARTERH_CONTRATO
               WHERE RHPESS_CONTRATO.CODIGO_EMPRESA = ARTERH_CONTRATO.CODIGO_EMPRESA
                 AND RHPESS_CONTRATO.TIPO_CONTRATO = ARTERH_CONTRATO.TIPO_CONTRATO
                 AND RHPESS_CONTRATO.CODIGO = ARTERH_CONTRATO.CODIGO
                 AND ARTERH_CONTRATO.ANO_MES_REFERENCIA <= SYSDATE )
          AND RHPESS_CONTRATO.CODIGO_EMPRESA = RHPONT_RES_SIT_DIA.CODIGO_EMPRESA AND RHPESS_CONTRATO.TIPO_CONTRATO = RHPONT_RES_SIT_DIA.TIPO_CONTRATO AND RHPESS_CONTRATO.CODIGO = RHPONT_RES_SIT_DIA.CODIGO_CONTRATO 
          AND RHPONT_RES_SIT_DIA.CODIGO_SITUACAO = RHPONT_SITUACAO.CODIGO AND RHPESS_PESSOA.CODIGO_EMPRESA = RHPESS_CONTRATO.CODIGO_EMPRESA AND RHPESS_PESSOA.CODIGO = RHPESS_CONTRATO.CODIGO_PESSOA
          AND RHPESS_CONTRATO.COD_UNIDADE1 = RHORGA_UNIDADE.COD_UNIDADE1 AND RHPESS_CONTRATO.COD_UNIDADE2 = RHORGA_UNIDADE.COD_UNIDADE2 AND RHPESS_CONTRATO.COD_UNIDADE3 = RHORGA_UNIDADE.COD_UNIDADE3 
          AND RHPESS_CONTRATO.COD_UNIDADE4 = RHORGA_UNIDADE.COD_UNIDADE4 AND RHPESS_CONTRATO.COD_UNIDADE5 = RHORGA_UNIDADE.COD_UNIDADE5 AND RHPESS_CONTRATO.COD_UNIDADE6 = RHORGA_UNIDADE.COD_UNIDADE6 
          AND RHPESS_CONTRATO.CODIGO_EMPRESA = RHORGA_UNIDADE.CODIGO_EMPRESA AND RHPESS_CONTRATO.SITUACAO_FUNCIONAL = RHPARM_SIT_FUNC.CODIGO AND RHPESS_CONTRATO.CODIGO_EMPRESA = RHPLCS_CARGO.CODIGO_EMPRESA (+)
          AND RHPESS_CONTRATO.COD_CARGO_EFETIVO = RHPLCS_CARGO.CODIGO (+) AND RHPONT_RES_SIT_DIA.TIPO_APURACAO = 'F' 
          AND RHPONT_RES_SIT_DIA.CODIGO_SITUACAO IN ('0546')) FR
      GROUP BY FR.DISTANCE, FR.CODIGO_EMPRESA, FR.CODIGO_PLANO, FR.CODIGO_SITUACAO, FR.DESCRICAO_SITUACAO, FR.MATRICULA, FR.DIGITO, FR.NOME, FR.CPF, FR.PIS_PASEP,FR.CODIGO_CARGO, FR.DATA_ADMISSAO_POSSE, FR.SITUACAO_FUNCIONAL, FR.CID, FR.DT_ULT_ALTER_USUA) 
      UNION ALL ( 
      SELECT 
        TO_CHAR(MIN(FR.DATA), 'YYYYMM') AS ANO_MES_REFERENCIA, FR.CODIGO_PLANO,FR.SITUACAO_FUNCIONAL,FR.CODIGO_EMPRESA,
        FR.MATRICULA,FR.DIGITO,FR.NOME,FR.CPF,FR.PIS_PASEP,FR.CODIGO_CARGO,FR.DATA_ADMISSAO_POSSE, 
        TO_CHAR(MIN(FR.DATA), 'RRRRMMDD') AS DATA_INICIO, TO_CHAR(MAX(FR.DATA), 'YYYYMMDD') AS DATA_FIM, COUNT(FR.DATA) DIAS,FR.CID, FR.DT_ULT_ALTER_USUA
      FROM (
        SELECT 
          TO_DATE(TO_CHAR(RHPONT_RES_SIT_DIA.DATA, 'DD/MM/YYYY'), 'DD/MM/YYYY') AS DATA,
          RHPONT_RES_SIT_DIA.DATA - ROW_NUMBER() OVER(ORDER BY RHPESS_CONTRATO.COD_UNIDADE1, RHPESS_CONTRATO.COD_UNIDADE2, RHPESS_CONTRATO.COD_UNIDADE3, RHPESS_CONTRATO.COD_UNIDADE4, RHPESS_CONTRATO.COD_UNIDADE5, RHPESS_CONTRATO.COD_UNIDADE6, RHPESS_CONTRATO.CODIGO, RHPONT_RES_SIT_DIA.CODIGO_SITUACAO, RHPONT_RES_SIT_DIA.DATA) AS DISTANCE,
          RHPONT_RES_SIT_DIA.CODIGO_SITUACAO, TO_NUMBER(RHPESS_CONTRATO.CODIGO_EMPRESA) AS CODIGO_EMPRESA, RHPONT_SITUACAO.DESCRICAO DESCRICAO_SITUACAO,
          TO_NUMBER(SUBSTR(RHPESS_CONTRATO.CODIGO, 5, 10)) AS MATRICULA, 
          CASE WHEN SUBSTR(RHPESS_CONTRATO.CODIGO, 15, 1) = 'X' THEN 7 ELSE TO_NUMBER(SUBSTR(RHPESS_CONTRATO.CODIGO, 15, 1)) END AS DIGITO,
          SUBSTR(TRIM(RHPESS_CONTRATO.NOME), 1, 80) AS NOME, SUBSTR(TRIM(RHPESS_PESSOA.CPF), 1, 11) AS CPF, TO_NUMBER(NVL(TRIM(RHPESS_PESSOA.PIS_PASEP), 0)) AS PIS_PASEP,
          CASE WHEN RHPESS_CONTRATO.DATA_ADMISSAO <= TO_DATE('30/12/2011', 'DD/MM/YYYY') THEN 1 ELSE 2 END AS CODIGO_PLANO,
          TO_NUMBER(SUBSTR(TRIM(RHPESS_CONTRATO.COD_CARGO_EFETIVO), 12, 4)) AS CODIGO_CARGO,
          CASE
            WHEN RHPESS_CONTRATO.DATA_EFETIVO_EXERC IS NOT NULL THEN TO_CHAR(RHPESS_CONTRATO.DATA_EFETIVO_EXERC, 'YYYYMMDD')
            ELSE TO_CHAR(RHPESS_CONTRATO.DATA_ADMISSAO, 'YYYYMMDD')
          END AS DATA_ADMISSAO_POSSE, RHPONT_RES_SIT_DIA.CODIGO_SITUACAO AS SITUACAO_FUNCIONAL, NULL AS CID, RHPONT_RES_SIT_DIA.DT_ULT_ALTER_USUA
         FROM RHPONT_RES_SIT_DIA,RHPONT_SITUACAO,RHPESS_CONTRATO,RHPESS_PESSOA,RHORGA_UNIDADE,RHPARM_SIT_FUNC,RHPLCS_CARGO
        WHERE RHPONT_RES_SIT_DIA.DT_ULT_ALTER_USUA > ULTIMA_ALTERACAO
          AND RHPESS_CONTRATO.TIPO_CONTRATO = '0001' AND RHPESS_CONTRATO.CODIGO_EMPRESA = '0001' AND (RHPESS_CONTRATO.SITUACAO_FUNCIONAL <= '7000' OR RHPESS_CONTRATO.SITUACAO_FUNCIONAL IN ('8000','8001')) 
          AND RHPESS_CONTRATO.COD_CARGO_PAGTO NOT IN ('000000000002006','000000000002007')
          AND RHPESS_CONTRATO.ANO_MES_REFERENCIA = (
              SELECT MAX(ARTERH_CONTRATO.ANO_MES_REFERENCIA) 
                FROM RHPESS_CONTRATO ARTERH_CONTRATO
               WHERE RHPESS_CONTRATO.CODIGO_EMPRESA = ARTERH_CONTRATO.CODIGO_EMPRESA
                 AND RHPESS_CONTRATO.TIPO_CONTRATO = ARTERH_CONTRATO.TIPO_CONTRATO
                 AND RHPESS_CONTRATO.CODIGO = ARTERH_CONTRATO.CODIGO
                 AND ARTERH_CONTRATO.ANO_MES_REFERENCIA <= SYSDATE )
          AND RHPESS_CONTRATO.CODIGO_EMPRESA = RHPONT_RES_SIT_DIA.CODIGO_EMPRESA AND RHPESS_CONTRATO.TIPO_CONTRATO = RHPONT_RES_SIT_DIA.TIPO_CONTRATO AND RHPESS_CONTRATO.CODIGO = RHPONT_RES_SIT_DIA.CODIGO_CONTRATO 
          AND RHPONT_RES_SIT_DIA.CODIGO_SITUACAO = RHPONT_SITUACAO.CODIGO AND RHPESS_PESSOA.CODIGO_EMPRESA = RHPESS_CONTRATO.CODIGO_EMPRESA AND RHPESS_PESSOA.CODIGO = RHPESS_CONTRATO.CODIGO_PESSOA
          AND RHPESS_CONTRATO.COD_UNIDADE1 = RHORGA_UNIDADE.COD_UNIDADE1 AND RHPESS_CONTRATO.COD_UNIDADE2 = RHORGA_UNIDADE.COD_UNIDADE2 AND RHPESS_CONTRATO.COD_UNIDADE3 = RHORGA_UNIDADE.COD_UNIDADE3 
          AND RHPESS_CONTRATO.COD_UNIDADE4 = RHORGA_UNIDADE.COD_UNIDADE4 AND RHPESS_CONTRATO.COD_UNIDADE5 = RHORGA_UNIDADE.COD_UNIDADE5 AND RHPESS_CONTRATO.COD_UNIDADE6 = RHORGA_UNIDADE.COD_UNIDADE6 
          AND RHPESS_CONTRATO.CODIGO_EMPRESA = RHORGA_UNIDADE.CODIGO_EMPRESA AND RHPESS_CONTRATO.SITUACAO_FUNCIONAL = RHPARM_SIT_FUNC.CODIGO AND RHPESS_CONTRATO.CODIGO_EMPRESA = RHPLCS_CARGO.CODIGO_EMPRESA (+)
          AND RHPESS_CONTRATO.COD_CARGO_EFETIVO = RHPLCS_CARGO.CODIGO (+) AND RHPONT_RES_SIT_DIA.TIPO_APURACAO = 'F' 
          AND RHPONT_RES_SIT_DIA.CODIGO_SITUACAO IN ('0552')) FR
      GROUP BY FR.DISTANCE, FR.CODIGO_EMPRESA, FR.CODIGO_PLANO, FR.CODIGO_SITUACAO, FR.DESCRICAO_SITUACAO, FR.MATRICULA, FR.DIGITO, FR.NOME, FR.CPF, FR.PIS_PASEP,FR.CODIGO_CARGO, FR.DATA_ADMISSAO_POSSE, FR.SITUACAO_FUNCIONAL, FR.CID, FR.DT_ULT_ALTER_USUA) 
      UNION ALL ( 
      SELECT 
        TO_CHAR(MIN(FR.DATA), 'YYYYMM') AS ANO_MES_REFERENCIA, FR.CODIGO_PLANO,FR.SITUACAO_FUNCIONAL,FR.CODIGO_EMPRESA,
        FR.MATRICULA,FR.DIGITO,FR.NOME,FR.CPF,FR.PIS_PASEP,FR.CODIGO_CARGO,FR.DATA_ADMISSAO_POSSE, 
        TO_CHAR(MIN(FR.DATA), 'RRRRMMDD') AS DATA_INICIO, TO_CHAR(MAX(FR.DATA), 'YYYYMMDD') AS DATA_FIM, COUNT(FR.DATA) DIAS,FR.CID, FR.DT_ULT_ALTER_USUA
      FROM (
        SELECT 
          TO_DATE(TO_CHAR(RHPONT_RES_SIT_DIA.DATA, 'DD/MM/YYYY'), 'DD/MM/YYYY') AS DATA,
          RHPONT_RES_SIT_DIA.DATA - ROW_NUMBER() OVER(ORDER BY RHPESS_CONTRATO.COD_UNIDADE1, RHPESS_CONTRATO.COD_UNIDADE2, RHPESS_CONTRATO.COD_UNIDADE3, RHPESS_CONTRATO.COD_UNIDADE4, RHPESS_CONTRATO.COD_UNIDADE5, RHPESS_CONTRATO.COD_UNIDADE6, RHPESS_CONTRATO.CODIGO, RHPONT_RES_SIT_DIA.CODIGO_SITUACAO, RHPONT_RES_SIT_DIA.DATA) AS DISTANCE,
          RHPONT_RES_SIT_DIA.CODIGO_SITUACAO, TO_NUMBER(RHPESS_CONTRATO.CODIGO_EMPRESA) AS CODIGO_EMPRESA, RHPONT_SITUACAO.DESCRICAO DESCRICAO_SITUACAO,
          TO_NUMBER(SUBSTR(RHPESS_CONTRATO.CODIGO, 5, 10)) AS MATRICULA, 
          CASE WHEN SUBSTR(RHPESS_CONTRATO.CODIGO, 15, 1) = 'X' THEN 7 ELSE TO_NUMBER(SUBSTR(RHPESS_CONTRATO.CODIGO, 15, 1)) END AS DIGITO,
          SUBSTR(TRIM(RHPESS_CONTRATO.NOME), 1, 80) AS NOME, SUBSTR(TRIM(RHPESS_PESSOA.CPF), 1, 11) AS CPF, TO_NUMBER(NVL(TRIM(RHPESS_PESSOA.PIS_PASEP), 0)) AS PIS_PASEP,
          CASE WHEN RHPESS_CONTRATO.DATA_ADMISSAO <= TO_DATE('30/12/2011', 'DD/MM/YYYY') THEN 1 ELSE 2 END AS CODIGO_PLANO,
          TO_NUMBER(SUBSTR(TRIM(RHPESS_CONTRATO.COD_CARGO_EFETIVO), 12, 4)) AS CODIGO_CARGO,
          CASE
            WHEN RHPESS_CONTRATO.DATA_EFETIVO_EXERC IS NOT NULL THEN TO_CHAR(RHPESS_CONTRATO.DATA_EFETIVO_EXERC, 'YYYYMMDD')
            ELSE TO_CHAR(RHPESS_CONTRATO.DATA_ADMISSAO, 'YYYYMMDD')
          END AS DATA_ADMISSAO_POSSE, RHPONT_RES_SIT_DIA.CODIGO_SITUACAO AS SITUACAO_FUNCIONAL, NULL AS CID, RHPONT_RES_SIT_DIA.DT_ULT_ALTER_USUA
         FROM RHPONT_RES_SIT_DIA,RHPONT_SITUACAO,RHPESS_CONTRATO,RHPESS_PESSOA,RHORGA_UNIDADE,RHPARM_SIT_FUNC,RHPLCS_CARGO
        WHERE RHPONT_RES_SIT_DIA.DT_ULT_ALTER_USUA > ULTIMA_ALTERACAO
          AND RHPESS_CONTRATO.TIPO_CONTRATO = '0001' AND RHPESS_CONTRATO.CODIGO_EMPRESA = '0001' AND (RHPESS_CONTRATO.SITUACAO_FUNCIONAL <= '7000' OR RHPESS_CONTRATO.SITUACAO_FUNCIONAL IN ('8000','8001')) 
          AND RHPESS_CONTRATO.COD_CARGO_PAGTO NOT IN ('000000000002006','000000000002007')
          AND RHPESS_CONTRATO.ANO_MES_REFERENCIA = (
              SELECT MAX(ARTERH_CONTRATO.ANO_MES_REFERENCIA) 
                FROM RHPESS_CONTRATO ARTERH_CONTRATO
               WHERE RHPESS_CONTRATO.CODIGO_EMPRESA = ARTERH_CONTRATO.CODIGO_EMPRESA
                 AND RHPESS_CONTRATO.TIPO_CONTRATO = ARTERH_CONTRATO.TIPO_CONTRATO
                 AND RHPESS_CONTRATO.CODIGO = ARTERH_CONTRATO.CODIGO
                 AND ARTERH_CONTRATO.ANO_MES_REFERENCIA <= SYSDATE )
          AND RHPESS_CONTRATO.CODIGO_EMPRESA = RHPONT_RES_SIT_DIA.CODIGO_EMPRESA AND RHPESS_CONTRATO.TIPO_CONTRATO = RHPONT_RES_SIT_DIA.TIPO_CONTRATO AND RHPESS_CONTRATO.CODIGO = RHPONT_RES_SIT_DIA.CODIGO_CONTRATO 
          AND RHPONT_RES_SIT_DIA.CODIGO_SITUACAO = RHPONT_SITUACAO.CODIGO AND RHPESS_PESSOA.CODIGO_EMPRESA = RHPESS_CONTRATO.CODIGO_EMPRESA AND RHPESS_PESSOA.CODIGO = RHPESS_CONTRATO.CODIGO_PESSOA
          AND RHPESS_CONTRATO.COD_UNIDADE1 = RHORGA_UNIDADE.COD_UNIDADE1 AND RHPESS_CONTRATO.COD_UNIDADE2 = RHORGA_UNIDADE.COD_UNIDADE2 AND RHPESS_CONTRATO.COD_UNIDADE3 = RHORGA_UNIDADE.COD_UNIDADE3 
          AND RHPESS_CONTRATO.COD_UNIDADE4 = RHORGA_UNIDADE.COD_UNIDADE4 AND RHPESS_CONTRATO.COD_UNIDADE5 = RHORGA_UNIDADE.COD_UNIDADE5 AND RHPESS_CONTRATO.COD_UNIDADE6 = RHORGA_UNIDADE.COD_UNIDADE6 
          AND RHPESS_CONTRATO.CODIGO_EMPRESA = RHORGA_UNIDADE.CODIGO_EMPRESA AND RHPESS_CONTRATO.SITUACAO_FUNCIONAL = RHPARM_SIT_FUNC.CODIGO AND RHPESS_CONTRATO.CODIGO_EMPRESA = RHPLCS_CARGO.CODIGO_EMPRESA (+)
          AND RHPESS_CONTRATO.COD_CARGO_EFETIVO = RHPLCS_CARGO.CODIGO (+) AND RHPONT_RES_SIT_DIA.TIPO_APURACAO = 'F' 
          AND RHPONT_RES_SIT_DIA.CODIGO_SITUACAO IN ('1004')) FR
      GROUP BY FR.DISTANCE, FR.CODIGO_EMPRESA, FR.CODIGO_PLANO, FR.CODIGO_SITUACAO, FR.DESCRICAO_SITUACAO, FR.MATRICULA, FR.DIGITO, FR.NOME, FR.CPF, FR.PIS_PASEP,FR.CODIGO_CARGO, FR.DATA_ADMISSAO_POSSE, FR.SITUACAO_FUNCIONAL, FR.CID, FR.DT_ULT_ALTER_USUA)
      UNION ALL ( 
      SELECT 
        TO_CHAR(MIN(FR.DATA), 'YYYYMM') AS ANO_MES_REFERENCIA, FR.CODIGO_PLANO,FR.SITUACAO_FUNCIONAL,FR.CODIGO_EMPRESA,
        FR.MATRICULA,FR.DIGITO,FR.NOME,FR.CPF,FR.PIS_PASEP,FR.CODIGO_CARGO,FR.DATA_ADMISSAO_POSSE, 
        TO_CHAR(MIN(FR.DATA), 'RRRRMMDD') AS DATA_INICIO, TO_CHAR(MAX(FR.DATA), 'YYYYMMDD') AS DATA_FIM, COUNT(FR.DATA) DIAS,FR.CID, FR.DT_ULT_ALTER_USUA
      FROM (
        SELECT 
          TO_DATE(TO_CHAR(RHPONT_RES_SIT_DIA.DATA, 'DD/MM/YYYY'), 'DD/MM/YYYY') AS DATA,
          RHPONT_RES_SIT_DIA.DATA - ROW_NUMBER() OVER(ORDER BY RHPESS_CONTRATO.COD_UNIDADE1, RHPESS_CONTRATO.COD_UNIDADE2, RHPESS_CONTRATO.COD_UNIDADE3, RHPESS_CONTRATO.COD_UNIDADE4, RHPESS_CONTRATO.COD_UNIDADE5, RHPESS_CONTRATO.COD_UNIDADE6, RHPESS_CONTRATO.CODIGO, RHPONT_RES_SIT_DIA.CODIGO_SITUACAO, RHPONT_RES_SIT_DIA.DATA) AS DISTANCE,
          RHPONT_RES_SIT_DIA.CODIGO_SITUACAO, TO_NUMBER(RHPESS_CONTRATO.CODIGO_EMPRESA) AS CODIGO_EMPRESA, RHPONT_SITUACAO.DESCRICAO DESCRICAO_SITUACAO,
          TO_NUMBER(SUBSTR(RHPESS_CONTRATO.CODIGO, 5, 10)) AS MATRICULA, 
          CASE WHEN SUBSTR(RHPESS_CONTRATO.CODIGO, 15, 1) = 'X' THEN 7 ELSE TO_NUMBER(SUBSTR(RHPESS_CONTRATO.CODIGO, 15, 1)) END AS DIGITO,
          SUBSTR(TRIM(RHPESS_CONTRATO.NOME), 1, 80) AS NOME, SUBSTR(TRIM(RHPESS_PESSOA.CPF), 1, 11) AS CPF, TO_NUMBER(NVL(TRIM(RHPESS_PESSOA.PIS_PASEP), 0)) AS PIS_PASEP,
          CASE WHEN RHPESS_CONTRATO.DATA_ADMISSAO <= TO_DATE('30/12/2011', 'DD/MM/YYYY') THEN 1 ELSE 2 END AS CODIGO_PLANO,
          TO_NUMBER(SUBSTR(TRIM(RHPESS_CONTRATO.COD_CARGO_EFETIVO), 12, 4)) AS CODIGO_CARGO,
          CASE
            WHEN RHPESS_CONTRATO.DATA_EFETIVO_EXERC IS NOT NULL THEN TO_CHAR(RHPESS_CONTRATO.DATA_EFETIVO_EXERC, 'YYYYMMDD')
            ELSE TO_CHAR(RHPESS_CONTRATO.DATA_ADMISSAO, 'YYYYMMDD')
          END AS DATA_ADMISSAO_POSSE, RHPONT_RES_SIT_DIA.CODIGO_SITUACAO AS SITUACAO_FUNCIONAL, NULL AS CID, RHPONT_RES_SIT_DIA.DT_ULT_ALTER_USUA
         FROM RHPONT_RES_SIT_DIA,RHPONT_SITUACAO,RHPESS_CONTRATO,RHPESS_PESSOA,RHORGA_UNIDADE,RHPARM_SIT_FUNC,RHPLCS_CARGO
        WHERE RHPONT_RES_SIT_DIA.DT_ULT_ALTER_USUA > ULTIMA_ALTERACAO
          AND RHPESS_CONTRATO.TIPO_CONTRATO = '0001' AND RHPESS_CONTRATO.CODIGO_EMPRESA = '0001' AND (RHPESS_CONTRATO.SITUACAO_FUNCIONAL <= '7000' OR RHPESS_CONTRATO.SITUACAO_FUNCIONAL IN ('8000','8001')) 
          AND RHPESS_CONTRATO.COD_CARGO_PAGTO NOT IN ('000000000002006','000000000002007')
          AND RHPESS_CONTRATO.ANO_MES_REFERENCIA = (
              SELECT MAX(ARTERH_CONTRATO.ANO_MES_REFERENCIA) 
                FROM RHPESS_CONTRATO ARTERH_CONTRATO
               WHERE RHPESS_CONTRATO.CODIGO_EMPRESA = ARTERH_CONTRATO.CODIGO_EMPRESA
                 AND RHPESS_CONTRATO.TIPO_CONTRATO = ARTERH_CONTRATO.TIPO_CONTRATO
                 AND RHPESS_CONTRATO.CODIGO = ARTERH_CONTRATO.CODIGO
                 AND ARTERH_CONTRATO.ANO_MES_REFERENCIA <= SYSDATE )
          AND RHPESS_CONTRATO.CODIGO_EMPRESA = RHPONT_RES_SIT_DIA.CODIGO_EMPRESA AND RHPESS_CONTRATO.TIPO_CONTRATO = RHPONT_RES_SIT_DIA.TIPO_CONTRATO AND RHPESS_CONTRATO.CODIGO = RHPONT_RES_SIT_DIA.CODIGO_CONTRATO 
          AND RHPONT_RES_SIT_DIA.CODIGO_SITUACAO = RHPONT_SITUACAO.CODIGO AND RHPESS_PESSOA.CODIGO_EMPRESA = RHPESS_CONTRATO.CODIGO_EMPRESA AND RHPESS_PESSOA.CODIGO = RHPESS_CONTRATO.CODIGO_PESSOA
          AND RHPESS_CONTRATO.COD_UNIDADE1 = RHORGA_UNIDADE.COD_UNIDADE1 AND RHPESS_CONTRATO.COD_UNIDADE2 = RHORGA_UNIDADE.COD_UNIDADE2 AND RHPESS_CONTRATO.COD_UNIDADE3 = RHORGA_UNIDADE.COD_UNIDADE3 
          AND RHPESS_CONTRATO.COD_UNIDADE4 = RHORGA_UNIDADE.COD_UNIDADE4 AND RHPESS_CONTRATO.COD_UNIDADE5 = RHORGA_UNIDADE.COD_UNIDADE5 AND RHPESS_CONTRATO.COD_UNIDADE6 = RHORGA_UNIDADE.COD_UNIDADE6 
          AND RHPESS_CONTRATO.CODIGO_EMPRESA = RHORGA_UNIDADE.CODIGO_EMPRESA AND RHPESS_CONTRATO.SITUACAO_FUNCIONAL = RHPARM_SIT_FUNC.CODIGO AND RHPESS_CONTRATO.CODIGO_EMPRESA = RHPLCS_CARGO.CODIGO_EMPRESA (+)
          AND RHPESS_CONTRATO.COD_CARGO_EFETIVO = RHPLCS_CARGO.CODIGO (+) AND RHPONT_RES_SIT_DIA.TIPO_APURACAO = 'F' 
          AND RHPONT_RES_SIT_DIA.CODIGO_SITUACAO IN ('1015')) FR
      GROUP BY FR.DISTANCE, FR.CODIGO_EMPRESA, FR.CODIGO_PLANO, FR.CODIGO_SITUACAO, FR.DESCRICAO_SITUACAO, FR.MATRICULA, FR.DIGITO, FR.NOME, FR.CPF, FR.PIS_PASEP,FR.CODIGO_CARGO, FR.DATA_ADMISSAO_POSSE, FR.SITUACAO_FUNCIONAL, FR.CID, FR.DT_ULT_ALTER_USUA)
      UNION ALL ( 
      SELECT 
        TO_CHAR(MIN(FR.DATA), 'YYYYMM') AS ANO_MES_REFERENCIA, FR.CODIGO_PLANO,FR.SITUACAO_FUNCIONAL,FR.CODIGO_EMPRESA,
        FR.MATRICULA,FR.DIGITO,FR.NOME,FR.CPF,FR.PIS_PASEP,FR.CODIGO_CARGO,FR.DATA_ADMISSAO_POSSE, 
        TO_CHAR(MIN(FR.DATA), 'RRRRMMDD') AS DATA_INICIO, TO_CHAR(MAX(FR.DATA), 'YYYYMMDD') AS DATA_FIM, COUNT(FR.DATA) DIAS,FR.CID, FR.DT_ULT_ALTER_USUA
      FROM (
        SELECT 
          TO_DATE(TO_CHAR(RHPONT_RES_SIT_DIA.DATA, 'DD/MM/YYYY'), 'DD/MM/YYYY') AS DATA,
          RHPONT_RES_SIT_DIA.DATA - ROW_NUMBER() OVER(ORDER BY RHPESS_CONTRATO.COD_UNIDADE1, RHPESS_CONTRATO.COD_UNIDADE2, RHPESS_CONTRATO.COD_UNIDADE3, RHPESS_CONTRATO.COD_UNIDADE4, RHPESS_CONTRATO.COD_UNIDADE5, RHPESS_CONTRATO.COD_UNIDADE6, RHPESS_CONTRATO.CODIGO, RHPONT_RES_SIT_DIA.CODIGO_SITUACAO, RHPONT_RES_SIT_DIA.DATA) AS DISTANCE,
          RHPONT_RES_SIT_DIA.CODIGO_SITUACAO, TO_NUMBER(RHPESS_CONTRATO.CODIGO_EMPRESA) AS CODIGO_EMPRESA, RHPONT_SITUACAO.DESCRICAO DESCRICAO_SITUACAO,
          TO_NUMBER(SUBSTR(RHPESS_CONTRATO.CODIGO, 5, 10)) AS MATRICULA, 
          CASE WHEN SUBSTR(RHPESS_CONTRATO.CODIGO, 15, 1) = 'X' THEN 7 ELSE TO_NUMBER(SUBSTR(RHPESS_CONTRATO.CODIGO, 15, 1)) END AS DIGITO,
          SUBSTR(TRIM(RHPESS_CONTRATO.NOME), 1, 80) AS NOME, SUBSTR(TRIM(RHPESS_PESSOA.CPF), 1, 11) AS CPF, TO_NUMBER(NVL(TRIM(RHPESS_PESSOA.PIS_PASEP), 0)) AS PIS_PASEP,
          CASE WHEN RHPESS_CONTRATO.DATA_ADMISSAO <= TO_DATE('30/12/2011', 'DD/MM/YYYY') THEN 1 ELSE 2 END AS CODIGO_PLANO,
          TO_NUMBER(SUBSTR(TRIM(RHPESS_CONTRATO.COD_CARGO_EFETIVO), 12, 4)) AS CODIGO_CARGO,
          CASE
            WHEN RHPESS_CONTRATO.DATA_EFETIVO_EXERC IS NOT NULL THEN TO_CHAR(RHPESS_CONTRATO.DATA_EFETIVO_EXERC, 'YYYYMMDD')
            ELSE TO_CHAR(RHPESS_CONTRATO.DATA_ADMISSAO, 'YYYYMMDD')
          END AS DATA_ADMISSAO_POSSE, RHPONT_RES_SIT_DIA.CODIGO_SITUACAO AS SITUACAO_FUNCIONAL, NULL AS CID, RHPONT_RES_SIT_DIA.DT_ULT_ALTER_USUA
         FROM RHPONT_RES_SIT_DIA,RHPONT_SITUACAO,RHPESS_CONTRATO,RHPESS_PESSOA,RHORGA_UNIDADE,RHPARM_SIT_FUNC,RHPLCS_CARGO
        WHERE RHPONT_RES_SIT_DIA.DT_ULT_ALTER_USUA > ULTIMA_ALTERACAO
          AND RHPESS_CONTRATO.TIPO_CONTRATO = '0001' AND RHPESS_CONTRATO.CODIGO_EMPRESA = '0001' AND (RHPESS_CONTRATO.SITUACAO_FUNCIONAL <= '7000' OR RHPESS_CONTRATO.SITUACAO_FUNCIONAL IN ('8000','8001')) 
          AND RHPESS_CONTRATO.COD_CARGO_PAGTO NOT IN ('000000000002006','000000000002007')
          AND RHPESS_CONTRATO.ANO_MES_REFERENCIA = (
              SELECT MAX(ARTERH_CONTRATO.ANO_MES_REFERENCIA) 
                FROM RHPESS_CONTRATO ARTERH_CONTRATO
               WHERE RHPESS_CONTRATO.CODIGO_EMPRESA = ARTERH_CONTRATO.CODIGO_EMPRESA
                 AND RHPESS_CONTRATO.TIPO_CONTRATO = ARTERH_CONTRATO.TIPO_CONTRATO
                 AND RHPESS_CONTRATO.CODIGO = ARTERH_CONTRATO.CODIGO
                 AND ARTERH_CONTRATO.ANO_MES_REFERENCIA <= SYSDATE )
          AND RHPESS_CONTRATO.CODIGO_EMPRESA = RHPONT_RES_SIT_DIA.CODIGO_EMPRESA AND RHPESS_CONTRATO.TIPO_CONTRATO = RHPONT_RES_SIT_DIA.TIPO_CONTRATO AND RHPESS_CONTRATO.CODIGO = RHPONT_RES_SIT_DIA.CODIGO_CONTRATO 
          AND RHPONT_RES_SIT_DIA.CODIGO_SITUACAO = RHPONT_SITUACAO.CODIGO AND RHPESS_PESSOA.CODIGO_EMPRESA = RHPESS_CONTRATO.CODIGO_EMPRESA AND RHPESS_PESSOA.CODIGO = RHPESS_CONTRATO.CODIGO_PESSOA
          AND RHPESS_CONTRATO.COD_UNIDADE1 = RHORGA_UNIDADE.COD_UNIDADE1 AND RHPESS_CONTRATO.COD_UNIDADE2 = RHORGA_UNIDADE.COD_UNIDADE2 AND RHPESS_CONTRATO.COD_UNIDADE3 = RHORGA_UNIDADE.COD_UNIDADE3 
          AND RHPESS_CONTRATO.COD_UNIDADE4 = RHORGA_UNIDADE.COD_UNIDADE4 AND RHPESS_CONTRATO.COD_UNIDADE5 = RHORGA_UNIDADE.COD_UNIDADE5 AND RHPESS_CONTRATO.COD_UNIDADE6 = RHORGA_UNIDADE.COD_UNIDADE6 
          AND RHPESS_CONTRATO.CODIGO_EMPRESA = RHORGA_UNIDADE.CODIGO_EMPRESA AND RHPESS_CONTRATO.SITUACAO_FUNCIONAL = RHPARM_SIT_FUNC.CODIGO AND RHPESS_CONTRATO.CODIGO_EMPRESA = RHPLCS_CARGO.CODIGO_EMPRESA (+)
          AND RHPESS_CONTRATO.COD_CARGO_EFETIVO = RHPLCS_CARGO.CODIGO (+) AND RHPONT_RES_SIT_DIA.TIPO_APURACAO = 'F' 
          AND RHPONT_RES_SIT_DIA.CODIGO_SITUACAO IN ('1124')) FR
      GROUP BY FR.DISTANCE, FR.CODIGO_EMPRESA, FR.CODIGO_PLANO, FR.CODIGO_SITUACAO, FR.DESCRICAO_SITUACAO, FR.MATRICULA, FR.DIGITO, FR.NOME, FR.CPF, FR.PIS_PASEP,FR.CODIGO_CARGO, FR.DATA_ADMISSAO_POSSE, FR.SITUACAO_FUNCIONAL, FR.CID, FR.DT_ULT_ALTER_USUA)
      UNION ALL ( 
      SELECT 
        TO_CHAR(MIN(FR.DATA), 'YYYYMM') AS ANO_MES_REFERENCIA, FR.CODIGO_PLANO,FR.SITUACAO_FUNCIONAL,FR.CODIGO_EMPRESA,
        FR.MATRICULA,FR.DIGITO,FR.NOME,FR.CPF,FR.PIS_PASEP,FR.CODIGO_CARGO,FR.DATA_ADMISSAO_POSSE, 
        TO_CHAR(MIN(FR.DATA), 'RRRRMMDD') AS DATA_INICIO, TO_CHAR(MAX(FR.DATA), 'YYYYMMDD') AS DATA_FIM, COUNT(FR.DATA) DIAS,FR.CID, FR.DT_ULT_ALTER_USUA
      FROM (
        SELECT 
          TO_DATE(TO_CHAR(RHPONT_RES_SIT_DIA.DATA, 'DD/MM/YYYY'), 'DD/MM/YYYY') AS DATA,
          RHPONT_RES_SIT_DIA.DATA - ROW_NUMBER() OVER(ORDER BY RHPESS_CONTRATO.COD_UNIDADE1, RHPESS_CONTRATO.COD_UNIDADE2, RHPESS_CONTRATO.COD_UNIDADE3, RHPESS_CONTRATO.COD_UNIDADE4, RHPESS_CONTRATO.COD_UNIDADE5, RHPESS_CONTRATO.COD_UNIDADE6, RHPESS_CONTRATO.CODIGO, RHPONT_RES_SIT_DIA.CODIGO_SITUACAO, RHPONT_RES_SIT_DIA.DATA) AS DISTANCE,
          RHPONT_RES_SIT_DIA.CODIGO_SITUACAO, TO_NUMBER(RHPESS_CONTRATO.CODIGO_EMPRESA) AS CODIGO_EMPRESA, RHPONT_SITUACAO.DESCRICAO DESCRICAO_SITUACAO,
          TO_NUMBER(SUBSTR(RHPESS_CONTRATO.CODIGO, 5, 10)) AS MATRICULA, 
          CASE WHEN SUBSTR(RHPESS_CONTRATO.CODIGO, 15, 1) = 'X' THEN 7 ELSE TO_NUMBER(SUBSTR(RHPESS_CONTRATO.CODIGO, 15, 1)) END AS DIGITO,
          SUBSTR(TRIM(RHPESS_CONTRATO.NOME), 1, 80) AS NOME, SUBSTR(TRIM(RHPESS_PESSOA.CPF), 1, 11) AS CPF, TO_NUMBER(NVL(TRIM(RHPESS_PESSOA.PIS_PASEP), 0)) AS PIS_PASEP,
          CASE WHEN RHPESS_CONTRATO.DATA_ADMISSAO <= TO_DATE('30/12/2011', 'DD/MM/YYYY') THEN 1 ELSE 2 END AS CODIGO_PLANO,
          TO_NUMBER(SUBSTR(TRIM(RHPESS_CONTRATO.COD_CARGO_EFETIVO), 12, 4)) AS CODIGO_CARGO,
          CASE
            WHEN RHPESS_CONTRATO.DATA_EFETIVO_EXERC IS NOT NULL THEN TO_CHAR(RHPESS_CONTRATO.DATA_EFETIVO_EXERC, 'YYYYMMDD')
            ELSE TO_CHAR(RHPESS_CONTRATO.DATA_ADMISSAO, 'YYYYMMDD')
          END AS DATA_ADMISSAO_POSSE, RHPONT_RES_SIT_DIA.CODIGO_SITUACAO AS SITUACAO_FUNCIONAL, NULL AS CID, RHPONT_RES_SIT_DIA.DT_ULT_ALTER_USUA
         FROM RHPONT_RES_SIT_DIA,RHPONT_SITUACAO,RHPESS_CONTRATO,RHPESS_PESSOA,RHORGA_UNIDADE,RHPARM_SIT_FUNC,RHPLCS_CARGO
        WHERE RHPONT_RES_SIT_DIA.DT_ULT_ALTER_USUA > ULTIMA_ALTERACAO
          AND RHPESS_CONTRATO.TIPO_CONTRATO = '0001' AND RHPESS_CONTRATO.CODIGO_EMPRESA = '0001' AND (RHPESS_CONTRATO.SITUACAO_FUNCIONAL <= '7000' OR RHPESS_CONTRATO.SITUACAO_FUNCIONAL IN ('8000','8001')) 
          AND RHPESS_CONTRATO.COD_CARGO_PAGTO NOT IN ('000000000002006','000000000002007')
          AND RHPESS_CONTRATO.ANO_MES_REFERENCIA = (
              SELECT MAX(ARTERH_CONTRATO.ANO_MES_REFERENCIA) 
                FROM RHPESS_CONTRATO ARTERH_CONTRATO
               WHERE RHPESS_CONTRATO.CODIGO_EMPRESA = ARTERH_CONTRATO.CODIGO_EMPRESA
                 AND RHPESS_CONTRATO.TIPO_CONTRATO = ARTERH_CONTRATO.TIPO_CONTRATO
                 AND RHPESS_CONTRATO.CODIGO = ARTERH_CONTRATO.CODIGO
                 AND ARTERH_CONTRATO.ANO_MES_REFERENCIA <= SYSDATE )
          AND RHPESS_CONTRATO.CODIGO_EMPRESA = RHPONT_RES_SIT_DIA.CODIGO_EMPRESA AND RHPESS_CONTRATO.TIPO_CONTRATO = RHPONT_RES_SIT_DIA.TIPO_CONTRATO AND RHPESS_CONTRATO.CODIGO = RHPONT_RES_SIT_DIA.CODIGO_CONTRATO 
          AND RHPONT_RES_SIT_DIA.CODIGO_SITUACAO = RHPONT_SITUACAO.CODIGO AND RHPESS_PESSOA.CODIGO_EMPRESA = RHPESS_CONTRATO.CODIGO_EMPRESA AND RHPESS_PESSOA.CODIGO = RHPESS_CONTRATO.CODIGO_PESSOA
          AND RHPESS_CONTRATO.COD_UNIDADE1 = RHORGA_UNIDADE.COD_UNIDADE1 AND RHPESS_CONTRATO.COD_UNIDADE2 = RHORGA_UNIDADE.COD_UNIDADE2 AND RHPESS_CONTRATO.COD_UNIDADE3 = RHORGA_UNIDADE.COD_UNIDADE3 
          AND RHPESS_CONTRATO.COD_UNIDADE4 = RHORGA_UNIDADE.COD_UNIDADE4 AND RHPESS_CONTRATO.COD_UNIDADE5 = RHORGA_UNIDADE.COD_UNIDADE5 AND RHPESS_CONTRATO.COD_UNIDADE6 = RHORGA_UNIDADE.COD_UNIDADE6 
          AND RHPESS_CONTRATO.CODIGO_EMPRESA = RHORGA_UNIDADE.CODIGO_EMPRESA AND RHPESS_CONTRATO.SITUACAO_FUNCIONAL = RHPARM_SIT_FUNC.CODIGO AND RHPESS_CONTRATO.CODIGO_EMPRESA = RHPLCS_CARGO.CODIGO_EMPRESA (+)
          AND RHPESS_CONTRATO.COD_CARGO_EFETIVO = RHPLCS_CARGO.CODIGO (+) AND RHPONT_RES_SIT_DIA.TIPO_APURACAO = 'F' 
          AND RHPONT_RES_SIT_DIA.CODIGO_SITUACAO IN ('1136')) FR
      GROUP BY FR.DISTANCE, FR.CODIGO_EMPRESA, FR.CODIGO_PLANO, FR.CODIGO_SITUACAO, FR.DESCRICAO_SITUACAO, FR.MATRICULA, FR.DIGITO, FR.NOME, FR.CPF, FR.PIS_PASEP,FR.CODIGO_CARGO, FR.DATA_ADMISSAO_POSSE, FR.SITUACAO_FUNCIONAL, FR.CID, FR.DT_ULT_ALTER_USUA)
      UNION ALL ( 
      SELECT 
        TO_CHAR(MIN(FR.DATA), 'YYYYMM') AS ANO_MES_REFERENCIA, FR.CODIGO_PLANO,FR.SITUACAO_FUNCIONAL,FR.CODIGO_EMPRESA,
        FR.MATRICULA,FR.DIGITO,FR.NOME,FR.CPF,FR.PIS_PASEP,FR.CODIGO_CARGO,FR.DATA_ADMISSAO_POSSE, 
        TO_CHAR(MIN(FR.DATA), 'RRRRMMDD') AS DATA_INICIO, TO_CHAR(MAX(FR.DATA), 'YYYYMMDD') AS DATA_FIM, COUNT(FR.DATA) DIAS,FR.CID, FR.DT_ULT_ALTER_USUA
      FROM (
        SELECT 
          TO_DATE(TO_CHAR(RHPONT_RES_SIT_DIA.DATA, 'DD/MM/YYYY'), 'DD/MM/YYYY') AS DATA,
          RHPONT_RES_SIT_DIA.DATA - ROW_NUMBER() OVER(ORDER BY RHPESS_CONTRATO.COD_UNIDADE1, RHPESS_CONTRATO.COD_UNIDADE2, RHPESS_CONTRATO.COD_UNIDADE3, RHPESS_CONTRATO.COD_UNIDADE4, RHPESS_CONTRATO.COD_UNIDADE5, RHPESS_CONTRATO.COD_UNIDADE6, RHPESS_CONTRATO.CODIGO, RHPONT_RES_SIT_DIA.CODIGO_SITUACAO, RHPONT_RES_SIT_DIA.DATA) AS DISTANCE,
          RHPONT_RES_SIT_DIA.CODIGO_SITUACAO, TO_NUMBER(RHPESS_CONTRATO.CODIGO_EMPRESA) AS CODIGO_EMPRESA, RHPONT_SITUACAO.DESCRICAO DESCRICAO_SITUACAO,
          TO_NUMBER(SUBSTR(RHPESS_CONTRATO.CODIGO, 5, 10)) AS MATRICULA, 
          CASE WHEN SUBSTR(RHPESS_CONTRATO.CODIGO, 15, 1) = 'X' THEN 7 ELSE TO_NUMBER(SUBSTR(RHPESS_CONTRATO.CODIGO, 15, 1)) END AS DIGITO,
          SUBSTR(TRIM(RHPESS_CONTRATO.NOME), 1, 80) AS NOME, SUBSTR(TRIM(RHPESS_PESSOA.CPF), 1, 11) AS CPF, TO_NUMBER(NVL(TRIM(RHPESS_PESSOA.PIS_PASEP), 0)) AS PIS_PASEP,
          CASE WHEN RHPESS_CONTRATO.DATA_ADMISSAO <= TO_DATE('30/12/2011', 'DD/MM/YYYY') THEN 1 ELSE 2 END AS CODIGO_PLANO,
          TO_NUMBER(SUBSTR(TRIM(RHPESS_CONTRATO.COD_CARGO_EFETIVO), 12, 4)) AS CODIGO_CARGO,
          CASE
            WHEN RHPESS_CONTRATO.DATA_EFETIVO_EXERC IS NOT NULL THEN TO_CHAR(RHPESS_CONTRATO.DATA_EFETIVO_EXERC, 'YYYYMMDD')
            ELSE TO_CHAR(RHPESS_CONTRATO.DATA_ADMISSAO, 'YYYYMMDD')
          END AS DATA_ADMISSAO_POSSE, RHPONT_RES_SIT_DIA.CODIGO_SITUACAO AS SITUACAO_FUNCIONAL, NULL AS CID, RHPONT_RES_SIT_DIA.DT_ULT_ALTER_USUA
         FROM RHPONT_RES_SIT_DIA,RHPONT_SITUACAO,RHPESS_CONTRATO,RHPESS_PESSOA,RHORGA_UNIDADE,RHPARM_SIT_FUNC,RHPLCS_CARGO
        WHERE RHPONT_RES_SIT_DIA.DT_ULT_ALTER_USUA > ULTIMA_ALTERACAO
          AND RHPESS_CONTRATO.TIPO_CONTRATO = '0001' AND RHPESS_CONTRATO.CODIGO_EMPRESA = '0001' AND (RHPESS_CONTRATO.SITUACAO_FUNCIONAL <= '7000' OR RHPESS_CONTRATO.SITUACAO_FUNCIONAL IN ('8000','8001')) 
          AND RHPESS_CONTRATO.COD_CARGO_PAGTO NOT IN ('000000000002006','000000000002007')
          AND RHPESS_CONTRATO.ANO_MES_REFERENCIA = (
              SELECT MAX(ARTERH_CONTRATO.ANO_MES_REFERENCIA) 
                FROM RHPESS_CONTRATO ARTERH_CONTRATO
               WHERE RHPESS_CONTRATO.CODIGO_EMPRESA = ARTERH_CONTRATO.CODIGO_EMPRESA
                 AND RHPESS_CONTRATO.TIPO_CONTRATO = ARTERH_CONTRATO.TIPO_CONTRATO
                 AND RHPESS_CONTRATO.CODIGO = ARTERH_CONTRATO.CODIGO
                 AND ARTERH_CONTRATO.ANO_MES_REFERENCIA <= SYSDATE )
          AND RHPESS_CONTRATO.CODIGO_EMPRESA = RHPONT_RES_SIT_DIA.CODIGO_EMPRESA AND RHPESS_CONTRATO.TIPO_CONTRATO = RHPONT_RES_SIT_DIA.TIPO_CONTRATO AND RHPESS_CONTRATO.CODIGO = RHPONT_RES_SIT_DIA.CODIGO_CONTRATO 
          AND RHPONT_RES_SIT_DIA.CODIGO_SITUACAO = RHPONT_SITUACAO.CODIGO AND RHPESS_PESSOA.CODIGO_EMPRESA = RHPESS_CONTRATO.CODIGO_EMPRESA AND RHPESS_PESSOA.CODIGO = RHPESS_CONTRATO.CODIGO_PESSOA
          AND RHPESS_CONTRATO.COD_UNIDADE1 = RHORGA_UNIDADE.COD_UNIDADE1 AND RHPESS_CONTRATO.COD_UNIDADE2 = RHORGA_UNIDADE.COD_UNIDADE2 AND RHPESS_CONTRATO.COD_UNIDADE3 = RHORGA_UNIDADE.COD_UNIDADE3 
          AND RHPESS_CONTRATO.COD_UNIDADE4 = RHORGA_UNIDADE.COD_UNIDADE4 AND RHPESS_CONTRATO.COD_UNIDADE5 = RHORGA_UNIDADE.COD_UNIDADE5 AND RHPESS_CONTRATO.COD_UNIDADE6 = RHORGA_UNIDADE.COD_UNIDADE6 
          AND RHPESS_CONTRATO.CODIGO_EMPRESA = RHORGA_UNIDADE.CODIGO_EMPRESA AND RHPESS_CONTRATO.SITUACAO_FUNCIONAL = RHPARM_SIT_FUNC.CODIGO AND RHPESS_CONTRATO.CODIGO_EMPRESA = RHPLCS_CARGO.CODIGO_EMPRESA (+)
          AND RHPESS_CONTRATO.COD_CARGO_EFETIVO = RHPLCS_CARGO.CODIGO (+) AND RHPONT_RES_SIT_DIA.TIPO_APURACAO = 'F' 
          AND RHPONT_RES_SIT_DIA.CODIGO_SITUACAO IN ('1140')) FR
      GROUP BY FR.DISTANCE, FR.CODIGO_EMPRESA, FR.CODIGO_PLANO, FR.CODIGO_SITUACAO, FR.DESCRICAO_SITUACAO, FR.MATRICULA, FR.DIGITO, FR.NOME, FR.CPF, FR.PIS_PASEP,FR.CODIGO_CARGO, FR.DATA_ADMISSAO_POSSE, FR.SITUACAO_FUNCIONAL, FR.CID, FR.DT_ULT_ALTER_USUA) 
      UNION ALL ( 
      SELECT 
        TO_CHAR(MIN(FR.DATA), 'YYYYMM') AS ANO_MES_REFERENCIA, FR.CODIGO_PLANO,FR.SITUACAO_FUNCIONAL,FR.CODIGO_EMPRESA,
        FR.MATRICULA,FR.DIGITO,FR.NOME,FR.CPF,FR.PIS_PASEP,FR.CODIGO_CARGO,FR.DATA_ADMISSAO_POSSE, 
        TO_CHAR(MIN(FR.DATA), 'RRRRMMDD') AS DATA_INICIO, TO_CHAR(MAX(FR.DATA), 'YYYYMMDD') AS DATA_FIM, COUNT(FR.DATA) DIAS,FR.CID, FR.DT_ULT_ALTER_USUA
      FROM (
        SELECT 
          TO_DATE(TO_CHAR(RHPONT_RES_SIT_DIA.DATA, 'DD/MM/YYYY'), 'DD/MM/YYYY') AS DATA,
          RHPONT_RES_SIT_DIA.DATA - ROW_NUMBER() OVER(ORDER BY RHPESS_CONTRATO.COD_UNIDADE1, RHPESS_CONTRATO.COD_UNIDADE2, RHPESS_CONTRATO.COD_UNIDADE3, RHPESS_CONTRATO.COD_UNIDADE4, RHPESS_CONTRATO.COD_UNIDADE5, RHPESS_CONTRATO.COD_UNIDADE6, RHPESS_CONTRATO.CODIGO, RHPONT_RES_SIT_DIA.CODIGO_SITUACAO, RHPONT_RES_SIT_DIA.DATA) AS DISTANCE,
          RHPONT_RES_SIT_DIA.CODIGO_SITUACAO, TO_NUMBER(RHPESS_CONTRATO.CODIGO_EMPRESA) AS CODIGO_EMPRESA, RHPONT_SITUACAO.DESCRICAO DESCRICAO_SITUACAO,
          TO_NUMBER(SUBSTR(RHPESS_CONTRATO.CODIGO, 5, 10)) AS MATRICULA, 
          CASE WHEN SUBSTR(RHPESS_CONTRATO.CODIGO, 15, 1) = 'X' THEN 7 ELSE TO_NUMBER(SUBSTR(RHPESS_CONTRATO.CODIGO, 15, 1)) END AS DIGITO,
          SUBSTR(TRIM(RHPESS_CONTRATO.NOME), 1, 80) AS NOME, SUBSTR(TRIM(RHPESS_PESSOA.CPF), 1, 11) AS CPF, TO_NUMBER(NVL(TRIM(RHPESS_PESSOA.PIS_PASEP), 0)) AS PIS_PASEP,
          CASE WHEN RHPESS_CONTRATO.DATA_ADMISSAO <= TO_DATE('30/12/2011', 'DD/MM/YYYY') THEN 1 ELSE 2 END AS CODIGO_PLANO,
          TO_NUMBER(SUBSTR(TRIM(RHPESS_CONTRATO.COD_CARGO_EFETIVO), 12, 4)) AS CODIGO_CARGO,
          CASE
            WHEN RHPESS_CONTRATO.DATA_EFETIVO_EXERC IS NOT NULL THEN TO_CHAR(RHPESS_CONTRATO.DATA_EFETIVO_EXERC, 'YYYYMMDD')
            ELSE TO_CHAR(RHPESS_CONTRATO.DATA_ADMISSAO, 'YYYYMMDD')
          END AS DATA_ADMISSAO_POSSE, RHPONT_RES_SIT_DIA.CODIGO_SITUACAO AS SITUACAO_FUNCIONAL, NULL AS CID, RHPONT_RES_SIT_DIA.DT_ULT_ALTER_USUA
         FROM RHPONT_RES_SIT_DIA,RHPONT_SITUACAO,RHPESS_CONTRATO,RHPESS_PESSOA,RHORGA_UNIDADE,RHPARM_SIT_FUNC,RHPLCS_CARGO
        WHERE RHPONT_RES_SIT_DIA.DT_ULT_ALTER_USUA > ULTIMA_ALTERACAO
          AND RHPESS_CONTRATO.TIPO_CONTRATO = '0001' AND RHPESS_CONTRATO.CODIGO_EMPRESA = '0001' AND (RHPESS_CONTRATO.SITUACAO_FUNCIONAL <= '7000' OR RHPESS_CONTRATO.SITUACAO_FUNCIONAL IN ('8000','8001')) 
          AND RHPESS_CONTRATO.COD_CARGO_PAGTO NOT IN ('000000000002006','000000000002007')
          AND RHPESS_CONTRATO.ANO_MES_REFERENCIA = (
              SELECT MAX(ARTERH_CONTRATO.ANO_MES_REFERENCIA) 
                FROM RHPESS_CONTRATO ARTERH_CONTRATO
               WHERE RHPESS_CONTRATO.CODIGO_EMPRESA = ARTERH_CONTRATO.CODIGO_EMPRESA
                 AND RHPESS_CONTRATO.TIPO_CONTRATO = ARTERH_CONTRATO.TIPO_CONTRATO
                 AND RHPESS_CONTRATO.CODIGO = ARTERH_CONTRATO.CODIGO
                 AND ARTERH_CONTRATO.ANO_MES_REFERENCIA <= SYSDATE )
          AND RHPESS_CONTRATO.CODIGO_EMPRESA = RHPONT_RES_SIT_DIA.CODIGO_EMPRESA AND RHPESS_CONTRATO.TIPO_CONTRATO = RHPONT_RES_SIT_DIA.TIPO_CONTRATO AND RHPESS_CONTRATO.CODIGO = RHPONT_RES_SIT_DIA.CODIGO_CONTRATO 
          AND RHPONT_RES_SIT_DIA.CODIGO_SITUACAO = RHPONT_SITUACAO.CODIGO AND RHPESS_PESSOA.CODIGO_EMPRESA = RHPESS_CONTRATO.CODIGO_EMPRESA AND RHPESS_PESSOA.CODIGO = RHPESS_CONTRATO.CODIGO_PESSOA
          AND RHPESS_CONTRATO.COD_UNIDADE1 = RHORGA_UNIDADE.COD_UNIDADE1 AND RHPESS_CONTRATO.COD_UNIDADE2 = RHORGA_UNIDADE.COD_UNIDADE2 AND RHPESS_CONTRATO.COD_UNIDADE3 = RHORGA_UNIDADE.COD_UNIDADE3 
          AND RHPESS_CONTRATO.COD_UNIDADE4 = RHORGA_UNIDADE.COD_UNIDADE4 AND RHPESS_CONTRATO.COD_UNIDADE5 = RHORGA_UNIDADE.COD_UNIDADE5 AND RHPESS_CONTRATO.COD_UNIDADE6 = RHORGA_UNIDADE.COD_UNIDADE6 
          AND RHPESS_CONTRATO.CODIGO_EMPRESA = RHORGA_UNIDADE.CODIGO_EMPRESA AND RHPESS_CONTRATO.SITUACAO_FUNCIONAL = RHPARM_SIT_FUNC.CODIGO AND RHPESS_CONTRATO.CODIGO_EMPRESA = RHPLCS_CARGO.CODIGO_EMPRESA (+)
          AND RHPESS_CONTRATO.COD_CARGO_EFETIVO = RHPLCS_CARGO.CODIGO (+) AND RHPONT_RES_SIT_DIA.TIPO_APURACAO = 'F' 
          AND RHPONT_RES_SIT_DIA.CODIGO_SITUACAO IN ('1145')) FR
      GROUP BY FR.DISTANCE, FR.CODIGO_EMPRESA, FR.CODIGO_PLANO, FR.CODIGO_SITUACAO, FR.DESCRICAO_SITUACAO, FR.MATRICULA, FR.DIGITO, FR.NOME, FR.CPF, FR.PIS_PASEP,FR.CODIGO_CARGO, FR.DATA_ADMISSAO_POSSE, FR.SITUACAO_FUNCIONAL, FR.CID, FR.DT_ULT_ALTER_USUA) 
      UNION ALL ( 
      SELECT 
        TO_CHAR(MIN(FR.DATA), 'YYYYMM') AS ANO_MES_REFERENCIA, FR.CODIGO_PLANO,FR.SITUACAO_FUNCIONAL,FR.CODIGO_EMPRESA,
        FR.MATRICULA,FR.DIGITO,FR.NOME,FR.CPF,FR.PIS_PASEP,FR.CODIGO_CARGO,FR.DATA_ADMISSAO_POSSE, 
        TO_CHAR(MIN(FR.DATA), 'RRRRMMDD') AS DATA_INICIO, TO_CHAR(MAX(FR.DATA), 'YYYYMMDD') AS DATA_FIM, COUNT(FR.DATA) DIAS,FR.CID, FR.DT_ULT_ALTER_USUA
      FROM (
        SELECT 
          TO_DATE(TO_CHAR(RHPONT_RES_SIT_DIA.DATA, 'DD/MM/YYYY'), 'DD/MM/YYYY') AS DATA,
          RHPONT_RES_SIT_DIA.DATA - ROW_NUMBER() OVER(ORDER BY RHPESS_CONTRATO.COD_UNIDADE1, RHPESS_CONTRATO.COD_UNIDADE2, RHPESS_CONTRATO.COD_UNIDADE3, RHPESS_CONTRATO.COD_UNIDADE4, RHPESS_CONTRATO.COD_UNIDADE5, RHPESS_CONTRATO.COD_UNIDADE6, RHPESS_CONTRATO.CODIGO, RHPONT_RES_SIT_DIA.CODIGO_SITUACAO, RHPONT_RES_SIT_DIA.DATA) AS DISTANCE,
          RHPONT_RES_SIT_DIA.CODIGO_SITUACAO, TO_NUMBER(RHPESS_CONTRATO.CODIGO_EMPRESA) AS CODIGO_EMPRESA, RHPONT_SITUACAO.DESCRICAO DESCRICAO_SITUACAO,
          TO_NUMBER(SUBSTR(RHPESS_CONTRATO.CODIGO, 5, 10)) AS MATRICULA, 
          CASE WHEN SUBSTR(RHPESS_CONTRATO.CODIGO, 15, 1) = 'X' THEN 7 ELSE TO_NUMBER(SUBSTR(RHPESS_CONTRATO.CODIGO, 15, 1)) END AS DIGITO,
          SUBSTR(TRIM(RHPESS_CONTRATO.NOME), 1, 80) AS NOME, SUBSTR(TRIM(RHPESS_PESSOA.CPF), 1, 11) AS CPF, TO_NUMBER(NVL(TRIM(RHPESS_PESSOA.PIS_PASEP), 0)) AS PIS_PASEP,
          CASE WHEN RHPESS_CONTRATO.DATA_ADMISSAO <= TO_DATE('30/12/2011', 'DD/MM/YYYY') THEN 1 ELSE 2 END AS CODIGO_PLANO,
          TO_NUMBER(SUBSTR(TRIM(RHPESS_CONTRATO.COD_CARGO_EFETIVO), 12, 4)) AS CODIGO_CARGO,
          CASE
            WHEN RHPESS_CONTRATO.DATA_EFETIVO_EXERC IS NOT NULL THEN TO_CHAR(RHPESS_CONTRATO.DATA_EFETIVO_EXERC, 'YYYYMMDD')
            ELSE TO_CHAR(RHPESS_CONTRATO.DATA_ADMISSAO, 'YYYYMMDD')
          END AS DATA_ADMISSAO_POSSE, RHPONT_RES_SIT_DIA.CODIGO_SITUACAO AS SITUACAO_FUNCIONAL, NULL AS CID, RHPONT_RES_SIT_DIA.DT_ULT_ALTER_USUA
         FROM RHPONT_RES_SIT_DIA,RHPONT_SITUACAO,RHPESS_CONTRATO,RHPESS_PESSOA,RHORGA_UNIDADE,RHPARM_SIT_FUNC,RHPLCS_CARGO
        WHERE RHPONT_RES_SIT_DIA.DT_ULT_ALTER_USUA > ULTIMA_ALTERACAO
          AND RHPESS_CONTRATO.TIPO_CONTRATO = '0001' AND RHPESS_CONTRATO.CODIGO_EMPRESA = '0001' AND (RHPESS_CONTRATO.SITUACAO_FUNCIONAL <= '7000' OR RHPESS_CONTRATO.SITUACAO_FUNCIONAL IN ('8000','8001')) 
          AND RHPESS_CONTRATO.COD_CARGO_PAGTO NOT IN ('000000000002006','000000000002007')
          AND RHPESS_CONTRATO.ANO_MES_REFERENCIA = (
              SELECT MAX(ARTERH_CONTRATO.ANO_MES_REFERENCIA) 
                FROM RHPESS_CONTRATO ARTERH_CONTRATO
               WHERE RHPESS_CONTRATO.CODIGO_EMPRESA = ARTERH_CONTRATO.CODIGO_EMPRESA
                 AND RHPESS_CONTRATO.TIPO_CONTRATO = ARTERH_CONTRATO.TIPO_CONTRATO
                 AND RHPESS_CONTRATO.CODIGO = ARTERH_CONTRATO.CODIGO
                 AND ARTERH_CONTRATO.ANO_MES_REFERENCIA <= SYSDATE )
          AND RHPESS_CONTRATO.CODIGO_EMPRESA = RHPONT_RES_SIT_DIA.CODIGO_EMPRESA AND RHPESS_CONTRATO.TIPO_CONTRATO = RHPONT_RES_SIT_DIA.TIPO_CONTRATO AND RHPESS_CONTRATO.CODIGO = RHPONT_RES_SIT_DIA.CODIGO_CONTRATO 
          AND RHPONT_RES_SIT_DIA.CODIGO_SITUACAO = RHPONT_SITUACAO.CODIGO AND RHPESS_PESSOA.CODIGO_EMPRESA = RHPESS_CONTRATO.CODIGO_EMPRESA AND RHPESS_PESSOA.CODIGO = RHPESS_CONTRATO.CODIGO_PESSOA
          AND RHPESS_CONTRATO.COD_UNIDADE1 = RHORGA_UNIDADE.COD_UNIDADE1 AND RHPESS_CONTRATO.COD_UNIDADE2 = RHORGA_UNIDADE.COD_UNIDADE2 AND RHPESS_CONTRATO.COD_UNIDADE3 = RHORGA_UNIDADE.COD_UNIDADE3 
          AND RHPESS_CONTRATO.COD_UNIDADE4 = RHORGA_UNIDADE.COD_UNIDADE4 AND RHPESS_CONTRATO.COD_UNIDADE5 = RHORGA_UNIDADE.COD_UNIDADE5 AND RHPESS_CONTRATO.COD_UNIDADE6 = RHORGA_UNIDADE.COD_UNIDADE6 
          AND RHPESS_CONTRATO.CODIGO_EMPRESA = RHORGA_UNIDADE.CODIGO_EMPRESA AND RHPESS_CONTRATO.SITUACAO_FUNCIONAL = RHPARM_SIT_FUNC.CODIGO AND RHPESS_CONTRATO.CODIGO_EMPRESA = RHPLCS_CARGO.CODIGO_EMPRESA (+)
          AND RHPESS_CONTRATO.COD_CARGO_EFETIVO = RHPLCS_CARGO.CODIGO (+) AND RHPONT_RES_SIT_DIA.TIPO_APURACAO = 'F' 
          AND RHPONT_RES_SIT_DIA.CODIGO_SITUACAO IN ('1148')) FR
      GROUP BY FR.DISTANCE, FR.CODIGO_EMPRESA, FR.CODIGO_PLANO, FR.CODIGO_SITUACAO, FR.DESCRICAO_SITUACAO, FR.MATRICULA, FR.DIGITO, FR.NOME, FR.CPF, FR.PIS_PASEP,FR.CODIGO_CARGO, FR.DATA_ADMISSAO_POSSE, FR.SITUACAO_FUNCIONAL, FR.CID, FR.DT_ULT_ALTER_USUA) 
      UNION ALL ( 
      SELECT 
        TO_CHAR(MIN(FR.DATA), 'YYYYMM') AS ANO_MES_REFERENCIA, FR.CODIGO_PLANO,FR.SITUACAO_FUNCIONAL,FR.CODIGO_EMPRESA,
        FR.MATRICULA,FR.DIGITO,FR.NOME,FR.CPF,FR.PIS_PASEP,FR.CODIGO_CARGO,FR.DATA_ADMISSAO_POSSE, 
        TO_CHAR(MIN(FR.DATA), 'RRRRMMDD') AS DATA_INICIO, TO_CHAR(MAX(FR.DATA), 'YYYYMMDD') AS DATA_FIM, COUNT(FR.DATA) DIAS,FR.CID, FR.DT_ULT_ALTER_USUA
      FROM (
        SELECT 
          TO_DATE(TO_CHAR(RHPONT_RES_SIT_DIA.DATA, 'DD/MM/YYYY'), 'DD/MM/YYYY') AS DATA,
          RHPONT_RES_SIT_DIA.DATA - ROW_NUMBER() OVER(ORDER BY RHPESS_CONTRATO.COD_UNIDADE1, RHPESS_CONTRATO.COD_UNIDADE2, RHPESS_CONTRATO.COD_UNIDADE3, RHPESS_CONTRATO.COD_UNIDADE4, RHPESS_CONTRATO.COD_UNIDADE5, RHPESS_CONTRATO.COD_UNIDADE6, RHPESS_CONTRATO.CODIGO, RHPONT_RES_SIT_DIA.CODIGO_SITUACAO, RHPONT_RES_SIT_DIA.DATA) AS DISTANCE,
          RHPONT_RES_SIT_DIA.CODIGO_SITUACAO, TO_NUMBER(RHPESS_CONTRATO.CODIGO_EMPRESA) AS CODIGO_EMPRESA, RHPONT_SITUACAO.DESCRICAO DESCRICAO_SITUACAO,
          TO_NUMBER(SUBSTR(RHPESS_CONTRATO.CODIGO, 5, 10)) AS MATRICULA, 
          CASE WHEN SUBSTR(RHPESS_CONTRATO.CODIGO, 15, 1) = 'X' THEN 7 ELSE TO_NUMBER(SUBSTR(RHPESS_CONTRATO.CODIGO, 15, 1)) END AS DIGITO,
          SUBSTR(TRIM(RHPESS_CONTRATO.NOME), 1, 80) AS NOME, SUBSTR(TRIM(RHPESS_PESSOA.CPF), 1, 11) AS CPF, TO_NUMBER(NVL(TRIM(RHPESS_PESSOA.PIS_PASEP), 0)) AS PIS_PASEP,
          CASE WHEN RHPESS_CONTRATO.DATA_ADMISSAO <= TO_DATE('30/12/2011', 'DD/MM/YYYY') THEN 1 ELSE 2 END AS CODIGO_PLANO,
          TO_NUMBER(SUBSTR(TRIM(RHPESS_CONTRATO.COD_CARGO_EFETIVO), 12, 4)) AS CODIGO_CARGO,
          CASE
            WHEN RHPESS_CONTRATO.DATA_EFETIVO_EXERC IS NOT NULL THEN TO_CHAR(RHPESS_CONTRATO.DATA_EFETIVO_EXERC, 'YYYYMMDD')
            ELSE TO_CHAR(RHPESS_CONTRATO.DATA_ADMISSAO, 'YYYYMMDD')
          END AS DATA_ADMISSAO_POSSE, RHPONT_RES_SIT_DIA.CODIGO_SITUACAO AS SITUACAO_FUNCIONAL, NULL AS CID, RHPONT_RES_SIT_DIA.DT_ULT_ALTER_USUA
         FROM RHPONT_RES_SIT_DIA,RHPONT_SITUACAO,RHPESS_CONTRATO,RHPESS_PESSOA,RHORGA_UNIDADE,RHPARM_SIT_FUNC,RHPLCS_CARGO
        WHERE RHPONT_RES_SIT_DIA.DT_ULT_ALTER_USUA > ULTIMA_ALTERACAO
          AND RHPESS_CONTRATO.TIPO_CONTRATO = '0001' AND RHPESS_CONTRATO.CODIGO_EMPRESA = '0001' AND (RHPESS_CONTRATO.SITUACAO_FUNCIONAL <= '7000' OR RHPESS_CONTRATO.SITUACAO_FUNCIONAL IN ('8000','8001')) 
          AND RHPESS_CONTRATO.COD_CARGO_PAGTO NOT IN ('000000000002006','000000000002007')
          AND RHPESS_CONTRATO.ANO_MES_REFERENCIA = (
              SELECT MAX(ARTERH_CONTRATO.ANO_MES_REFERENCIA) 
                FROM RHPESS_CONTRATO ARTERH_CONTRATO
               WHERE RHPESS_CONTRATO.CODIGO_EMPRESA = ARTERH_CONTRATO.CODIGO_EMPRESA
                 AND RHPESS_CONTRATO.TIPO_CONTRATO = ARTERH_CONTRATO.TIPO_CONTRATO
                 AND RHPESS_CONTRATO.CODIGO = ARTERH_CONTRATO.CODIGO
                 AND ARTERH_CONTRATO.ANO_MES_REFERENCIA <= SYSDATE )
          AND RHPESS_CONTRATO.CODIGO_EMPRESA = RHPONT_RES_SIT_DIA.CODIGO_EMPRESA AND RHPESS_CONTRATO.TIPO_CONTRATO = RHPONT_RES_SIT_DIA.TIPO_CONTRATO AND RHPESS_CONTRATO.CODIGO = RHPONT_RES_SIT_DIA.CODIGO_CONTRATO 
          AND RHPONT_RES_SIT_DIA.CODIGO_SITUACAO = RHPONT_SITUACAO.CODIGO AND RHPESS_PESSOA.CODIGO_EMPRESA = RHPESS_CONTRATO.CODIGO_EMPRESA AND RHPESS_PESSOA.CODIGO = RHPESS_CONTRATO.CODIGO_PESSOA
          AND RHPESS_CONTRATO.COD_UNIDADE1 = RHORGA_UNIDADE.COD_UNIDADE1 AND RHPESS_CONTRATO.COD_UNIDADE2 = RHORGA_UNIDADE.COD_UNIDADE2 AND RHPESS_CONTRATO.COD_UNIDADE3 = RHORGA_UNIDADE.COD_UNIDADE3 
          AND RHPESS_CONTRATO.COD_UNIDADE4 = RHORGA_UNIDADE.COD_UNIDADE4 AND RHPESS_CONTRATO.COD_UNIDADE5 = RHORGA_UNIDADE.COD_UNIDADE5 AND RHPESS_CONTRATO.COD_UNIDADE6 = RHORGA_UNIDADE.COD_UNIDADE6 
          AND RHPESS_CONTRATO.CODIGO_EMPRESA = RHORGA_UNIDADE.CODIGO_EMPRESA AND RHPESS_CONTRATO.SITUACAO_FUNCIONAL = RHPARM_SIT_FUNC.CODIGO AND RHPESS_CONTRATO.CODIGO_EMPRESA = RHPLCS_CARGO.CODIGO_EMPRESA (+)
          AND RHPESS_CONTRATO.COD_CARGO_EFETIVO = RHPLCS_CARGO.CODIGO (+) AND RHPONT_RES_SIT_DIA.TIPO_APURACAO = 'F' 
          AND RHPONT_RES_SIT_DIA.CODIGO_SITUACAO IN ('1149')) FR
      GROUP BY FR.DISTANCE, FR.CODIGO_EMPRESA, FR.CODIGO_PLANO, FR.CODIGO_SITUACAO, FR.DESCRICAO_SITUACAO, FR.MATRICULA, FR.DIGITO, FR.NOME, FR.CPF, FR.PIS_PASEP,FR.CODIGO_CARGO, FR.DATA_ADMISSAO_POSSE, FR.SITUACAO_FUNCIONAL, FR.CID, FR.DT_ULT_ALTER_USUA)
      UNION ALL ( 
      SELECT 
        TO_CHAR(MIN(FR.DATA), 'YYYYMM') AS ANO_MES_REFERENCIA, FR.CODIGO_PLANO,FR.SITUACAO_FUNCIONAL,FR.CODIGO_EMPRESA,
        FR.MATRICULA,FR.DIGITO,FR.NOME,FR.CPF,FR.PIS_PASEP,FR.CODIGO_CARGO,FR.DATA_ADMISSAO_POSSE, 
        TO_CHAR(MIN(FR.DATA), 'RRRRMMDD') AS DATA_INICIO, TO_CHAR(MAX(FR.DATA), 'YYYYMMDD') AS DATA_FIM, COUNT(FR.DATA) DIAS,FR.CID, FR.DT_ULT_ALTER_USUA
      FROM (
        SELECT 
          TO_DATE(TO_CHAR(RHPONT_RES_SIT_DIA.DATA, 'DD/MM/YYYY'), 'DD/MM/YYYY') AS DATA,
          RHPONT_RES_SIT_DIA.DATA - ROW_NUMBER() OVER(ORDER BY RHPESS_CONTRATO.COD_UNIDADE1, RHPESS_CONTRATO.COD_UNIDADE2, RHPESS_CONTRATO.COD_UNIDADE3, RHPESS_CONTRATO.COD_UNIDADE4, RHPESS_CONTRATO.COD_UNIDADE5, RHPESS_CONTRATO.COD_UNIDADE6, RHPESS_CONTRATO.CODIGO, RHPONT_RES_SIT_DIA.CODIGO_SITUACAO, RHPONT_RES_SIT_DIA.DATA) AS DISTANCE,
          RHPONT_RES_SIT_DIA.CODIGO_SITUACAO, TO_NUMBER(RHPESS_CONTRATO.CODIGO_EMPRESA) AS CODIGO_EMPRESA, RHPONT_SITUACAO.DESCRICAO DESCRICAO_SITUACAO,
          TO_NUMBER(SUBSTR(RHPESS_CONTRATO.CODIGO, 5, 10)) AS MATRICULA, 
          CASE WHEN SUBSTR(RHPESS_CONTRATO.CODIGO, 15, 1) = 'X' THEN 7 ELSE TO_NUMBER(SUBSTR(RHPESS_CONTRATO.CODIGO, 15, 1)) END AS DIGITO,
          SUBSTR(TRIM(RHPESS_CONTRATO.NOME), 1, 80) AS NOME, SUBSTR(TRIM(RHPESS_PESSOA.CPF), 1, 11) AS CPF, TO_NUMBER(NVL(TRIM(RHPESS_PESSOA.PIS_PASEP), 0)) AS PIS_PASEP,
          CASE WHEN RHPESS_CONTRATO.DATA_ADMISSAO <= TO_DATE('30/12/2011', 'DD/MM/YYYY') THEN 1 ELSE 2 END AS CODIGO_PLANO,
          TO_NUMBER(SUBSTR(TRIM(RHPESS_CONTRATO.COD_CARGO_EFETIVO), 12, 4)) AS CODIGO_CARGO,
          CASE
            WHEN RHPESS_CONTRATO.DATA_EFETIVO_EXERC IS NOT NULL THEN TO_CHAR(RHPESS_CONTRATO.DATA_EFETIVO_EXERC, 'YYYYMMDD')
            ELSE TO_CHAR(RHPESS_CONTRATO.DATA_ADMISSAO, 'YYYYMMDD')
          END AS DATA_ADMISSAO_POSSE, RHPONT_RES_SIT_DIA.CODIGO_SITUACAO AS SITUACAO_FUNCIONAL, NULL AS CID, RHPONT_RES_SIT_DIA.DT_ULT_ALTER_USUA
         FROM RHPONT_RES_SIT_DIA,RHPONT_SITUACAO,RHPESS_CONTRATO,RHPESS_PESSOA,RHORGA_UNIDADE,RHPARM_SIT_FUNC,RHPLCS_CARGO
        WHERE RHPONT_RES_SIT_DIA.DT_ULT_ALTER_USUA > ULTIMA_ALTERACAO
          AND RHPESS_CONTRATO.TIPO_CONTRATO = '0001' AND RHPESS_CONTRATO.CODIGO_EMPRESA = '0001' AND (RHPESS_CONTRATO.SITUACAO_FUNCIONAL <= '7000' OR RHPESS_CONTRATO.SITUACAO_FUNCIONAL IN ('8000','8001')) 
          AND RHPESS_CONTRATO.COD_CARGO_PAGTO NOT IN ('000000000002006','000000000002007')
          AND RHPESS_CONTRATO.ANO_MES_REFERENCIA = (
              SELECT MAX(ARTERH_CONTRATO.ANO_MES_REFERENCIA) 
                FROM RHPESS_CONTRATO ARTERH_CONTRATO
               WHERE RHPESS_CONTRATO.CODIGO_EMPRESA = ARTERH_CONTRATO.CODIGO_EMPRESA
                 AND RHPESS_CONTRATO.TIPO_CONTRATO = ARTERH_CONTRATO.TIPO_CONTRATO
                 AND RHPESS_CONTRATO.CODIGO = ARTERH_CONTRATO.CODIGO
                 AND ARTERH_CONTRATO.ANO_MES_REFERENCIA <= SYSDATE )
          AND RHPESS_CONTRATO.CODIGO_EMPRESA = RHPONT_RES_SIT_DIA.CODIGO_EMPRESA AND RHPESS_CONTRATO.TIPO_CONTRATO = RHPONT_RES_SIT_DIA.TIPO_CONTRATO AND RHPESS_CONTRATO.CODIGO = RHPONT_RES_SIT_DIA.CODIGO_CONTRATO 
          AND RHPONT_RES_SIT_DIA.CODIGO_SITUACAO = RHPONT_SITUACAO.CODIGO AND RHPESS_PESSOA.CODIGO_EMPRESA = RHPESS_CONTRATO.CODIGO_EMPRESA AND RHPESS_PESSOA.CODIGO = RHPESS_CONTRATO.CODIGO_PESSOA
          AND RHPESS_CONTRATO.COD_UNIDADE1 = RHORGA_UNIDADE.COD_UNIDADE1 AND RHPESS_CONTRATO.COD_UNIDADE2 = RHORGA_UNIDADE.COD_UNIDADE2 AND RHPESS_CONTRATO.COD_UNIDADE3 = RHORGA_UNIDADE.COD_UNIDADE3 
          AND RHPESS_CONTRATO.COD_UNIDADE4 = RHORGA_UNIDADE.COD_UNIDADE4 AND RHPESS_CONTRATO.COD_UNIDADE5 = RHORGA_UNIDADE.COD_UNIDADE5 AND RHPESS_CONTRATO.COD_UNIDADE6 = RHORGA_UNIDADE.COD_UNIDADE6 
          AND RHPESS_CONTRATO.CODIGO_EMPRESA = RHORGA_UNIDADE.CODIGO_EMPRESA AND RHPESS_CONTRATO.SITUACAO_FUNCIONAL = RHPARM_SIT_FUNC.CODIGO AND RHPESS_CONTRATO.CODIGO_EMPRESA = RHPLCS_CARGO.CODIGO_EMPRESA (+)
          AND RHPESS_CONTRATO.COD_CARGO_EFETIVO = RHPLCS_CARGO.CODIGO (+) AND RHPONT_RES_SIT_DIA.TIPO_APURACAO = 'F' 
          AND RHPONT_RES_SIT_DIA.CODIGO_SITUACAO IN ('1168')) FR
      GROUP BY FR.DISTANCE, FR.CODIGO_EMPRESA, FR.CODIGO_PLANO, FR.CODIGO_SITUACAO, FR.DESCRICAO_SITUACAO, FR.MATRICULA, FR.DIGITO, FR.NOME, FR.CPF, FR.PIS_PASEP,FR.CODIGO_CARGO, FR.DATA_ADMISSAO_POSSE, FR.SITUACAO_FUNCIONAL, FR.CID, FR.DT_ULT_ALTER_USUA)
    );
    
    REGISTROS_AFETADOS := SQL%ROWCOUNT;
    HORA_FIM := SYSDATE;
    TEMPO_TOTAL := TRUNC(24 * (HORA_FIM - HORA_INICIO) * 3660);
    PR_GRAVA_LOG_SIT_FUNC(REGISTROS_AFETADOS, TO_CHAR(HORA_INICIO, 'HH24:MI:SS'), TO_CHAR(HORA_FIM, 'HH24:MI:SS'), TEMPO_TOTAL, 'SUCESSO');   

    EXCEPTION  
      WHEN OTHERS THEN 
        ROLLBACK;
        PR_GRAVA_LOG_SIT_FUNC(REGISTROS_AFETADOS, TO_CHAR(HORA_INICIO, 'HH24:MI:SS'), TO_CHAR(HORA_FIM, 'HH24:MI:SS'), TEMPO_TOTAL, SQLERRM);  
END PR_UPDATE_SIT_FUNC;