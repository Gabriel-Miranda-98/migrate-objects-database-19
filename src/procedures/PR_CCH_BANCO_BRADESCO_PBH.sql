
  CREATE OR REPLACE EDITIONABLE PROCEDURE "ARTERH"."PR_CCH_BANCO_BRADESCO_PBH" 
(EMPRESA IN VARCHAR2, TIPO_CONTRATO IN VARCHAR2, OPERACAO IN VARCHAR2 , MES_ANO IN VARCHAR2, GRUPO_USUARIO IN VARCHAR2, RELATORIO IN VARCHAR2, TEXTO1 IN VARCHAR2, TEXTO2 IN VARCHAR2, TEXTO3 IN VARCHAR2, DATA1 IN DATE , INTEIRO1 IN NUMBER )
AS
BEGIN

DECLARE 
VCONTADOR NUMBER (10);

VGLB_EMPRESA VARCHAR2 (4);
VGLB_TIPO_CONTRATO VARCHAR2 (4);
VGLB_MODO_OPERACAO VARCHAR2 (2);
VGLB_MES_ANO_SISTEMA  DATE;
VGLB_GRUPO_USUARIO VARCHAR (4);
VGLB_RELATORIO VARCHAR2 (4);
VTEXTO_1 VARCHAR2(60);
VTEXTO_2 VARCHAR2(60);
VTEXTO_3 VARCHAR2(60);
VDATA_1 DATE;
VINTEIRO_1 NUMBER;


BEGIN 
DBMS_OUTPUT.ENABLE(NULL);
VCONTADOR :=0;

VGLB_EMPRESA := EMPRESA; 
VGLB_TIPO_CONTRATO := TIPO_CONTRATO;
VGLB_MODO_OPERACAO := OPERACAO;
VGLB_MES_ANO_SISTEMA := MES_ANO;
VGLB_GRUPO_USUARIO := GRUPO_USUARIO;
VGLB_RELATORIO := RELATORIO;
VTEXTO_1 := TEXTO1;
VTEXTO_2 := TEXTO2;
VTEXTO_3 := TEXTO3;
VDATA_1 := DATA1;
VINTEIRO_1 := INTEIRO1;

DBMS_OUTPUT.PUT_LINE('CODIGO, INICIO_LINHA, AGENCIA, CONTA, NOME, CPF, AGENCIA_EMPRESA, CONTA_EMPRESA, CONTRATO_EMPRESA, SEQUENCIAL, MES_REF,DATA_CREDITO,LINHA1,LINHA2,LINHA3,LINHA4,LINHA5,LINHA6,LINHA7,LINHA8,LINHA9,LINHA10,LINHA11,NUM_LINHAS_INICIO,LINHA_MOV');

FOR C1 IN (

--INICIO----------------------------------------------- SQL DO RELATORIO
SELECT RHPESS_CONTRATO.CODIGO,
		 LPAD(TRIM(RHPESS_PESSOA.CPF)||LTRIM(SUBSTR(RHPESS_CONTRATO.CODIGO,1,14),'0'),20,'0') INICIO_LINHA,
		 LPAD(SUBSTR(RHPESS_CONTRATO.CODIGO_BANCO_CC,11,4),4,'0') AGENCIA,
		 LPAD(SUBSTR(RHPESS_CONTRATO.CONTA_CORRENTE,4,11),11,'0') CONTA,
		 RPAD(UPPER(TRIM(RHPESS_CONTRATO.NOME)),40,' ') NOME,
		 RPAD(LPAD(RHPESS_PESSOA.CPF,11,'0'),20,' ') CPF,
		 SUBSTR(VTEXTO_3,1,INSTR(VTEXTO_3,'/',1,1)-1) AGENCIA_EMPRESA,
		 SUBSTR(VTEXTO_3,INSTR(VTEXTO_3,'/',1,1)+1,INSTR(VTEXTO_3,'/',1,2)-INSTR(VTEXTO_3,'/',1,1)-1) CONTA_EMPRESA,
		 SUBSTR(VTEXTO_3,INSTR(VTEXTO_3,'/',1,2)+1) CONTRATO_EMPRESA,
		 LPAD(VTEXTO_2,6,'0') SEQUENCIAL,
		 TO_CHAR(VGLB_MES_ANO_SISTEMA,'YYYYMM') MES_REF,
		 TO_CHAR(VDATA_1,'DDMMYYYY') DATA_CREDITO,
 		 LPAD(TRIM(RHPESS_PESSOA.CPF)||LTRIM(SUBSTR(RHPESS_CONTRATO.CODIGO,1,14),'0'),20,'0')||'012'||RPAD('PREFEITURA MUNICIPAL DE BELO HORIZONTE',48,' ')||RPAD('0',29,' ') LINHA1,
		 LPAD(TRIM(RHPESS_PESSOA.CPF)||LTRIM(SUBSTR(RHPESS_CONTRATO.CODIGO,1,14),'0'),20,'0')||'022'||RPAD('CNPJ',14,' ')||'-     '||RPAD('18.715.383/0001-40',28,' ')||RPAD('0',29,' ') LINHA2,--DIFERE
		 LPAD(TRIM(RHPESS_PESSOA.CPF)||LTRIM(SUBSTR(RHPESS_CONTRATO.CODIGO,1,14),'0'),20,'0')||'032'||RPAD(UPPER(TRIM(RHPESS_CONTRATO.NOME)),40,' ')||LPAD(' ',8)||RPAD('0',29,' ') LINHA3,
		 LPAD(TRIM(RHPESS_PESSOA.CPF)||LTRIM(SUBSTR(RHPESS_CONTRATO.CODIGO,1,14),'0'),20,'0')||'042'||RPAD('CPF',14,' ')||'-     '||RPAD(REGEXP_REPLACE(LPAD(RHPESS_PESSOA.CPF,11,'0'),'([0-9]{3})([0-9]{3})([0-9]{3})([0-9]{2})','\1.\2.\3-\4'),28,' ')||RPAD('0',29,' ') LINHA4,
		 LPAD(TRIM(RHPESS_PESSOA.CPF)||LTRIM(SUBSTR(RHPESS_CONTRATO.CODIGO,1,14),'0'),20,'0')||'052'||RPAD('BM',14,' ')||'-     '||RPAD(SUBSTR(LTRIM(RHPESS_CONTRATO.CODIGO,'0'),0,LENGTH(LTRIM(RHPESS_CONTRATO.CODIGO,'0'))-1)||'-'||SUBSTR(LTRIM(RHPESS_CONTRATO.CODIGO,'0'),-1),28,' ')||RPAD('0',29,' ') LINHA5,
		 LPAD(TRIM(RHPESS_PESSOA.CPF)||LTRIM(SUBSTR(RHPESS_CONTRATO.CODIGO,1,14),'0'),20,'0')||'062'||RPAD('DATA DE ADMISSAO',18,' ')||'- '||RPAD(TO_CHAR(RHPESS_CONTRATO.DATA_ADMISSAO,'DD/MM/YYYY'),28,' ')||RPAD('0',29,' ') LINHA6,
		 LPAD(TRIM(RHPESS_PESSOA.CPF)||LTRIM(SUBSTR(RHPESS_CONTRATO.CODIGO,1,14),'0'),20,'0')||'072'||'C. PAG. '||RPAD(UPPER(TRIM(CARGO_PAGAMENTO.DESCRICAO)),32,' ')||LPAD(' ',8)||RPAD('0',29,' ') LINHA7,

		 CASE WHEN RHPESS_CONTRATO.CODIGO_EMPRESA = '0098'
				THEN LPAD(TRIM(RHPESS_PESSOA.CPF)||LTRIM(SUBSTR(RHPESS_CONTRATO.CODIGO,1,14),'0'),20,'0')||'082'||RPAD('REF. PAGAMENTO',18,' ')||'- '||RPAD(REPLACE(TO_CHAR(VGLB_MES_ANO_SISTEMA,'MONTH/YYYY','NLS_DATE_LANGUAGE= ''BRAZILIAN PORTUGUESE'''),' ',''),28,' ')||RPAD('1',29,' ')
				WHEN NVL(RHPESS_CONTRATO.COD_CARGO_COMISS,'000000000000000') <> '000000000000000' AND
					  NVL(RHPESS_CONTRATO.COD_CARGO_EFETIVO,'000000000000000') <> '000000000000000'
				THEN LPAD(TRIM(RHPESS_PESSOA.CPF)||LTRIM(SUBSTR(RHPESS_CONTRATO.CODIGO,1,14),'0'),20,'0')||'082'||'C. COM. '||RPAD(UPPER(TRIM(CARGO_COMISSIONADO.DESCRICAO)),32,' ')||LPAD(' ',8)||RPAD('0',29,' ')	  
				WHEN NVL(RHPESS_CONTRATO.COD_CARGO_COMISS,'000000000000000') <> '000000000000000'
				THEN LPAD(TRIM(RHPESS_PESSOA.CPF)||LTRIM(SUBSTR(RHPESS_CONTRATO.CODIGO,1,14),'0'),20,'0')||'082'||'C. COM. '||RPAD(UPPER(TRIM(CARGO_COMISSIONADO.DESCRICAO)),32,' ')||LPAD(' ',8)||RPAD('0',29,' ')
				ELSE LPAD(TRIM(RHPESS_PESSOA.CPF)||LTRIM(SUBSTR(RHPESS_CONTRATO.CODIGO,1,14),'0'),20,'0')||'082'||'C. EFE. '||RPAD(UPPER(TRIM(CARGO_EFETIVO.DESCRICAO)),32,' ')||LPAD(' ',8)||RPAD('0',29,' ')
		 END LINHA8,
		 CASE WHEN RHPESS_CONTRATO.CODIGO_EMPRESA = '0098'
				THEN ''
				WHEN NVL(RHPESS_CONTRATO.COD_CARGO_COMISS,'000000000000000') <> '000000000000000' AND
					  NVL(RHPESS_CONTRATO.COD_CARGO_EFETIVO,'000000000000000') <> '000000000000000'
				THEN LPAD(TRIM(RHPESS_PESSOA.CPF)||LTRIM(SUBSTR(RHPESS_CONTRATO.CODIGO,1,14),'0'),20,'0')||'092'||'C. EFE. '||RPAD(UPPER(TRIM(CARGO_EFETIVO.DESCRICAO)),32,' ')||LPAD(' ',8)||RPAD('0',29,' ')
				WHEN NVL(RHPESS_CONTRATO.COD_CARGO_COMISS,'000000000000000') <> '000000000000000'
				THEN LPAD(TRIM(RHPESS_PESSOA.CPF)||LTRIM(SUBSTR(RHPESS_CONTRATO.CODIGO,1,14),'0'),20,'0')||'092'||RPAD('REF. PAGAMENTO',18,' ')||'- '||RPAD(REPLACE(TO_CHAR(VGLB_MES_ANO_SISTEMA,'MONTH/YYYY','NLS_DATE_LANGUAGE= ''BRAZILIAN PORTUGUESE'''),' ',''),28,' ')||RPAD('1',29,' ')
				ELSE LPAD(TRIM(RHPESS_PESSOA.CPF)||LTRIM(SUBSTR(RHPESS_CONTRATO.CODIGO,1,14),'0'),20,'0')||'092'||RPAD('NIVEL CARGO EFETIVO',19,' ')||' - '||RPAD(NVL(LTRIM(RHPESS_CONTRATO.NIVEL_CARGO_EFETIV,'0'),0),26,' ')||RPAD('0',29,' ')
		 END LINHA9,
		 CASE WHEN RHPESS_CONTRATO.CODIGO_EMPRESA = '0098'
				THEN ''
				WHEN NVL(RHPESS_CONTRATO.COD_CARGO_COMISS,'000000000000000') <> '000000000000000' AND
					  NVL(RHPESS_CONTRATO.COD_CARGO_EFETIVO,'000000000000000') <> '000000000000000'
				THEN LPAD(TRIM(RHPESS_PESSOA.CPF)||LTRIM(SUBSTR(RHPESS_CONTRATO.CODIGO,1,14),'0'),20,'0')||'102'||RPAD('NIVEL CARGO EFETIVO',19,' ')||' - '||RPAD(NVL(LTRIM(RHPESS_CONTRATO.NIVEL_CARGO_EFETIV,'0'),0),26,' ')||RPAD('0',29,' ')
				WHEN NVL(RHPESS_CONTRATO.COD_CARGO_COMISS,'000000000000000') <> '000000000000000'
				THEN ''
				ELSE LPAD(TRIM(RHPESS_PESSOA.CPF)||LTRIM(SUBSTR(RHPESS_CONTRATO.CODIGO,1,14),'0'),20,'0')||'102'||RPAD('REF. PAGAMENTO',18,' ')||'- '||RPAD(REPLACE(TO_CHAR(VGLB_MES_ANO_SISTEMA,'MONTH/YYYY','NLS_DATE_LANGUAGE= ''BRAZILIAN PORTUGUESE'''),' ',''),28,' ')||RPAD('1',29,' ')
		 END LINHA10,
		 CASE WHEN RHPESS_CONTRATO.CODIGO_EMPRESA = '0098'
				THEN ''
				WHEN NVL(RHPESS_CONTRATO.COD_CARGO_COMISS,'000000000000000') <> '000000000000000' AND
					  NVL(RHPESS_CONTRATO.COD_CARGO_EFETIVO,'000000000000000') <> '000000000000000'
				THEN LPAD(TRIM(RHPESS_PESSOA.CPF)||LTRIM(SUBSTR(RHPESS_CONTRATO.CODIGO,1,14),'0'),20,'0')||'112'||RPAD('REF. PAGAMENTO',18,' ')||'- '||RPAD(REPLACE(TO_CHAR(VGLB_MES_ANO_SISTEMA,'MONTH/YYYY','NLS_DATE_LANGUAGE= ''BRAZILIAN PORTUGUESE'''),' ',''),28,' ')||RPAD('1',29,' ')
				ELSE ''
		 END LINHA11,
		 CASE WHEN RHPESS_CONTRATO.CODIGO_EMPRESA = '0098' THEN 8
				WHEN NVL(RHPESS_CONTRATO.COD_CARGO_COMISS,'000000000000000') <> '000000000000000' AND
					  NVL(RHPESS_CONTRATO.COD_CARGO_EFETIVO,'000000000000000') <> '000000000000000'
				THEN 11
				WHEN NVL(RHPESS_CONTRATO.COD_CARGO_COMISS,'000000000000000') <> '000000000000000'
				THEN 9
				ELSE 10
		 END NUM_LINHAS_INICIO,
		 CASE WHEN SUBSTR(MOV.CODIGO_VERBA,1,4) <> 'ZZZZ' AND MOV.DESCRICAO IS NOT NULL THEN
		 LPAD(TRIM(RHPESS_PESSOA.CPF)||LTRIM(SUBSTR(RHPESS_CONTRATO.CODIGO,1,14),'0'),20,'0')||LPAD(TO_CHAR(CASE WHEN RHPESS_CONTRATO.CODIGO_EMPRESA = '0098' THEN 8
						WHEN NVL(RHPESS_CONTRATO.COD_CARGO_COMISS,'000000000000000') <> '000000000000000' AND
							  NVL(RHPESS_CONTRATO.COD_CARGO_EFETIVO,'000000000000000') <> '000000000000000'
						THEN 11
						WHEN NVL(RHPESS_CONTRATO.COD_CARGO_COMISS,'000000000000000') <> '000000000000000'
						THEN 9
						ELSE 10
				 END+
		 ROW_NUMBER() OVER (PARTITION BY MOV.CODIGO_EMPRESA, MOV.CODIGO_CONTRATO ORDER BY MOV.CODIGO_EMPRESA, MOV.CODIGO_CONTRATO, MOV.CODIGO_VERBA)),2,'0')||'2'||
		 CASE WHEN SUBSTR(MOV.CODIGO_VERBA,1,4) <> 'ZZZZ' AND MOV.DESCRICAO IS NOT NULL THEN
		 			  RPAD(MOV.DESCRICAO,30,' ')||LPAD(MOV.VALOR_VERBA,10,' ')||CASE WHEN SUBSTR(MOV.CODIGO_VERBA,1,1) = LEAD(SUBSTR(MOV.CODIGO_VERBA,1,1)) OVER
		 			  (ORDER BY MOV.CODIGO_EMPRESA, MOV.CODIGO_CONTRATO,MOV.CODIGO_VERBA, SUBSTR(MOV.CODIGO_VERBA,1,1)) OR LEAD(SUBSTR(MOV.CODIGO_VERBA,1,1)) OVER
		 			  (ORDER BY MOV.CODIGO_EMPRESA, MOV.CODIGO_CONTRATO,MOV.CODIGO_VERBA, SUBSTR(MOV.CODIGO_VERBA,1,1)) IS NULL OR (SUBSTR(MOV.CODIGO_VERBA,1,1) = '4' AND 
		 			  LEAD(SUBSTR(MOV.CODIGO_VERBA,1,1)) OVER (ORDER BY MOV.CODIGO_EMPRESA, MOV.CODIGO_CONTRATO,MOV.CODIGO_VERBA, SUBSTR(MOV.CODIGO_VERBA,1,1)) = '1') 
		 			  THEN LPAD(' ',8)||RPAD('0',29,' ') ELSE LPAD(' ',8)||RPAD('1',29,' ') END
				ELSE RPAD(MOV.DESCRICAO,40,' ')||LPAD(' ',8)||RPAD('0',29,' ')
		 END END LINHA_MOV
	FROM RHPESS_CONTRATO,
		  RHPESS_PESSOA,
		  RHPLCS_CARGO CARGO_EFETIVO,
  		  RHPLCS_CARGO CARGO_COMISSIONADO,
		  RHPLCS_CARGO CARGO_PAGAMENTO,
		  (
				SELECT M.CODIGO_EMPRESA,
						 M.CODIGO_CONTRATO,
						 M.TIPO_CONTRATO,
						 M.CODIGO_VERBA,
						 CASE WHEN M.CODIGO_VERBA = '4001' THEN 'TOTAL REMUNERACAO' 
								WHEN M.CODIGO_VERBA = '4002' THEN 'TOTAL DESCONTOS'
								WHEN M.CODIGO_VERBA = '4003' THEN 'LIQUIDO'
								WHEN M.CODIGO_VERBA = '3001' THEN 'FGTS NO MES'
								ELSE TRIM(UPPER(RHPARM_VERBA.DESCRICAO))
						 END DESCRICAO,
						 TRIM(TO_CHAR(M.VALOR_VERBA,'9G999G999G999G999D99','NLS_NUMERIC_CHARACTERS = '',.''')) VALOR_VERBA
				FROM RHMOVI_MOVIMENTO M,
					  RHPARM_VERBA
				WHERE M.CODIGO_VERBA = RHPARM_VERBA.CODIGO AND
						(M.CODIGO_VERBA BETWEEN '1000' AND '3000' OR M.CODIGO_VERBA IN ('3001','4001','4002','4003')) AND
						M.CTRL_DEMO = 'N' AND
						M.VALOR_VERBA > 0 AND
						M.TIPO_MOVIMENTO = VTEXTO_1 AND
						M.MODO_OPERACAO = VGLB_MODO_OPERACAO AND
						M.CODIGO_EMPRESA = VGLB_EMPRESA AND
						M.ANO_MES_REFERENCIA = VGLB_MES_ANO_SISTEMA
				UNION ALL
				SELECT M.CODIGO_EMPRESA,
						 M.CODIGO_CONTRATO,
						 M.TIPO_CONTRATO,
						 M.CODIGO_VERBA,
						 M.DESCRICAO,
						 M.VALOR_VERBA
				FROM
				(
					SELECT M2.CODIGO_EMPRESA,
							 M2.CODIGO_CONTRATO,
							 M2.TIPO_CONTRATO,
							 CASE WHEN M2.CODIGO_VERBA BETWEEN '1000' AND '1ZZZ' THEN '1000'
									WHEN M2.CODIGO_VERBA = '4001' AND LEAD(M2.CODIGO_VERBA) OVER (ORDER BY M2.CODIGO_EMPRESA, M2.CODIGO_CONTRATO,M2.CODIGO_VERBA) = '4003' THEN '4002'
									WHEN M2.CODIGO_VERBA = '4003' THEN '4004'
									ELSE '2000'
							 END CODIGO_VERBA,
							 CASE WHEN M2.CODIGO_VERBA BETWEEN '1000' AND '1ZZZ' THEN 'REMUNERACAO'
									WHEN M2.CODIGO_VERBA = '4001' AND LEAD(M2.CODIGO_VERBA) OVER (ORDER BY M2.CODIGO_EMPRESA, M2.CODIGO_CONTRATO,M2.CODIGO_VERBA) = '4003' THEN 'TOTAL DESCONTOS'
									WHEN M2.CODIGO_VERBA = '4003' THEN 'VALOR CREDITADO'
									ELSE 'DESCONTOS'
							 END DESCRICAO,
							 CASE WHEN M2.CODIGO_VERBA = '4003' THEN TRIM(TO_CHAR(M2.VALOR_VERBA,'9G999G999G999G999D99','NLS_NUMERIC_CHARACTERS = '',.''')) ELSE ' ' END VALOR_VERBA 
					FROM RHMOVI_MOVIMENTO M2
					WHERE (M2.CODIGO_VERBA BETWEEN '1000' AND '3000' OR M2.CODIGO_VERBA IN ('3001','4001','4002','4003')) AND
							M2.CTRL_DEMO = 'N' AND
							M2.VALOR_VERBA > 0 AND
							M2.TIPO_MOVIMENTO = VTEXTO_1 AND
							M2.MODO_OPERACAO = VGLB_MODO_OPERACAO AND
							M2.CODIGO_EMPRESA = VGLB_EMPRESA AND
							M2.ANO_MES_REFERENCIA = VGLB_MES_ANO_SISTEMA
				) M
				GROUP BY M.CODIGO_EMPRESA,
							M.CODIGO_CONTRATO,
						   M.TIPO_CONTRATO,
							M.CODIGO_VERBA,
							M.DESCRICAO,
							M.VALOR_VERBA
				UNION ALL
				SELECT C.CODIGO_EMPRESA,
						 C.CODIGO_CONTRATO,
						 C.TIPO_CONTRATO,
						 'ZZZZ'||MENSAGEM.LINHA CODIGO_VERBA,
						 MENSAGEM.TEXTO DESCRICAO,
						 ' ' VALOR_VERBA
				FROM RHPESS_CONTR_MEST C,
					  (
							SELECT ROWNUM LINHA, SUBSTR(M.MENSAGEM,DECODE(ROWNUM,1,1,ROWNUM+(39*(ROWNUM-1))),40) TEXTO
							FROM DUAL,
							(
								SELECT TRIM(R.OBSERVACAO_1) MENSAGEM
								FROM RHRELS_ED_RELATORI R
								WHERE R.CODIGO_GRUPO = VGLB_GRUPO_USUARIO AND
										R.CODIGO = VGLB_RELATORIO AND
										R.TIPO_ELEMENTO = 'T'
							) M
							CONNECT BY LEVEL < (LENGTH(M.MENSAGEM)/40)+1
					  ) MENSAGEM
				WHERE C.CODIGO_EMPRESA = VGLB_EMPRESA AND
						C.TIPO_CONTRATO = VGLB_TIPO_CONTRATO
		  ) MOV,
		  (
				SELECT RHPESS_CONTRATO.CODIGO,
						 RHPESS_CONTRATO.CODIGO_EMPRESA,
						 RHPESS_CONTRATO.TIPO_CONTRATO,
						 RHPESS_CONTRATO.CODIGO_PESSOA,

						 ROW_NUMBER() OVER (PARTITION BY RHPESS_CONTRATO.CODIGO_EMPRESA, RHPESS_CONTRATO.CODIGO_PESSOA
												  ORDER BY RHPESS_CONTRATO.CODIGO_EMPRESA, RHPESS_CONTRATO.CODIGO_PESSOA, RHPESS_CONTRATO.CODIGO) ORDEM
				FROM RHPESS_CONTRATO,
					  RHTABS_WHERE

	WHERE 

					RHPESS_CONTRATO.ANO_MES_REFERENCIA = (SELECT MAX(A.ANO_MES_REFERENCIA) 
												    	FROM RHPESS_CONTRATO A WHERE A.CODIGO = RHPESS_CONTRATO.CODIGO AND
														     A.CODIGO_EMPRESA = RHPESS_CONTRATO.CODIGO_EMPRESA AND
															  A.TIPO_CONTRATO = RHPESS_CONTRATO.TIPO_CONTRATO AND
															  A.ANO_MES_REFERENCIA > TO_DATE('01/01/1900','DD/MM/YYYY') AND
															  A.ANO_MES_REFERENCIA <= VGLB_MES_ANO_SISTEMA)
		  ) CTRL_MAIS_1_CONTRATO,
		  RHTABS_WHERE
	WHERE RHPESS_CONTRATO.CODIGO_PESSOA = RHPESS_PESSOA.CODIGO AND
			RHPESS_CONTRATO.CODIGO_EMPRESA = RHPESS_PESSOA.CODIGO_EMPRESA AND
			RHPESS_CONTRATO.CODIGO_EMPRESA = CARGO_EFETIVO.CODIGO_EMPRESA (+) AND
			RHPESS_CONTRATO.COD_CARGO_EFETIVO = CARGO_EFETIVO.CODIGO (+) AND
			RHPESS_CONTRATO.CODIGO_EMPRESA = CARGO_COMISSIONADO.CODIGO_EMPRESA (+) AND
			RHPESS_CONTRATO.COD_CARGO_COMISS = CARGO_COMISSIONADO.CODIGO (+) AND
			RHPESS_CONTRATO.CODIGO_EMPRESA = CARGO_PAGAMENTO.CODIGO_EMPRESA (+) AND
			RHPESS_CONTRATO.COD_CARGO_PAGTO = CARGO_PAGAMENTO.CODIGO (+) AND
			RHPESS_CONTRATO.CODIGO_EMPRESA = MOV.CODIGO_EMPRESA AND
			RHPESS_CONTRATO.TIPO_CONTRATO = MOV.TIPO_CONTRATO AND
			RHPESS_CONTRATO.CODIGO = MOV.CODIGO_CONTRATO AND
			RHPESS_CONTRATO.CODIGO_EMPRESA = VGLB_EMPRESA AND
			RHPESS_CONTRATO.TIPO_CONTRATO = VGLB_TIPO_CONTRATO AND
			RHPESS_CONTRATO.CODIGO_EMPRESA = CTRL_MAIS_1_CONTRATO.CODIGO_EMPRESA AND
			RHPESS_CONTRATO.TIPO_CONTRATO = CTRL_MAIS_1_CONTRATO.TIPO_CONTRATO AND
			RHPESS_CONTRATO.CODIGO_PESSOA = CTRL_MAIS_1_CONTRATO.CODIGO_PESSOA AND--DIFERE
			RHPESS_CONTRATO.CODIGO = CTRL_MAIS_1_CONTRATO.CODIGO AND
			CTRL_MAIS_1_CONTRATO.ORDEM = VINTEIRO_1 AND
			EXISTS (SELECT M.CODIGO_CONTRATO
					  FROM RHMOVI_MOVIMENTO M
					  WHERE M.CODIGO_EMPRESA = RHPESS_CONTRATO.CODIGO_EMPRESA AND
							  M.TIPO_CONTRATO = RHPESS_CONTRATO.TIPO_CONTRATO AND
							  M.CODIGO_CONTRATO = RHPESS_CONTRATO.CODIGO AND
							  M.TIPO_MOVIMENTO = VTEXTO_1 AND
							  M.MODO_OPERACAO = VGLB_MODO_OPERACAO AND
							  M.ANO_MES_REFERENCIA = VGLB_MES_ANO_SISTEMA) AND
			RHPESS_CONTRATO.ANO_MES_REFERENCIA = (SELECT MAX(A.ANO_MES_REFERENCIA) 
																  FROM RHPESS_CONTRATO A WHERE A.CODIGO = RHPESS_CONTRATO.CODIGO AND
																		 A.CODIGO_EMPRESA = RHPESS_CONTRATO.CODIGO_EMPRESA AND
																		 A.TIPO_CONTRATO = RHPESS_CONTRATO.TIPO_CONTRATO AND
																		 A.ANO_MES_REFERENCIA > TO_DATE('01/01/1900','DD/MM/YYYY') AND
																		 A.ANO_MES_REFERENCIA <= VGLB_MES_ANO_SISTEMA)
ORDER BY 1,14
--FIM-----------------------------------------------------------------------SQL DO RELATORIO
)     
LOOP  

VCONTADOR :=VCONTADOR+1;
DBMS_OUTPUT.PUT_LINE('--'||VCONTADOR);
DBMS_OUTPUT.PUT_LINE(C1.CODIGO||C1.INICIO_LINHA||C1.AGENCIA||C1.CONTA||C1.NOME||C1.CPF||C1.AGENCIA_EMPRESA||C1.CONTA_EMPRESA||C1.CONTRATO_EMPRESA||C1.SEQUENCIAL||C1.MES_REF||C1.DATA_CREDITO||C1.LINHA1||C1.LINHA2||C1.LINHA3||C1.LINHA4||C1.LINHA5||C1.LINHA6||C1.LINHA7||C1.LINHA8||C1.LINHA9||C1.LINHA10||C1.LINHA11||C1.NUM_LINHAS_INICIO||C1.LINHA_MOV);

END LOOP;

END;

END;

