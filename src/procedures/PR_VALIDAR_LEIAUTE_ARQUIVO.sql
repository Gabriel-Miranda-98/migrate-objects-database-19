
  CREATE OR REPLACE EDITIONABLE PROCEDURE "ARTERH"."PR_VALIDAR_LEIAUTE_ARQUIVO" (IDENTIFICADOR_ARQUIVO NUMBER) as

vRETORNO RETORNO_PROCESSAMENTO := RETORNO_PROCESSAMENTO(null,null,null);
REG_LOG LOG_PROCESSAMENTO;
vLISTA_LOG LISTA_LOG := LISTA_LOG(null,null,null);

vINTERFACE_ARQUIVO INTERFACE_ARQUIVO;

/*
  REG_IS REG_INTERFACE_SOFTWARE;
  vIS INTERFACE_SOFTWARE;
  I_S INTERFACE_SOFTWARE;
  vIS_ARQUIVO INTERFACE_ARQUIVO;

  TIPO_ALFANUMERICO     CONSTANT NUMBER := 1;
  TIPO_NUMERICO         CONSTANT NUMBER := 2;
  TIPO_DATA             CONSTANT NUMBER := 3;
  TIPO_DATA_HORA        CONSTANT NUMBER := 4;
  TIPO_SIM_NAO          CONSTANT NUMBER := 5;
  TIPO_VALOR            CONSTANT NUMBER := 6;
  SIM                   CONSTANT NUMBER := 1;
  NAO                   CONSTANT NUMBER := 0;
  */

  ARQUIVO_CONCESSOES         CONSTANT CHAR(4) := '0001';
  ARQUIVO_BENEFICIARIOS      CONSTANT CHAR(4) := '0002';
  ARQUIVO_MOVIMENTOS         CONSTANT CHAR(4) := '0003';
  ARQUIVO_MOVIMENTOS_DIRF    CONSTANT CHAR(4) := '0004';
  ARQUIVO_TABELA_VALORES_PS  CONSTANT CHAR(4) := '0005';
  ARQUIVO_DUPLA_LOTACAO         CONSTANT CHAR(4) := 'DPL1';



  EMPRESA_ATIVOS        CONSTANT CHAR(4) := '0001';
  EMPRESA_APOSENTADOS   CONSTANT CHAR(4) := '1700';
  EMPRESA_PENSIONISTAS  CONSTANT CHAR(4) := '0011';

  STATUS_CARREGADO    CONSTANT NUMBER := 0;
  STATUS_VALIDADO     CONSTANT NUMBER := 1;
  STATUS_INVALIDADO   CONSTANT NUMBER := 2;
  STATUS_PROCESSADO   CONSTANT NUMBER := 3;
  STATUS_EFETIVADO    CONSTANT NUMBER := 4;

  TIPO_LOG_SUCESSO      CONSTANT NUMBER := 0;
  TIPO_LOG_INFO         CONSTANT NUMBER := 2;
  TIPO_LOG_ALERTA       CONSTANT NUMBER := 2;
  TIPO_LOG_ERRO         CONSTANT NUMBER := 99;

  CATEGORIA_LOG_VALIDACAO CONSTANT NUMBER := 0;
  CATEGORIA_LOG_EXECUCAO  CONSTANT NUMBER := 1;
  CATEGORIA_LOG_LEIAUTE   CONSTANT NUMBER := 2;

  LOG_TAMANHO_LINHA_INVALIDO     CONSTANT CHAR(4) := 'L001';
  LOG_QUANTIDADE_CAMPOS_INVALIDA CONSTANT CHAR(4) := 'L002';
  LOG_TAMANHO_CAMPO_INVALIDO     CONSTANT CHAR(4) := 'L003';
  LOG_CAMPO_NULO                 CONSTANT CHAR(4) := 'L004';
  LOG_DATA_INVALIDA              CONSTANT CHAR(4) := 'L005';
  LOG_TEXTO_INVALIDO             CONSTANT CHAR(4) := 'L006';
  LOG_NUMERO_INVALIDO            CONSTANT CHAR(4) := 'L007';

  LISTA_TIPO_BENEFICIO_PENSAO LISTA:=LISTA('0025','0026');
  LISTA_TIPO_BENEFICIO_GERAL  LISTA:=LISTA('0005','0006');

  LISTA_VERBAS_DIRF  LISTA:=LISTA('24I8','24I9','16I8','16I5','24I5');

  LISTA_TIPO_BENEFICIO LISTA;

  LISTA_FORNECEDORES CLOB;

  vLISTA_FORNECEDORES CLOB;
  vIDENTIFICADOR_FORNCEDOR VARCHAR2(15);
  vIDENTIFICADOR_BENEFICIO VARCHAR2(15);
  vIDENTIFICADOR_VERBA VARCHAR2(4);
  vCONTADOR NUMBER;
  vTIPO_ARQUIVO CHAR(4);
  vDATA_PROCESSAMENTO DATE;
  vIS_TESTE BOOLEAN;
  vSITUACAO_PROCESSAMENTO NUMBER;
  vCODIGO_EMPRESA CHAR(4);
  vANO_MES_REFERENCIA DATE;
  vCATEGORIA_LOG NUMBER;
  vTIPO_LOG NUMBER;
  vID_ARQUIVO NUMBER;
  vSITUACAO_ATUALIZADA CHAR(2);
  vDATA_ANO_MES_REFERENCIA DATE;
  vPRIMEIRA_LINHA VARCHAR2(4000);
  vQTDE_REPETICOES_REGISTROS NUMBER;

FUNCTION OBTER_INTERFACE(pTIPO_ARQUIVO CHAR, pID_ARQUIVO NUMBER DEFAULT NULL)
RETURN INTERFACE_ARQUIVO AS

  REG_IS REG_INTERFACE_SOFTWARE;
  vIS INTERFACE_SOFTWARE;
  I_S INTERFACE_SOFTWARE;
  vIS_ARQUIVO INTERFACE_ARQUIVO;

  vTAMANHO_MAXIMO_LINHA NUMBER;
  vNUMERO_CAMPOS NUMBER;

  TIPO_ALFANUMERICO     CONSTANT NUMBER := 1;
  TIPO_NUMERICO         CONSTANT NUMBER := 2;
  TIPO_DATA             CONSTANT NUMBER := 3;
  TIPO_DATA_HORA        CONSTANT NUMBER := 4;
  TIPO_SIM_NAO          CONSTANT NUMBER := 5;
  TIPO_VALOR            CONSTANT NUMBER := 6;
  TIPO_VALOR_SEPARADOR_DECIMAL            CONSTANT NUMBER := 7;
  SIM                   CONSTANT NUMBER := 1;
  NAO                   CONSTANT NUMBER := 0;

BEGIN

    REG_IS := REG_INTERFACE_SOFTWARE(null, null, null, null, null, null, null);
    vIS := INTERFACE_SOFTWARE();
    I_S := INTERFACE_SOFTWARE();
    vIS_ARQUIVO := INTERFACE_ARQUIVO(null,null,null,null,null,null);

     CASE WHEN pTIPO_ARQUIVO = ARQUIVO_CONCESSOES THEN
              vIS_ARQUIVO.TIPO_ARQUIVO := pTIPO_ARQUIVO;
              vIS_ARQUIVO.DESCRICAO_TIPO_ARQUIVO := 'ARQUIVO_CONCESSAO';
              vIS_ARQUIVO.CARACTERE_SEPARADOR := ';';
              vIS_ARQUIVO.QTDE_CAMPOS := 21;

              FOR i in 1..vIS_ARQUIVO.QTDE_CAMPOS LOOP
                  I_S.EXTEND(1);
                  I_S(i) := REG_INTERFACE_SOFTWARE(null, null, null, null, null, null, null);
              END LOOP;

              vCONTADOR := 1;

              I_S(vCONTADOR).CAMPO := 'IDENTIFICADOR_ARQUIVO';        I_S(vCONTADOR).TAMANHO_IS := 4;  I_S(vCONTADOR).TAMANHO := 4;  I_S(vCONTADOR).TIPO_IS := TIPO_ALFANUMERICO; I_S(vCONTADOR).TIPO := TIPO_ALFANUMERICO; I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'DATA_HORA_GERACAO_ARQUIVO';    I_S(vCONTADOR).TAMANHO_IS := 14; I_S(vCONTADOR).TAMANHO := 14; I_S(vCONTADOR).TIPO_IS := TIPO_DATA_HORA;    I_S(vCONTADOR).TIPO := TIPO_DATA_HORA;    I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'SEQUENCIAL_REGISTRO';          I_S(vCONTADOR).TAMANHO_IS := 6;  I_S(vCONTADOR).TAMANHO := 6;  I_S(vCONTADOR).TIPO_IS := TIPO_NUMERICO;     I_S(vCONTADOR).TIPO := TIPO_NUMERICO;     I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'TIPO_OPERACAO';                I_S(vCONTADOR).TAMANHO_IS := 1;  I_S(vCONTADOR).TAMANHO := 1;  I_S(vCONTADOR).TIPO_IS := TIPO_ALFANUMERICO; I_S(vCONTADOR).TIPO := TIPO_ALFANUMERICO; I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'CODIGO_EMPRESA';               I_S(vCONTADOR).TAMANHO_IS := 4;  I_S(vCONTADOR).TAMANHO := 4;  I_S(vCONTADOR).TIPO_IS := TIPO_NUMERICO;     I_S(vCONTADOR).TIPO := TIPO_NUMERICO;     I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'CODIGO_CONTRATO';              I_S(vCONTADOR).TAMANHO_IS := 15; I_S(vCONTADOR).TAMANHO := 15; I_S(vCONTADOR).TIPO_IS := TIPO_ALFANUMERICO; I_S(vCONTADOR).TIPO := TIPO_NUMERICO;     I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'CPF';                          I_S(vCONTADOR).TAMANHO_IS := 11; I_S(vCONTADOR).TAMANHO := 11; I_S(vCONTADOR).TIPO_IS := TIPO_NUMERICO;     I_S(vCONTADOR).TIPO := TIPO_NUMERICO;     I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'CODIGO_ANS_FORNECEDOR';        I_S(vCONTADOR).TAMANHO_IS := 15; I_S(vCONTADOR).TAMANHO := 15; I_S(vCONTADOR).TIPO_IS := TIPO_NUMERICO;     I_S(vCONTADOR).TIPO := TIPO_NUMERICO;     I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'CODIGO_BENEFICIO';             I_S(vCONTADOR).TAMANHO_IS := 15; I_S(vCONTADOR).TAMANHO := 15; I_S(vCONTADOR).TIPO_IS := TIPO_NUMERICO;     I_S(vCONTADOR).TIPO := TIPO_NUMERICO;     I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'CATEGORIA_BENEFICIARIO';       I_S(vCONTADOR).TAMANHO_IS := 4;  I_S(vCONTADOR).TAMANHO := 4;  I_S(vCONTADOR).TIPO_IS := TIPO_NUMERICO;     I_S(vCONTADOR).TIPO := TIPO_NUMERICO;     I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'ORDEM_DEPENDENTE';             I_S(vCONTADOR).TAMANHO_IS := 2;  I_S(vCONTADOR).TAMANHO := 2;  I_S(vCONTADOR).TIPO_IS := TIPO_NUMERICO;     I_S(vCONTADOR).TIPO := TIPO_NUMERICO;     I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'MOTIVO_CONCESSAO';             I_S(vCONTADOR).TAMANHO_IS := 4;  I_S(vCONTADOR).TAMANHO := 4;  I_S(vCONTADOR).TIPO_IS := TIPO_ALFANUMERICO; I_S(vCONTADOR).TIPO := TIPO_ALFANUMERICO; I_S(vCONTADOR).NULO := SIM; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'DATA_CONCESSAO';               I_S(vCONTADOR).TAMANHO_IS := 8;  I_S(vCONTADOR).TAMANHO := 8;  I_S(vCONTADOR).TIPO_IS := TIPO_DATA;         I_S(vCONTADOR).TIPO := TIPO_DATA;         I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;

              I_S(vCONTADOR).CAMPO := 'MOTIVO_CANCELAMENTO';          I_S(vCONTADOR).TAMANHO_IS := 4;  I_S(vCONTADOR).TAMANHO := 4;  I_S(vCONTADOR).TIPO_IS := TIPO_ALFANUMERICO; I_S(vCONTADOR).TIPO := TIPO_ALFANUMERICO; I_S(vCONTADOR).NULO := SIM; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'DATA_CANCELAMENTO';            I_S(vCONTADOR).TAMANHO_IS := 8;  I_S(vCONTADOR).TAMANHO := 8;  I_S(vCONTADOR).TIPO_IS := TIPO_DATA;         I_S(vCONTADOR).TIPO := TIPO_DATA;         I_S(vCONTADOR).NULO := SIM; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'OBSERVACAO';                   I_S(vCONTADOR).TAMANHO_IS := 60; I_S(vCONTADOR).TAMANHO := 60; I_S(vCONTADOR).TIPO_IS := TIPO_ALFANUMERICO; I_S(vCONTADOR).TIPO := TIPO_ALFANUMERICO; I_S(vCONTADOR).NULO := SIM; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'NUMERO_CARTEIRA';              I_S(vCONTADOR).TAMANHO_IS := 30; I_S(vCONTADOR).TAMANHO := 30; I_S(vCONTADOR).TIPO_IS := TIPO_ALFANUMERICO; I_S(vCONTADOR).TIPO := TIPO_ALFANUMERICO; I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'NUMERO_PROTOCOLO';             I_S(vCONTADOR).TAMANHO_IS := 30; I_S(vCONTADOR).TAMANHO := 30; I_S(vCONTADOR).TIPO_IS := TIPO_ALFANUMERICO; I_S(vCONTADOR).TIPO := TIPO_ALFANUMERICO; I_S(vCONTADOR).NULO := SIM; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'DATA_FIM_EXCECAO_DEPENDENCIA'; I_S(vCONTADOR).TAMANHO_IS := 8;  I_S(vCONTADOR).TAMANHO := 8;  I_S(vCONTADOR).TIPO_IS := TIPO_DATA;         I_S(vCONTADOR).TIPO := TIPO_DATA;         I_S(vCONTADOR).NULO := SIM; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'EXCECAO_DEPENDENCIA';          I_S(vCONTADOR).TAMANHO_IS := 1;  I_S(vCONTADOR).TAMANHO := 1;  I_S(vCONTADOR).TIPO_IS := TIPO_NUMERICO;     I_S(vCONTADOR).TIPO := TIPO_NUMERICO;     I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'DATA_CADASTRAMENTO';           I_S(vCONTADOR).TAMANHO_IS := 14; I_S(vCONTADOR).TAMANHO := 14; I_S(vCONTADOR).TIPO_IS := TIPO_DATA_HORA;    I_S(vCONTADOR).TIPO := TIPO_DATA_HORA;    I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;

          WHEN pTIPO_ARQUIVO = ARQUIVO_BENEFICIARIOS THEN
              vIS_ARQUIVO.TIPO_ARQUIVO := pTIPO_ARQUIVO;
              vIS_ARQUIVO.DESCRICAO_TIPO_ARQUIVO := 'ARQUIVO_BENEFICIARIOS';
              vIS_ARQUIVO.CARACTERE_SEPARADOR := ';';
              vIS_ARQUIVO.QTDE_CAMPOS := 27;

              FOR i in 1..vIS_ARQUIVO.QTDE_CAMPOS LOOP
                  I_S.EXTEND(1);
                  I_S(i) := REG_INTERFACE_SOFTWARE(null, null, null, null, null, null, null);
              END LOOP;

              vCONTADOR := 1;

              I_S(vCONTADOR).CAMPO := 'IDENTIFICADOR_ARQUIVO';     I_S(vCONTADOR).TAMANHO_IS := 4;  I_S(vCONTADOR).TAMANHO := 4;  I_S(vCONTADOR).TIPO_IS := TIPO_ALFANUMERICO; I_S(vCONTADOR).TIPO := TIPO_ALFANUMERICO; I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'DATA_HORA_GERACAO_ARQUIVO'; I_S(vCONTADOR).TAMANHO_IS := 14; I_S(vCONTADOR).TAMANHO := 14; I_S(vCONTADOR).TIPO_IS := TIPO_DATA_HORA;    I_S(vCONTADOR).TIPO := TIPO_DATA_HORA;    I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'SEQUENCIAL_REGISTRO';       I_S(vCONTADOR).TAMANHO_IS := 6;  I_S(vCONTADOR).TAMANHO := 6;  I_S(vCONTADOR).TIPO_IS := TIPO_NUMERICO;     I_S(vCONTADOR).TIPO := TIPO_NUMERICO;     I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'TIPO_OPERACAO';             I_S(vCONTADOR).TAMANHO_IS := 1;  I_S(vCONTADOR).TAMANHO := 1;  I_S(vCONTADOR).TIPO_IS := TIPO_ALFANUMERICO; I_S(vCONTADOR).TIPO := TIPO_ALFANUMERICO; I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'CODIGO_EMPRESA';            I_S(vCONTADOR).TAMANHO_IS := 4;  I_S(vCONTADOR).TAMANHO := 4;  I_S(vCONTADOR).TIPO_IS := TIPO_NUMERICO;     I_S(vCONTADOR).TIPO := TIPO_NUMERICO;     I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'CODIGO_CONTRATO';           I_S(vCONTADOR).TAMANHO_IS := 15; I_S(vCONTADOR).TAMANHO := 15; I_S(vCONTADOR).TIPO_IS := TIPO_ALFANUMERICO; I_S(vCONTADOR).TIPO := TIPO_NUMERICO;     I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'CPF';                       I_S(vCONTADOR).TAMANHO_IS := 11; I_S(vCONTADOR).TAMANHO := 11; I_S(vCONTADOR).TIPO_IS := TIPO_NUMERICO;     I_S(vCONTADOR).TIPO := TIPO_NUMERICO;     I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'NOME';                      I_S(vCONTADOR).TAMANHO_IS := 60; I_S(vCONTADOR).TAMANHO := 60; I_S(vCONTADOR).TIPO_IS := TIPO_ALFANUMERICO; I_S(vCONTADOR).TIPO := TIPO_ALFANUMERICO; I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'DATA_NASCIMENTO';           I_S(vCONTADOR).TAMANHO_IS := 8;  I_S(vCONTADOR).TAMANHO := 8;  I_S(vCONTADOR).TIPO_IS := TIPO_DATA;         I_S(vCONTADOR).TIPO := TIPO_DATA;         I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'CODIGO_SEXO';               I_S(vCONTADOR).TAMANHO_IS := 4;  I_S(vCONTADOR).TAMANHO := 4;  I_S(vCONTADOR).TIPO_IS := TIPO_NUMERICO;     I_S(vCONTADOR).TIPO := TIPO_NUMERICO;     I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'CODIGO_RACA_COR';           I_S(vCONTADOR).TAMANHO_IS := 4;  I_S(vCONTADOR).TAMANHO := 4;  I_S(vCONTADOR).TIPO_IS := TIPO_NUMERICO;     I_S(vCONTADOR).TIPO := TIPO_NUMERICO;     I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'CODIGO_IMCAP_LABOR';        I_S(vCONTADOR).TAMANHO_IS := 4;  I_S(vCONTADOR).TAMANHO := 4;  I_S(vCONTADOR).TIPO_IS := TIPO_NUMERICO;     I_S(vCONTADOR).TIPO := TIPO_NUMERICO;     I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'CODIGO_TIPO_RELACIONAMENTO';I_S(vCONTADOR).TAMANHO_IS := 4;  I_S(vCONTADOR).TAMANHO := 4;  I_S(vCONTADOR).TIPO_IS := TIPO_NUMERICO;     I_S(vCONTADOR).TIPO := TIPO_NUMERICO;     I_S(vCONTADOR).NULO := SIM; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'CODIGO_ESTADO_CIVIL';       I_S(vCONTADOR).TAMANHO_IS := 4;  I_S(vCONTADOR).TAMANHO := 4;  I_S(vCONTADOR).TIPO_IS := TIPO_NUMERICO;     I_S(vCONTADOR).TIPO := TIPO_NUMERICO;     I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'IDENTIDADE';                I_S(vCONTADOR).TAMANHO_IS := 20; I_S(vCONTADOR).TAMANHO := 20; I_S(vCONTADOR).TIPO_IS := TIPO_ALFANUMERICO; I_S(vCONTADOR).TIPO := TIPO_ALFANUMERICO; I_S(vCONTADOR).NULO := SIM; vCONTADOR := vCONTADOR + 1;

              I_S(vCONTADOR).CAMPO := 'NOME_DA_MAE';               I_S(vCONTADOR).TAMANHO_IS := 60; I_S(vCONTADOR).TAMANHO := 60; I_S(vCONTADOR).TIPO_IS := TIPO_ALFANUMERICO; I_S(vCONTADOR).TIPO := TIPO_ALFANUMERICO; I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'CODIGO_TIPO_LOGRADOURO';    I_S(vCONTADOR).TAMANHO_IS := 4;  I_S(vCONTADOR).TAMANHO := 4;  I_S(vCONTADOR).TIPO_IS := TIPO_NUMERICO;     I_S(vCONTADOR).TIPO := TIPO_NUMERICO;     I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'ENDERECO';                  I_S(vCONTADOR).TAMANHO_IS := 40; I_S(vCONTADOR).TAMANHO := 40; I_S(vCONTADOR).TIPO_IS := TIPO_ALFANUMERICO; I_S(vCONTADOR).TIPO := TIPO_ALFANUMERICO; I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'NUMERO';                    I_S(vCONTADOR).TAMANHO_IS := 10; I_S(vCONTADOR).TAMANHO := 10; I_S(vCONTADOR).TIPO_IS := TIPO_ALFANUMERICO; I_S(vCONTADOR).TIPO := TIPO_ALFANUMERICO; I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'COMPLEMENTO';               I_S(vCONTADOR).TAMANHO_IS := 40; I_S(vCONTADOR).TAMANHO := 40; I_S(vCONTADOR).TIPO_IS := TIPO_ALFANUMERICO; I_S(vCONTADOR).TIPO := TIPO_ALFANUMERICO; I_S(vCONTADOR).NULO := SIM; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'BAIRRO';                    I_S(vCONTADOR).TAMANHO_IS := 40; I_S(vCONTADOR).TAMANHO := 40; I_S(vCONTADOR).TIPO_IS := TIPO_ALFANUMERICO; I_S(vCONTADOR).TIPO := TIPO_ALFANUMERICO; I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'CODIGO_MUNICIPIO';          I_S(vCONTADOR).TAMANHO_IS := 7;  I_S(vCONTADOR).TAMANHO := 7;  I_S(vCONTADOR).TIPO_IS := TIPO_NUMERICO;     I_S(vCONTADOR).TIPO := TIPO_NUMERICO;     I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'UF';                        I_S(vCONTADOR).TAMANHO_IS := 2;  I_S(vCONTADOR).TAMANHO := 2;  I_S(vCONTADOR).TIPO_IS := TIPO_ALFANUMERICO; I_S(vCONTADOR).TIPO := TIPO_ALFANUMERICO; I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'CEP';                       I_S(vCONTADOR).TAMANHO_IS := 8;  I_S(vCONTADOR).TAMANHO := 8;  I_S(vCONTADOR).TIPO_IS := TIPO_NUMERICO;     I_S(vCONTADOR).TIPO := TIPO_NUMERICO;     I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'TELEFONE_FIXO';             I_S(vCONTADOR).TAMANHO_IS := 10; I_S(vCONTADOR).TAMANHO := 10; I_S(vCONTADOR).TIPO_IS := TIPO_NUMERICO;     I_S(vCONTADOR).TIPO := TIPO_NUMERICO;     I_S(vCONTADOR).NULO := SIM; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'TELEFONE_CELULAR';          I_S(vCONTADOR).TAMANHO_IS := 11; I_S(vCONTADOR).TAMANHO := 11; I_S(vCONTADOR).TIPO_IS := TIPO_NUMERICO;     I_S(vCONTADOR).TIPO := TIPO_NUMERICO;     I_S(vCONTADOR).NULO := SIM; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'DATA_CADASTRAMENTO';        I_S(vCONTADOR).TAMANHO_IS := 14; I_S(vCONTADOR).TAMANHO := 14; I_S(vCONTADOR).TIPO_IS := TIPO_DATA_HORA;    I_S(vCONTADOR).TIPO := TIPO_DATA_HORA;    I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;


          WHEN pTIPO_ARQUIVO = ARQUIVO_MOVIMENTOS THEN
              vIS_ARQUIVO.TIPO_ARQUIVO := pTIPO_ARQUIVO;
              vIS_ARQUIVO.DESCRICAO_TIPO_ARQUIVO := 'ARQUIVO_MOVIMENTO';
              vIS_ARQUIVO.CARACTERE_SEPARADOR := null;
              vIS_ARQUIVO.QTDE_CAMPOS := 19;

              FOR i in 1..vIS_ARQUIVO.QTDE_CAMPOS LOOP
                  I_S.EXTEND(1);
                  I_S(i) := REG_INTERFACE_SOFTWARE(null, null, null, null, null, null, null);
              END LOOP;

              vCONTADOR := 1;

              I_S(vCONTADOR).CAMPO := 'OPERACAO';                  I_S(vCONTADOR).TAMANHO_IS :=  1;  I_S(vCONTADOR).TAMANHO :=  1;  I_S(vCONTADOR).TIPO_IS := TIPO_ALFANUMERICO; I_S(vCONTADOR).TIPO := TIPO_ALFANUMERICO; I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'PERIODO_REFERENCIA';        I_S(vCONTADOR).TAMANHO_IS :=  8;  I_S(vCONTADOR).TAMANHO :=  8;  I_S(vCONTADOR).TIPO_IS := TIPO_DATA;         I_S(vCONTADOR).TIPO := TIPO_DATA;         I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'CODIGO_EMPRESA';            I_S(vCONTADOR).TAMANHO_IS :=  4;  I_S(vCONTADOR).TAMANHO :=  4;  I_S(vCONTADOR).TIPO_IS := TIPO_NUMERICO;     I_S(vCONTADOR).TIPO := TIPO_NUMERICO;     I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'INDICADOR_EMPRESA';         I_S(vCONTADOR).TAMANHO_IS :=  2;  I_S(vCONTADOR).TAMANHO :=  2;  I_S(vCONTADOR).TIPO_IS := TIPO_NUMERICO;     I_S(vCONTADOR).TIPO := TIPO_ALFANUMERICO; I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'MATRICULA';                 I_S(vCONTADOR).TAMANHO_IS := 15;  I_S(vCONTADOR).TAMANHO := 15;  I_S(vCONTADOR).TIPO_IS := TIPO_ALFANUMERICO; I_S(vCONTADOR).TIPO := TIPO_ALFANUMERICO; I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'CPF_SERVIDOR';              I_S(vCONTADOR).TAMANHO_IS := 11;  I_S(vCONTADOR).TAMANHO := 11;  I_S(vCONTADOR).TIPO_IS := TIPO_NUMERICO;     I_S(vCONTADOR).TIPO := TIPO_NUMERICO;     I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'CPF_BENEFICIARIO';          I_S(vCONTADOR).TAMANHO_IS := 11;  I_S(vCONTADOR).TAMANHO := 11;  I_S(vCONTADOR).TIPO_IS := TIPO_NUMERICO;     I_S(vCONTADOR).TIPO := TIPO_NUMERICO;     I_S(vCONTADOR).NULO := SIM; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'ADE_NUMERO';                I_S(vCONTADOR).TAMANHO_IS := 10;  I_S(vCONTADOR).TAMANHO := 10;  I_S(vCONTADOR).TIPO_IS := TIPO_NUMERICO;     I_S(vCONTADOR).TIPO := TIPO_NUMERICO;     I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'NUMERO_CARTEIRA';           I_S(vCONTADOR).TAMANHO_IS := 23;  I_S(vCONTADOR).TAMANHO := 23;  I_S(vCONTADOR).TIPO_IS := TIPO_ALFANUMERICO; I_S(vCONTADOR).TIPO := TIPO_ALFANUMERICO; I_S(vCONTADOR).NULO := SIM; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'NUMERO_CONTRATO_OPERADORA'; I_S(vCONTADOR).TAMANHO_IS := 10;  I_S(vCONTADOR).TAMANHO := 10;  I_S(vCONTADOR).TIPO_IS := TIPO_NUMERICO;     I_S(vCONTADOR).TIPO := TIPO_NUMERICO;     I_S(vCONTADOR).NULO := SIM; vCONTADOR := vCONTADOR + 1;

              I_S(vCONTADOR).CAMPO := 'CNPJ_FORNECEDOR';           I_S(vCONTADOR).TAMANHO_IS := 14;  I_S(vCONTADOR).TAMANHO := 14;  I_S(vCONTADOR).TIPO_IS := TIPO_NUMERICO;     I_S(vCONTADOR).TIPO := TIPO_NUMERICO;     I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'CODIGO_VERBA';              I_S(vCONTADOR).TAMANHO_IS :=  4;  I_S(vCONTADOR).TAMANHO :=  4;  I_S(vCONTADOR).TIPO_IS := TIPO_ALFANUMERICO; I_S(vCONTADOR).TIPO := TIPO_ALFANUMERICO; I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'VALOR_VERBA';               I_S(vCONTADOR).TAMANHO_IS := 10;  I_S(vCONTADOR).TAMANHO := 10;  I_S(vCONTADOR).TIPO_IS := TIPO_NUMERICO;     I_S(vCONTADOR).TIPO := TIPO_NUMERICO;     I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'NUMERO_PARCELAS';           I_S(vCONTADOR).TAMANHO_IS :=  3;  I_S(vCONTADOR).TAMANHO :=  3;  I_S(vCONTADOR).TIPO_IS := TIPO_NUMERICO;     I_S(vCONTADOR).TIPO := TIPO_NUMERICO;     I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'DATA_AUTORIZACAO_INICIAL';  I_S(vCONTADOR).TAMANHO_IS := 14;  I_S(vCONTADOR).TAMANHO := 14;  I_S(vCONTADOR).TIPO_IS := TIPO_DATA_HORA;    I_S(vCONTADOR).TIPO := TIPO_DATA_HORA;    I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'DATA_AUTORIZACAO_CORRENTE'; I_S(vCONTADOR).TAMANHO_IS := 14;  I_S(vCONTADOR).TAMANHO := 14;  I_S(vCONTADOR).TIPO_IS := TIPO_DATA_HORA;    I_S(vCONTADOR).TIPO := TIPO_DATA_HORA;    I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'VALOR_DESCONTADO';          I_S(vCONTADOR).TAMANHO_IS := 10;  I_S(vCONTADOR).TAMANHO := 10;  I_S(vCONTADOR).TIPO_IS := TIPO_NUMERICO;     I_S(vCONTADOR).TIPO := TIPO_NUMERICO;     I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'CODIGO_SITUACAO_FUNCIONAL'; I_S(vCONTADOR).TAMANHO_IS :=  2;  I_S(vCONTADOR).TAMANHO :=  2;  I_S(vCONTADOR).TIPO_IS := TIPO_NUMERICO;     I_S(vCONTADOR).TIPO := TIPO_NUMERICO;     I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'FUNDO_REPASSE';             I_S(vCONTADOR).TAMANHO_IS :=  2;  I_S(vCONTADOR).TAMANHO :=  2;  I_S(vCONTADOR).TIPO_IS := TIPO_NUMERICO;     I_S(vCONTADOR).TIPO := TIPO_NUMERICO;     I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;

/*
              I_S(vCONTADOR).CAMPO := 'CODIGO_EMPRESA';               I_S(vCONTADOR).TAMANHO_IS := 10;  I_S(vCONTADOR).TAMANHO := 4;   I_S(vCONTADOR).TIPO_IS := TIPO_NUMERICO;     I_S(vCONTADOR).TIPO := TIPO_NUMERICO;     I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'CODIGO_CONTRATO';              I_S(vCONTADOR).TAMANHO_IS := 10;  I_S(vCONTADOR).TAMANHO := 15;  I_S(vCONTADOR).TIPO_IS := TIPO_ALFANUMERICO; I_S(vCONTADOR).TIPO := TIPO_NUMERICO;     I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'CODIGO_FORNECEDOR';            I_S(vCONTADOR).TAMANHO_IS := 10;  I_S(vCONTADOR).TAMANHO := 15;  I_S(vCONTADOR).TIPO_IS := TIPO_NUMERICO;     I_S(vCONTADOR).TIPO := TIPO_NUMERICO;     I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'CODIGO_VERBA';                 I_S(vCONTADOR).TAMANHO_IS := 10;  I_S(vCONTADOR).TAMANHO := 4;   I_S(vCONTADOR).TIPO_IS := TIPO_ALFANUMERICO; I_S(vCONTADOR).TIPO := TIPO_ALFANUMERICO; I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'VALOR_VERBA';                  I_S(vCONTADOR).TAMANHO_IS := 15;  I_S(vCONTADOR).TAMANHO := 15;  I_S(vCONTADOR).TIPO_IS := TIPO_NUMERICO;     I_S(vCONTADOR).TIPO := TIPO_VALOR;        I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'CONTADOR';                     I_S(vCONTADOR).TAMANHO_IS := 5;   I_S(vCONTADOR).TAMANHO := 5;   I_S(vCONTADOR).TIPO_IS := TIPO_NUMERICO;     I_S(vCONTADOR).TIPO := TIPO_NUMERICO;     I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'REFERENCIA_VERBA';             I_S(vCONTADOR).TAMANHO_IS := 10;  I_S(vCONTADOR).TAMANHO := 10;  I_S(vCONTADOR).TIPO_IS := TIPO_NUMERICO;     I_S(vCONTADOR).TIPO := TIPO_NUMERICO;     I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'DATA_AUTORIZACAO';             I_S(vCONTADOR).TAMANHO_IS := 14;  I_S(vCONTADOR).TAMANHO := 14;  I_S(vCONTADOR).TIPO_IS := TIPO_DATA_HORA;    I_S(vCONTADOR).TIPO := TIPO_DATA_HORA;    I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'TIPO_OPERACAO';                I_S(vCONTADOR).TAMANHO_IS := 1;   I_S(vCONTADOR).TAMANHO := 1;   I_S(vCONTADOR).TIPO_IS := TIPO_ALFANUMERICO; I_S(vCONTADOR).TIPO := TIPO_ALFANUMERICO; I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'CODIGO_CONSIG_ERRO ';          I_S(vCONTADOR).TAMANHO_IS := 2;   I_S(vCONTADOR).TAMANHO := 2;   I_S(vCONTADOR).TIPO_IS := TIPO_NUMERICO;     I_S(vCONTADOR).TIPO := TIPO_NUMERICO;     I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;

              I_S(vCONTADOR).CAMPO := 'NUMERO_GUIA_IPTU';             I_S(vCONTADOR).TAMANHO_IS := 13;  I_S(vCONTADOR).TAMANHO := 13;  I_S(vCONTADOR).TIPO_IS := TIPO_NUMERICO;     I_S(vCONTADOR).TIPO := TIPO_NUMERICO;     I_S(vCONTADOR).NULO := SIM; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'CPF';                          I_S(vCONTADOR).TAMANHO_IS := 11;  I_S(vCONTADOR).TAMANHO := 11;  I_S(vCONTADOR).TIPO_IS := TIPO_NUMERICO;     I_S(vCONTADOR).TIPO := TIPO_NUMERICO;     I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'DATA_CADASTRAMENTO';           I_S(vCONTADOR).TAMANHO_IS := 14;  I_S(vCONTADOR).TAMANHO := 14;  I_S(vCONTADOR).TIPO_IS := TIPO_DATA_HORA;    I_S(vCONTADOR).TIPO := TIPO_DATA_HORA;    I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'NUMERO_CARTEIRA';              I_S(vCONTADOR).TAMANHO_IS := 30;  I_S(vCONTADOR).TAMANHO := 30;  I_S(vCONTADOR).TIPO_IS := TIPO_ALFANUMERICO; I_S(vCONTADOR).TIPO := TIPO_ALFANUMERICO; I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;

*/
          WHEN pTIPO_ARQUIVO = ARQUIVO_MOVIMENTOS_DIRF THEN
              --dbms_output.put_line('PASSOU 1');
              vIS_ARQUIVO.TIPO_ARQUIVO := pTIPO_ARQUIVO;
              vIS_ARQUIVO.DESCRICAO_TIPO_ARQUIVO := 'ARQUIVO_MOVIMENTO_DIRF';
              vIS_ARQUIVO.CARACTERE_SEPARADOR := ';';
              vIS_ARQUIVO.QTDE_CAMPOS := 8;

/*
              vIS_ARQUIVO.TIPO_ARQUIVO := pTIPO_ARQUIVO;
              vIS_ARQUIVO.DESCRICAO_TIPO_ARQUIVO := 'ARQUIVO_MOVIMENTO_DIRF';
              vIS_ARQUIVO.CARACTERE_SEPARADOR := null;
              vIS_ARQUIVO.QTDE_CAMPOS := 14;
*/

              FOR i in 1..vIS_ARQUIVO.QTDE_CAMPOS LOOP
                  I_S.EXTEND(1);
                  I_S(i) := REG_INTERFACE_SOFTWARE(null, null, null, null, null, null, null);
              END LOOP;

              vCONTADOR := 1;

              I_S(vCONTADOR).CAMPO := 'PERIODO_REFERENCIA';           I_S(vCONTADOR).TAMANHO_IS := 8;  I_S(vCONTADOR).TAMANHO := 8;   I_S(vCONTADOR).TIPO_IS := TIPO_DATA;                        I_S(vCONTADOR).TIPO := TIPO_DATA;                    I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'CODIGO_EMPRESA';               I_S(vCONTADOR).TAMANHO_IS := 4;  I_S(vCONTADOR).TAMANHO := 4;   I_S(vCONTADOR).TIPO_IS := TIPO_NUMERICO;                    I_S(vCONTADOR).TIPO := TIPO_NUMERICO;                I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'CODIGO_CONTRATO';              I_S(vCONTADOR).TAMANHO_IS := 15; I_S(vCONTADOR).TAMANHO := 15;  I_S(vCONTADOR).TIPO_IS := TIPO_ALFANUMERICO;                I_S(vCONTADOR).TIPO := TIPO_NUMERICO;                I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'CPF';                          I_S(vCONTADOR).TAMANHO_IS := 11; I_S(vCONTADOR).TAMANHO := 11;  I_S(vCONTADOR).TIPO_IS := TIPO_NUMERICO;                    I_S(vCONTADOR).TIPO := TIPO_NUMERICO;                I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'CNPJ_FORNECEDOR';              I_S(vCONTADOR).TAMANHO_IS := 14; I_S(vCONTADOR).TAMANHO := 14;  I_S(vCONTADOR).TIPO_IS := TIPO_NUMERICO;                    I_S(vCONTADOR).TIPO := TIPO_NUMERICO;                I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'TIPO_BENEFICIO';               I_S(vCONTADOR).TAMANHO_IS := 1;  I_S(vCONTADOR).TAMANHO := 1;   I_S(vCONTADOR).TIPO_IS := TIPO_ALFANUMERICO;                I_S(vCONTADOR).TIPO := TIPO_ALFANUMERICO;            I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'CODIGO_VERBA';                 I_S(vCONTADOR).TAMANHO_IS := 4;  I_S(vCONTADOR).TAMANHO := 4;   I_S(vCONTADOR).TIPO_IS := TIPO_ALFANUMERICO;                I_S(vCONTADOR).TIPO := TIPO_ALFANUMERICO;            I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'VALOR_VERBA';                  I_S(vCONTADOR).TAMANHO_IS := 10; I_S(vCONTADOR).TAMANHO := 10;  I_S(vCONTADOR).TIPO_IS := TIPO_VALOR_SEPARADOR_DECIMAL;     I_S(vCONTADOR).TIPO := TIPO_VALOR_SEPARADOR_DECIMAL; I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;

/*
              I_S(vCONTADOR).CAMPO := 'CODIGO_EMPRESA';               I_S(vCONTADOR).TAMANHO_IS := 10;  I_S(vCONTADOR).TAMANHO := 4;   I_S(vCONTADOR).TIPO_IS := TIPO_NUMERICO;     I_S(vCONTADOR).TIPO := TIPO_NUMERICO;     I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'CODIGO_CONTRATO';              I_S(vCONTADOR).TAMANHO_IS := 10;  I_S(vCONTADOR).TAMANHO := 15;  I_S(vCONTADOR).TIPO_IS := TIPO_ALFANUMERICO; I_S(vCONTADOR).TIPO := TIPO_NUMERICO;     I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'CODIGO_FORNECEDOR';            I_S(vCONTADOR).TAMANHO_IS := 10;  I_S(vCONTADOR).TAMANHO := 15;  I_S(vCONTADOR).TIPO_IS := TIPO_NUMERICO;     I_S(vCONTADOR).TIPO := TIPO_NUMERICO;     I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'CODIGO_VERBA';                 I_S(vCONTADOR).TAMANHO_IS := 10;  I_S(vCONTADOR).TAMANHO := 4;   I_S(vCONTADOR).TIPO_IS := TIPO_ALFANUMERICO; I_S(vCONTADOR).TIPO := TIPO_ALFANUMERICO; I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'VALOR_VERBA';                  I_S(vCONTADOR).TAMANHO_IS := 15;  I_S(vCONTADOR).TAMANHO := 15;  I_S(vCONTADOR).TIPO_IS := TIPO_NUMERICO;     I_S(vCONTADOR).TIPO := TIPO_VALOR;        I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'CONTADOR';                     I_S(vCONTADOR).TAMANHO_IS := 5;   I_S(vCONTADOR).TAMANHO := 5;   I_S(vCONTADOR).TIPO_IS := TIPO_NUMERICO;     I_S(vCONTADOR).TIPO := TIPO_NUMERICO;     I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'REFERENCIA_VERBA';             I_S(vCONTADOR).TAMANHO_IS := 10;  I_S(vCONTADOR).TAMANHO := 10;  I_S(vCONTADOR).TIPO_IS := TIPO_NUMERICO;     I_S(vCONTADOR).TIPO := TIPO_NUMERICO;     I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'DATA_AUTORIZACAO';             I_S(vCONTADOR).TAMANHO_IS := 14;  I_S(vCONTADOR).TAMANHO := 14;  I_S(vCONTADOR).TIPO_IS := TIPO_DATA_HORA;    I_S(vCONTADOR).TIPO := TIPO_DATA_HORA;    I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'TIPO_OPERACAO';                I_S(vCONTADOR).TAMANHO_IS := 1;   I_S(vCONTADOR).TAMANHO := 1;   I_S(vCONTADOR).TIPO_IS := TIPO_ALFANUMERICO; I_S(vCONTADOR).TIPO := TIPO_ALFANUMERICO; I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'CODIGO_CONSIG_ERRO ';          I_S(vCONTADOR).TAMANHO_IS := 2;   I_S(vCONTADOR).TAMANHO := 2;   I_S(vCONTADOR).TIPO_IS := TIPO_NUMERICO;     I_S(vCONTADOR).TIPO := TIPO_NUMERICO;     I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;

              I_S(vCONTADOR).CAMPO := 'NUMERO_GUIA_IPTU';             I_S(vCONTADOR).TAMANHO_IS := 13;  I_S(vCONTADOR).TAMANHO := 13;  I_S(vCONTADOR).TIPO_IS := TIPO_NUMERICO;     I_S(vCONTADOR).TIPO := TIPO_NUMERICO;     I_S(vCONTADOR).NULO := SIM; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'CPF';                          I_S(vCONTADOR).TAMANHO_IS := 11;  I_S(vCONTADOR).TAMANHO := 11;  I_S(vCONTADOR).TIPO_IS := TIPO_NUMERICO;     I_S(vCONTADOR).TIPO := TIPO_NUMERICO;     I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'DATA_CADASTRAMENTO';           I_S(vCONTADOR).TAMANHO_IS := 14;  I_S(vCONTADOR).TAMANHO := 14;  I_S(vCONTADOR).TIPO_IS := TIPO_DATA_HORA;    I_S(vCONTADOR).TIPO := TIPO_DATA_HORA;    I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'NUMERO_CARTEIRA';              I_S(vCONTADOR).TAMANHO_IS := 30;  I_S(vCONTADOR).TAMANHO := 30;  I_S(vCONTADOR).TIPO_IS := TIPO_ALFANUMERICO; I_S(vCONTADOR).TIPO := TIPO_ALFANUMERICO; I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;
*/
          WHEN pTIPO_ARQUIVO = ARQUIVO_TABELA_VALORES_PS THEN

              BEGIN
                   --CABECALHO INVALIDO. FALHA NA RECUPERACAO DA INFORMACAO. NO_DATA_FOUND
                   select LINHA
                     into vPRIMEIRA_LINHA
                     from RHPBH_ARQUIVO_LINHA
                    where ID_ARQUIVO = pID_ARQUIVO
                      and NUMERO_LINHA = 1;

                    IF (vPRIMEIRA_LINHA IS NULL OR TRIM(vPRIMEIRA_LINHA) IS NULL) THEN
                       dbms_output.put_line('CABECALHO INVALIDO. LINHA NULA.');
                       raise_application_error (-20001,'CABECALHO INVALIDO. LINHA NULA.');
                    END IF;

                    BEGIN
                         vDATA_ANO_MES_REFERENCIA := TO_DATE(vPRIMEIRA_LINHA, 'DD/MM/YYYY');
                    EXCEPTION
                    WHEN OTHERS THEN
                         dbms_output.put_line('CABECALHO INVALIDO. DATA INVALIDA.');
                         raise_application_error (-20001,'CABECALHO INVALIDO. DATA INVALIDA.');
                    END;
                    vQTDE_REPETICOES_REGISTROS := 0;


                    BEGIN
                         select COUNT(1)
                           into vQTDE_REPETICOES_REGISTROS
                           from RHPBH_PS_PLANOS
                          where ANO_MES_REFERENCIA = (select max(ANO_MES_REFERENCIA)
                                                        from RHPBH_PS_PLANOS
                                                       where ANO_MES_REFERENCIA <= vDATA_ANO_MES_REFERENCIA
                                    );
                    EXCEPTION
                    WHEN OTHERS THEN
                         vQTDE_REPETICOES_REGISTROS := 0;
                         dbms_output.put_line('FALHA AO RECUPERAR PLANOS PARA A TABELA DE VALORES DE PLANO DE SAUDE.');
                         raise_application_error (-20001,'FALHA AO RECUPERAR PLANOS PARA A TABELA DE VALORES DE PLANO DE SAUDE.');
                    END;

              EXCEPTION
              WHEN NO_DATA_FOUND THEN
                   dbms_output.put_line('CABECALHO INVALIDO. FALHA NA RECUPERACAO DA INFORMACAO. NO_DATA_FOUND');
                   raise_application_error (-20001,'CABECALHO INVALIDO. FALHA NA RECUPERACAO DA INFORMACAO. NO_DATA_FOUND');
              WHEN OTHERS THEN
                   dbms_output.put_line('CABECALHO INVALIDO. FALHA NA RECUPERACAO DA INFORMACAO.');
                   raise_application_error (-20001,'CABECALHO INVALIDO. FALHA NA RECUPERACAO DA INFORMACAO.');
              END;


              vIS_ARQUIVO.TIPO_ARQUIVO := pTIPO_ARQUIVO;
              vIS_ARQUIVO.DESCRICAO_TIPO_ARQUIVO := 'ARQUIVO_MENSALIDADE_PS';
              vIS_ARQUIVO.CARACTERE_SEPARADOR := ';';
              vIS_ARQUIVO.QTDE_CAMPOS := 3 + vQTDE_REPETICOES_REGISTROS;

              FOR i in 1..vIS_ARQUIVO.QTDE_CAMPOS LOOP
                  I_S.EXTEND(1);
                  I_S(i) := REG_INTERFACE_SOFTWARE(null, null, null, null, null, null, null);
              END LOOP;

              vCONTADOR := 1;

              I_S(vCONTADOR).CAMPO := 'TIPO_REGISTRO';                I_S(vCONTADOR).TAMANHO_IS := 30;  I_S(vCONTADOR).TAMANHO := 30;   I_S(vCONTADOR).TIPO_IS := TIPO_ALFANUMERICO;                I_S(vCONTADOR).TIPO := TIPO_ALFANUMERICO;            I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;
              --I_S(vCONTADOR).CAMPO := 'ANO_MES_REFERENCIA';           I_S(vCONTADOR).TAMANHO_IS := 8;  I_S(vCONTADOR).TAMANHO := 8;   I_S(vCONTADOR).TIPO_IS := TIPO_DATA;                        I_S(vCONTADOR).TIPO := TIPO_DATA;                    I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'FAIXA_SALARIAL';               I_S(vCONTADOR).TAMANHO_IS := 30;  I_S(vCONTADOR).TAMANHO := 30;   I_S(vCONTADOR).TIPO_IS := TIPO_ALFANUMERICO;                I_S(vCONTADOR).TIPO := TIPO_ALFANUMERICO;            I_S(vCONTADOR).NULO := SIM; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'FAIXA_ETARIA';                 I_S(vCONTADOR).TAMANHO_IS := 30; I_S(vCONTADOR).TAMANHO := 30;  I_S(vCONTADOR).TIPO_IS := TIPO_ALFANUMERICO;                I_S(vCONTADOR).TIPO := TIPO_ALFANUMERICO;            I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;

              FOR i in 1..vQTDE_REPETICOES_REGISTROS LOOP
                  I_S(vCONTADOR).CAMPO := 'VALOR';                    I_S(vCONTADOR).TAMANHO_IS := 10; I_S(vCONTADOR).TAMANHO := 10;  I_S(vCONTADOR).TIPO_IS := TIPO_VALOR_SEPARADOR_DECIMAL;     I_S(vCONTADOR).TIPO := TIPO_VALOR_SEPARADOR_DECIMAL; I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;
              END LOOP;
     /* Gabriel em 13/12/2023 validação de layout do arquivo de locais dupla lotacao */   
       WHEN pTIPO_ARQUIVO = ARQUIVO_DUPLA_LOTACAO THEN
              --dbms_output.put_line('PASSOU 1');
              vIS_ARQUIVO.TIPO_ARQUIVO := pTIPO_ARQUIVO;
              vIS_ARQUIVO.DESCRICAO_TIPO_ARQUIVO := 'ARQUIVO_DUPLA_LOTACAO';
              vIS_ARQUIVO.CARACTERE_SEPARADOR := ';';
              vIS_ARQUIVO.QTDE_CAMPOS := 8;


              FOR i in 1..vIS_ARQUIVO.QTDE_CAMPOS LOOP
                  I_S.EXTEND(1);
                  I_S(i) := REG_INTERFACE_SOFTWARE(null, null, null, null, null, null, null);
              END LOOP;

              vCONTADOR := 1;

              I_S(vCONTADOR).CAMPO := 'ACAO';                          I_S(vCONTADOR).TAMANHO_IS := 1;  I_S(vCONTADOR).TAMANHO := 1;   I_S(vCONTADOR).TIPO_IS := TIPO_ALFANUMERICO;                        I_S(vCONTADOR).TIPO := TIPO_ALFANUMERICO;                    I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'CODIGO_OPUS_PAI';               I_S(vCONTADOR).TAMANHO_IS := 41;  I_S(vCONTADOR).TAMANHO := 41;   I_S(vCONTADOR).TIPO_IS := TIPO_ALFANUMERICO;                    I_S(vCONTADOR).TIPO := TIPO_ALFANUMERICO;                I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'CODIGO_DUPLA_LOTACAO_DE';       I_S(vCONTADOR).TAMANHO_IS := 41; I_S(vCONTADOR).TAMANHO := 41;  I_S(vCONTADOR).TIPO_IS := TIPO_ALFANUMERICO;                I_S(vCONTADOR).TIPO := TIPO_ALFANUMERICO;                I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'DESCRICAO_DE';                  I_S(vCONTADOR).TAMANHO_IS := 100; I_S(vCONTADOR).TAMANHO := 100;  I_S(vCONTADOR).TIPO_IS := TIPO_ALFANUMERICO;                    I_S(vCONTADOR).TIPO := TIPO_ALFANUMERICO;                I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'ABREVICAO_DE';                  I_S(vCONTADOR).TAMANHO_IS := 15; I_S(vCONTADOR).TAMANHO := 15;  I_S(vCONTADOR).TIPO_IS := TIPO_ALFANUMERICO;                    I_S(vCONTADOR).TIPO := TIPO_ALFANUMERICO;                I_S(vCONTADOR).NULO := NAO; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'CODIGO_DUPLA_LOTACAO_PARA';     I_S(vCONTADOR).TAMANHO_IS := 41;  I_S(vCONTADOR).TAMANHO := 41;   I_S(vCONTADOR).TIPO_IS := TIPO_ALFANUMERICO;                I_S(vCONTADOR).TIPO := TIPO_ALFANUMERICO;            I_S(vCONTADOR).NULO := SIM; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'DESCRICAO_PARA';                  I_S(vCONTADOR).TAMANHO_IS := 100;  I_S(vCONTADOR).TAMANHO := 100;   I_S(vCONTADOR).TIPO_IS := TIPO_ALFANUMERICO;                I_S(vCONTADOR).TIPO := TIPO_ALFANUMERICO;            I_S(vCONTADOR).NULO := SIM; vCONTADOR := vCONTADOR + 1;
              I_S(vCONTADOR).CAMPO := 'ABREVICAO_PARA';                   I_S(vCONTADOR).TAMANHO_IS := 15; I_S(vCONTADOR).TAMANHO := 15;  I_S(vCONTADOR).TIPO_IS := TIPO_ALFANUMERICO;     I_S(vCONTADOR).TIPO := TIPO_ALFANUMERICO; I_S(vCONTADOR).NULO := SIM; vCONTADOR := vCONTADOR + 1;

        
        
        
        
          ELSE vIS_ARQUIVO := NULL;

     END CASE;

     dbms_output.put_line('PASSOU 2' || vIS_ARQUIVO.QTDE_CAMPOS || I_S.count);
    -- calculando tamanho máximo da linha
    vTAMANHO_MAXIMO_LINHA := 0;
    FOR i in 1..I_S.count LOOP
        vTAMANHO_MAXIMO_LINHA := vTAMANHO_MAXIMO_LINHA + I_S(i).TAMANHO_IS;
    END LOOP;
    --dbms_output.put_line('PASSOU 1');
    vIS_ARQUIVO.TAMANHO_MAXIMO_LINHA := vTAMANHO_MAXIMO_LINHA;

    vIS_ARQUIVO.INTERFACE := I_S;

    RETURN vIS_ARQUIVO;
END;

PROCEDURE GRAVA_LOG(CodigoEmpresa IN CHAR, CategoriaLog IN NUMBER, TipoLog IN NUMBER, IdArquivo IN NUMBER, Numero_linha IN NUMBER, CodigoLog IN CHAR, DetalheLog IN VARCHAR2) AS
BEGIN
     INSERT INTO RHPBH_ARQUIVO_LOG(ID_LOG, DATA_LOG, CATEGORIA, TIPO, ID_ARQUIVO, NUMERO_LINHA, CODIGO_LOG, DETALHE, CODIGO_EMPRESA)
     values (SQ_RHPBH_PS_IMPORTACAO_LOG.NEXTVAL, sysdate, CategoriaLog, TipoLog, IdArquivo, Numero_linha, CodigoLog, DetalheLog, CodigoEmpresa);
END;

begin

    -- Verifica se o identificador de arquivo informado é válido
    BEGIN
         vID_ARQUIVO := null;
         select ID_ARQUIVO, TIPO_ARQUIVO into vID_ARQUIVO, vTIPO_ARQUIVO from RHPBH_ARQUIVO where ID_ARQUIVO = IDENTIFICADOR_ARQUIVO;

         IF vID_ARQUIVO IS NULL THEN
            raise_application_error (-20001,'IDENTIFICADOR_ARQUIVO INVALIDO.');
         END IF;
    EXCEPTION
    WHEN OTHERS THEN
       --dbms_output.put_line('ENCONTRADO ERRO - '||SQLCODE||' -ERROR- '||SQLERRM);
       raise_application_error (-20002,'IDENTIFICADOR_ARQUIVO INVALIDO.');
    END;


  vCONTADOR := 0;
  vDATA_PROCESSAMENTO := sysdate;
  vCATEGORIA_LOG := CATEGORIA_LOG_LEIAUTE;

  BEGIN
    vINTERFACE_ARQUIVO := OBTER_INTERFACE(vTIPO_ARQUIVO, IDENTIFICADOR_ARQUIVO);
    --dbms_output.put_line('OBTER_INTERFACE(vTIPO_ARQUIVO)' || vTIPO_ARQUIVO);
    IF vINTERFACE_ARQUIVO IS NULL or vINTERFACE_ARQUIVO.INTERFACE IS NULL THEN
       raise_application_error (-20002,'NAO FOI POSSIVEL RECUPERAR O LEIAUTE DO ARQUIVO.');
    END IF;
  EXCEPTION
  WHEN OTHERS THEN
       raise_application_error (-20002,'HOUVE UM ERRO AO TENTAR RECUPERAR O LEIAUTE DO ARQUIVO.');
  END;

for C1 in (

select RHPBH_ARQUIVO.CODIGO_EMPRESA, RHPBH_ARQUIVO_LINHA.ID_ARQUIVO, RHPBH_ARQUIVO_LINHA.NUMERO_LINHA, RHPBH_ARQUIVO_LINHA.LINHA, RHPBH_ARQUIVO_LINHA.SITUACAO
  from RHPBH_ARQUIVO_LINHA, RHPBH_ARQUIVO
 where RHPBH_ARQUIVO_LINHA.ID_ARQUIVO = RHPBH_ARQUIVO.ID_ARQUIVO
   and RHPBH_ARQUIVO.ID_ARQUIVO = IDENTIFICADOR_ARQUIVO
   and RHPBH_ARQUIVO_LINHA.NUMERO_LINHA > (CASE WHEN vTIPO_ARQUIVO = ARQUIVO_TABELA_VALORES_PS THEN 1 ELSE 0 END)
   --and rownum <= 10
 order by NUMERO_LINHA

          )
loop
    --dbms_output.put_line('PASSO -1');
    --dbms_output.put_line(C1.LINHA);
    BEGIN

    vRETORNO := FU_VALIDAR_LINHA_ARQUIVO(vINTERFACE_ARQUIVO, C1.LINHA);

    EXCEPTION
    WHEN OTHERS THEN
       --dbms_output.put_line('C1.ID_ARQUIVO '||C1.ID_ARQUIVO);
       --dbms_output.put_line('C1.NUMERO_LINHA '||C1.NUMERO_LINHA);
       --dbms_output.put_line('C1.LINHA '||C1.LINHA);
       --dbms_output.put_line('ENCONTRADO ERRO - '||SQLCODE||' -ERROR- '||SQLERRM);
       raise_application_error (-20002,'ERRO NA CHAMADA A FUNCAO FU_VALIDAR_LINHA_ARQUIVO ' || 'ENCONTRADO ERRO - '||SQLCODE||' -ERROR- '||SQLERRM);
    END;
    vSITUACAO_ATUALIZADA := '01';

    --dbms_output.put_line('PASSO -1 RETORNO');
    vLISTA_LOG := LISTA_LOG();
    vLISTA_LOG := vRETORNO.LISTA_LOG_RETORNO;
    --dbms_output.put_line(vLISTA_LOG.count);

    --dbms_output.put_line('PASSO 0');
    IF vLISTA_LOG.count = 0 THEN
       --dbms_output.put_line('PASSO 1');
      vSITUACAO_ATUALIZADA := '01';

    ELSE
    --dbms_output.put_line('PASSO 2');
        for i in 1..vLISTA_LOG.count loop
            REG_LOG := vLISTA_LOG(i);
            --dbms_output.put_line(REG_LOG.TIPO_LOG || REG_LOG.DESCRICAO_LOG || REG_LOG.DETALHE_LOG || C1.NUMERO_LINHA || C1.LINHA);
            GRAVA_LOG(C1.CODIGO_EMPRESA, vCATEGORIA_LOG, REG_LOG.TIPO_LOG, C1.ID_ARQUIVO, C1.NUMERO_LINHA, REG_LOG.CODIGO_LOG, REG_LOG.DETALHE_LOG);
        end loop;
        vSITUACAO_ATUALIZADA := '99';

    END IF;
--dbms_output.put_line('PASSO 3');
        /*
      update RHPBH_ARQUIVO_LINHA
         set SITUACAO = vSITUACAO_ATUALIZADA
       where ID_ARQUIVO = C1.ID_ARQUIVO
         and NUMERO_LINHA = C1.NUMERO_LINHA
         and SITUACAO = C1.SITUACAO;
--dbms_output.put_line('PASSO 4');
*/

    IF MOD(vCONTADOR,1000) = 0 THEN
       COMMIT;
    END IF;

    vCONTADOR := vCONTADOR + 1;
end loop;
    COMMIT;
--dbms_output.put_line('PROCESSAMENTO FINALIZADO.');
--dbms_output.put_line('REGISTROS PROCESSADOS = ' || vCONTADOR);
end;