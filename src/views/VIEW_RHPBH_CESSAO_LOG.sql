
  CREATE OR REPLACE FORCE EDITIONABLE VIEW "ARTERH"."VIEW_RHPBH_CESSAO_LOG" ("ID", "DATA_LOG", "ACAO", "CODIGO_EMPRESA", "TIPO_CONTRATO", "CODIGO_CONTRATO", "DATA_INICIO_CESSAO", "DATA_TERMINO_CESSAO_ANTIGO", "DATA_TERMINO_CESSAO_NOVO", "TIPO_CESSAO_ANTIGO", "TIPO_CESSAO_NOVO", "TP_INSCRICAO_CEDENTE_ANTIGO", "TP_INSCRICAO_CEDENTE_NOVO", "NRO_INSCRICAO_CEDENTE_ANTIGO", "NRO_INSCRICAO_CEDENTE_NOVO", "MATRICULA_CEDENTE_ANTIGO", "MATRICULA_CEDENTE_NOVO", "DT_ADMISSAO_CEDENTE_NOVO", "INFO_ONUS_ANTIGO", "INFO_ONUS_NOVO", "CODIGO_CARGO_ORIGEM_ANTIGO", "CODIGO_CARGO_ORIGEM_NOVO", "COD_CATEG_ORIGEM_ANTIGO", "COD_CATEG_ORIGEM_NOVO", "TP_REGIME_TRAB_CEDENTE_ANTIGO", "TP_REGIME_TRAB_CEDENTE_NOVO", "LOGIN_USUARIO_ANTIGO", "LOGIN_USUARIO_NOVO", "DT_ULT_ALTER_USUA") AS 
  SELECT ID,
TO_CHAR(DATA_LOG,'DD/MM/YYYY HH24:MI:SS') AS DATA_LOG,
DECODE(ACAO,'I','Inseriu','U','Atualizou','D','Excluiu')ACAO,
CODIGO_EMPRESA,
TIPO_CONTRATO,
CODIGO_CONTRATO,
TO_CHAR(DATA_INICIO_CESSAO,'DD/MM/YYYY')DATA_INICIO_CESSAO,
CASE WHEN DATA_TERMINO_CESSAO_ANTIGO IS NULL THEN 'SEM VALOR' ELSE TO_CHAR(DATA_TERMINO_CESSAO_ANTIGO,'DD/MM/YYYY') END AS  DATA_TERMINO_CESSAO_ANTIGO,
CASE WHEN DATA_TERMINO_CESSAO_NOVO IS NULL THEN 'SEM VALOR' ELSE TO_CHAR(DATA_TERMINO_CESSAO_NOVO,'DD/MM/YYYY') END AS  DATA_TERMINO_CESSAO_NOVO,
CASE WHEN TIPO_CESSAO_ANTIGO IS NULL THEN 'SEM VALOR' ELSE TIPO_CESSAO_ANTIGO END AS TIPO_CESSAO_ANTIGO,
CASE WHEN TIPO_CESSAO_NOVO IS NULL THEN 'SEM VALOR' ELSE TIPO_CESSAO_ANTIGO END AS TIPO_CESSAO_NOVO,
CASE WHEN TP_INSCRICAO_CEDENTE_ANTIGO IS NULL THEN 'SEM VALOR' ELSE TP_INSCRICAO_CEDENTE_ANTIGO END AS TP_INSCRICAO_CEDENTE_ANTIGO,
CASE WHEN TP_INSCRICAO_CEDENTE_NOVO IS NULL THEN 'SEM VALOR' ELSE TP_INSCRICAO_CEDENTE_NOVO END AS TP_INSCRICAO_CEDENTE_NOVO,
CASE WHEN NRO_INSCRICAO_CEDENTE_ANTIGO IS NULL THEN 'SEM VALOR' ELSE TO_CHAR (NRO_INSCRICAO_CEDENTE_ANTIGO) END AS NRO_INSCRICAO_CEDENTE_ANTIGO,
CASE WHEN NRO_INSCRICAO_CEDENTE_NOVO IS NULL THEN 'SEM VALOR' ELSE TO_CHAR (NRO_INSCRICAO_CEDENTE_NOVO) END AS NRO_INSCRICAO_CEDENTE_NOVO,
CASE WHEN MATRICULA_CEDENTE_ANTIGO IS NULL THEN 'SEM VALOR' ELSE TO_CHAR(MATRICULA_CEDENTE_ANTIGO) END AS MATRICULA_CEDENTE_ANTIGO,
CASE WHEN MATRICULA_CEDENTE_NOVO IS NULL THEN 'SEM VALOR' ELSE TO_CHAR(MATRICULA_CEDENTE_NOVO) END AS MATRICULA_CEDENTE_NOVO,
CASE WHEN DT_ADMISSAO_CEDENTE_NOVO IS NULL THEN 'SEM VALOR' ELSE DT_ADMISSAO_CEDENTE_NOVO END  AS  DT_ADMISSAO_CEDENTE_NOVO,
CASE WHEN INFO_ONUS_ANTIGO IS NULL THEN 'SEM VALOR' ELSE TO_CHAR(INFO_ONUS_ANTIGO) END AS  INFO_ONUS_ANTIGO,
CASE WHEN INFO_ONUS_NOVO IS NULL THEN 'SEM VALOR' ELSE TO_CHAR(INFO_ONUS_NOVO) END AS  INFO_ONUS_NOVO,
CASE WHEN CODIGO_CARGO_ORIGEM_ANTIGO IS NULL THEN 'SEM VALOR' ELSE TO_CHAR(CODIGO_CARGO_ORIGEM_ANTIGO) END AS  CODIGO_CARGO_ORIGEM_ANTIGO,
CASE WHEN CODIGO_CARGO_ORIGEM_NOVO IS NULL THEN 'SEM VALOR' ELSE TO_CHAR(CODIGO_CARGO_ORIGEM_NOVO) END AS  CODIGO_CARGO_ORIGEM_NOVO,
CASE WHEN COD_CATEG_ORIGEM_ANTIGO IS NULL THEN 'SEM VALOR' ELSE TO_CHAR(COD_CATEG_ORIGEM_ANTIGO) END AS  COD_CATEG_ORIGEM_ANTIGO,
CASE WHEN COD_CATEG_ORIGEM_NOVO IS NULL THEN 'SEM VALOR' ELSE TO_CHAR(COD_CATEG_ORIGEM_NOVO) END AS  COD_CATEG_ORIGEM_NOVO,
CASE WHEN TP_REGIME_TRAB_CEDENTE_ANTIGO IS NULL THEN 'SEM VALOR' ELSE TO_CHAR(TP_REGIME_TRAB_CEDENTE_ANTIGO) END AS  TP_REGIME_TRAB_CEDENTE_ANTIGO,
CASE WHEN TP_REGIME_TRAB_CEDENTE_NOVO IS NULL THEN 'SEM VALOR' ELSE TO_CHAR(TP_REGIME_TRAB_CEDENTE_NOVO) END AS  TP_REGIME_TRAB_CEDENTE_NOVO,
CASE WHEN LOGIN_USUARIO_ANTIGO IS NULL THEN 'SEM VALOR' ELSE TO_CHAR(LOGIN_USUARIO_ANTIGO) END AS  LOGIN_USUARIO_ANTIGO,
CASE WHEN LOGIN_USUARIO_NOVO IS NULL THEN 'SEM VALOR' ELSE TO_CHAR(LOGIN_USUARIO_NOVO) END AS  LOGIN_USUARIO_NOVO,
TO_CHAR(DT_ULT_ALTER_USUA,'DD/MM/YYYY  HH24:MI:SS')DT_ULT_ALTER_USUA
FROM ARTERH.RHPBH_CESSAO_LOG WHERE TRUNC(DATA_LOG) BETWEEN TRUNC(SYSDATE-8) AND TRUNC(SYSDATE-1) 
order by id,tipo_contrato,codigo_empresa,codigo_contrato,DATA_INICIO_CESSAO asc