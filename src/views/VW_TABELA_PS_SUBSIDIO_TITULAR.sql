
  CREATE OR REPLACE FORCE EDITIONABLE VIEW "ARTERH"."VW_TABELA_PS_SUBSIDIO_TITULAR" ("CODIGO_PLANO", "FAIXA_SALARIAL", "CODIGO_FAIXA_SALARIAL", "FAIXA_ETARIA", "VALOR", "ANO_MES_REF") AS 
  select ( select CODIGO
           from RHBENF_BENEFICIO,
           (
            select DADO_ORIGEM, DADO_DESTINO
              from RHINTE_ED_IT_CONV
             where CODIGO_CONVERSAO = 'PS06'
           ) CONVERSAO_CODIGO_BENEFICIO
          where RHBENF_BENEFICIO.CODIGO = CONVERSAO_CODIGO_BENEFICIO.DADO_DESTINO
            and CONVERSAO_CODIGO_BENEFICIO.DADO_ORIGEM = '000000000002105'
       ) AS CODIGO_PLANO,
       FAIXA_SALARIAL.VALNUM AS FAIXA_SALARIAL,
       CODIGO_FAIXA_SALARIAL.VALNUM AS CODIGO_FAIXA_SALARIAL,
       FAIXA_ETARIA.VALNUM AS FAIXA_ETARIA,
       VALOR.VALNUM AS VALOR,
       VALOR.ANO_MES_REF AS ANO_MES_REF
  from
(
select VPNUM.*
  from RHPESS_TABELAS VP, RHPESS_VALNUM VPNUM
 where VP.CODIGO_TABELA = VPNUM.CODIGO_TABELA
   and VPNUM.CODIGO_TABELA = '000000000008002'
   and VPNUM.NRO_COLUNA = 2
) FAIXA_SALARIAL,
(
select VPNUM.*
  from RHPESS_TABELAS VP, RHPESS_VALNUM VPNUM
 where VP.CODIGO_TABELA = VPNUM.CODIGO_TABELA
   and VPNUM.CODIGO_TABELA = '000000000008002'
   and VPNUM.NRO_COLUNA = 4
) CODIGO_FAIXA_SALARIAL,
(
select VPNUM.*
  from RHPESS_TABELAS VP, RHPESS_VALNUM VPNUM
 where VP.CODIGO_TABELA = VPNUM.CODIGO_TABELA
   and VPNUM.CODIGO_TABELA = '000000000008002'
   and VPNUM.NRO_COLUNA = 3
) FAIXA_ETARIA,
(
select VPNUM.*
  from RHPESS_TABELAS VP, RHPESS_VALNUM VPNUM
 where VP.CODIGO_TABELA = VPNUM.CODIGO_TABELA
   and VPNUM.CODIGO_TABELA = '000000000008002'
   and VPNUM.NRO_COLUNA = 6
) VALOR
where FAIXA_ETARIA.CODIGO_TABELA = VALOR.CODIGO_TABELA
  and FAIXA_ETARIA.NRO_LINHA = VALOR.NRO_LINHA
  and FAIXA_ETARIA.ANO_MES_REF = VALOR.ANO_MES_REF
  and FAIXA_SALARIAL.CODIGO_TABELA = VALOR.CODIGO_TABELA
  and FAIXA_SALARIAL.NRO_LINHA = VALOR.NRO_LINHA
  and FAIXA_SALARIAL.ANO_MES_REF = VALOR.ANO_MES_REF
  and CODIGO_FAIXA_SALARIAL.CODIGO_TABELA = VALOR.CODIGO_TABELA
  and CODIGO_FAIXA_SALARIAL.NRO_LINHA = VALOR.NRO_LINHA
  and CODIGO_FAIXA_SALARIAL.ANO_MES_REF = VALOR.ANO_MES_REF

union

/* PLANO 3 - CODIGO 000000000002106 - VALOR NA COLUNA 7 DA TABELA 000000000008002 */
select ( select CODIGO
           from RHBENF_BENEFICIO,
           (
            select DADO_ORIGEM, DADO_DESTINO
              from RHINTE_ED_IT_CONV
             where CODIGO_CONVERSAO = 'PS06'
           ) CONVERSAO_CODIGO_BENEFICIO
          where RHBENF_BENEFICIO.CODIGO = CONVERSAO_CODIGO_BENEFICIO.DADO_DESTINO
            and CONVERSAO_CODIGO_BENEFICIO.DADO_ORIGEM = '000000000002106'
       ) AS CODIGO_PLANO,
       FAIXA_SALARIAL.VALNUM AS FAIXA_SALARIAL,
       CODIGO_FAIXA_SALARIAL.VALNUM AS CODIGO_FAIXA_SALARIAL,
       FAIXA_ETARIA.VALNUM AS FAIXA_ETARIA,
       VALOR.VALNUM AS VALOR,
       VALOR.ANO_MES_REF AS ANO_MES_REF
  from
(
select VPNUM.*
  from RHPESS_TABELAS VP, RHPESS_VALNUM VPNUM
 where VP.CODIGO_TABELA = VPNUM.CODIGO_TABELA
   and VPNUM.CODIGO_TABELA = '000000000008002'
   and VPNUM.NRO_COLUNA = 2
) FAIXA_SALARIAL,
(
select VPNUM.*
  from RHPESS_TABELAS VP, RHPESS_VALNUM VPNUM
 where VP.CODIGO_TABELA = VPNUM.CODIGO_TABELA
   and VPNUM.CODIGO_TABELA = '000000000008002'
   and VPNUM.NRO_COLUNA = 4
) CODIGO_FAIXA_SALARIAL,
(
select VPNUM.*
  from RHPESS_TABELAS VP, RHPESS_VALNUM VPNUM
 where VP.CODIGO_TABELA = VPNUM.CODIGO_TABELA
   and VPNUM.CODIGO_TABELA = '000000000008002'
   and VPNUM.NRO_COLUNA = 3
) FAIXA_ETARIA,
(
select VPNUM.*
  from RHPESS_TABELAS VP, RHPESS_VALNUM VPNUM
 where VP.CODIGO_TABELA = VPNUM.CODIGO_TABELA
   and VPNUM.CODIGO_TABELA = '000000000008002'
   and VPNUM.NRO_COLUNA = 7
   and VPNUM.ANO_MES_REF = (select max(ANO_MES_REF)
                              from RHPESS_VALNUM VPNUM_AUX
                             where VPNUM_AUX.CODIGO_TABELA = VPNUM.CODIGO_TABELA
                               and VPNUM_AUX.NRO_COLUNA = VPNUM.NRO_COLUNA
                               and VPNUM.ANO_MES_REF <= sysdate
                           ) order by NRO_LINHA
) VALOR
where FAIXA_ETARIA.CODIGO_TABELA = VALOR.CODIGO_TABELA
  and FAIXA_ETARIA.NRO_LINHA = VALOR.NRO_LINHA
  and FAIXA_ETARIA.ANO_MES_REF = VALOR.ANO_MES_REF
  and FAIXA_SALARIAL.CODIGO_TABELA = VALOR.CODIGO_TABELA
  and FAIXA_SALARIAL.NRO_LINHA = VALOR.NRO_LINHA
  and FAIXA_SALARIAL.ANO_MES_REF = VALOR.ANO_MES_REF
  and CODIGO_FAIXA_SALARIAL.CODIGO_TABELA = VALOR.CODIGO_TABELA
  and CODIGO_FAIXA_SALARIAL.NRO_LINHA = VALOR.NRO_LINHA
  and CODIGO_FAIXA_SALARIAL.ANO_MES_REF = VALOR.ANO_MES_REF

union

/* PLANO 4 - CODIGO 000000000002107 - VALOR NA COLUNA 8 DA TABELA 000000000008002 */
select ( select CODIGO
           from RHBENF_BENEFICIO,
           (
            select DADO_ORIGEM, DADO_DESTINO
              from RHINTE_ED_IT_CONV
             where CODIGO_CONVERSAO = 'PS06'
           ) CONVERSAO_CODIGO_BENEFICIO
          where RHBENF_BENEFICIO.CODIGO = CONVERSAO_CODIGO_BENEFICIO.DADO_DESTINO
            and CONVERSAO_CODIGO_BENEFICIO.DADO_ORIGEM = '000000000002107'
       ) AS CODIGO_PLANO,
       FAIXA_SALARIAL.VALNUM AS FAIXA_SALARIAL,
       CODIGO_FAIXA_SALARIAL.VALNUM AS CODIGO_FAIXA_SALARIAL,
       FAIXA_ETARIA.VALNUM AS FAIXA_ETARIA,
       VALOR.VALNUM AS VALOR,
       VALOR.ANO_MES_REF AS ANO_MES_REF
  from
(
select VPNUM.*
  from RHPESS_TABELAS VP, RHPESS_VALNUM VPNUM
 where VP.CODIGO_TABELA = VPNUM.CODIGO_TABELA
   and VPNUM.CODIGO_TABELA = '000000000008002'
   and VPNUM.NRO_COLUNA = 2
) FAIXA_SALARIAL,
(
select VPNUM.*
  from RHPESS_TABELAS VP, RHPESS_VALNUM VPNUM
 where VP.CODIGO_TABELA = VPNUM.CODIGO_TABELA
   and VPNUM.CODIGO_TABELA = '000000000008002'
   and VPNUM.NRO_COLUNA = 4
) CODIGO_FAIXA_SALARIAL,
(
select VPNUM.*
  from RHPESS_TABELAS VP, RHPESS_VALNUM VPNUM
 where VP.CODIGO_TABELA = VPNUM.CODIGO_TABELA
   and VPNUM.CODIGO_TABELA = '000000000008002'
   and VPNUM.NRO_COLUNA = 3
   and VPNUM.ANO_MES_REF = (select max(ANO_MES_REF)
                              from RHPESS_VALNUM VPNUM_AUX
                             where VPNUM_AUX.CODIGO_TABELA = VPNUM.CODIGO_TABELA
                               and VPNUM_AUX.NRO_COLUNA = VPNUM.NRO_COLUNA
                               and VPNUM.ANO_MES_REF <= sysdate
                           ) order by NRO_LINHA
) FAIXA_ETARIA,
(
select VPNUM.*
  from RHPESS_TABELAS VP, RHPESS_VALNUM VPNUM
 where VP.CODIGO_TABELA = VPNUM.CODIGO_TABELA
   and VPNUM.CODIGO_TABELA = '000000000008002'
   and VPNUM.NRO_COLUNA = 8
) VALOR
where FAIXA_ETARIA.CODIGO_TABELA = VALOR.CODIGO_TABELA
  and FAIXA_ETARIA.NRO_LINHA = VALOR.NRO_LINHA
  and FAIXA_ETARIA.ANO_MES_REF = VALOR.ANO_MES_REF
  and FAIXA_SALARIAL.CODIGO_TABELA = VALOR.CODIGO_TABELA
  and FAIXA_SALARIAL.NRO_LINHA = VALOR.NRO_LINHA
  and FAIXA_SALARIAL.ANO_MES_REF = VALOR.ANO_MES_REF
  and CODIGO_FAIXA_SALARIAL.CODIGO_TABELA = VALOR.CODIGO_TABELA
  and CODIGO_FAIXA_SALARIAL.NRO_LINHA = VALOR.NRO_LINHA
  and CODIGO_FAIXA_SALARIAL.ANO_MES_REF = VALOR.ANO_MES_REF

union

/* PLANO 5 - CODIGO 000000000002108 - VALOR NA COLUNA 9 DA TABELA 000000000008002 */
select ( select CODIGO
           from RHBENF_BENEFICIO,
           (
            select DADO_ORIGEM, DADO_DESTINO
              from RHINTE_ED_IT_CONV
             where CODIGO_CONVERSAO = 'PS06'
           ) CONVERSAO_CODIGO_BENEFICIO
          where RHBENF_BENEFICIO.CODIGO = CONVERSAO_CODIGO_BENEFICIO.DADO_DESTINO
            and CONVERSAO_CODIGO_BENEFICIO.DADO_ORIGEM = '000000000002108'
       ) AS CODIGO_PLANO,
       FAIXA_SALARIAL.VALNUM AS FAIXA_SALARIAL,
       CODIGO_FAIXA_SALARIAL.VALNUM AS CODIGO_FAIXA_SALARIAL,
       FAIXA_ETARIA.VALNUM AS FAIXA_ETARIA,
       VALOR.VALNUM AS VALOR,
       VALOR.ANO_MES_REF AS ANO_MES_REF
  from
(
select VPNUM.*
  from RHPESS_TABELAS VP, RHPESS_VALNUM VPNUM
 where VP.CODIGO_TABELA = VPNUM.CODIGO_TABELA
   and VPNUM.CODIGO_TABELA = '000000000008002'
   and VPNUM.NRO_COLUNA = 2
) FAIXA_SALARIAL,
(
select VPNUM.*
  from RHPESS_TABELAS VP, RHPESS_VALNUM VPNUM
 where VP.CODIGO_TABELA = VPNUM.CODIGO_TABELA
   and VPNUM.CODIGO_TABELA = '000000000008002'
   and VPNUM.NRO_COLUNA = 4
) CODIGO_FAIXA_SALARIAL,
(
select VPNUM.*
  from RHPESS_TABELAS VP, RHPESS_VALNUM VPNUM
 where VP.CODIGO_TABELA = VPNUM.CODIGO_TABELA
   and VPNUM.CODIGO_TABELA = '000000000008002'
   and VPNUM.NRO_COLUNA = 3
) FAIXA_ETARIA,
(
select VPNUM.*
  from RHPESS_TABELAS VP, RHPESS_VALNUM VPNUM
 where VP.CODIGO_TABELA = VPNUM.CODIGO_TABELA
   and VPNUM.CODIGO_TABELA = '000000000008002'
   and VPNUM.NRO_COLUNA = 9
) VALOR
where FAIXA_ETARIA.CODIGO_TABELA = VALOR.CODIGO_TABELA
  and FAIXA_ETARIA.NRO_LINHA = VALOR.NRO_LINHA
  and FAIXA_ETARIA.ANO_MES_REF = VALOR.ANO_MES_REF
  and FAIXA_SALARIAL.CODIGO_TABELA = VALOR.CODIGO_TABELA
  and FAIXA_SALARIAL.NRO_LINHA = VALOR.NRO_LINHA
  and FAIXA_SALARIAL.ANO_MES_REF = VALOR.ANO_MES_REF
  and CODIGO_FAIXA_SALARIAL.CODIGO_TABELA = VALOR.CODIGO_TABELA
  and CODIGO_FAIXA_SALARIAL.NRO_LINHA = VALOR.NRO_LINHA
  and CODIGO_FAIXA_SALARIAL.ANO_MES_REF = VALOR.ANO_MES_REF

union

/* PLANO 6 - CODIGO 000000000002109 - VALOR NA COLUNA 10 DA TABELA 000000000008002 */
select ( select CODIGO
           from RHBENF_BENEFICIO,
           (
            select DADO_ORIGEM, DADO_DESTINO
              from RHINTE_ED_IT_CONV
             where CODIGO_CONVERSAO = 'PS06'
           ) CONVERSAO_CODIGO_BENEFICIO
          where RHBENF_BENEFICIO.CODIGO = CONVERSAO_CODIGO_BENEFICIO.DADO_DESTINO
            and CONVERSAO_CODIGO_BENEFICIO.DADO_ORIGEM = '000000000002109'
       ) AS CODIGO_PLANO,
       FAIXA_SALARIAL.VALNUM AS FAIXA_SALARIAL,
       CODIGO_FAIXA_SALARIAL.VALNUM AS CODIGO_FAIXA_SALARIAL,
       FAIXA_ETARIA.VALNUM AS FAIXA_ETARIA,
       VALOR.VALNUM AS VALOR,
       VALOR.ANO_MES_REF AS ANO_MES_REF
  from
(
select VPNUM.*
  from RHPESS_TABELAS VP, RHPESS_VALNUM VPNUM
 where VP.CODIGO_TABELA = VPNUM.CODIGO_TABELA
   and VPNUM.CODIGO_TABELA = '000000000008002'
   and VPNUM.NRO_COLUNA = 2
) FAIXA_SALARIAL,
(
select VPNUM.*
  from RHPESS_TABELAS VP, RHPESS_VALNUM VPNUM
 where VP.CODIGO_TABELA = VPNUM.CODIGO_TABELA
   and VPNUM.CODIGO_TABELA = '000000000008002'
   and VPNUM.NRO_COLUNA = 4
) CODIGO_FAIXA_SALARIAL,
(
select VPNUM.*
  from RHPESS_TABELAS VP, RHPESS_VALNUM VPNUM
 where VP.CODIGO_TABELA = VPNUM.CODIGO_TABELA
   and VPNUM.CODIGO_TABELA = '000000000008002'
   and VPNUM.NRO_COLUNA = 3
) FAIXA_ETARIA,
(
select VPNUM.*
  from RHPESS_TABELAS VP, RHPESS_VALNUM VPNUM
 where VP.CODIGO_TABELA = VPNUM.CODIGO_TABELA
   and VPNUM.CODIGO_TABELA = '000000000008002'
   and VPNUM.NRO_COLUNA = 10
) VALOR
where FAIXA_ETARIA.CODIGO_TABELA = VALOR.CODIGO_TABELA
  and FAIXA_ETARIA.NRO_LINHA = VALOR.NRO_LINHA
  and FAIXA_ETARIA.ANO_MES_REF = VALOR.ANO_MES_REF
  and FAIXA_SALARIAL.CODIGO_TABELA = VALOR.CODIGO_TABELA
  and FAIXA_SALARIAL.NRO_LINHA = VALOR.NRO_LINHA
  and FAIXA_SALARIAL.ANO_MES_REF = VALOR.ANO_MES_REF
  and CODIGO_FAIXA_SALARIAL.CODIGO_TABELA = VALOR.CODIGO_TABELA
  and CODIGO_FAIXA_SALARIAL.NRO_LINHA = VALOR.NRO_LINHA
  and CODIGO_FAIXA_SALARIAL.ANO_MES_REF = VALOR.ANO_MES_REF

union

/* PLANO 7 - CODIGO 000000000002110 - VALOR NA COLUNA 11 DA TABELA 000000000008002 */
select ( select CODIGO
           from RHBENF_BENEFICIO,
           (
            select DADO_ORIGEM, DADO_DESTINO
              from RHINTE_ED_IT_CONV
             where CODIGO_CONVERSAO = 'PS06'
           ) CONVERSAO_CODIGO_BENEFICIO
          where RHBENF_BENEFICIO.CODIGO = CONVERSAO_CODIGO_BENEFICIO.DADO_DESTINO
            and CONVERSAO_CODIGO_BENEFICIO.DADO_ORIGEM = '000000000002110'
       ) AS CODIGO_PLANO,
       FAIXA_SALARIAL.VALNUM AS FAIXA_SALARIAL,
       CODIGO_FAIXA_SALARIAL.VALNUM AS CODIGO_FAIXA_SALARIAL,
       FAIXA_ETARIA.VALNUM AS FAIXA_ETARIA,
       VALOR.VALNUM AS VALOR,
       VALOR.ANO_MES_REF AS ANO_MES_REF
  from
(
select VPNUM.*
  from RHPESS_TABELAS VP, RHPESS_VALNUM VPNUM
 where VP.CODIGO_TABELA = VPNUM.CODIGO_TABELA
   and VPNUM.CODIGO_TABELA = '000000000008002'
   and VPNUM.NRO_COLUNA = 2
) FAIXA_SALARIAL,
(
select VPNUM.*
  from RHPESS_TABELAS VP, RHPESS_VALNUM VPNUM
 where VP.CODIGO_TABELA = VPNUM.CODIGO_TABELA
   and VPNUM.CODIGO_TABELA = '000000000008002'
   and VPNUM.NRO_COLUNA = 4
) CODIGO_FAIXA_SALARIAL,
(
select VPNUM.*
  from RHPESS_TABELAS VP, RHPESS_VALNUM VPNUM
 where VP.CODIGO_TABELA = VPNUM.CODIGO_TABELA
   and VPNUM.CODIGO_TABELA = '000000000008002'
   and VPNUM.NRO_COLUNA = 3
) FAIXA_ETARIA,
(
select VPNUM.*
  from RHPESS_TABELAS VP, RHPESS_VALNUM VPNUM
 where VP.CODIGO_TABELA = VPNUM.CODIGO_TABELA
   and VPNUM.CODIGO_TABELA = '000000000008002'
   and VPNUM.NRO_COLUNA = 11
) VALOR
where FAIXA_ETARIA.CODIGO_TABELA = VALOR.CODIGO_TABELA
  and FAIXA_ETARIA.NRO_LINHA = VALOR.NRO_LINHA
  and FAIXA_ETARIA.ANO_MES_REF = VALOR.ANO_MES_REF
  and FAIXA_SALARIAL.CODIGO_TABELA = VALOR.CODIGO_TABELA
  and FAIXA_SALARIAL.NRO_LINHA = VALOR.NRO_LINHA
  and FAIXA_SALARIAL.ANO_MES_REF = VALOR.ANO_MES_REF
  and CODIGO_FAIXA_SALARIAL.CODIGO_TABELA = VALOR.CODIGO_TABELA
  and CODIGO_FAIXA_SALARIAL.NRO_LINHA = VALOR.NRO_LINHA
  and CODIGO_FAIXA_SALARIAL.ANO_MES_REF = VALOR.ANO_MES_REF

union

/* PLANO 7 - CODIGO 000000000002111 - VALOR NA COLUNA 11 DA TABELA 000000000008002 */
select ( select CODIGO
           from RHBENF_BENEFICIO,
           (
            select DADO_ORIGEM, DADO_DESTINO
              from RHINTE_ED_IT_CONV
             where CODIGO_CONVERSAO = 'PS06'
           ) CONVERSAO_CODIGO_BENEFICIO
          where RHBENF_BENEFICIO.CODIGO = CONVERSAO_CODIGO_BENEFICIO.DADO_DESTINO
            and CONVERSAO_CODIGO_BENEFICIO.DADO_ORIGEM = '000000000002111'
       ) AS CODIGO_PLANO,
       FAIXA_SALARIAL.VALNUM AS FAIXA_SALARIAL,
       CODIGO_FAIXA_SALARIAL.VALNUM AS CODIGO_FAIXA_SALARIAL,
       FAIXA_ETARIA.VALNUM AS FAIXA_ETARIA,
       VALOR.VALNUM AS VALOR,
       VALOR.ANO_MES_REF AS ANO_MES_REF
  from
(
select VPNUM.*
  from RHPESS_TABELAS VP, RHPESS_VALNUM VPNUM
 where VP.CODIGO_TABELA = VPNUM.CODIGO_TABELA
   and VPNUM.CODIGO_TABELA = '000000000008002'
   and VPNUM.NRO_COLUNA = 2
) FAIXA_SALARIAL,
(
select VPNUM.*
  from RHPESS_TABELAS VP, RHPESS_VALNUM VPNUM
 where VP.CODIGO_TABELA = VPNUM.CODIGO_TABELA
   and VPNUM.CODIGO_TABELA = '000000000008002'
   and VPNUM.NRO_COLUNA = 4
) CODIGO_FAIXA_SALARIAL,
(
select VPNUM.*
  from RHPESS_TABELAS VP, RHPESS_VALNUM VPNUM
 where VP.CODIGO_TABELA = VPNUM.CODIGO_TABELA
   and VPNUM.CODIGO_TABELA = '000000000008002'
   and VPNUM.NRO_COLUNA = 3
) FAIXA_ETARIA,
(
select VPNUM.*
  from RHPESS_TABELAS VP, RHPESS_VALNUM VPNUM
 where VP.CODIGO_TABELA = VPNUM.CODIGO_TABELA
   and VPNUM.CODIGO_TABELA = '000000000008002'
   and VPNUM.NRO_COLUNA = 11
) VALOR
where FAIXA_ETARIA.CODIGO_TABELA = VALOR.CODIGO_TABELA
  and FAIXA_ETARIA.NRO_LINHA = VALOR.NRO_LINHA
  and FAIXA_ETARIA.ANO_MES_REF = VALOR.ANO_MES_REF
  and FAIXA_SALARIAL.CODIGO_TABELA = VALOR.CODIGO_TABELA
  and FAIXA_SALARIAL.NRO_LINHA = VALOR.NRO_LINHA
  and FAIXA_SALARIAL.ANO_MES_REF = VALOR.ANO_MES_REF
  and CODIGO_FAIXA_SALARIAL.CODIGO_TABELA = VALOR.CODIGO_TABELA
  and CODIGO_FAIXA_SALARIAL.NRO_LINHA = VALOR.NRO_LINHA
  and CODIGO_FAIXA_SALARIAL.ANO_MES_REF = VALOR.ANO_MES_REF

union

/* PLANO 7 - CODIGO 000000000002112 - VALOR NA COLUNA 11 DA TABELA 000000000008002 */
select ( select CODIGO
           from RHBENF_BENEFICIO,
           (
            select DADO_ORIGEM, DADO_DESTINO
              from RHINTE_ED_IT_CONV
             where CODIGO_CONVERSAO = 'PS06'
           ) CONVERSAO_CODIGO_BENEFICIO
          where RHBENF_BENEFICIO.CODIGO = CONVERSAO_CODIGO_BENEFICIO.DADO_DESTINO
            and CONVERSAO_CODIGO_BENEFICIO.DADO_ORIGEM = '000000000002112'
       ) AS CODIGO_PLANO,
       FAIXA_SALARIAL.VALNUM AS FAIXA_SALARIAL,
       CODIGO_FAIXA_SALARIAL.VALNUM AS CODIGO_FAIXA_SALARIAL,
       FAIXA_ETARIA.VALNUM AS FAIXA_ETARIA,
       VALOR.VALNUM AS VALOR,
       VALOR.ANO_MES_REF AS ANO_MES_REF
  from
(
select VPNUM.*
  from RHPESS_TABELAS VP, RHPESS_VALNUM VPNUM
 where VP.CODIGO_TABELA = VPNUM.CODIGO_TABELA
   and VPNUM.CODIGO_TABELA = '000000000008002'
   and VPNUM.NRO_COLUNA = 2
) FAIXA_SALARIAL,
(
select VPNUM.*
  from RHPESS_TABELAS VP, RHPESS_VALNUM VPNUM
 where VP.CODIGO_TABELA = VPNUM.CODIGO_TABELA
   and VPNUM.CODIGO_TABELA = '000000000008002'
   and VPNUM.NRO_COLUNA = 4
) CODIGO_FAIXA_SALARIAL,
(
select VPNUM.*
  from RHPESS_TABELAS VP, RHPESS_VALNUM VPNUM
 where VP.CODIGO_TABELA = VPNUM.CODIGO_TABELA
   and VPNUM.CODIGO_TABELA = '000000000008002'
   and VPNUM.NRO_COLUNA = 3
   and VPNUM.ANO_MES_REF = (select max(ANO_MES_REF)
                              from RHPESS_VALNUM VPNUM_AUX
                             where VPNUM_AUX.CODIGO_TABELA = VPNUM.CODIGO_TABELA
                               and VPNUM_AUX.NRO_COLUNA = VPNUM.NRO_COLUNA
                               and VPNUM.ANO_MES_REF <= sysdate
                           ) order by NRO_LINHA
) FAIXA_ETARIA,
(
select VPNUM.*
  from RHPESS_TABELAS VP, RHPESS_VALNUM VPNUM
 where VP.CODIGO_TABELA = VPNUM.CODIGO_TABELA
   and VPNUM.CODIGO_TABELA = '000000000008002'
   and VPNUM.NRO_COLUNA = 11
) VALOR
where FAIXA_ETARIA.CODIGO_TABELA = VALOR.CODIGO_TABELA
  and FAIXA_ETARIA.NRO_LINHA = VALOR.NRO_LINHA
  and FAIXA_ETARIA.ANO_MES_REF = VALOR.ANO_MES_REF
  and FAIXA_SALARIAL.CODIGO_TABELA = VALOR.CODIGO_TABELA
  and FAIXA_SALARIAL.NRO_LINHA = VALOR.NRO_LINHA
  and FAIXA_SALARIAL.ANO_MES_REF = VALOR.ANO_MES_REF
  and CODIGO_FAIXA_SALARIAL.CODIGO_TABELA = VALOR.CODIGO_TABELA
  and CODIGO_FAIXA_SALARIAL.NRO_LINHA = VALOR.NRO_LINHA
  and CODIGO_FAIXA_SALARIAL.ANO_MES_REF = VALOR.ANO_MES_REF