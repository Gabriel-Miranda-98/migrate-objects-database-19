
  CREATE OR REPLACE FORCE EDITIONABLE VIEW "ARTERH"."VWSEGU_PESQUISA_CANDIDATO" ("CODIGO_EMPRESA", "CODIGO", "CODIGO_PESSOA", "NOME", "CODIGO_EVENTO_SEL", "CODIGO_EMPRESA_AGRUP", "TIPO_AGRUP", "COD_AGRUP1", "COD_AGRUP2", "COD_AGRUP3", "COD_AGRUP4", "COD_AGRUP5", "COD_AGRUP6", "DESCRICAO_AGRUP", "CODIGO_EMPRESA_AGRUP_CLIENTE", "TIPO_AGRUP_CLIENTE", "COD_AGRUP_CLIENTE1", "COD_AGRUP_CLIENTE2", "COD_AGRUP_CLIENTE3", "COD_AGRUP_CLIENTE4", "COD_AGRUP_CLIENTE5", "COD_AGRUP_CLIENTE6", "DESCRICAO_AGRUP_CLIENTE", "CODIGO_EMPRESA_CARGO", "CODIGO_CARGO", "DESCRICAO_CARGO") AS 
  select
	RHPESS_CANDIDATO.CODIGO_EMPRESA as codigo_empresa,
	RHPESS_CANDIDATO.CODIGO as codigo,
	RHPESS_CANDIDATO.CODIGO_PESSOA as codigo_pessoa, 
	RHPESS_CANDIDATO.NOME as nome,
	RHPESS_CANDIDATO.CODIGO_EVENTO_SEL as codigo_evento_sel,
	RHORGA_AGRUPADOR.CODIGO_EMPRESA as codigo_empresa_agrup,
	RHORGA_AGRUPADOR.TIPO_AGRUP as tipo_agrup,
	RHORGA_AGRUPADOR.COD_AGRUP1 as cod_agrup1,
	RHORGA_AGRUPADOR.COD_AGRUP2 as cod_agrup2,
	RHORGA_AGRUPADOR.COD_AGRUP3 as cod_agrup3,
	RHORGA_AGRUPADOR.COD_AGRUP4 as cod_agrup4,
	RHORGA_AGRUPADOR.COD_AGRUP5 as cod_agrup5,
	RHORGA_AGRUPADOR.COD_AGRUP6 as cod_agrup6,
	RHORGA_AGRUPADOR.DESCRICAO as descricao_agrup,
	AGRUPADOR_CLIENTE.CODIGO_EMPRESA as codigo_empresa_agrup_cliente,
	AGRUPADOR_CLIENTE.TIPO_AGRUP as tipo_agrup_cliente,
	AGRUPADOR_CLIENTE.COD_AGRUP1 as cod_agrup_cliente1,
	AGRUPADOR_CLIENTE.COD_AGRUP2 as cod_agrup_cliente2,
	AGRUPADOR_CLIENTE.COD_AGRUP3 as cod_agrup_cliente3,
	AGRUPADOR_CLIENTE.COD_AGRUP4 as cod_agrup_cliente4,
	AGRUPADOR_CLIENTE.COD_AGRUP5 as cod_agrup_cliente5,
	AGRUPADOR_CLIENTE.COD_AGRUP6 as cod_agrup_cliente6,
	AGRUPADOR_CLIENTE.DESCRICAO as descricao_agrup_cliente,
	RHPLCS_CARGO.CODIGO_EMPRESA as codigo_empresa_cargo,
	RHPLCS_CARGO.CODIGO as codigo_cargo,
	RHPLCS_CARGO.DESCRICAO as descricao_cargo

from 
	RHPESS_CANDIDATO

inner join RHORGA_AGRUPADOR on 
	 RHORGA_AGRUPADOR.CODIGO_EMPRESA  = RHPESS_CANDIDATO.CODIGO_EMPRESA
and RHORGA_AGRUPADOR.TIPO_AGRUP in (select SIARTE_PARAMETRO.VALOR from SIARTE_PARAMETRO
    								  where SIARTE_PARAMETRO.CODIGO_EMPRESA = RHPESS_CANDIDATO.CODIGO_EMPRESA
    								  and SIARTE_PARAMETRO.NOME = 'TIPO_AGRUP_SEGU')
and (
	(RHORGA_AGRUPADOR.CODIGO_EMPRESA = RHPESS_CANDIDATO.CODIGO_EMPRESA
and RHORGA_AGRUPADOR.TIPO_AGRUP = 'L'
and RHORGA_AGRUPADOR.COD_AGRUP1 = RHPESS_CANDIDATO.CODIGO_LOTACAO1
and RHORGA_AGRUPADOR.COD_AGRUP2 = RHPESS_CANDIDATO.CODIGO_LOTACAO2
and RHORGA_AGRUPADOR.COD_AGRUP3 = RHPESS_CANDIDATO.CODIGO_LOTACAO3
and RHORGA_AGRUPADOR.COD_AGRUP4 = RHPESS_CANDIDATO.CODIGO_LOTACAO4
and RHORGA_AGRUPADOR.COD_AGRUP5 = RHPESS_CANDIDATO.CODIGO_LOTACAO5
and RHORGA_AGRUPADOR.COD_AGRUP6 = RHPESS_CANDIDATO.CODIGO_LOTACAO6 )
or ( RHORGA_AGRUPADOR.CODIGO_EMPRESA = RHPESS_CANDIDATO.CODIGO_EMPRESA
and RHORGA_AGRUPADOR.TIPO_AGRUP = 'U'
and RHORGA_AGRUPADOR.COD_AGRUP1 = RHPESS_CANDIDATO.CODIGO_UNIDADE1
and RHORGA_AGRUPADOR.COD_AGRUP2 = RHPESS_CANDIDATO.CODIGO_UNIDADE2
and RHORGA_AGRUPADOR.COD_AGRUP3 = RHPESS_CANDIDATO.CODIGO_UNIDADE3
and RHORGA_AGRUPADOR.COD_AGRUP4 = RHPESS_CANDIDATO.CODIGO_UNIDADE4
and RHORGA_AGRUPADOR.COD_AGRUP5 = RHPESS_CANDIDATO.CODIGO_UNIDADE5
and RHORGA_AGRUPADOR.COD_AGRUP6 = RHPESS_CANDIDATO.CODIGO_UNIDADE6 )
or ( RHORGA_AGRUPADOR.CODIGO_EMPRESA = RHPESS_CANDIDATO.CODIGO_EMPRESA
and RHORGA_AGRUPADOR.TIPO_AGRUP = 'C'
and RHORGA_AGRUPADOR.COD_AGRUP1 = RHPESS_CANDIDATO.CODIGO_CCONTAB1
and RHORGA_AGRUPADOR.COD_AGRUP2 = RHPESS_CANDIDATO.CODIGO_CCONTAB2
and RHORGA_AGRUPADOR.COD_AGRUP3 = RHPESS_CANDIDATO.CODIGO_CCONTAB3
and RHORGA_AGRUPADOR.COD_AGRUP4 = RHPESS_CANDIDATO.CODIGO_CCONTAB4
and RHORGA_AGRUPADOR.COD_AGRUP5 = RHPESS_CANDIDATO.CODIGO_CCONTAB5
and RHORGA_AGRUPADOR.COD_AGRUP6 = RHPESS_CANDIDATO.CODIGO_CCONTAB6 )
or ( RHORGA_AGRUPADOR.CODIGO_EMPRESA = RHPESS_CANDIDATO.CODIGO_EMPRESA
and RHORGA_AGRUPADOR.TIPO_AGRUP = 'G'
and RHORGA_AGRUPADOR.COD_AGRUP1 = RHPESS_CANDIDATO.CODIGO_CGERENC1
and RHORGA_AGRUPADOR.COD_AGRUP2 = RHPESS_CANDIDATO.CODIGO_CGERENC2
and RHORGA_AGRUPADOR.COD_AGRUP3 = RHPESS_CANDIDATO.CODIGO_CGERENC3
and RHORGA_AGRUPADOR.COD_AGRUP4 = RHPESS_CANDIDATO.CODIGO_CGERENC4
and RHORGA_AGRUPADOR.COD_AGRUP5 = RHPESS_CANDIDATO.CODIGO_CGERENC5
and RHORGA_AGRUPADOR.COD_AGRUP6 = RHPESS_CANDIDATO.CODIGO_CGERENC6 )
)

inner join RHORGA_AGRUPADOR AGRUPADOR_CLIENTE on 
	 AGRUPADOR_CLIENTE.CODIGO_EMPRESA  = RHPESS_CANDIDATO.CODIGO_EMPRESA
and AGRUPADOR_CLIENTE.TIPO_AGRUP in (select SIARTE_PARAMETRO.VALOR from SIARTE_PARAMETRO
									where SIARTE_PARAMETRO.CODIGO_EMPRESA = RHPESS_CANDIDATO.CODIGO_EMPRESA
									and NOME = 'TIPO_AGRUP_SEGU_CLIENTE' )
and (
	( AGRUPADOR_CLIENTE.CODIGO_EMPRESA = RHPESS_CANDIDATO.CODIGO_EMPRESA
and AGRUPADOR_CLIENTE.TIPO_AGRUP = 'L'
and AGRUPADOR_CLIENTE.COD_AGRUP1 = RHPESS_CANDIDATO.CODIGO_LOTACAO1
and AGRUPADOR_CLIENTE.COD_AGRUP2 = RHPESS_CANDIDATO.CODIGO_LOTACAO2
and AGRUPADOR_CLIENTE.COD_AGRUP3 = RHPESS_CANDIDATO.CODIGO_LOTACAO3
and AGRUPADOR_CLIENTE.COD_AGRUP4 = RHPESS_CANDIDATO.CODIGO_LOTACAO4
and AGRUPADOR_CLIENTE.COD_AGRUP5 = RHPESS_CANDIDATO.CODIGO_LOTACAO5
and AGRUPADOR_CLIENTE.COD_AGRUP6 = RHPESS_CANDIDATO.CODIGO_LOTACAO6 )
or ( RHORGA_AGRUPADOR.CODIGO_EMPRESA = RHPESS_CANDIDATO.CODIGO_EMPRESA
and AGRUPADOR_CLIENTE.TIPO_AGRUP = 'U'
and AGRUPADOR_CLIENTE.COD_AGRUP1 = RHPESS_CANDIDATO.CODIGO_UNIDADE1
and AGRUPADOR_CLIENTE.COD_AGRUP2 = RHPESS_CANDIDATO.CODIGO_UNIDADE2
and AGRUPADOR_CLIENTE.COD_AGRUP3 = RHPESS_CANDIDATO.CODIGO_UNIDADE3
and AGRUPADOR_CLIENTE.COD_AGRUP4 = RHPESS_CANDIDATO.CODIGO_UNIDADE4
and AGRUPADOR_CLIENTE.COD_AGRUP5 = RHPESS_CANDIDATO.CODIGO_UNIDADE5
and AGRUPADOR_CLIENTE.COD_AGRUP6 = RHPESS_CANDIDATO.CODIGO_UNIDADE6 )
or ( AGRUPADOR_CLIENTE.CODIGO_EMPRESA = RHPESS_CANDIDATO.CODIGO_EMPRESA
and AGRUPADOR_CLIENTE.TIPO_AGRUP = 'C'
and AGRUPADOR_CLIENTE.COD_AGRUP1 = RHPESS_CANDIDATO.CODIGO_CCONTAB1
and AGRUPADOR_CLIENTE.COD_AGRUP2 = RHPESS_CANDIDATO.CODIGO_CCONTAB2
and AGRUPADOR_CLIENTE.COD_AGRUP3 = RHPESS_CANDIDATO.CODIGO_CCONTAB3
and AGRUPADOR_CLIENTE.COD_AGRUP4 = RHPESS_CANDIDATO.CODIGO_CCONTAB4
and AGRUPADOR_CLIENTE.COD_AGRUP5 = RHPESS_CANDIDATO.CODIGO_CCONTAB5
and AGRUPADOR_CLIENTE.COD_AGRUP6 = RHPESS_CANDIDATO.CODIGO_CCONTAB6 )
or ( AGRUPADOR_CLIENTE.CODIGO_EMPRESA = RHPESS_CANDIDATO.CODIGO_EMPRESA
and AGRUPADOR_CLIENTE.TIPO_AGRUP = 'G'
and AGRUPADOR_CLIENTE.COD_AGRUP1 = RHPESS_CANDIDATO.CODIGO_CGERENC1
and AGRUPADOR_CLIENTE.COD_AGRUP2 = RHPESS_CANDIDATO.CODIGO_CGERENC2
and AGRUPADOR_CLIENTE.COD_AGRUP3 = RHPESS_CANDIDATO.CODIGO_CGERENC3
and AGRUPADOR_CLIENTE.COD_AGRUP4 = RHPESS_CANDIDATO.CODIGO_CGERENC4
and AGRUPADOR_CLIENTE.COD_AGRUP5 = RHPESS_CANDIDATO.CODIGO_CGERENC5
and AGRUPADOR_CLIENTE.COD_AGRUP6 = RHPESS_CANDIDATO.CODIGO_CGERENC6 )
)

inner join RHPLCS_CARGO on
	 RHPLCS_CARGO.CODIGO_EMPRESA = RHPESS_CANDIDATO.CODIGO_EMPRESA
and RHPLCS_CARGO.CODIGO = RHPESS_CANDIDATO.CODIGO_CARGO_EFET

where RHPESS_CANDIDATO.CODIGO_EMPRESA >=  '0001'
and RHPESS_CANDIDATO.SITUACAO_CANDIDATO IN (select P.VALOR from SIARTE_PARAMETRO P
															where P.CODIGO_EMPRESA = RHPESS_CANDIDATO.CODIGO_EMPRESA
															and P.CODIGO_ASSUNTO = '..ME'
															and P.NOME = 'CODIGO_SIT_CANDIDATO_FICHA_ADM'
															)

WITH READ ONLY CONSTRAINT "APENAS_LEITURA_CAND"