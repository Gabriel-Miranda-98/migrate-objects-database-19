
  CREATE OR REPLACE FORCE EDITIONABLE VIEW "ARTERH"."DESAVERBACAO" ("CODIGO_EMPRESA", "MATRICULA", "OCORRENCIA", "DATA_INICIO_DESAVERBACAO", "DATA_FIM_DESAVERBACAO", "MOTIVO_DESAVERBACAO", "DIAS", "MESES", "ANOS", "DIAS_LIQUIDOS", "DIAS_FALTA_ACUMULADAS", "PROCESSO") AS 
  SELECT 
DES.CODIGO_EMPRESA AS CODIGO_EMPRESA,
TO_NUMBER(SUBSTR(DES.CODIGO_PESSOA, 5,10))||
CASE WHEN SUBSTR(DES.CODIGO_PESSOA, 15,1) != 'X' THEN TO_NUMBER(SUBSTR(DES.CODIGO_PESSOA, 15,1)) ELSE 7 END AS MATRICULA,
DES.OCORRENCIA AS OCORRENCIA,
TO_CHAR(DES.DATA_INI_DESAVERB,'YYYYMMDD') AS DATA_INICIO_DESAVERBACAO,
TO_CHAR(DES.DATA_FIM_DESAVERB,'YYYYMMDD') AS DATA_FIM_DESAVERBACAO,
DES.MOTIV_DESAVERBACAO AS MOTIVO_DESAVERBACAO,
DES.DIAS AS DIAS,
DES.MESES AS MESES,
DES.ANOS AS ANOS,
DES.DIAS_LIQUIDO AS DIAS_LIQUIDOS,
DES.DIAS_FALTA_ACUMUL AS DIAS_FALTA_ACUMULADAS,
DES.PROCESSO AS PROCESSO

FROM RHTEMP_DESAVERB DES