
  CREATE OR REPLACE FORCE EDITIONABLE VIEW "ARTERH"."VW_CONSULTA_EMPREGADO" ("CODIGO", "NOME", "CPF", "DATA_NASCIMENTO", "DATA_ADMISSAO", "DATA_RESCISAO", "COD_ESPECIALIDADE", "ESPECIALIDADE", "CODIGO_FUNCAO", "FUNCAO_DESCRICAO", "COD_CARGO_PAGTO", "CARGO_DESCRICAO", "TIPO_CONTRATO", "SITUACAO_CONTRATO", "SITUACAO_FUNCIONAL", "COD_UNIDADE1", "COD_UNIDADE2", "COD_UNIDADE3", "COD_UNIDADE4", "COD_UNIDADE5", "COD_UNIDADE6", "LOTACAO_DESCRICAO", "DT_ULT_ALT_UNID", "ENDER_ELETRONICO") AS 
  SELECT
CONTRATO.CODIGO,
CONTRATO.NOME,
PESSOA.CPF,
PESSOA.DATA_NASCIMENTO,
CONTRATO.DATA_ADMISSAO,
CONTRATO.DATA_RESCISAO,
CONTRATO.COD_ESPECIALIDADE,
ESPECIALID.DESCRICAO as ESPECIALIDADE,
CONTRATO.CODIGO_FUNCAO,
FUNCAO.DESCRICAO as FUNCAO_DESCRICAO,
CONTRATO.COD_CARGO_PAGTO,
CARGO.DESCRICAO as CARGO_DESCRICAO,
CONTRATO.TIPO_CONTRATO,
CONTRATO.SITUACAO_CONTRATO,
CONTRATO.SITUACAO_FUNCIONAL,
CONTRATO.COD_UNIDADE1,
CONTRATO.COD_UNIDADE2,
CONTRATO.COD_UNIDADE3,
CONTRATO.COD_UNIDADE4,
CONTRATO.COD_UNIDADE5,
CONTRATO.COD_UNIDADE6,
U.DESCRICAO as LOTACAO_DESCRICAO,
CONTRATO.DT_ULT_ALT_UNID,
ENDERECO.ENDER_ELETRONICO
FROM
RHPESS_CONTRATO CONTRATO
INNER JOIN RHORGA_UNIDADE U ON
((CONTRATO.CODIGO_EMPRESA = '0010') AND 
(U.CODIGO_EMPRESA = CONTRATO.CODIGO_EMPRESA) AND
(CONTRATO.COD_UNIDADE1 = U.COD_UNIDADE1) AND
(CONTRATO.COD_UNIDADE2 = U.COD_UNIDADE2) AND
(CONTRATO.COD_UNIDADE3 = U.COD_UNIDADE3) AND
(CONTRATO.COD_UNIDADE4 = U.COD_UNIDADE4) AND
(CONTRATO.COD_UNIDADE5 = U.COD_UNIDADE5) AND
(CONTRATO.COD_UNIDADE6 = U.COD_UNIDADE6))
INNER JOIN RHPESS_PESSOA PESSOA ON ((PESSOA.CODIGO_EMPRESA = '0010') AND PESSOA.CODIGO_EMPRESA = CONTRATO.CODIGO_EMPRESA AND CONTRATO.CODIGO_PESSOA = PESSOA.CODIGO)
LEFT JOIN RHPESS_ENDERECO_P ENDERECO ON ((ENDERECO.CODIGO_EMPRESA = '0010') AND ENDERECO.CODIGO_EMPRESA = CONTRATO.CODIGO_EMPRESA AND PESSOA.CODIGO = ENDERECO.CODIGO_PESSOA)
LEFT JOIN RHPLCS_CARGO CARGO ON ((CARGO.CODIGO_EMPRESA = '0010') AND CARGO.CODIGO_EMPRESA = CONTRATO.CODIGO_EMPRESA AND CONTRATO.COD_CARGO_PAGTO = CARGO.CODIGO)
LEFT JOIN RHPLCS_ESPECIALID ESPECIALID ON ((ESPECIALID.CODIGO_EMPRESA = '0010') AND ESPECIALID.CODIGO_EMPRESA = CONTRATO.CODIGO_EMPRESA AND CONTRATO.COD_ESPECIALIDADE = ESPECIALID.CODIGO)
LEFT JOIN RHPLCS_FUNCAO FUNCAO ON ((FUNCAO.CODIGO_EMPRESA = '0010') AND FUNCAO.CODIGO_EMPRESA = CONTRATO.CODIGO_EMPRESA AND CONTRATO.CODIGO_FUNCAO = FUNCAO.CODIGO)
LEFT JOIN RHPARM_SIT_FUNC SIT ON (CONTRATO.SITUACAO_FUNCIONAL = SIT.CODIGO)
WHERE
((CONTRATO.CODIGO_EMPRESA = '0010') AND
(((CONTRATO.SITUACAO_CONTRATO = 'N') OR
(CONTRATO.SITUACAO_CONTRATO = 'F') OR
(CONTRATO.SITUACAO_CONTRATO = 'A') OR
(CONTRATO.SITUACAO_CONTRATO = 'M')) OR
((CONTRATO.SITUACAO_CONTRATO = 'D') AND
(CONTRATO.DATA_RESCISAO >= (SELECT ADD_MONTHS(SYSDATE,-6) FROM DUAL)))) AND
CONTRATO.ANO_MES_REFERENCIA >= (SELECT TRUNC(SYSDATE, 'YEAR') FROM DUAL) AND
(CONTRATO.ANO_MES_REFERENCIA = (SELECT MAX(ARTERH_CONTRATO.ANO_MES_REFERENCIA) FROM
RHPESS_CONTRATO ARTERH_CONTRATO WHERE
CONTRATO.CODIGO_EMPRESA = ARTERH_CONTRATO.CODIGO_EMPRESA AND
CONTRATO.TIPO_CONTRATO = ARTERH_CONTRATO.TIPO_CONTRATO AND
CONTRATO.CODIGO = ARTERH_CONTRATO.CODIGO AND
ARTERH_CONTRATO.ANO_MES_REFERENCIA >= (SELECT TRUNC(SYSDATE, 'YEAR') FROM DUAL))))