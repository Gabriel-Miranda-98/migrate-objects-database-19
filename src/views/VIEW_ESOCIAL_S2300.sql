
  CREATE OR REPLACE FORCE EDITIONABLE VIEW "ARTERH"."VIEW_ESOCIAL_S2300" ("companyCode", "contractType", "contractCode", "name") AS 
  SELECT RHPESS_CANDIDATO.CODIGO_EMPRESA,
  RHPESS_CANDIDATO.TIPO_CONTRATO,
   RHPESS_CANDIDATO.CODIGO_CONTRATO,
    RHPESS_CANDIDATO.nome

FROM RHPESS_CANDIDATO
INNER JOIN RHSELE_EVENTO_SEL
ON RHSELE_EVENTO_SEL.CODIGO_EVENTO_SEL = RHPESS_CANDIDATO.CODIGO_EVENTO_SEL
AND RHSELE_EVENTO_SEL.CODIGO_EMPRESA   = RHPESS_CANDIDATO.CODIGO_EMPRESA
INNER JOIN RHTABS_VINCULO_EMP
ON RHTABS_VINCULO_EMP.CODIGO              = RHSELE_EVENTO_SEL.COD_VINCULO
AND RHTABS_VINCULO_EMP.COD_CATEG_ESOCIAL IN ('901')
LEFT OUTER JOIN RHPLCS_CARGO
ON RHPESS_CANDIDATO.CODIGO_CARGO_EFET = RHPLCS_CARGO.CODIGO
AND RHPESS_CANDIDATO.CODIGO_EMPRESA   = RHPLCS_CARGO.CODIGO_EMPRESA
WHERE EXISTS
  (SELECT 1
  FROM RHPESS_CONTR_MEST
  WHERE RHPESS_CANDIDATO.CODIGO_EMPRESA = RHPESS_CONTR_MEST.CODIGO_EMPRESA
  AND RHPESS_CANDIDATO.TIPO_CONTRATO    = RHPESS_CONTR_MEST.TIPO_CONTRATO
  AND RHPESS_CANDIDATO.CODIGO_CONTRATO  = RHPESS_CONTR_MEST.CODIGO_CONTRATO
  )
AND NOT EXISTS
  (SELECT 1
  FROM RHPESS_INFO_ESTAGIO
  WHERE RHPESS_CANDIDATO.CODIGO_EMPRESA = RHPESS_INFO_ESTAGIO.CODIGO_EMPRESA
  AND RHPESS_CANDIDATO.TIPO_CONTRATO    = RHPESS_INFO_ESTAGIO.TIPO_CONTRATO
  AND RHPESS_CANDIDATO.CODIGO_CONTRATO  = RHPESS_INFO_ESTAGIO.CODIGO_CONTRATO
  )
AND RHPESS_CANDIDATO.CODIGO_EMPRESA = '0001'