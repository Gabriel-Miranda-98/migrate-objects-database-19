
  CREATE OR REPLACE FORCE EDITIONABLE VIEW "ARTERH"."CONTRATO_SAUDE" ("CODIGO", "NOME", "SEXO", "DATA_NASCIMENTO", "ESTADO_CIVIL", "GRAU_INSTRUCAO", "NATURALIDADE", "C_LIVRE_DESCR12", "CPF", "IDENTIDADE", "ORGAO_EXPEDIDOR", "CONSELHO_REGIONAL", "INSCRICAO_CONSELHO", "ENDERECO", "NUMERO", "COMPLEMENTO", "BAIRRO", "DESC_MUNICIPIO", "UF", "CEP", "TELEFONE", "DESC_VINCULO", "AREA_ATUACAO", "DESC_ESCALA", "JORNADA_DIARIA", "COD_CARGO_EFETIVO", "DESC_CARGO", "CATEG_PROFISSIONAL", "DESC_CATEG", "COD_UNIDADE1", "COD_UNIDADE2", "COD_UNIDADE3", "COD_UNIDADE4", "COD_UNIDADE5", "COD_UNIDADE6", "DESC_UNIDADE", "ABREVIACAO") AS 
  SELECT "RHPESS_CONTRATO"."CODIGO",  
         "RHPESS_CONTRATO"."NOME",  
         "RHPESS_PESSOA"."SEXO",  
         "RHPESS_PESSOA"."DATA_NASCIMENTO",  
         "RHPESS_PESSOA"."ESTADO_CIVIL",  
         "RHPESS_PESSOA"."GRAU_INSTRUCAO",  
         "RHPESS_PESSOA"."NATURALIDADE",  
         "RHPESS_PESSOA"."C_LIVRE_DESCR12",  
         "RHPESS_PESSOA"."CPF",  
         "RHPESS_PESSOA"."IDENTIDADE",  
         "RHPESS_PESSOA"."ORGAO_EXPEDIDOR",  
         "RHPESS_PESSOA"."CONSELHO_REGIONAL",  
         "RHPESS_PESSOA"."INSCRICAO_CONSELHO",  
         "RHPESS_ENDERECO_P"."ENDERECO",  
         "RHPESS_ENDERECO_P"."NUMERO",  
         "RHPESS_ENDERECO_P"."COMPLEMENTO",  
         "RHPESS_ENDERECO_P"."BAIRRO",  
         "RHTABS_MUNICIPIO"."DESCRICAO" DESC_MUNICIPIO,  
         "RHPESS_ENDERECO_P"."UF",  
         "RHPESS_ENDERECO_P"."CEP",  
         "RHPESS_PESSOA"."TELEFONE",  
         "RHTABS_VINCULO_EMP"."DESCRICAO" DESC_VINCULO,  
         "RHPESS_CONTRATO"."AREA_ATUACAO",  
         "RHPONT_ESCALA"."DESCRICAO" DESC_ESCALA,  
         "RHPONT_ESCALA"."JORNADA_DIARIA",  
         "RHPESS_CONTRATO"."COD_CARGO_EFETIVO",  
         "RHPLCS_CARGO"."DESCRICAO" DESC_CARGO,  
         "RHPESS_CONTRATO"."CATEG_PROFISSIONAL",  
         "RHTABS_CAT_PROFIS"."DESCRICAO" DESC_CATEG,  
         "RHPESS_CONTRATO"."COD_UNIDADE1",  
         "RHPESS_CONTRATO"."COD_UNIDADE2",  
         "RHPESS_CONTRATO"."COD_UNIDADE3",  
         "RHPESS_CONTRATO"."COD_UNIDADE4",  
         "RHPESS_CONTRATO"."COD_UNIDADE5",  
         "RHPESS_CONTRATO"."COD_UNIDADE6",  
         "RHORGA_UNIDADE"."DESCRICAO" DESC_UNIDADE,  
         "RHORGA_UNIDADE"."ABREVIACAO" 
    FROM "RHPESS_CONTRATO",  
         "RHPESS_PESSOA",  
         "RHPESS_ENDERECO_P",  
         "RHORGA_UNIDADE",  
         "RHPLCS_CARGO",  
         "RHTABS_VINCULO_EMP",  
         "RHPONT_ESCALA",  
         "RHTABS_MUNICIPIO",  
         "RHTABS_CAT_PROFIS" 
   WHERE ( "RHPESS_CONTRATO"."CODIGO_EMPRESA" = "RHPESS_PESSOA"."CODIGO_EMPRESA" ) and 
         ( "RHPESS_CONTRATO"."CODIGO_EMPRESA" = "RHPESS_ENDERECO_P"."CODIGO_EMPRESA" ) and 
         ( "RHPESS_CONTRATO"."CODIGO_EMPRESA" = "RHORGA_UNIDADE"."CODIGO_EMPRESA" ) and 
         ( "RHPESS_CONTRATO"."CODIGO_PESSOA" = "RHPESS_PESSOA"."CODIGO" ) and 
         ( "RHPESS_CONTRATO"."CODIGO_PESSOA" = "RHPESS_ENDERECO_P"."CODIGO_PESSOA" ) and 
         ( rhpess_endereco_p.municipio = rhtabs_municipio.codigo (+)) and 
         ( "RHPESS_CONTRATO"."COD_UNIDADE1" = "RHORGA_UNIDADE"."COD_UNIDADE1" ) and 
         ( "RHPESS_CONTRATO"."COD_UNIDADE2" = "RHORGA_UNIDADE"."COD_UNIDADE2" ) and 
         ( "RHPESS_CONTRATO"."COD_UNIDADE3" = "RHORGA_UNIDADE"."COD_UNIDADE3" ) and 
         ( "RHPESS_CONTRATO"."COD_UNIDADE4" = "RHORGA_UNIDADE"."COD_UNIDADE4" ) and 
         ( "RHPESS_CONTRATO"."COD_UNIDADE5" = "RHORGA_UNIDADE"."COD_UNIDADE5" ) and 
         ( "RHPESS_CONTRATO"."COD_UNIDADE6" = "RHORGA_UNIDADE"."COD_UNIDADE6" ) and 
         ( "RHPESS_CONTRATO"."COD_CARGO_EFETIVO" = "RHPLCS_CARGO"."CODIGO" ) and 
         ( "RHPESS_CONTRATO"."VINCULO" = "RHTABS_VINCULO_EMP"."CODIGO" ) and 
         ( "RHPESS_CONTRATO"."CODIGO_ESCALA" = "RHPONT_ESCALA"."CODIGO" ) and 
         ( rhpess_contrato.categ_profissional = rhtabs_cat_profis.codigo (+)) and 
         ( "RHPESS_CONTRATO"."CODIGO_EMPRESA" = '0001' ) AND 
         ( "RHPESS_CONTRATO"."TIPO_CONTRATO" = '0001' ) AND
 
        (( "RHPESS_CONTRATO"."SITUACAO_FUNCIONAL" < '1700' ) AND 
        (( "RHPESS_CONTRATO"."COD_UNIDADE1" = '000070' AND 
           "RHPESS_CONTRATO"."COD_UNIDADE2" = '000002') OR 
         ( "RHPESS_CONTRATO"."COD_UNIDADE1" >= '000071' AND 
           "RHPESS_CONTRATO"."COD_UNIDADE1" <= '000079' AND 
           "RHPESS_CONTRATO"."COD_UNIDADE2" = '000002' AND 
           "RHPESS_CONTRATO"."COD_UNIDADE3" = '000002'))) AND 

         ( "RHPESS_CONTRATO"."ANO_MES_REFERENCIA" = (SELECT MAX(A."ANO_MES_REFERENCIA" )
                           FROM "RHPESS_CONTRATO" A
                           WHERE A."CODIGO" = "RHPESS_CONTRATO"."CODIGO" AND
                                 A."CODIGO_EMPRESA" = "RHPESS_CONTRATO"."CODIGO_EMPRESA" AND
                                 A."TIPO_CONTRATO" = "RHPESS_CONTRATO"."TIPO_CONTRATO" AND
                                 A."ANO_MES_REFERENCIA" <= SYSDATE ))   


 