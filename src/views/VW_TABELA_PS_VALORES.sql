
  CREATE OR REPLACE FORCE EDITIONABLE VIEW "ARTERH"."VW_TABELA_PS_VALORES" ("ANO_MES_REFERENCIA", "CODIGO_PLANO", "FAIXA_SALARIAL", "FAIXA_ETARIA", "VALOR_MENSALIDADE", "VALOR_SUBSIDIO_TITULAR", "VALOR_SOMENTE_MEDICO", "VALOR_MEDICO_ODONTO", "VALOR_SOMENTE_ODONTO") AS 
  select MENSALIDADE."ANO_MES_REFERENCIA",
       MENSALIDADE."CODIGO_PLANO",
       NVL(SUBSIDIO.FAIXA_SALARIAL,0) AS FAIXA_SALARIAL,
       MENSALIDADE."FAIXA_ETARIA",MENSALIDADE."VALOR_MENSALIDADE",
       NVL(SUBSIDIO.VALOR_SUBSIDIO_TITULAR,0) AS VALOR_SUBSIDIO_TITULAR,
       NVL(SUBSIDIO_DEPENDENTE.VALOR_SOMENTE_MEDICO,0) AS VALOR_SOMENTE_MEDICO,
       NVL(SUBSIDIO_DEPENDENTE.VALOR_MEDICO_ODONTO,0) AS VALOR_MEDICO_ODONTO,
       NVL(SUBSIDIO_DEPENDENTE.VALOR_SOMENTE_ODONTO,0) AS VALOR_SOMENTE_ODONTO
from
(
select ANO_MES_REF AS ANO_MES_REFERENCIA,
       CODIGO_PLANO,
       FAIXA_ETARIA,
       VALOR AS VALOR_MENSALIDADE
  from VW_TABELA_PS_MENSALIDADE
 where exists(
         select CODIGO
           from RHBENF_BENEFICIO,
           (
            select DADO_ORIGEM, DADO_DESTINO
              from RHINTE_ED_IT_CONV
             where CODIGO_CONVERSAO = 'PS06'
           ) CONVERSAO_CODIGO_BENEFICIO
          where RHBENF_BENEFICIO.CODIGO = CONVERSAO_CODIGO_BENEFICIO.DADO_DESTINO 
            and RHBENF_BENEFICIO.CODIGO = VW_TABELA_PS_MENSALIDADE.CODIGO_PLANO         
 )
) MENSALIDADE,
(
select ANO_MES_REF AS ANO_MES_REFERENCIA,
       CODIGO_PLANO,
       FAIXA_SALARIAL,
       FAIXA_ETARIA,
       VALOR AS VALOR_SUBSIDIO_TITULAR
   from VW_TABELA_PS_SUBSIDIO_TITULAR order by 1,2,3,4
) SUBSIDIO,
(
select * from VW_TABELA_PS_SUBSIDIO_DEPEND
) SUBSIDIO_DEPENDENTE
where MENSALIDADE.ANO_MES_REFERENCIA = SUBSIDIO.ANO_MES_REFERENCIA (+)
  and MENSALIDADE.CODIGO_PLANO = SUBSIDIO.CODIGO_PLANO (+)
  and MENSALIDADE.FAIXA_ETARIA = SUBSIDIO.FAIXA_ETARIA (+)
  and MENSALIDADE.ANO_MES_REFERENCIA = SUBSIDIO_DEPENDENTE.ANO_MES_REF (+)