
  CREATE OR REPLACE FORCE EDITIONABLE VIEW "ARTERH"."VW_ARQUIVO_0002" ("ID_ARQUIVO", "CODIGO_EMPRESA_ARQUIVO", "SITUACAO_ARQUIVO", "DATA_CARGA", "NUMERO_LINHA", "SITUACAO_LINHA", "LINHA_ORIGINAL", "IDENTIFICADOR_ARQUIVO", "DATA_HORA_GERACAO_ARQUIVO", "SEQUENCIAL_REGISTRO", "TIPO_OPERACAO", "CODIGO_EMPRESA", "CODIGO_CONTRATO", "CPF", "NOME", "DATA_NASCIMENTO", "CODIGO_SEXO", "CODIGO_RACA_COR", "CODIGO_IMCAP_LABOR", "CODIGO_TIPO_RELACIONAMENTO", "CODIGO_ESTADO_CIVIL", "IDENTIDADE", "NOME_DA_MAE", "CODIGO_TIPO_LOGRADOURO", "ENDERECO", "NUMERO", "COMPLEMENTO", "BAIRRO", "CODIGO_MUNICIPIO", "UF", "CEP", "TELEFONE_FIXO", "TELEFONE_CELULAR", "DATA_CADASTRAMENTO") AS 
  select
RHPBH_ARQUIVO.ID_ARQUIVO,
RHPBH_ARQUIVO.CODIGO_EMPRESA AS CODIGO_EMPRESA_ARQUIVO,
RHPBH_ARQUIVO.SITUACAO AS SITUACAO_ARQUIVO,
RHPBH_ARQUIVO.DATA_CARGA,
RHPBH_ARQUIVO_LINHA.NUMERO_LINHA,
RHPBH_ARQUIVO_LINHA.SITUACAO AS SITUACAO_LINHA,
RHPBH_ARQUIVO_LINHA.LINHA AS LINHA_ORIGINAL,
regexp_substr(REPLACE(RHPBH_ARQUIVO_LINHA.LINHA,';;','; ;'), '[^;]+', 1, 1)	AS	IDENTIFICADOR_ARQUIVO,
regexp_substr(REPLACE(RHPBH_ARQUIVO_LINHA.LINHA,';;','; ;'), '[^;]+', 1, 2)	AS	DATA_HORA_GERACAO_ARQUIVO,
regexp_substr(REPLACE(RHPBH_ARQUIVO_LINHA.LINHA,';;','; ;'), '[^;]+', 1, 3)	AS	SEQUENCIAL_REGISTRO,
regexp_substr(REPLACE(RHPBH_ARQUIVO_LINHA.LINHA,';;','; ;'), '[^;]+', 1, 4)	AS	TIPO_OPERACAO,
regexp_substr(REPLACE(RHPBH_ARQUIVO_LINHA.LINHA,';;','; ;'), '[^;]+', 1, 5)	AS	CODIGO_EMPRESA,
regexp_substr(REPLACE(RHPBH_ARQUIVO_LINHA.LINHA,';;','; ;'), '[^;]+', 1, 6)	AS	CODIGO_CONTRATO,
regexp_substr(REPLACE(RHPBH_ARQUIVO_LINHA.LINHA,';;','; ;'), '[^;]+', 1, 7)	AS	CPF,
regexp_substr(REPLACE(RHPBH_ARQUIVO_LINHA.LINHA,';;','; ;'), '[^;]+', 1, 8)	AS	NOME,
regexp_substr(REPLACE(RHPBH_ARQUIVO_LINHA.LINHA,';;','; ;'), '[^;]+', 1, 9)	AS	DATA_NASCIMENTO,
regexp_substr(REPLACE(RHPBH_ARQUIVO_LINHA.LINHA,';;','; ;'), '[^;]+', 1, 10)	AS	CODIGO_SEXO,
regexp_substr(REPLACE(RHPBH_ARQUIVO_LINHA.LINHA,';;','; ;'), '[^;]+', 1, 11)	AS	CODIGO_RACA_COR,
regexp_substr(REPLACE(RHPBH_ARQUIVO_LINHA.LINHA,';;','; ;'), '[^;]+', 1, 12)	AS	CODIGO_IMCAP_LABOR,
regexp_substr(REPLACE(RHPBH_ARQUIVO_LINHA.LINHA,';;','; ;'), '[^;]+', 1, 13)	AS	CODIGO_TIPO_RELACIONAMENTO,
regexp_substr(REPLACE(RHPBH_ARQUIVO_LINHA.LINHA,';;','; ;'), '[^;]+', 1, 14)	AS	CODIGO_ESTADO_CIVIL,
regexp_substr(REPLACE(RHPBH_ARQUIVO_LINHA.LINHA,';;','; ;'), '[^;]+', 1, 15)	AS	IDENTIDADE,
regexp_substr(REPLACE(RHPBH_ARQUIVO_LINHA.LINHA,';;','; ;'), '[^;]+', 1, 16)	AS	NOME_DA_MAE,
regexp_substr(REPLACE(RHPBH_ARQUIVO_LINHA.LINHA,';;','; ;'), '[^;]+', 1, 17)	AS	CODIGO_TIPO_LOGRADOURO,
regexp_substr(REPLACE(RHPBH_ARQUIVO_LINHA.LINHA,';;','; ;'), '[^;]+', 1, 18)	AS	ENDERECO,
regexp_substr(REPLACE(RHPBH_ARQUIVO_LINHA.LINHA,';;','; ;'), '[^;]+', 1, 19)	AS	NUMERO,
regexp_substr(REPLACE(RHPBH_ARQUIVO_LINHA.LINHA,';;','; ;'), '[^;]+', 1, 20)	AS	COMPLEMENTO,
regexp_substr(REPLACE(RHPBH_ARQUIVO_LINHA.LINHA,';;','; ;'), '[^;]+', 1, 21)	AS	BAIRRO,
regexp_substr(REPLACE(RHPBH_ARQUIVO_LINHA.LINHA,';;','; ;'), '[^;]+', 1, 22)	AS	CODIGO_MUNICIPIO,
regexp_substr(REPLACE(RHPBH_ARQUIVO_LINHA.LINHA,';;','; ;'), '[^;]+', 1, 23)	AS	UF,
regexp_substr(REPLACE(RHPBH_ARQUIVO_LINHA.LINHA,';;','; ;'), '[^;]+', 1, 24)	AS	CEP,
regexp_substr(REPLACE(RHPBH_ARQUIVO_LINHA.LINHA,';;','; ;'), '[^;]+', 1, 25)	AS	TELEFONE_FIXO,
regexp_substr(REPLACE(RHPBH_ARQUIVO_LINHA.LINHA,';;','; ;'), '[^;]+', 1, 26)	AS	TELEFONE_CELULAR,
regexp_substr(REPLACE(RHPBH_ARQUIVO_LINHA.LINHA,';;','; ;'), '[^;]+', 1, 27)	AS	DATA_CADASTRAMENTO
  from RHPBH_ARQUIVO, RHPBH_ARQUIVO_LINHA
 where RHPBH_ARQUIVO.ID_ARQUIVO = RHPBH_ARQUIVO_LINHA.ID_ARQUIVO
   and RHPBH_ARQUIVO.TIPO_ARQUIVO = '0002'