
  CREATE OR REPLACE FORCE EDITIONABLE VIEW "ARTERH"."DADOS_BANCARIOS" ("COD_ORG", "MATRICULA", "CPF", "TIPO_BENEFICIARIO", "AGENCIA", "DV_AGENCIA", "CONTA", "DV_CONTA", "TIPO_DA_CONTA", "INC_VIG_VINCULO", "FORMA_LANC_CONTA") AS 
  SELECT
CASE SUBSTR(CO.COD_LOCAL1,5,2)||SUBSTR(CO.COD_LOCAL2,5,2)||SUBSTR(CO.COD_LOCAL3,5,2)||SUBSTR(CO.COD_LOCAL4,5,2)
WHEN '99990100' THEN '0001'/*ADMINISTRAÇÃO DIRETA*/
WHEN '99990200' THEN '0001'/*ADMINISTRAÇÃO DIRETA*/
WHEN '99990101' THEN '0006'/*BEPREM*/
WHEN '99990102' THEN '0002'/*CMBH*/
WHEN '99990103' THEN '0005'/*HOB*/
WHEN '99990104' THEN '0003'/*FPMZB*/
WHEN '99990105' THEN '0003'/*FPMZB*/
WHEN '99990205' THEN '0003'/*FPMZB*/
WHEN '99990106' THEN '0004'/*FMC*/
WHEN '99990206' THEN '0004'/*FMC*/
ELSE '0001' END AS COD_ORG,
TO_NUMBER(SUBSTR(CO.CODIGO, 5,10))||
CASE WHEN SUBSTR(CO.CODIGO, 15,1) != 'X' THEN TO_NUMBER(SUBSTR(co.CODIGO, 15,1)) ELSE 7 END AS MATRICULA,
PE.CPF AS CPF,
'1' TIPO_BENEFICIARIO,
SUBSTR(CO.CODIGO_BANCO_CC,11,4)AGENCIA,
SUBSTR(CO.CODIGO_BANCO_CC,-1)DV_AGENCIA,
SUBSTR(CO.CONTA_CORRENTE,9,6)CONTA,
SUBSTR(CO.CONTA_CORRENTE,-1)DV_CONTA,
'37' TIPO_DA_CONTA,
'20170101' INC_VIG_VINCULO,
'04'FORMA_LANC_CONTA







FROM 
RHPESS_CONTRATO CO,RHPESS_PESSOA PE


WHERE

CO.CODIGO_PESSOA  = PE.CODIGO
AND CO.CODIGO_EMPRESA = PE.CODIGO_EMPRESA
--AND SUBSTR(CO.CODIGO, 5,10) LIKE '%X%'
AND cO.codigo_empresa IN  ('0013','0014','0001')
AND CO.TIPO_CONTRATO       in ('0001')

AND CO.SITUACAO_FUNCIONAL NOT IN ('1710', '1715', '1800', '1850', '1900', '5000', '5001', '5002', '5003', '5004', '5005', '5006',
                                  '5008', '5009', '5011', '5019', '5022', '5026', '5028', '5200', '5201', '5400', '5555', '5700', '5800',
                                  '5801', '5808', '5900', '5901', '6002', '6003', '8000')
AND CO.VINCULO IN ('0000','0002')
AND (CO.CODIGO < '000000099999999' AND CO.CODIGO NOT IN('000000000777777','000000000823701','000000000833014','000000000866265','000000000747428','000000000190072','000000000420534')) /*FALECIDOS PIA*/
AND CO.ANO_MES_REFERENCIA  =
(SELECT MAX(A.ANO_MES_REFERENCIA)
FROM RHPESS_CONTRATO A
WHERE A.CODIGO            = CO.CODIGO
AND A.CODIGO_EMPRESA      = CO.CODIGO_EMPRESA
AND A.TIPO_CONTRATO       = CO.TIPO_CONTRATO
AND A.ANO_MES_REFERENCIA <= add_months(sysdate,(-1))-0)