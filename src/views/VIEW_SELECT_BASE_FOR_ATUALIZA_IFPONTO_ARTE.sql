
  CREATE OR REPLACE FORCE EDITIONABLE VIEW "PONTO_ELETRONICO"."VIEW_SELECT_BASE_FOR_ATUALIZA_IFPONTO_ARTE" ("CODIGO_EMPRESA", "EMPRESA", "AGRUPAMENTO_EMPRESA", "CPF", "NOME", "APELIDO", "PIS_PASEP", "IDENTIDADE", "TIPO_CONTRATO", "CODIGO_CONTRATO", "CODIGO_ESCALA", "DT_ULT_ESCALA", "DIA_COMECO_CICLO", "CODIGO_UNIDADE", "COD_UNIDADE1", "COD_UNIDADE2", "COD_UNIDADE3", "COD_UNIDADE4", "COD_UNIDADE5", "COD_UNIDADE6", "DESCRICAO_UNIDADE", "CODIGO_CARGO_EFETIVO", "DESCRICAO_CARGO_EFETIVO", "CODIGO_CARGO_COMISSIONADO", "DESCRICAO_CARGO_COMISSIONADO", "DATA_ADMISSAO", "DATA_RESCISAO", "REGISTRO_PONTO", "CODIGO_EMPRESA_GESTOR", "TIPO_CONTRATO_GESTOR", "CODIGO_RESPONSAVEL", "TIPO_VW_DADOS_SERVIDOR", "DT_SAIU_ARTE", "DT_ENVIADO_IFPONTO_SURICATO", "LOCAL_GESTOR", "COD_TIPO_PESSOA", "CODIGO_LEGADO", "EXCECAO_FUNCIONAL", "NOME_SEGUINTE", "DIA_SEGUINTE", "TIPO_SEGUINTE", "INTEGRADO_SEGUINTE", "PIS_PASEP_SEGUINTE", "CPF_SEGUINTE", "CNPJ_SEGUINTE", "IDENTIDADE_SEGUINTE", "COD_UNIDADE1_SEGUINTE", "COD_UNIDADE2_SEGUINTE", "COD_UNIDADE3_SEGUINTE", "COD_UNIDADE4_SEGUINTE", "COD_UNIDADE5_SEGUINTE", "COD_UNIDADE6_SEGUINTE", "DESCRICAO_UNIDADE_SEGUINTE", "REGISTRO_PONTO_SEGUINTE", "SITUACAO_FUNCIONAL_SEGUINTE", "NOME_SIT_FUNC_SEGUINTE", "CONTROLE_FOLHA_SEGUINTE", "DATA_RESCISAO_SEGUINTE", "CODIGO_ESCALA_SEGUINTE", "DT_ULT_ESCALA_SEGUINTE", "DIA_COMECO_CICLO_SEGUINTE", "COD_CARGO_EFETIVO_SEGUINTE", "CARGO_EFETIVO_SEGUINTE", "COD_CARGO_COMISS_SEGUINTE", "CARGO_COMISSIONADO_SEGUINTE", "CODIGO_FUNCAO_SEGUINTE", "FUNCAO_PUBLICA_SEGUINTE", "CODIGO_EMPRESA_GESTOR_SEGUINTE", "TIPO_CONTRATO_GESTOR_SEGUINTE", "CONTRATO_GESTOR_SEGUINTE", "CPF_GESTOR_SEGUINTE", "E_GESTOR_SEGUINTE", "TIPO_USUARIO_SEGUINTE", "CODIGO_LEGADO_SEGUINTE", "CHAVE_INTEGRACAO_SEGUINTE", "E_GESTOR", "ALTEROU_CODIGO_ESCALA", "ALTEROU_COD_CARGO_EFETIVO", "ALTEROU_COD_CARGO_COMISS", "ALTEROU_CODIGO_FUNCAO", "ALTEROU_LOCAL", "ALTEROU_REGISTRO_PONTO", "ALTEROU_CHAVE_INTEGRACAO", "ALTEROU_CPF_GESTOR", "ALTEROU_E_GESTOR", "ALTEROU_NOME", "ALTEROU_CNPJ", "ALTEROU_TIPO_USUARIO", "ALTEROU_CERCA", "ALTEROU_INI_ESCALA", "ALTEROU_TIPO_HIERARQUIA", "ALTEROU_DIA_CICLO_ESCALA", "ALTEROU_DATA_ADMISSAO", "CODIGO_PESSOA", "PESSOA_GESTOR", "MARCACAO_INTERVALO_AUTO", "CODIGO_VINCULO", "DESCRICAO_VINCULO", "COD_UNIDADE_ANTERIOR1", "COD_UNIDADE_ANTERIOR2", "COD_UNIDADE_ANTERIOR3", "COD_UNIDADE_ANTERIOR4", "COD_UNIDADE_ANTERIOR5", "COD_UNIDADE_ANTERIOR6") AS 
  select 
fim_case_gerar_dados_foto.CODIGO_EMPRESA,
CASE WHEN fim_case_gerar_dados_foto.CODIGO_EMPRESA = '0001' THEN 'PREF.MUN.BELO HORIZONTE'  WHEN fim_case_gerar_dados_foto.CODIGO_EMPRESA = '0098' THEN 'PREF.MUN.BH CONTRATOS'
     WHEN fim_case_gerar_dados_foto.CODIGO_EMPRESA = '0013' THEN 'FUND MUNC CULTURA'
     WHEN fim_case_gerar_dados_foto.CODIGO_EMPRESA = '0014' THEN 'FUND PARQUES MUNICIPAIS E ZOOBOTANICA DE BH'
     WHEN fim_case_gerar_dados_foto.CODIGO_EMPRESA = '0003' THEN 'SUDECAP'
WHEN CODIGO_EMPRESA = '0015' THEN 'SES - MUNICIPALIZADOS' WHEN fim_case_gerar_dados_foto.CODIGO_EMPRESA = '0021' THEN 'SMSABH/FMSBH - CONTRATOS ADMINISTRATIVOS' WHEN fim_case_gerar_dados_foto.CODIGO_EMPRESA = '0032' THEN 'CA - PROJETOS ESPECIAIS'
END AS EMPRESA,
CASE WHEN fim_case_gerar_dados_foto.CODIGO_EMPRESA in ('0001','0098','0015','0021','0032') then 'ADM DIRETA' else 'ADM INDIRETA' END AS AGRUPAMENTO_EMPRESA,
fim_case_gerar_dados_foto.CPF,
fim_case_gerar_dados_foto.NOME,
fim_case_gerar_dados_foto.APELIDO,
fim_case_gerar_dados_foto.PIS_PASEP,
fim_case_gerar_dados_foto.IDENTIDADE,
fim_case_gerar_dados_foto.TIPO_CONTRATO,
fim_case_gerar_dados_foto.CODIGO_CONTRATO    ,
fim_case_gerar_dados_foto.CODIGO_ESCALA,
fim_case_gerar_dados_foto.DT_ULT_ESCALA,
fim_case_gerar_dados_foto.DIA_COMECO_CICLO,
CASE WHEN fim_case_gerar_dados_foto.COD_UNIDADE1 IS NOT NULL THEN
SUBSTR(fim_case_gerar_dados_foto.EMPRESA_HIERARQUIA,3,2)||'.'||fim_case_gerar_dados_foto.COD_UNIDADE1||'.'||fim_case_gerar_dados_foto.COD_UNIDADE2||'.'||fim_case_gerar_dados_foto.COD_UNIDADE3||'.'||fim_case_gerar_dados_foto.COD_UNIDADE4||'.'||fim_case_gerar_dados_foto.COD_UNIDADE5||'.'||fim_case_gerar_dados_foto.COD_UNIDADE6 ELSE NULL END AS CODIGO_UNIDADE,
fim_case_gerar_dados_foto.COD_UNIDADE1,
fim_case_gerar_dados_foto.COD_UNIDADE2,
fim_case_gerar_dados_foto.COD_UNIDADE3,
fim_case_gerar_dados_foto.COD_UNIDADE4,
fim_case_gerar_dados_foto.COD_UNIDADE5,
fim_case_gerar_dados_foto.COD_UNIDADE6,
fim_case_gerar_dados_foto.DESCRICAO_UNIDADE    ,
fim_case_gerar_dados_foto.CODIGO_CARGO_EFETIVO    ,
fim_case_gerar_dados_foto.DESCRICAO_CARGO_EFETIVO    ,
fim_case_gerar_dados_foto.CODIGO_CARGO_COMISSIONADO    ,
fim_case_gerar_dados_foto.DESCRICAO_CARGO_COMISSIONADO    ,
fim_case_gerar_dados_foto.DATA_ADMISSAO    ,
fim_case_gerar_dados_foto.DATA_RESCISAO    ,
fim_case_gerar_dados_foto.REGISTRO_PONTO,
fim_case_gerar_dados_foto.CODIGO_EMPRESA_GESTOR,
fim_case_gerar_dados_foto.TIPO_CONTRATO_GESTOR,
fim_case_gerar_dados_foto.CODIGO_RESPONSAVEL,
fim_case_gerar_dados_foto.TIPO_VW_DADOS_SERVIDOR,
fim_case_gerar_dados_foto.DT_SAIU_ARTE,
fim_case_gerar_dados_foto.DT_ENVIADO_IFPONTO_SURICATO,
fim_case_gerar_dados_foto.LOCAL_GESTOR,
fim_case_gerar_dados_foto.COD_TIPO_PESSOA,
fim_case_gerar_dados_foto.CODIGO_LEGADO,
fim_case_gerar_dados_foto.EXCECAO_FUNCIONAL,--NOVO EM 16/8/22 EMAIL (Customização - Cadastro de justificativa)
fim_case_gerar_dados_foto.NOME_SEGUINTE,
fim_case_gerar_dados_foto.DIA_SEGUINTE,
fim_case_gerar_dados_foto.TIPO_SEGUINTE,
fim_case_gerar_dados_foto.INTEGRADO_SEGUINTE,
fim_case_gerar_dados_foto.PIS_PASEP_SEGUINTE,
fim_case_gerar_dados_foto.CPF_SEGUINTE,
fim_case_gerar_dados_foto.CNPJ_SEGUINTE,
fim_case_gerar_dados_foto.IDENTIDADE_SEGUINTE,
fim_case_gerar_dados_foto.COD_UNIDADE1_SEGUINTE,
fim_case_gerar_dados_foto.COD_UNIDADE2_SEGUINTE,
fim_case_gerar_dados_foto.COD_UNIDADE3_SEGUINTE,
fim_case_gerar_dados_foto.COD_UNIDADE4_SEGUINTE,
fim_case_gerar_dados_foto.COD_UNIDADE5_SEGUINTE,
fim_case_gerar_dados_foto.COD_UNIDADE6_SEGUINTE,
fim_case_gerar_dados_foto.DESCRICAO_UNIDADE_SEGUINTE,
fim_case_gerar_dados_foto.REGISTRO_PONTO_SEGUINTE,
fim_case_gerar_dados_foto.SITUACAO_FUNCIONAL_SEGUINTE,
fim_case_gerar_dados_foto.NOME_SIT_FUNC_SEGUINTE,
fim_case_gerar_dados_foto.CONTROLE_FOLHA_SEGUINTE,
fim_case_gerar_dados_foto.DATA_RESCISAO_SEGUINTE,
fim_case_gerar_dados_foto.CODIGO_ESCALA_SEGUINTE,
fim_case_gerar_dados_foto.DT_ULT_ESCALA_SEGUINTE,
fim_case_gerar_dados_foto.DIA_COMECO_CICLO_SEGUINTE,
fim_case_gerar_dados_foto.COD_CARGO_EFETIVO_SEGUINTE,
fim_case_gerar_dados_foto.CARGO_EFETIVO_SEGUINTE,
fim_case_gerar_dados_foto.COD_CARGO_COMISS_SEGUINTE,
fim_case_gerar_dados_foto.CARGO_COMISSIONADO_SEGUINTE,
fim_case_gerar_dados_foto.CODIGO_FUNCAO_SEGUINTE,
fim_case_gerar_dados_foto.FUNCAO_PUBLICA_SEGUINTE,
fim_case_gerar_dados_foto.CODIGO_EMPRESA_GESTOR_SEGUINTE,
fim_case_gerar_dados_foto.TIPO_CONTRATO_GESTOR_SEGUINTE,
fim_case_gerar_dados_foto.CONTRATO_GESTOR_SEGUINTE,
fim_case_gerar_dados_foto.CPF_GESTOR_SEGUINTE,
fim_case_gerar_dados_foto.E_GESTOR_SEGUINTE,
fim_case_gerar_dados_foto.TIPO_USUARIO_SEGUINTE,
fim_case_gerar_dados_foto.CODIGO_LEGADO_SEGUINTE,
fim_case_gerar_dados_foto.CHAVE_INTEGRACAO_SEGUINTE,
fim_case_gerar_dados_foto.E_GESTOR,
fim_case_gerar_dados_foto.ALTEROU_CODIGO_ESCALA,
fim_case_gerar_dados_foto.ALTEROU_COD_CARGO_EFETIVO,
fim_case_gerar_dados_foto.ALTEROU_COD_CARGO_COMISS,
fim_case_gerar_dados_foto.ALTEROU_CODIGO_FUNCAO,
fim_case_gerar_dados_foto.ALTEROU_LOCAL,
fim_case_gerar_dados_foto.ALTEROU_REGISTRO_PONTO,
fim_case_gerar_dados_foto.ALTEROU_CHAVE_INTEGRACAO,
fim_case_gerar_dados_foto.ALTEROU_CPF_GESTOR,
fim_case_gerar_dados_foto.ALTEROU_E_GESTOR,
fim_case_gerar_dados_foto.ALTEROU_NOME,
fim_case_gerar_dados_foto.ALTEROU_CNPJ,
fim_case_gerar_dados_foto.ALTEROU_TIPO_USUARIO,
fim_case_gerar_dados_foto.ALTEROU_CERCA,
fim_case_gerar_dados_foto.ALTEROU_INI_ESCALA,
fim_case_gerar_dados_foto.ALTEROU_TIPO_HIERARQUIA,
fim_case_gerar_dados_foto.ALTEROU_DIA_CICLO_ESCALA,
fim_case_gerar_dados_foto.ALTEROU_DATA_ADMISSAO,
fim_case_gerar_dados_foto.CODIGO_PESSOA ,
fim_case_gerar_dados_foto.PESSOA_GESTOR,
MARCACAO_INTERVALO_AUTO,
FIM_CASE_GERAR_DADOS_FOTO.CODIGO_VINCULO,
FIM_CASE_GERAR_DADOS_FOTO.DESCRICAO_VINCULO,
FIM_CASE_GERAR_DADOS_FOTO.COD_UNIDADE_ANTERIOR1,
FIM_CASE_GERAR_DADOS_FOTO.COD_UNIDADE_ANTERIOR2,
FIM_CASE_GERAR_DADOS_FOTO.COD_UNIDADE_ANTERIOR3,
FIM_CASE_GERAR_DADOS_FOTO.COD_UNIDADE_ANTERIOR4,
FIM_CASE_GERAR_DADOS_FOTO.COD_UNIDADE_ANTERIOR5,
FIM_CASE_GERAR_DADOS_FOTO.COD_UNIDADE_ANTERIOR6


from (
SELECT  CODIGO_EMPRESA,
EMPRESA_HIERARQUIA,
-------------------------------------------------------------------------CPF 31/07/2019--------------------------------------------------------------------------------------------
  CASE WHEN TIPO_VW_DADOS_SERVIDOR IN ('DIARIA_NOVOS', 'READMISSAO')THEN CPF
  ELSE NULL
  END CPF,

 -------------------------------------------------------------------------NOME 31/07/2019------------------------------------------------------------------------------------------
  CASE
  WHEN TIPO_VW_DADOS_SERVIDOR IN ('DIARIA_NOVOS')AND NOME IS NOT NULL THEN NOME
  WHEN TIPO_VW_DADOS_SERVIDOR IN ('READMISSAO')AND NOME_SEGUINTE IS NOT NULL THEN NOME_SEGUINTE
  WHEN TIPO_VW_DADOS_SERVIDOR NOT IN ('DIARIA_NOVOS', 'READMISSAO','DESLIGAMENTO')AND ALTEROU_NOME = 'NOME_MUDOU'THEN NOME_SEGUINTE
  ELSE NULL
  END NOME,

-----------------------------------------------------------------------------IDENTIDADE 31/07/2019-------------------------------------------------------------------------------
  CASE WHEN TIPO_VW_DADOS_SERVIDOR IN ('DIARIA_NOVOS', 'READMISSAO')AND IDENTIDADE IS NOT NULL THEN IDENTIDADE
   WHEN TIPO_VW_DADOS_SERVIDOR NOT IN ('DIARIA_NOVOS', 'READMISSAO','DESLIGAMENTO') AND ALTEROU_IDENTIDADE = 'IDENTIDADE_MUDOU' THEN IDENTIDADE_SEGUINTE WHEN TIPO_VW_DADOS_SERVIDOR NOT IN ('DIARIA_NOVOS', 'READMISSAO')AND ALTEROU_IDENTIDADE = 'IDENTIDADE_MUDOU'THEN IDENTIDADE_SEGUINTE
  END AS IDENTIDADE ,
----------------------------------------------------------------------------------APILIDO PARA OS CADASTROS NOVOS E READMISSAO 31/07/2019-----------------------------------
  CASE
    WHEN TIPO_VW_DADOS_SERVIDOR IN ('DIARIA_NOVOS', 'READMISSAO')AND APELIDO IS NOT NULL THEN APELIDO
    ELSE NULL
  END AS APELIDO,
-------------------------------------------------- PIS DOS CADASTROS NOVOS   31/072019------------------------------------------------------
  CASE WHEN TIPO_VW_DADOS_SERVIDOR = 'DIARIA_NOVOS' AND (PIS_PASEP IS NULL OR PIS_PASEP  = '00000000000')THEN LTRIM(CODIGO_EMPRESA,0)||REPLACE(LTRIM(CODIGO_CONTRATO,0),'X','')
   WHEN TIPO_VW_DADOS_SERVIDOR ='DIARIA_NOVOS'AND PIS_PASEP IS NOT NULL THEN PIS_PASEP
   WHEN TIPO_VW_DADOS_SERVIDOR='READMISSAO' AND PIS_PASEP_SEGUINTE IS NOT NULL THEN PIS_PASEP_SEGUINTE
  ELSE NULL
  END AS PIS_PASEP,
-----------------------------------------------------------TIPO_CONTRATO E CODIGO CONTRATO 31/07/2019--------------------
  TIPO_CONTRATO,
  CODIGO_CONTRATO,
-------------------------------------------------------------------CODIGO_ESCALA  EM 31/07/2019 --------------------------------------------------------------
--------------------------------------------------------GABRIEM EM 21/11/2019 MUDOU PARA ATENDER A NOVA CHAVE (TIPO_CONTRATO)+(EMRPESA)+(MATRICULA)-----------------------------
  CASE
    WHEN TIPO_VW_DADOS_SERVIDOR IN ('DIARIA_NOVOS')THEN SUBSTR(CODIGO_EMPRESA,3,2)||CODIGO_ESCALA
    WHEN TIPO_VW_DADOS_SERVIDOR IN ('READMISSAO')THEN SUBSTR(CODIGO_EMPRESA,3,2)||CODIGO_ESCALA_SEGUINTE
    WHEN TIPO_VW_DADOS_SERVIDOR NOT IN ('DIARIA_NOVOS', 'READMISSAO','DESLIGAMENTO')AND (ALTEROU_CODIGO_ESCALA = 'CODIGO_ESCALA_MUDOU'OR ALTEROU_INI_ESCALA='DATA_ESCALA_MUDOU' OR ALTEROU_DIA_CICLO_ESCALA='DIA_CICLO_MUDOU') THEN SUBSTR(CODIGO_EMPRESA,3,2)||CODIGO_ESCALA_SEGUINTE
    ELSE NULL
  END AS CODIGO_ESCALA,
  -------------------------------------------------------------------DATA_INICIO_ESCALA  EM 31/07/2019 --------------------------------------------------------------

  CASE WHEN TIPO_VW_DADOS_SERVIDOR IN ('DIARIA_NOVOS') AND  DT_ULT_ESCALA IS NOT NULL THEN DT_ULT_ESCALA
  WHEN TIPO_VW_DADOS_SERVIDOR IN ('DIARIA_NOVOS') AND DT_ULT_ESCALA IS NULL THEN DATA_ADMISSAO
  WHEN TIPO_VW_DADOS_SERVIDOR IN ('READMISSAO') AND DT_ULT_ESCALA_SEGUINTE IS NOT NULL THEN DT_ULT_ESCALA_SEGUINTE
  WHEN TIPO_VW_DADOS_SERVIDOR IN ('READMISSAO') AND DT_ULT_ESCALA_SEGUINTE IS  NULL THEN DT_SAIU_ARTE
  WHEN TIPO_VW_DADOS_SERVIDOR NOT IN  ('DIARIA_NOVOS', 'READMISSAO','DESLIGAMENTO') AND ALTEROU_CODIGO_ESCALA = 'CODIGO_ESCALA_MUDOU' AND DT_ULT_ESCALA_SEGUINTE IS NOT NULL THEN DT_ULT_ESCALA_SEGUINTE
  WHEN TIPO_VW_DADOS_SERVIDOR NOT IN ('DIARIA_NOVOS', 'READMISSAO','DESLIGAMENTO') AND ALTEROU_CODIGO_ESCALA = 'CODIGO_ESCALA_MUDOU' AND DT_ULT_ESCALA_SEGUINTE IS NULL THEN DT_SAIU_ARTE
  WHEN TIPO_VW_DADOS_SERVIDOR NOT IN ('DIARIA_NOVOS', 'READMISSAO','DESLIGAMENTO') AND ALTEROU_CODIGO_ESCALA = 'CODIGO_ESCALA_IGUAL' AND (ALTEROU_INI_ESCALA='DATA_ESCALA_MUDOU'OR ALTEROU_DIA_CICLO_ESCALA='DIA_CICLO_MUDOU') AND DT_ULT_ESCALA_SEGUINTE IS NOT NULL THEN DT_ULT_ESCALA_SEGUINTE
  ELSE NULL END DT_ULT_ESCALA,
-------------------------------------------------------------------DIA_CICLO  EM 28/07/2021 --------------------------------------------------------------

  CASE WHEN TIPO_VW_DADOS_SERVIDOR IN ('DIARIA_NOVOS') AND  DIA_COMECO_CICLO IS NOT NULL THEN DIA_COMECO_CICLO
  WHEN TIPO_VW_DADOS_SERVIDOR IN ('DIARIA_NOVOS') AND DIA_COMECO_CICLO IS NULL THEN NULL
  WHEN TIPO_VW_DADOS_SERVIDOR IN ('READMISSAO') AND DIA_COMECO_CICLO_SEGUINTE IS NOT NULL THEN DIA_COMECO_CICLO_SEGUINTE
  WHEN TIPO_VW_DADOS_SERVIDOR IN ('READMISSAO') AND DIA_COMECO_CICLO_SEGUINTE IS  NULL THEN NULL
  WHEN TIPO_VW_DADOS_SERVIDOR NOT IN  ('DIARIA_NOVOS', 'READMISSAO','DESLIGAMENTO') AND ALTEROU_CODIGO_ESCALA = 'CODIGO_ESCALA_MUDOU' AND DIA_COMECO_CICLO_SEGUINTE IS NOT NULL THEN DIA_COMECO_CICLO_SEGUINTE
  WHEN TIPO_VW_DADOS_SERVIDOR NOT IN ('DIARIA_NOVOS', 'READMISSAO','DESLIGAMENTO') AND ALTEROU_CODIGO_ESCALA = 'CODIGO_ESCALA_MUDOU' AND DIA_COMECO_CICLO_SEGUINTE IS NULL THEN NULL
  WHEN TIPO_VW_DADOS_SERVIDOR NOT IN ('DIARIA_NOVOS', 'READMISSAO','DESLIGAMENTO') AND ALTEROU_CODIGO_ESCALA = 'CODIGO_ESCALA_IGUAL' AND (ALTEROU_INI_ESCALA='DATA_ESCALA_MUDOU' OR ALTEROU_DIA_CICLO_ESCALA='DIA_CICLO_MUDOU' )AND DIA_COMECO_CICLO_SEGUINTE IS NOT NULL THEN DIA_COMECO_CICLO_SEGUINTE
  ELSE NULL END DIA_COMECO_CICLO,

----------------------------------------------------- CODIGO_UNIDADE 1 31/07/2019------------------------------------
  CASE WHEN TIPO_VW_DADOS_SERVIDOR IN  ('DIARIA_NOVOS') THEN COD_UNIDADE1
  WHEN TIPO_VW_DADOS_SERVIDOR IN ('READMISSAO') THEN COD_UNIDADE1_SEGUINTE
  /*WHEN TIPO_VW_DADOS_SERVIDOR NOT IN  ('DIARIA_NOVOS', 'READMISSAO','DESLIGAMENTO') AND (ALTEROU_LOCAL = 'LOCAL_MUDOU' OR  (ALTEROU_CPF_GESTOR = 'CPF_GESTOR_MUDOU' AND TIPO_SEGUINTE = 'HIERARQUIA POR LOCAL'))AND SITUACAO_FUNCIONAL_SEGUINTE = '1017' THEN '000099'
  WHEN TIPO_VW_DADOS_SERVIDOR NOT IN  ('DIARIA_NOVOS', 'READMISSAO','DESLIGAMENTO') AND (ALTEROU_LOCAL = 'LOCAL_MUDOU' OR  (ALTEROU_CPF_GESTOR = 'CPF_GESTOR_MUDOU' AND TIPO_SEGUINTE = 'HIERARQUIA POR LOCAL'))AND REGISTRO_PONTO_SEGUINTE = '0110' THEN '000099'*/
  WHEN TIPO_VW_DADOS_SERVIDOR NOT IN  ('DIARIA_NOVOS', 'READMISSAO','DESLIGAMENTO') AND (ALTEROU_LOCAL = 'LOCAL_MUDOU' OR  (ALTEROU_CPF_GESTOR = 'CPF_GESTOR_MUDOU' AND TIPO_SEGUINTE = 'HIERARQUIA POR LOCAL')) THEN COD_UNIDADE1_SEGUINTE
  ELSE NULL END AS COD_UNIDADE1,

------------------------------------------CODIGO_UNIDADE 2 01/08/2019
  CASE WHEN TIPO_VW_DADOS_SERVIDOR IN ('DIARIA_NOVOS') THEN COD_UNIDADE2
  WHEN TIPO_VW_DADOS_SERVIDOR IN ('READMISSAO') THEN COD_UNIDADE2_SEGUINTE
  /*WHEN TIPO_VW_DADOS_SERVIDOR NOT IN  ('DIARIA_NOVOS', 'READMISSAO','DESLIGAMENTO') AND (ALTEROU_LOCAL = 'LOCAL_MUDOU' OR  (ALTEROU_CPF_GESTOR = 'CPF_GESTOR_MUDOU' AND TIPO_SEGUINTE = 'HIERARQUIA POR LOCAL'))AND SITUACAO_FUNCIONAL_SEGUINTE = '1017' THEN '000098'
  WHEN TIPO_VW_DADOS_SERVIDOR NOT IN  ('DIARIA_NOVOS', 'READMISSAO','DESLIGAMENTO') AND (ALTEROU_LOCAL = 'LOCAL_MUDOU' OR  (ALTEROU_CPF_GESTOR = 'CPF_GESTOR_MUDOU' AND TIPO_SEGUINTE = 'HIERARQUIA POR LOCAL'))AND REGISTRO_PONTO_SEGUINTE = '0110' THEN '000098'*/
  WHEN TIPO_VW_DADOS_SERVIDOR NOT IN  ('DIARIA_NOVOS', 'READMISSAO','DESLIGAMENTO') AND (ALTEROU_LOCAL = 'LOCAL_MUDOU' OR  (ALTEROU_CPF_GESTOR = 'CPF_GESTOR_MUDOU' AND TIPO_SEGUINTE = 'HIERARQUIA POR LOCAL'))THEN COD_UNIDADE2_SEGUINTE
  ELSE NULL END AS COD_UNIDADE2,
---------------------------------------------CODIGO_UNIDADE 3 01/08/2019-----------------------------------------------
 CASE WHEN TIPO_VW_DADOS_SERVIDOR IN ('DIARIA_NOVOS') THEN COD_UNIDADE3
  WHEN TIPO_VW_DADOS_SERVIDOR IN ('READMISSAO') THEN COD_UNIDADE3_SEGUINTE
 /* WHEN TIPO_VW_DADOS_SERVIDOR NOT IN  ('DIARIA_NOVOS', 'READMISSAO','DESLIGAMENTO') AND (ALTEROU_LOCAL = 'LOCAL_MUDOU' OR  (ALTEROU_CPF_GESTOR = 'CPF_GESTOR_MUDOU' AND TIPO_SEGUINTE = 'HIERARQUIA POR LOCAL'))AND SITUACAO_FUNCIONAL_SEGUINTE = '1017' THEN '000004'
  WHEN TIPO_VW_DADOS_SERVIDOR NOT IN  ('DIARIA_NOVOS', 'READMISSAO','DESLIGAMENTO') AND (ALTEROU_LOCAL = 'LOCAL_MUDOU' OR  (ALTEROU_CPF_GESTOR = 'CPF_GESTOR_MUDOU' AND TIPO_SEGUINTE = 'HIERARQUIA POR LOCAL'))AND REGISTRO_PONTO_SEGUINTE = '0110' THEN '000004'*/
  WHEN TIPO_VW_DADOS_SERVIDOR NOT IN  ('DIARIA_NOVOS', 'READMISSAO','DESLIGAMENTO') AND (ALTEROU_LOCAL = 'LOCAL_MUDOU' OR  (ALTEROU_CPF_GESTOR = 'CPF_GESTOR_MUDOU' AND TIPO_SEGUINTE = 'HIERARQUIA POR LOCAL')) THEN COD_UNIDADE3_SEGUINTE
  ELSE NULL END AS COD_UNIDADE3,
-----------------------------------------------CODIGO_UNIDADE 4 01/08/2019---------------------------------------
  CASE WHEN TIPO_VW_DADOS_SERVIDOR IN ('DIARIA_NOVOS') THEN COD_UNIDADE4
  WHEN TIPO_VW_DADOS_SERVIDOR IN ('READMISSAO') THEN COD_UNIDADE4_SEGUINTE
  /*WHEN TIPO_VW_DADOS_SERVIDOR NOT IN  ('DIARIA_NOVOS', 'READMISSAO','DESLIGAMENTO') AND (ALTEROU_LOCAL = 'LOCAL_MUDOU' OR  (ALTEROU_CPF_GESTOR = 'CPF_GESTOR_MUDOU' AND TIPO_SEGUINTE = 'HIERARQUIA POR LOCAL'))AND SITUACAO_FUNCIONAL_SEGUINTE = '1017' THEN '000000'
  WHEN TIPO_VW_DADOS_SERVIDOR NOT IN  ('DIARIA_NOVOS', 'READMISSAO','DESLIGAMENTO') AND (ALTEROU_LOCAL = 'LOCAL_MUDOU' OR  (ALTEROU_CPF_GESTOR = 'CPF_GESTOR_MUDOU' AND TIPO_SEGUINTE = 'HIERARQUIA POR LOCAL'))AND REGISTRO_PONTO_SEGUINTE = '0110' THEN '000000'*/
  WHEN TIPO_VW_DADOS_SERVIDOR NOT IN  ('DIARIA_NOVOS', 'READMISSAO','DESLIGAMENTO') AND (ALTEROU_LOCAL = 'LOCAL_MUDOU' OR  (ALTEROU_CPF_GESTOR = 'CPF_GESTOR_MUDOU' AND TIPO_SEGUINTE = 'HIERARQUIA POR LOCAL'))THEN COD_UNIDADE4_SEGUINTE
  ELSE NULL END AS COD_UNIDADE4,
------------------------------------------CODIGO_UNIDADE 5 01/08/2019 ---------------------------------------------------
  CASE WHEN TIPO_VW_DADOS_SERVIDOR IN ('DIARIA_NOVOS') THEN COD_UNIDADE5
  WHEN TIPO_VW_DADOS_SERVIDOR IN ('READMISSAO') THEN COD_UNIDADE5_SEGUINTE
 /* WHEN TIPO_VW_DADOS_SERVIDOR NOT IN  ('DIARIA_NOVOS', 'READMISSAO','DESLIGAMENTO') AND (ALTEROU_LOCAL = 'LOCAL_MUDOU' OR  (ALTEROU_CPF_GESTOR = 'CPF_GESTOR_MUDOU' AND TIPO_SEGUINTE = 'HIERARQUIA POR LOCAL'))AND SITUACAO_FUNCIONAL_SEGUINTE = '1017' THEN '000000'
  WHEN TIPO_VW_DADOS_SERVIDOR NOT IN  ('DIARIA_NOVOS', 'READMISSAO','DESLIGAMENTO') AND (ALTEROU_LOCAL = 'LOCAL_MUDOU' OR  (ALTEROU_CPF_GESTOR = 'CPF_GESTOR_MUDOU' AND TIPO_SEGUINTE = 'HIERARQUIA POR LOCAL'))AND REGISTRO_PONTO_SEGUINTE = '0110' THEN '000000'*/
  WHEN TIPO_VW_DADOS_SERVIDOR NOT IN  ('DIARIA_NOVOS', 'READMISSAO','DESLIGAMENTO') AND (ALTEROU_LOCAL = 'LOCAL_MUDOU' OR  (ALTEROU_CPF_GESTOR = 'CPF_GESTOR_MUDOU' AND TIPO_SEGUINTE = 'HIERARQUIA POR LOCAL'))THEN COD_UNIDADE5_SEGUINTE
  ELSE NULL END AS COD_UNIDADE5,
------------------------------------------CODIGO_UNIDADE 6 01/08/2019 ---------------------------------------------------
 CASE WHEN TIPO_VW_DADOS_SERVIDOR IN ('DIARIA_NOVOS') THEN COD_UNIDADE6
  WHEN TIPO_VW_DADOS_SERVIDOR IN ('READMISSAO') THEN COD_UNIDADE6_SEGUINTE
  /*WHEN TIPO_VW_DADOS_SERVIDOR NOT IN  ('DIARIA_NOVOS', 'READMISSAO','DESLIGAMENTO') AND (ALTEROU_LOCAL = 'LOCAL_MUDOU' OR  (ALTEROU_CPF_GESTOR = 'CPF_GESTOR_MUDOU' AND TIPO_SEGUINTE = 'HIERARQUIA POR LOCAL'))AND SITUACAO_FUNCIONAL_SEGUINTE = '1017' THEN '000000'
  WHEN TIPO_VW_DADOS_SERVIDOR NOT IN  ('DIARIA_NOVOS', 'READMISSAO','DESLIGAMENTO') AND (ALTEROU_LOCAL = 'LOCAL_MUDOU' OR  (ALTEROU_CPF_GESTOR = 'CPF_GESTOR_MUDOU' AND TIPO_SEGUINTE = 'HIERARQUIA POR LOCAL'))AND REGISTRO_PONTO_SEGUINTE = '0110' THEN '000000'*/
  WHEN TIPO_VW_DADOS_SERVIDOR NOT IN  ('DIARIA_NOVOS', 'READMISSAO','DESLIGAMENTO') AND (ALTEROU_LOCAL = 'LOCAL_MUDOU' OR  (ALTEROU_CPF_GESTOR = 'CPF_GESTOR_MUDOU' AND TIPO_SEGUINTE = 'HIERARQUIA POR LOCAL'))THEN COD_UNIDADE6_SEGUINTE
  ELSE NULL END AS COD_UNIDADE6,
------------------------------------------------------------------------------------------------DESCRICAO_UNIDADE-----------------------------------------------------------------------------------------------------------------------------------------------------------
 CASE WHEN TIPO_VW_DADOS_SERVIDOR IN ('DIARIA_NOVOS') THEN SUBSTR(DESCRICAO_UNIDADE,1,55)
  WHEN TIPO_VW_DADOS_SERVIDOR  IN   ('READMISSAO') THEN SUBSTR(DESCRICAO_UNIDADE_SEGUINTE,1,55)
  /*WHEN TIPO_VW_DADOS_SERVIDOR not in ('DIARIA_NOVOS', 'READMISSAO','DESLIGAMENTO') AND (ALTEROU_LOCAL = 'LOCAL_MUDOU' OR  (ALTEROU_CPF_GESTOR = 'CPF_GESTOR_MUDOU' AND TIPO_SEGUINTE = 'HIERARQUIA POR LOCAL'))AND SITUACAO_FUNCIONAL_SEGUINTE = '1017' THEN '1017-ATIVO CARGO COMISSIONADO OUTRO BM'
  WHEN TIPO_VW_DADOS_SERVIDOR not in ('DIARIA_NOVOS', 'READMISSAO','DESLIGAMENTO') AND (ALTEROU_LOCAL = 'LOCAL_MUDOU' OR  (ALTEROU_CPF_GESTOR = 'CPF_GESTOR_MUDOU' AND TIPO_SEGUINTE = 'HIERARQUIA POR LOCAL'))AND REGISTRO_PONTO_SEGUINTE = '0110' THEN '0110-REGISTRO MANUAL-LOCAL SEM RELOGIO'*/
  WHEN TIPO_VW_DADOS_SERVIDOR not in ('DIARIA_NOVOS', 'READMISSAO','DESLIGAMENTO') AND (ALTEROU_LOCAL = 'LOCAL_MUDOU' OR  (ALTEROU_CPF_GESTOR = 'CPF_GESTOR_MUDOU' AND TIPO_SEGUINTE = 'HIERARQUIA POR LOCAL')) THEN DESCRICAO_UNIDADE_SEGUINTE
  ELSE NULL END AS DESCRICAO_UNIDADE,
---------------------------------------=-------------------------------------------------------------------------CARGO_EFETIVO 01/08/2019---------------------------------------------------------------------------------------------------------------------
  CASE  WHEN TIPO_VW_DADOS_SERVIDOR IN ('DIARIA_NOVOS') AND (cod_cargo_efetivo is null or cod_cargo_efetivo = '000000000000000') THEN NULL
   WHEN TIPO_VW_DADOS_SERVIDOR IN ( 'READMISSAO') AND (COD_CARGO_EFETIVO_SEGUINTE is null or COD_CARGO_EFETIVO_SEGUINTE = '000000000000000') THEN NULL
   WHEN TIPO_VW_DADOS_SERVIDOR IN  ('DIARIA_NOVOS') AND (cod_cargo_efetivo is NOT null or cod_cargo_efetivo <> '000000000000000') THEN SUBSTR(CODIGO_EMPRESA,3,2)||SUBSTR(COD_CARGO_EFETIVO,11,5)
   WHEN TIPO_VW_DADOS_SERVIDOR IN  ('READMISSAO') AND (COD_CARGO_EFETIVO_SEGUINTE is NOT null or COD_CARGO_EFETIVO_SEGUINTE <> '000000000000000') THEN SUBSTR(CODIGO_EMPRESA,3,2)||SUBSTR(COD_CARGO_EFETIVO_SEGUINTE,11,5)
   WHEN TIPO_VW_DADOS_SERVIDOR NOT IN ('READMISSAO','DIARIA_NOVOS','DESLIGAMENTO')AND ALTEROU_COD_CARGO_EFETIVO = 'COD_CARGO_EFETIVO_MUDOU' AND (COD_CARGO_EFETIVO_SEGUINTE is null or COD_CARGO_EFETIVO_SEGUINTE = '000000000000000') THEN NULL
   WHEN TIPO_VW_DADOS_SERVIDOR NOT IN ('READMISSAO','DIARIA_NOVOS','DESLIGAMENTO')AND (cod_cargo_COMISS_SEGUINTE is null or cod_cargo_COMISS_SEGUINTE = '000000000000000')AND (codIGO_FUNCAO_SEGUINTE is null or codIGO_FUNCAO_SEGUINTE = '000000000000000')AND (ALTEROU_CODIGO_FUNCAO = 'CODIGO_FUNCAO_MUDOU' or ALTEROU_COD_CARGO_COMISS = 'COD_CARGO_COMISS_MUDOU')THEN SUBSTR(CODIGO_EMPRESA,3,2)||SUBSTR(COD_CARGO_EFETIVO_SEGUINTE,11,5)
   WHEN TIPO_VW_DADOS_SERVIDOR NOT IN ('READMISSAO','DIARIA_NOVOS','DESLIGAMENTO')AND ALTEROU_COD_CARGO_EFETIVO = 'COD_CARGO_EFETIVO_MUDOU' AND (COD_CARGO_EFETIVO_SEGUINTE is NOT null or COD_CARGO_EFETIVO_SEGUINTE <> '000000000000000') THEN SUBSTR(CODIGO_EMPRESA,3,2)||SUBSTR(COD_CARGO_EFETIVO_SEGUINTE,11,5)

   ELSE NULL END AS CODIGO_CARGO_EFETIVO,
------------------------------------------------------------------------------------------------------------DESCRICAO_CARGO EFETIVO --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  CASE  WHEN TIPO_VW_DADOS_SERVIDOR IN ('DIARIA_NOVOS') AND (cod_cargo_efetivo is null or cod_cargo_efetivo = '000000000000000') THEN NULL
   WHEN TIPO_VW_DADOS_SERVIDOR IN ( 'READMISSAO') AND (COD_CARGO_EFETIVO_SEGUINTE is null or COD_CARGO_EFETIVO_SEGUINTE = '000000000000000') THEN NULL
   WHEN TIPO_VW_DADOS_SERVIDOR IN  ('DIARIA_NOVOS') AND (cod_cargo_efetivo is NOT null or cod_cargo_efetivo <> '000000000000000') THEN CARGO_EFETIVO
   WHEN TIPO_VW_DADOS_SERVIDOR IN  ('READMISSAO') AND (COD_CARGO_EFETIVO_SEGUINTE is NOT null or COD_CARGO_EFETIVO_SEGUINTE <> '000000000000000') THEN CARGO_EFETIVO_SEGUINTE
   WHEN TIPO_VW_DADOS_SERVIDOR NOT IN ('READMISSAO','DIARIA_NOVOS','DESLIGAMENTO')AND (cod_cargo_COMISS_SEGUINTE is null or cod_cargo_COMISS_SEGUINTE = '000000000000000')AND (codIGO_FUNCAO_SEGUINTE is null or codIGO_FUNCAO_SEGUINTE = '000000000000000')AND (ALTEROU_CODIGO_FUNCAO = 'CODIGO_FUNCAO_MUDOU' or ALTEROU_COD_CARGO_COMISS = 'COD_CARGO_COMISS_MUDOU')THEN CARGO_EFETIVO_SEGUINTE
   WHEN TIPO_VW_DADOS_SERVIDOR NOT IN ('READMISSAO','DIARIA_NOVOS','DESLIGAMENTO')AND ALTEROU_COD_CARGO_EFETIVO = 'COD_CARGO_EFETIVO_MUDOU' AND (COD_CARGO_EFETIVO_SEGUINTE is null or COD_CARGO_EFETIVO_SEGUINTE = '000000000000000') THEN NULL
   WHEN TIPO_VW_DADOS_SERVIDOR NOT IN ('READMISSAO','DIARIA_NOVOS','DESLIGAMENTO')AND ALTEROU_COD_CARGO_EFETIVO = 'COD_CARGO_EFETIVO_MUDOU' AND (COD_CARGO_EFETIVO_SEGUINTE is NOT null or COD_CARGO_EFETIVO_SEGUINTE <> '000000000000000') THEN CARGO_EFETIVO_SEGUINTE
   ELSE NULL END AS DESCRICAO_CARGO_EFETIVO,
-------------------------------------------  CARGO COMISS 01/08/2019------------------------------------------------------------------
  CASE WHEN TIPO_VW_DADOS_SERVIDOR IN ('DIARIA_NOVOS') AND (cod_cargo_COMISS IS NULL OR cod_cargo_COMISS = '000000000000000')AND (codIGO_FUNCAO is null or codIGO_FUNCAO = '000000000000000') THEN NULL
   WHEN TIPO_VW_DADOS_SERVIDOR IN ('DIARIA_NOVOS') AND (cod_cargo_COMISS IS NOT NULL OR  cod_cargo_COMISS <> '000000000000000')AND (codIGO_FUNCAO is NOT null or codIGO_FUNCAO <> '000000000000000') THEN SUBSTR(CODIGO_EMPRESA,3,2)|| 9 || SUBSTR(codigo_funcao,12,4)
   WHEN TIPO_VW_DADOS_SERVIDOR IN ('DIARIA_NOVOS') AND (cod_cargo_COMISS IS  NULL OR  cod_cargo_COMISS = '000000000000000')AND (codIGO_FUNCAO is NOT null or codIGO_FUNCAO <> '000000000000000') THEN SUBSTR(CODIGO_EMPRESA,3,2)||9 || SUBSTR(codigo_funcao,12,4)
   WHEN TIPO_VW_DADOS_SERVIDOR IN ('DIARIA_NOVOS') AND (cod_cargo_COMISS is NOT null or cod_cargo_COMISS <> '000000000000000')AND (codIGO_FUNCAO is null or codIGO_FUNCAO = '000000000000000')THEN SUBSTR(CODIGO_EMPRESA,3,2)||SUBSTR(COD_CARGO_COMISS,11,5)
   WHEN TIPO_VW_DADOS_SERVIDOR IN ('READMISSAO') AND (cod_cargo_COMISS_SEGUINTE IS NULL OR cod_cargo_COMISS_SEGUINTE = '000000000000000')AND (codigo_funcao_SEGUINTE is null or codigo_funcao_SEGUINTE = '000000000000000') THEN NULL
   WHEN TIPO_VW_DADOS_SERVIDOR IN ('READMISSAO') AND (cod_cargo_COMISS_SEGUINTE IS NOT NULL OR  cod_cargo_COMISS_SEGUINTE <> '000000000000000')AND (codigo_funcao_SEGUINTE is NOT null or codigo_funcao_SEGUINTE <> '000000000000000')THEN SUBSTR(CODIGO_EMPRESA,3,2)||9 || SUBSTR(codigo_funcao_SEGUINTE,12,4)
   WHEN TIPO_VW_DADOS_SERVIDOR IN ('READMISSAO') AND (cod_cargo_COMISS_SEGUINTE is NOT null or cod_cargo_COMISS_SEGUINTE <> '000000000000000')AND (codigo_funcao_SEGUINTE is null or codigo_funcao_SEGUINTE = '000000000000000')THEN SUBSTR(CODIGO_EMPRESA,3,2)||SUBSTR(COD_CARGO_COMISS_SEGUINTE,11,5)
   WHEN TIPO_VW_DADOS_SERVIDOR NOT IN ('DIARIA_NOVOS', 'READMISSAO','DESLIGAMENTO') AND (cod_cargo_COMISS_SEGUINTE is null or cod_cargo_COMISS_SEGUINTE = '000000000000000')AND (codIGO_FUNCAO_SEGUINTE is null or codIGO_FUNCAO_SEGUINTE = '000000000000000')AND (ALTEROU_CODIGO_FUNCAO = 'CODIGO_FUNCAO_MUDOU' or ALTEROU_COD_CARGO_COMISS = 'COD_CARGO_COMISS_MUDOU')  THEN NULL
   WHEN TIPO_VW_DADOS_SERVIDOR NOT IN ('DIARIA_NOVOS', 'READMISSAO','DESLIGAMENTO') AND (cod_cargo_COMISS_SEGUINTE is  null or cod_cargo_COMISS_SEGUINTE = '000000000000000')AND (codIGO_FUNCAO_SEGUINTE is NOT null or codIGO_FUNCAO_SEGUINTE <> '000000000000000') AND (ALTEROU_CODIGO_FUNCAO = 'CODIGO_FUNCAO_MUDOU' or ALTEROU_COD_CARGO_COMISS = 'COD_CARGO_COMISS_MUDOU') THEN SUBSTR(CODIGO_EMPRESA,3,2)|| 9 || SUBSTR(codigo_funcao_SEGUINTE,12,4)
   WHEN TIPO_VW_DADOS_SERVIDOR NOT IN  ('DIARIA_NOVOS', 'READMISSAO','DESLIGAMENTO') AND (cod_cargo_COMISS_SEGUINTE is NOT null or cod_cargo_COMISS_SEGUINTE <> '000000000000000')AND (codIGO_FUNCAO_SEGUINTE is NOT null or codIGO_FUNCAO_SEGUINTE <> '000000000000000') AND (ALTEROU_CODIGO_FUNCAO = 'CODIGO_FUNCAO_MUDOU' or ALTEROU_COD_CARGO_COMISS = 'COD_CARGO_COMISS_MUDOU') THEN SUBSTR(CODIGO_EMPRESA,3,2)|| 9 || SUBSTR(codigo_funcao_SEGUINTE,12,4)
   WHEN TIPO_VW_DADOS_SERVIDOR NOT IN ('DIARIA_NOVOS', 'READMISSAO','DESLIGAMENTO') AND (cod_cargo_COMISS_SEGUINTE is NOT null or cod_cargo_COMISS_SEGUINTE <> '000000000000000')AND (codIGO_FUNCAO_SEGUINTE is null or codIGO_FUNCAO_SEGUINTE = '000000000000000') AND (ALTEROU_CODIGO_FUNCAO = 'CODIGO_FUNCAO_MUDOU' or ALTEROU_COD_CARGO_COMISS = 'COD_CARGO_COMISS_MUDOU') THEN SUBSTR(CODIGO_EMPRESA,3,2)||SUBSTR(cod_CARGO_COMISS_SEGUINTE,11,5)
   ELSE NULL end AS CODIGO_CARGO_COMISSIONADO,
--------------------------------------------------------------------------------------------------DESCRICAO CARGO COMISS----------------------------------------------------------------------------------------------------------------------------------------------
  CASE WHEN TIPO_VW_DADOS_SERVIDOR IN ('DIARIA_NOVOS') AND (cod_cargo_COMISS IS NULL OR cod_cargo_COMISS = '000000000000000')AND (codIGO_FUNCAO is null or codIGO_FUNCAO = '000000000000000') THEN NULL
   WHEN TIPO_VW_DADOS_SERVIDOR IN ('DIARIA_NOVOS') AND (cod_cargo_COMISS IS NOT NULL OR  cod_cargo_COMISS <> '000000000000000')AND (codIGO_FUNCAO is NOT null or codIGO_FUNCAO <> '000000000000000') THEN FUNCAO_PUBLICA
   WHEN TIPO_VW_DADOS_SERVIDOR IN ('DIARIA_NOVOS') AND (cod_cargo_COMISS IS  NULL OR  cod_cargo_COMISS = '000000000000000')AND (codIGO_FUNCAO is NOT null or codIGO_FUNCAO <> '000000000000000') THEN FUNCAO_PUBLICA
   WHEN TIPO_VW_DADOS_SERVIDOR IN ('DIARIA_NOVOS') AND (cod_cargo_COMISS is NOT null or cod_cargo_COMISS <> '000000000000000')AND (codIGO_FUNCAO is null or codIGO_FUNCAO = '000000000000000')THEN CARGO_COMISSIONADO
   WHEN TIPO_VW_DADOS_SERVIDOR IN ('READMISSAO') AND (cod_cargo_COMISS_SEGUINTE IS NULL OR cod_cargo_COMISS_SEGUINTE = '000000000000000')AND (codigo_funcao_SEGUINTE is null or codigo_funcao_SEGUINTE = '000000000000000') THEN NULL
   WHEN TIPO_VW_DADOS_SERVIDOR IN ('READMISSAO') AND (cod_cargo_COMISS_SEGUINTE IS NOT NULL OR  cod_cargo_COMISS_SEGUINTE <> '000000000000000')AND (codigo_funcao_SEGUINTE is NOT null or codigo_funcao_SEGUINTE <> '000000000000000')THEN FUNCAO_PUBLICA_SEGUINTE
   WHEN TIPO_VW_DADOS_SERVIDOR IN ('READMISSAO') AND (cod_cargo_COMISS_SEGUINTE is NOT null or cod_cargo_COMISS_SEGUINTE <> '000000000000000')AND (codigo_funcao_SEGUINTE is null or codigo_funcao_SEGUINTE = '000000000000000')THEN CARGO_COMISSIONADO_SEGUINTE
   WHEN TIPO_VW_DADOS_SERVIDOR NOT IN ('DIARIA_NOVOS', 'READMISSAO','DESLIGAMENTO') AND (cod_cargo_COMISS_SEGUINTE is null or cod_cargo_COMISS_SEGUINTE = '000000000000000')AND (codIGO_FUNCAO_SEGUINTE is null or codIGO_FUNCAO_SEGUINTE = '000000000000000')AND (ALTEROU_CODIGO_FUNCAO = 'CODIGO_FUNCAO_MUDOU' or ALTEROU_COD_CARGO_COMISS = 'COD_CARGO_COMISS_MUDOU')  THEN NULL
   WHEN TIPO_VW_DADOS_SERVIDOR NOT IN ('DIARIA_NOVOS', 'READMISSAO','DESLIGAMENTO') AND (cod_cargo_COMISS_SEGUINTE is  null or cod_cargo_COMISS_SEGUINTE = '000000000000000')AND (codIGO_FUNCAO_SEGUINTE is NOT null or codIGO_FUNCAO_SEGUINTE <> '000000000000000') AND (ALTEROU_CODIGO_FUNCAO = 'CODIGO_FUNCAO_MUDOU' or ALTEROU_COD_CARGO_COMISS = 'COD_CARGO_COMISS_MUDOU') THEN FUNCAO_PUBLICA_SEGUINTE
   WHEN TIPO_VW_DADOS_SERVIDOR NOT IN  ('DIARIA_NOVOS', 'READMISSAO','DESLIGAMENTO') AND (cod_cargo_COMISS_SEGUINTE is NOT null or cod_cargo_COMISS_SEGUINTE <> '000000000000000')AND (codIGO_FUNCAO_SEGUINTE is NOT null or codIGO_FUNCAO_SEGUINTE <> '000000000000000') AND (ALTEROU_CODIGO_FUNCAO = 'CODIGO_FUNCAO_MUDOU' or ALTEROU_COD_CARGO_COMISS = 'COD_CARGO_COMISS_MUDOU') THEN FUNCAO_PUBLICA_SEGUINTE
   WHEN TIPO_VW_DADOS_SERVIDOR NOT IN ('DIARIA_NOVOS', 'READMISSAO','DESLIGAMENTO') AND (cod_cargo_COMISS_SEGUINTE is NOT null or cod_cargo_COMISS_SEGUINTE <> '000000000000000')AND (codIGO_FUNCAO_SEGUINTE is null or codIGO_FUNCAO_SEGUINTE = '000000000000000') AND (ALTEROU_CODIGO_FUNCAO = 'CODIGO_FUNCAO_MUDOU' or ALTEROU_COD_CARGO_COMISS = 'COD_CARGO_COMISS_MUDOU') THEN CARGO_COMISSIONADO_SEGUINTE
   ELSE NULL end AS DESCRICAO_CARGO_COMISSIONADO,
------------------------------------------------------DATA DE ADMISSAO  01/08/2019-------------------------------------------------------------------
 CASE WHEN TIPO_VW_DADOS_SERVIDOR IN ('DIARIA_NOVOS') AND DATA_ADMISSAO IS NOT NULL THEN DATA_ADMISSAO
  WHEN TIPO_VW_DADOS_SERVIDOR IN ('DIARIA_NOVOS') AND DATA_ADMISSAO IS NULL THEN DT_SAIU_ARTE
  WHEN TIPO_VW_DADOS_SERVIDOR IN ('READMISSAO')AND DATA_ADMISSAO_SEGUINTE IS NOT NULL THEN DATA_ADMISSAO_SEGUINTE
  WHEN TIPO_VW_DADOS_SERVIDOR IN ('READMISSAO')AND DATA_ADMISSAO_SEGUINTE IS NULL THEN DT_SAIU_ARTE
  WHEN TIPO_VW_DADOS_SERVIDOR NOT IN ('DIARIA_NOVOS','READMISSAO','DESLIGAMENTO') AND DATA_ADMISSAO_SEGUINTE IS NOT NULL AND DATA_ADMISSAO<>DATA_ADMISSAO_SEGUINTE THEN DATA_ADMISSAO_SEGUINTE
  WHEN TIPO_VW_DADOS_SERVIDOR NOT IN ('DIARIA_NOVOS','READMISSAO','DESLIGAMENTO') AND DATA_ADMISSAO_SEGUINTE IS  NULL AND DATA_ADMISSAO<>DATA_ADMISSAO_SEGUINTE THEN DT_SAIU_ARTE

  ELSE NULL END AS DATA_ADMISSAO,
-----------------------------------------------------DATA_RESCISAO 01/08/2019 -----------------------------------------------------------------------------------
 CASE 
   WHEN DATA_RESCISAO IS NOT NULL AND TIPO_VW_DADOS_SERVIDOR IN('DESLIGAMENTO') AND VINCULO <> '0009' AND SITUACAO_FUNCIONAL_SEGUINTE <>'1851' THEN TO_DATE(DATA_RESCISAO,'DD/MM/YYYY') --INCLUIDO EM 3/2/23
   WHEN DATA_RESCISAO IS NULL AND TIPO_VW_DADOS_SERVIDOR IN('DESLIGAMENTO') AND VINCULO = '0009' AND SITUACAO_FUNCIONAL_SEGUINTE='1851' THEN  (SELECT S.DATA_INIC_SITUACAO FROM ARTERH.RHCGED_ALT_SIT_FUN S WHERE S.CODIGO_EMPRESA  =CODIGO_EMPRESA
   AND S.CODIGO =CODIGO_CONTRATO AND S.TIPO_CONTRATO=TIPO_CONTRATO AND S.COD_SIT_FUNCIONAL =SITUACAO_FUNCIONAL_SEGUINTE
   AND S.DATA_INIC_SITUACAO =(SELECT MAX(AUX.DATA_INIC_SITUACAO)FROM RHCGED_ALT_SIT_FUN AUX WHERE S.CODIGO_EMPRESA =AUX.CODIGO_EMPRESA AND S.CODIGO=AUX.CODIGO
   AND S.TIPO_CONTRATO    =AUX.TIPO_CONTRATO))
   WHEN DATA_RESCISAO IS NULL AND TIPO_VW_DADOS_SERVIDOR IN('DESLIGAMENTO') AND SITUACAO_FUNCIONAL_SEGUINTE<>'1851'  THEN  (SELECT S.DATA_INIC_SITUACAO --COMENTADO O MENOS 1 EM 3/2/23 DEVIDO EMAIL(Divergência no ponto - BM 313.268-2) -1 
   FROM ARTERH.RHCGED_ALT_SIT_FUN S WHERE S.CODIGO_EMPRESA  =CODIGO_EMPRESA
   AND S.CODIGO =CODIGO_CONTRATO AND S.TIPO_CONTRATO=TIPO_CONTRATO AND S.COD_SIT_FUNCIONAL =SITUACAO_FUNCIONAL_SEGUINTE
   AND S.DATA_INIC_SITUACAO =(SELECT MAX(AUX.DATA_INIC_SITUACAO)FROM RHCGED_ALT_SIT_FUN AUX WHERE S.CODIGO_EMPRESA =AUX.CODIGO_EMPRESA AND S.CODIGO=AUX.CODIGO
   AND S.TIPO_CONTRATO    =AUX.TIPO_CONTRATO))
  ELSE NULL  END AS DATA_RESCISAO,
----------------------------------------------------------- TIPO_USUARIO 01/08/2019 DEIXEI DE USAR EM 20/08/2019-----------------------------------------------
 /*CASE WHEN TIPO_VW_DADOS_SERVIDOR IN('DIARIA_NOVOS') AND E_GESTOR = 'N' AND VINCULO = '0009' THEN 'Estagiario'
  WHEN TIPO_VW_DADOS_SERVIDOR IN ('DIARIA_NOVOS') AND E_GESTOR = 'N'  AND  VINCULO <> '0009' THEN 'Servidor'
  WHEN TIPO_VW_DADOS_SERVIDOR IN ('DIARIA_NOVOS') AND E_GESTOR = 'S'  AND  VINCULO <> '0009' THEN 'Gestor'
  WHEN TIPO_VW_DADOS_SERVIDOR IN ('READMISSAO') AND E_GESTOR_SEGUINTE = 'N' AND VINCULO ='0009'THEN 'Estagiario'
  WHEN TIPO_VW_DADOS_SERVIDOR IN ('READMISSAO') AND E_GESTOR_SEGUINTE = 'N'  AND  VINCULO <> '0009' THEN 'Servidor'
  WHEN TIPO_VW_DADOS_SERVIDOR IN ('READMISSAO') AND E_GESTOR_SEGUINTE = 'S'  AND  VINCULO <> '0009' THEN 'Gestor'
  WHEN TIPO_VW_DADOS_SERVIDOR NOT IN ('DIARIA_NOVOS','READMISSAO','DESLIGAMENTO') AND (ALTEROU_E_GESTOR = 'E_GESTOR_MUDOU' OR ALTEROU_REGISTRO_PONTO = 'REGISTRO_PONTO_MUDOU')AND VINCULO ='0009'THEN'Estagiario'
  WHEN TIPO_VW_DADOS_SERVIDOR NOT IN ('DIARIA_NOVOS','READMISSAO','DESLIGAMENTO') AND (ALTEROU_E_GESTOR = 'E_GESTOR_MUDOU' OR ALTEROU_REGISTRO_PONTO = 'REGISTRO_PONTO_MUDOU')AND VINCULO <>'0009' AND E_GESTOR_SEGUINTE ='N' THEN 'Servidor'
  WHEN TIPO_VW_DADOS_SERVIDOR NOT IN ('DIARIA_NOVOS','READMISSAO','DESLIGAMENTO') AND (ALTEROU_E_GESTOR = 'E_GESTOR_MUDOU' OR ALTEROU_REGISTRO_PONTO = 'REGISTRO_PONTO_MUDOU')AND VINCULO <>'0009' AND E_GESTOR_SEGUINTE ='S'THEN 'Gestor'
  ELSE NULL END AS TIPO_USUARIO,*/
-------------------------------------------------------------NOVO TIPO DE USUARIO AGURDANDO TESTE CAMPO NA VW(COD_TIPO_PESSOA) 01/08/2019--------------------------------------------------------------------------------
 CASE WHEN TIPO_VW_DADOS_SERVIDOR IN  ('DIARIA_NOVOS') AND E_GESTOR='N' AND  VINCULO = '0009'AND TIPO_USUARIO NOT IN ('USA_NAVEGADOR','USA_AMBOS') THEN '3'--Estagiario
  WHEN TIPO_VW_DADOS_SERVIDOR IN ('DIARIA_NOVOS') AND E_GESTOR='N' AND  VINCULO <> '0009' AND REGISTRO_PONTO IN ('0010','0020', '0030','0140','0170','0100')AND TIPO_USUARIO NOT IN ('USA_NAVEGADOR','USA_AMBOS') THEN '4'-- Servidor nao registra ponto no login
  WHEN TIPO_VW_DADOS_SERVIDOR IN ('DIARIA_NOVOS') AND E_GESTOR='N' AND  VINCULO <> '0009' AND REGISTRO_PONTO IN('0110','0120','0150','0200')AND TIPO_USUARIO NOT IN ('USA_NAVEGADOR','USA_AMBOS') THEN '13'--Servidor Isento
  WHEN TIPO_VW_DADOS_SERVIDOR IN('DIARIA_NOVOS') AND E_GESTOR='N' AND VINCULO<>'0009' AND REGISTRO_PONTO IN ('0130','0180') AND TIPO_USUARIO NOT IN ('USA_NAVEGADOR','USA_AMBOS')THEN '10' --Servidor 1 marcacao nao registra ponto no login
  WHEN TIPO_VW_DADOS_SERVIDOR IN ('DIARIA_NOVOS') AND E_GESTOR='S' AND VINCULO<>'0009' AND REGISTRO_PONTO IN ('0010','0020', '0030','0140','0170','0100')AND TIPO_USUARIO NOT IN ('USA_NAVEGADOR','USA_AMBOS') THEN '5' --Gestor nao registra no login
  WHEN TIPO_VW_DADOS_SERVIDOR IN ('DIARIA_NOVOS') AND E_GESTOR='S' AND VINCULO<>'0009' AND REGISTRO_PONTO IN ('0130','0180')AND TIPO_USUARIO NOT IN ('USA_NAVEGADOR','USA_AMBOS') THEN '11' --Gestor 1 marcacao nao registra no login
  WHEN TIPO_VW_DADOS_SERVIDOR IN ('DIARIA_NOVOS') AND E_GESTOR='S' AND VINCULO<>'0009' AND REGISTRO_PONTO IN ('0110','0160','0120','0150','0200')AND TIPO_USUARIO NOT IN ('USA_NAVEGADOR','USA_AMBOS') AND CODIGO_EMPRESA <> '0002' THEN '12' --Gestor Isento
  WHEN TIPO_VW_DADOS_SERVIDOR IN ('DIARIA_NOVOS') AND E_GESTOR='S' AND VINCULO<>'0009' AND REGISTRO_PONTO IN ('0110','0160','0120','0150','0200')AND TIPO_USUARIO NOT IN ('USA_NAVEGADOR','USA_AMBOS') AND CODIGO_EMPRESA = '0002' THEN '359' --Prodabel Gestor isento
-------------------------------------------------------------------------------------------------------USA NAVEGADOR E DIARIA_NOVOS  E NAO E GESTROR-----------------------------------------------------------------------------------------------------------------------------

  WHEN TIPO_VW_DADOS_SERVIDOR IN  ('DIARIA_NOVOS') AND E_GESTOR='N' AND  VINCULO = '0009' AND TIPO_USUARIO='USA_NAVEGADOR' THEN '342'--Subordinado- registro desktop
  WHEN TIPO_VW_DADOS_SERVIDOR IN ('DIARIA_NOVOS') AND E_GESTOR='N' AND  VINCULO <> '0009' AND REGISTRO_PONTO IN ('0010','0020', '0030','0140','0170','0100')AND TIPO_USUARIO='USA_NAVEGADOR' THEN '342'--Subordinado- registro desktop
  WHEN TIPO_VW_DADOS_SERVIDOR IN('DIARIA_NOVOS') AND E_GESTOR='N' AND VINCULO<>'0009' AND REGISTRO_PONTO IN ('0130','0180')AND TIPO_USUARIO='USA_NAVEGADOR' THEN '343' --Subordinado 1 marcacao- registro desktop
  WHEN TIPO_VW_DADOS_SERVIDOR IN('DIARIA_NOVOS') AND E_GESTOR='N' AND VINCULO<>'0009' AND REGISTRO_PONTO IN('0110','0160','0120','0150','0200')AND TIPO_USUARIO = 'USA_NAVEGADOR' THEN '13' --Servidor Isento

-------------------------------------------------------------------------------------------USA NAVEGADOR E APP E DIARIA_NOVOS E NAO E GESTOR ----------------------------------------------------------------------------------------------------------------

  WHEN TIPO_VW_DADOS_SERVIDOR IN  ('DIARIA_NOVOS') AND E_GESTOR='N' AND  VINCULO = '0009' AND TIPO_USUARIO='USA_AMBOS'THEN '350'--Subordinado- registro APP e desktop
  WHEN TIPO_VW_DADOS_SERVIDOR IN ('DIARIA_NOVOS') AND E_GESTOR='N' AND  VINCULO <> '0009' AND REGISTRO_PONTO IN ('0010','0020', '0030','0140','0170','0100')AND TIPO_USUARIO='USA_AMBOS' AND CODIGO_EMPRESA <> '0002' THEN '350'--Subordinado- registro APP e desktop
  WHEN TIPO_VW_DADOS_SERVIDOR IN ('DIARIA_NOVOS') AND E_GESTOR='N' AND  VINCULO <> '0009' AND REGISTRO_PONTO IN ('0010','0020', '0030','0140','0170','0100')AND TIPO_USUARIO='USA_AMBOS' AND CODIGO_EMPRESA = '0002' THEN '357'--357- Prodabel Subordinado- registro APP e desktop NOVO EM 31/5/23 EMAIL ([IMPLANTAÇÃO IFPONTO] Tolerância das jornadas fixas)
  WHEN TIPO_VW_DADOS_SERVIDOR IN('DIARIA_NOVOS') AND E_GESTOR='N' AND VINCULO<>'0009' AND REGISTRO_PONTO IN ('0130','0180')AND TIPO_USUARIO='USA_AMBOS' THEN '351'--Subordinado 1 marcacao- registro APP e desktop
  WHEN TIPO_VW_DADOS_SERVIDOR IN('DIARIA_NOVOS') AND E_GESTOR='N' AND VINCULO<>'0009' AND REGISTRO_PONTO IN('0110','0160','0120','0150','0200')AND TIPO_USUARIO='USA_AMBOS' THEN'13'--Servidor Isento

----------------------------------------------------------------------------------------USA NAVEGADOR E DIARIA NOVOS E GESTOR---------------------------------------------------------------------------------------------------------------------------------

  WHEN TIPO_VW_DADOS_SERVIDOR IN ('DIARIA_NOVOS') AND E_GESTOR='S' AND VINCULO<>'0009' AND REGISTRO_PONTO IN ('0010','0020', '0030','0140','0170','0100')AND TIPO_USUARIO='USA_NAVEGADOR' THEN '340'--Gestor- registro desktop
  WHEN TIPO_VW_DADOS_SERVIDOR IN ('DIARIA_NOVOS') AND E_GESTOR='S' AND VINCULO<>'0009' AND REGISTRO_PONTO IN ('0130','0180')AND TIPO_USUARIO='USA_NAVEGADOR' THEN '341'--Gestor 1 marcacao- registro desktop
  WHEN TIPO_VW_DADOS_SERVIDOR IN ('DIARIA_NOVOS') AND E_GESTOR='S' AND VINCULO<>'0009' AND REGISTRO_PONTO IN ('0110','0160','0120','0150','0200')AND TIPO_USUARIO='USA_NAVEGADOR' AND CODIGO_EMPRESA <> '0002' THEN '12'--Gestor Isento
  WHEN TIPO_VW_DADOS_SERVIDOR IN ('DIARIA_NOVOS') AND E_GESTOR='S' AND VINCULO<>'0009' AND REGISTRO_PONTO IN ('0110','0160','0120','0150','0200')AND TIPO_USUARIO='USA_NAVEGADOR' AND CODIGO_EMPRESA = '0002' THEN '359' --Prodabel Gestor isento

----------------------------------------------------------------------------------------USA NAVEGADOR E APP E DIARIA NOVOS E GESTOR---------------------------------------------------------------------------------------------------------------------------------
  WHEN TIPO_VW_DADOS_SERVIDOR IN ('DIARIA_NOVOS') AND E_GESTOR='S' AND VINCULO<>'0009' AND REGISTRO_PONTO IN ('0010','0020', '0030','0140','0170','0100')AND TIPO_USUARIO='USA_AMBOS' AND CODIGO_EMPRESA <> '0002'  THEN '348'--Gestor- registro APP e desktop
  WHEN TIPO_VW_DADOS_SERVIDOR IN ('DIARIA_NOVOS') AND E_GESTOR='S' AND VINCULO<>'0009' AND REGISTRO_PONTO IN ('0010','0020', '0030','0140','0170','0100')AND TIPO_USUARIO='USA_AMBOS' AND CODIGO_EMPRESA = '0002' THEN '360' --Prodabel Gestor - registro APP e desktop
  WHEN TIPO_VW_DADOS_SERVIDOR IN ('DIARIA_NOVOS') AND E_GESTOR='S' AND VINCULO<>'0009' AND REGISTRO_PONTO IN ('0130','0180')AND TIPO_USUARIO='USA_AMBOS' THEN '349'--Gestor 1 marcacao- registro APP e desktop
  WHEN TIPO_VW_DADOS_SERVIDOR IN ('DIARIA_NOVOS') AND E_GESTOR='S' AND VINCULO<>'0009' AND REGISTRO_PONTO IN ('0110','0160','0120','0150','0200')AND TIPO_USUARIO='USA_AMBOS' AND CODIGO_EMPRESA <> '0002' THEN '12'--Gestor Isento
  WHEN TIPO_VW_DADOS_SERVIDOR IN ('DIARIA_NOVOS') AND E_GESTOR='S' AND VINCULO<>'0009' AND REGISTRO_PONTO IN ('0110','0160','0120','0150','0200')AND TIPO_USUARIO='USA_AMBOS' AND CODIGO_EMPRESA = '0002' THEN '359' --Prodabel Gestor isento

----------------------------------------------------------------------------------FIM NOVOS SERVIDORES----------------------------------------------------------------------------------

  WHEN TIPO_VW_DADOS_SERVIDOR IN ('READMISSAO') AND E_GESTOR='N' AND  VINCULO = '0009' AND TIPO_USUARIO_SEGUINTE NOT IN ('USA_NAVEGADOR','USA_AMBOS') THEN '3'--Estagiario
  WHEN TIPO_VW_DADOS_SERVIDOR IN ('READMISSAO') AND E_GESTOR_SEGUINTE='N' AND  VINCULO <> '0009' AND REGISTRO_PONTO_SEGUINTE IN ('0010','0020', '0030','0140','0170','0100')AND TIPO_USUARIO_SEGUINTE NOT IN ('USA_NAVEGADOR','USA_AMBOS') THEN '4'-- Servidor nao registra ponto no login
  WHEN TIPO_VW_DADOS_SERVIDOR IN ('READMISSAO') AND E_GESTOR_SEGUINTE='N' AND  VINCULO <> '0009' AND REGISTRO_PONTO_SEGUINTE IN('0110','0160','0120','0150','0200')AND TIPO_USUARIO_SEGUINTE NOT IN ('USA_NAVEGADOR','USA_AMBOS') THEN '13'--Servidor Isento
  WHEN TIPO_VW_DADOS_SERVIDOR IN ('READMISSAO') AND E_GESTOR_SEGUINTE='N' AND VINCULO<>'0009' AND REGISTRO_PONTO_SEGUINTE IN ('0130','0180')AND TIPO_USUARIO_SEGUINTE NOT IN ('USA_NAVEGADOR','USA_AMBOS') THEN '10'--Servidor 1 marcacao nao registra ponto no login
  WHEN TIPO_VW_DADOS_SERVIDOR IN ('READMISSAO') AND E_GESTOR_SEGUINTE='S' AND VINCULO<>'0009' AND REGISTRO_PONTO_SEGUINTE IN ('0010','0020', '0030','0140','0170','0100')AND TIPO_USUARIO_SEGUINTE NOT IN ('USA_NAVEGADOR','USA_AMBOS') THEN '5'--Gestor nao registra no login
  WHEN TIPO_VW_DADOS_SERVIDOR IN ('READMISSAO') AND E_GESTOR_SEGUINTE='S' AND VINCULO<>'0009' AND REGISTRO_PONTO_SEGUINTE IN ('0130','0180')AND TIPO_USUARIO_SEGUINTE NOT IN ('USA_NAVEGADOR','USA_AMBOS') THEN '11'--Gestor 1 marcacao nao registra no login
  WHEN TIPO_VW_DADOS_SERVIDOR IN ('READMISSAO') AND E_GESTOR_SEGUINTE='S' AND VINCULO<>'0009' AND REGISTRO_PONTO_SEGUINTE IN ('0110','0160','0120','0150','0200')AND TIPO_USUARIO_SEGUINTE NOT IN ('USA_NAVEGADOR','USA_AMBOS') AND CODIGO_EMPRESA <> '0002' THEN '12'--Gestor Isento
  WHEN TIPO_VW_DADOS_SERVIDOR IN ('READMISSAO') AND E_GESTOR_SEGUINTE='S' AND VINCULO<>'0009' AND REGISTRO_PONTO_SEGUINTE IN ('0110','0160','0120','0150','0200')AND TIPO_USUARIO_SEGUINTE NOT IN ('USA_NAVEGADOR','USA_AMBOS') AND CODIGO_EMPRESA = '0002' THEN '359' --Prodabel Gestor isento
---------------------------------------------------------USA NAVEGADOR SERVIDORES READMITDOS -----------------------------------------------------------------------------------------------------------------------
  WHEN TIPO_VW_DADOS_SERVIDOR IN ('READMISSAO') AND  VINCULO = '0009' AND TIPO_USUARIO_SEGUINTE='USA_NAVEGADOR'  AND TIPO_USUARIO_SEGUINTE='USA_NAVEGADOR'  THEN '342'--Subordinado- registro desktop
  WHEN TIPO_VW_DADOS_SERVIDOR IN ('READMISSAO') AND E_GESTOR_SEGUINTE='N' AND  VINCULO <> '0009' AND REGISTRO_PONTO_SEGUINTE IN ('0010','0020', '0030','0140','0170','0100')AND TIPO_USUARIO_SEGUINTE='USA_NAVEGADOR'  THEN '342'--Subordinado- registro desktop
  WHEN TIPO_VW_DADOS_SERVIDOR IN ('READMISSAO') AND E_GESTOR_SEGUINTE='N' AND VINCULO<>'0009' AND REGISTRO_PONTO_SEGUINTE IN ('0130','0180')AND TIPO_USUARIO_SEGUINTE='USA_NAVEGADOR' THEN '343'--Subordinado 1 marcacao- registro desktop
  WHEN TIPO_VW_DADOS_SERVIDOR IN ('READMISSAO') AND E_GESTOR_SEGUINTE='N' AND VINCULO<>'0009' AND REGISTRO_PONTO_SEGUINTE IN ('0110','0160','0120','0150','0200')AND TIPO_USUARIO_SEGUINTE='USA_NAVEGADOR'THEN '13'--Servidor Isento

----------------------------------------------------------------------------------------USA NAVEGADOR E APP E READMISSAO E NAO  GESTOR---------------------------------------------------------------------------------------------------------------------------------
   WHEN TIPO_VW_DADOS_SERVIDOR IN ('READMISSAO') AND  VINCULO = '0009' AND TIPO_USUARIO_SEGUINTE='USA_NAVEGADOR'  AND TIPO_USUARIO_SEGUINTE='USA_AMBOS' THEN '342'--Subordinado- registro desktop
  WHEN TIPO_VW_DADOS_SERVIDOR IN ('READMISSAO') AND E_GESTOR_SEGUINTE='N' AND  VINCULO <> '0009' AND REGISTRO_PONTO_SEGUINTE IN ('0010','0020', '0030','0140','0170','0100')AND TIPO_USUARIO_SEGUINTE='USA_AMBOS' AND CODIGO_EMPRESA <> '0002' THEN '350'--Subordinado- registro APP e desktop
  WHEN TIPO_VW_DADOS_SERVIDOR IN ('READMISSAO') AND E_GESTOR_SEGUINTE='N' AND  VINCULO <> '0009' AND REGISTRO_PONTO_SEGUINTE IN ('0010','0020', '0030','0140','0170','0100')AND TIPO_USUARIO_SEGUINTE='USA_AMBOS' AND CODIGO_EMPRESA = '0002' THEN '357'--357- Prodabel Subordinado- registro APP e desktop NOVO EM 31/5/23 EMAIL ([IMPLANTAÇÃO IFPONTO] Tolerância das jornadas fixas)
  WHEN TIPO_VW_DADOS_SERVIDOR IN ('READMISSAO') AND E_GESTOR_SEGUINTE='N' AND VINCULO<>'0009' AND REGISTRO_PONTO_SEGUINTE IN ('0130','0180')AND TIPO_USUARIO_SEGUINTE='USA_AMBOS' THEN '351'--Subordinado 1 marcacao- registro APP e desktop
  WHEN TIPO_VW_DADOS_SERVIDOR IN ('READMISSAO') AND E_GESTOR_SEGUINTE='N' AND VINCULO<>'0009' AND REGISTRO_PONTO_SEGUINTE IN ('0110','0160','0120','0150','0200')AND TIPO_USUARIO_SEGUINTE='USA_AMBOS'THEN '13'--Servidor Isento

----------------------------------------------------------------------------------------USA NAVEGADOR E READMISSAO E   GESTOR---------------------------------------------------------------------------------------------------------------------------------
  WHEN TIPO_VW_DADOS_SERVIDOR IN ('READMISSAO') AND E_GESTOR_SEGUINTE='S' AND VINCULO<>'0009' AND REGISTRO_PONTO_SEGUINTE IN ('0010','0020', '0030','0140','0170','0100')AND TIPO_USUARIO_SEGUINTE='USA_NAVEGADOR' THEN '340'--Gestor- registro desktop
  WHEN TIPO_VW_DADOS_SERVIDOR IN ('READMISSAO') AND E_GESTOR_SEGUINTE='S' AND VINCULO<>'0009' AND REGISTRO_PONTO_SEGUINTE IN ('0130','0180')AND TIPO_USUARIO_SEGUINTE='USA_NAVEGADOR' THEN '341'--Gestor 1 marcacao- registro desktop
  WHEN TIPO_VW_DADOS_SERVIDOR IN ('READMISSAO') AND E_GESTOR_SEGUINTE='S' AND VINCULO<>'0009' AND REGISTRO_PONTO_SEGUINTE IN ('0110','0160','0120','0150','0200')AND TIPO_USUARIO_SEGUINTE='USA_NAVEGADOR' AND CODIGO_EMPRESA <> '0002' THEN '12'--Gestor Isento
  WHEN TIPO_VW_DADOS_SERVIDOR IN ('READMISSAO') AND E_GESTOR_SEGUINTE='S' AND VINCULO<>'0009' AND REGISTRO_PONTO_SEGUINTE IN ('0110','0160','0120','0150','0200')AND TIPO_USUARIO_SEGUINTE='USA_NAVEGADOR' AND CODIGO_EMPRESA = '0002' THEN '359' --Prodabel Gestor isento
----------------------------------------------------------------------------------------USA NAVEGADOR E APP E READMISSAO E   GESTOR---------------------------------------------------------------------------------------------------------------------------------
  WHEN TIPO_VW_DADOS_SERVIDOR IN ('READMISSAO') AND E_GESTOR_SEGUINTE='S' AND VINCULO<>'0009' AND REGISTRO_PONTO_SEGUINTE IN ('0010','0020', '0030','0140','0170','0100')AND TIPO_USUARIO_SEGUINTE='USA_AMBOS' AND CODIGO_EMPRESA <> '0002' THEN '348'--Gestor- registro APP e desktop
  WHEN TIPO_VW_DADOS_SERVIDOR IN ('READMISSAO') AND E_GESTOR_SEGUINTE='S' AND VINCULO<>'0009' AND REGISTRO_PONTO_SEGUINTE IN ('0010','0020', '0030','0140','0170','0100')AND TIPO_USUARIO_SEGUINTE='USA_AMBOS' AND CODIGO_EMPRESA = '0002' THEN '360' --Prodabel Gestor - registro APP e desktop
  WHEN TIPO_VW_DADOS_SERVIDOR IN ('READMISSAO') AND E_GESTOR_SEGUINTE='S' AND VINCULO<>'0009' AND REGISTRO_PONTO_SEGUINTE IN ('0130','0180')AND TIPO_USUARIO_SEGUINTE='USA_AMBOS'THEN '349'--Gestor 1 marcacao- registro APP e desktop
  WHEN TIPO_VW_DADOS_SERVIDOR IN ('READMISSAO') AND E_GESTOR_SEGUINTE='S' AND VINCULO<>'0009' AND REGISTRO_PONTO_SEGUINTE IN ('0110','0160','0120','0150','0200')AND TIPO_USUARIO_SEGUINTE='USA_AMBOS' AND CODIGO_EMPRESA <> '0002' THEN '12'--Gestor Isento
  WHEN TIPO_VW_DADOS_SERVIDOR IN ('READMISSAO') AND E_GESTOR_SEGUINTE='S' AND VINCULO<>'0009' AND REGISTRO_PONTO_SEGUINTE IN ('0110','0160','0120','0150','0200')AND TIPO_USUARIO_SEGUINTE='USA_AMBOS' AND CODIGO_EMPRESA = '0002' THEN '359' --Prodabel Gestor isento

---------------------------------------------------------------------FIM READMISSAO--------------------------------------------------------------------------------------------------------------------------------------------------
  WHEN TIPO_VW_DADOS_SERVIDOR NOT IN ('DIARIA_NOVOS','READMISSAO','DESLIGAMENTO')AND (ALTEROU_E_GESTOR = 'E_GESTOR_MUDOU' OR ALTEROU_REGISTRO_PONTO = 'REGISTRO_PONTO_MUDOU'OR ALTEROU_TIPO_USUARIO='TIPO_USUARIO_MUDOU')AND TIPO_USUARIO_SEGUINTE NOT IN ('USA_NAVEGADOR','USA_AMBOS') AND E_GESTOR_SEGUINTE ='N' AND  VINCULO = '0009' THEN '3'--Estagiario
  WHEN TIPO_VW_DADOS_SERVIDOR NOT IN ('DIARIA_NOVOS','READMISSAO','DESLIGAMENTO')AND (ALTEROU_E_GESTOR = 'E_GESTOR_MUDOU' OR ALTEROU_REGISTRO_PONTO = 'REGISTRO_PONTO_MUDOU'OR ALTEROU_TIPO_USUARIO='TIPO_USUARIO_MUDOU')AND TIPO_USUARIO_SEGUINTE NOT IN ('USA_NAVEGADOR','USA_AMBOS') AND E_GESTOR_SEGUINTE ='N' AND  VINCULO <> '0009' AND REGISTRO_PONTO_SEGUINTE IN ('0010','0020', '0030','0140','0170','0100') THEN '4'-- Servidor nao registra ponto no login
  WHEN TIPO_VW_DADOS_SERVIDOR NOT IN ('DIARIA_NOVOS','READMISSAO','DESLIGAMENTO')AND (ALTEROU_E_GESTOR = 'E_GESTOR_MUDOU' OR ALTEROU_REGISTRO_PONTO = 'REGISTRO_PONTO_MUDOU'OR ALTEROU_TIPO_USUARIO='TIPO_USUARIO_MUDOU')AND TIPO_USUARIO_SEGUINTE NOT IN ('USA_NAVEGADOR','USA_AMBOS') AND E_GESTOR_SEGUINTE ='N' AND  VINCULO <> '0009' AND REGISTRO_PONTO_SEGUINTE IN ('0130','0180') THEN '10'--Servidor 1 marcacao nao registra ponto no login
  WHEN TIPO_VW_DADOS_SERVIDOR NOT IN ('DIARIA_NOVOS','READMISSAO','DESLIGAMENTO')AND (ALTEROU_E_GESTOR = 'E_GESTOR_MUDOU' OR ALTEROU_REGISTRO_PONTO = 'REGISTRO_PONTO_MUDOU'OR ALTEROU_TIPO_USUARIO='TIPO_USUARIO_MUDOU')AND TIPO_USUARIO_SEGUINTE NOT IN ('USA_NAVEGADOR','USA_AMBOS') AND E_GESTOR_SEGUINTE ='N' AND  VINCULO <> '0009' AND REGISTRO_PONTO_SEGUINTE IN ('0110','0160','0120','0150','0200') THEN '13'--Servidor Isento
  WHEN TIPO_VW_DADOS_SERVIDOR NOT IN ('DIARIA_NOVOS','READMISSAO','DESLIGAMENTO')AND (ALTEROU_E_GESTOR = 'E_GESTOR_MUDOU' OR ALTEROU_REGISTRO_PONTO = 'REGISTRO_PONTO_MUDOU'OR ALTEROU_TIPO_USUARIO='TIPO_USUARIO_MUDOU')AND TIPO_USUARIO_SEGUINTE NOT IN ('USA_NAVEGADOR','USA_AMBOS') AND E_GESTOR_SEGUINTE ='S' AND  VINCULO <> '0009' AND REGISTRO_PONTO_SEGUINTE IN ('0010','0020', '0030','0140','0170','0100') THEN '5'--Gestor nao registra no login
  WHEN TIPO_VW_DADOS_SERVIDOR NOT IN ('DIARIA_NOVOS','READMISSAO','DESLIGAMENTO')AND (ALTEROU_E_GESTOR = 'E_GESTOR_MUDOU' OR ALTEROU_REGISTRO_PONTO = 'REGISTRO_PONTO_MUDOU'OR ALTEROU_TIPO_USUARIO='TIPO_USUARIO_MUDOU')AND TIPO_USUARIO_SEGUINTE NOT IN ('USA_NAVEGADOR','USA_AMBOS') AND E_GESTOR_SEGUINTE ='S' AND  VINCULO <> '0009' AND REGISTRO_PONTO_SEGUINTE IN ('0130','0180') THEN '11'--Gestor 1 marcacao nao registra no login
  WHEN TIPO_VW_DADOS_SERVIDOR NOT IN ('DIARIA_NOVOS','READMISSAO','DESLIGAMENTO')AND (ALTEROU_E_GESTOR = 'E_GESTOR_MUDOU' OR ALTEROU_REGISTRO_PONTO = 'REGISTRO_PONTO_MUDOU'OR ALTEROU_TIPO_USUARIO='TIPO_USUARIO_MUDOU')AND TIPO_USUARIO_SEGUINTE NOT IN ('USA_NAVEGADOR','USA_AMBOS') AND E_GESTOR_SEGUINTE ='S' AND  VINCULO <> '0009' AND REGISTRO_PONTO_SEGUINTE IN ('0110','0160','0120','0150','0200') AND CODIGO_EMPRESA <> '0002' THEN '12'--Gestor Isento
  WHEN TIPO_VW_DADOS_SERVIDOR NOT IN ('DIARIA_NOVOS','READMISSAO','DESLIGAMENTO')AND (ALTEROU_E_GESTOR = 'E_GESTOR_MUDOU' OR ALTEROU_REGISTRO_PONTO = 'REGISTRO_PONTO_MUDOU'OR ALTEROU_TIPO_USUARIO='TIPO_USUARIO_MUDOU')AND TIPO_USUARIO_SEGUINTE NOT IN ('USA_NAVEGADOR','USA_AMBOS') AND E_GESTOR_SEGUINTE ='S' AND  VINCULO <> '0009' AND REGISTRO_PONTO_SEGUINTE IN ('0110','0160','0120','0150','0200') AND CODIGO_EMPRESA = '0002' THEN '359' --Prodabel Gestor isento

----------------------------------------------------------------------------------------USA NAVEGADOR E ALTERACAO_DIVERSAS E NAO   GESTOR---------------------------------------------------------------------------------------------------------------------------------------
  WHEN TIPO_VW_DADOS_SERVIDOR NOT IN ('DIARIA_NOVOS','READMISSAO','DESLIGAMENTO')AND (ALTEROU_E_GESTOR = 'E_GESTOR_MUDOU' OR ALTEROU_REGISTRO_PONTO = 'REGISTRO_PONTO_MUDOU' OR ALTEROU_TIPO_USUARIO='TIPO_USUARIO_MUDOU') AND E_GESTOR_SEGUINTE ='N' AND  VINCULO = '0009' AND TIPO_USUARIO_SEGUINTE='USA_NAVEGADOR'  THEN '342'--Subordinado- registro desktop
  WHEN TIPO_VW_DADOS_SERVIDOR NOT IN ('DIARIA_NOVOS','READMISSAO','DESLIGAMENTO')AND (ALTEROU_E_GESTOR = 'E_GESTOR_MUDOU' OR ALTEROU_REGISTRO_PONTO = 'REGISTRO_PONTO_MUDOU' OR ALTEROU_TIPO_USUARIO='TIPO_USUARIO_MUDOU') AND E_GESTOR_SEGUINTE ='N' AND  VINCULO <> '0009' AND REGISTRO_PONTO_SEGUINTE IN ('0010','0020', '0030','0140','0170','0100') AND TIPO_USUARIO_SEGUINTE='USA_NAVEGADOR' THEN '342'--Subordinado- registro desktop
  WHEN TIPO_VW_DADOS_SERVIDOR NOT IN ('DIARIA_NOVOS','READMISSAO','DESLIGAMENTO')AND (ALTEROU_E_GESTOR = 'E_GESTOR_MUDOU' OR ALTEROU_REGISTRO_PONTO = 'REGISTRO_PONTO_MUDOU' OR ALTEROU_TIPO_USUARIO='TIPO_USUARIO_MUDOU') AND E_GESTOR_SEGUINTE ='N' AND  VINCULO <> '0009' AND REGISTRO_PONTO_SEGUINTE IN ('0130','0180')AND TIPO_USUARIO_SEGUINTE='USA_NAVEGADOR' THEN '343'--Subordinado 1 marcacao- registro desktop
  WHEN TIPO_VW_DADOS_SERVIDOR NOT IN ('DIARIA_NOVOS','READMISSAO','DESLIGAMENTO')AND (ALTEROU_E_GESTOR = 'E_GESTOR_MUDOU' OR ALTEROU_REGISTRO_PONTO = 'REGISTRO_PONTO_MUDOU' OR ALTEROU_TIPO_USUARIO='TIPO_USUARIO_MUDOU') AND E_GESTOR_SEGUINTE ='N' AND  VINCULO <> '0009' AND REGISTRO_PONTO_SEGUINTE IN ('0110','0160','0120','0150','0200')AND TIPO_USUARIO_SEGUINTE='USA_NAVEGADOR'THEN '13'--Servidor Isento

----------------------------------------------------------------------------------------USA NAVEGADOR E APP E ALTERACAO_DIVERSAS E NAO   GESTOR---------------------------------------------------------------------------------------------------------------------------------------
  WHEN TIPO_VW_DADOS_SERVIDOR NOT IN ('DIARIA_NOVOS','READMISSAO','DESLIGAMENTO')AND (ALTEROU_E_GESTOR = 'E_GESTOR_MUDOU' OR ALTEROU_REGISTRO_PONTO = 'REGISTRO_PONTO_MUDOU' OR ALTEROU_TIPO_USUARIO='TIPO_USUARIO_MUDOU') AND E_GESTOR_SEGUINTE ='N' AND  VINCULO = '0009'AND TIPO_USUARIO_SEGUINTE='USA_AMBOS'  THEN '350'--Subordinado- registro APP e desktop
  WHEN TIPO_VW_DADOS_SERVIDOR NOT IN ('DIARIA_NOVOS','READMISSAO','DESLIGAMENTO')AND (ALTEROU_E_GESTOR = 'E_GESTOR_MUDOU' OR ALTEROU_REGISTRO_PONTO = 'REGISTRO_PONTO_MUDOU' OR ALTEROU_TIPO_USUARIO='TIPO_USUARIO_MUDOU') AND E_GESTOR_SEGUINTE ='N' AND  VINCULO <> '0009' AND REGISTRO_PONTO_SEGUINTE IN ('0010','0020', '0030','0140','0170','0100')AND TIPO_USUARIO_SEGUINTE='USA_AMBOS' AND CODIGO_EMPRESA <> '0002' THEN '350'--Subordinado- registro APP e desktop
  WHEN TIPO_VW_DADOS_SERVIDOR NOT IN ('DIARIA_NOVOS','READMISSAO','DESLIGAMENTO')AND (ALTEROU_E_GESTOR = 'E_GESTOR_MUDOU' OR ALTEROU_REGISTRO_PONTO = 'REGISTRO_PONTO_MUDOU' OR ALTEROU_TIPO_USUARIO='TIPO_USUARIO_MUDOU') AND E_GESTOR_SEGUINTE ='N' AND  VINCULO <> '0009' AND REGISTRO_PONTO_SEGUINTE IN ('0010','0020', '0030','0140','0170','0100')AND TIPO_USUARIO_SEGUINTE='USA_AMBOS' AND CODIGO_EMPRESA = '0002' THEN '357'--357- Prodabel Subordinado- registro APP e desktop NOVO EM 31/5/23 EMAIL ([IMPLANTAÇÃO IFPONTO] Tolerância das jornadas fixas)
  WHEN TIPO_VW_DADOS_SERVIDOR NOT IN ('DIARIA_NOVOS','READMISSAO','DESLIGAMENTO')AND (ALTEROU_E_GESTOR = 'E_GESTOR_MUDOU' OR ALTEROU_REGISTRO_PONTO = 'REGISTRO_PONTO_MUDOU' OR ALTEROU_TIPO_USUARIO='TIPO_USUARIO_MUDOU') AND E_GESTOR_SEGUINTE ='N' AND  VINCULO <> '0009' AND REGISTRO_PONTO_SEGUINTE IN ('0130','0180') AND TIPO_USUARIO_SEGUINTE='USA_AMBOS' THEN '351'--Subordinado 1 marcacao- registro APP e desktop
  WHEN TIPO_VW_DADOS_SERVIDOR NOT IN ('DIARIA_NOVOS','READMISSAO','DESLIGAMENTO')AND (ALTEROU_E_GESTOR = 'E_GESTOR_MUDOU' OR ALTEROU_REGISTRO_PONTO = 'REGISTRO_PONTO_MUDOU' OR ALTEROU_TIPO_USUARIO='TIPO_USUARIO_MUDOU') AND E_GESTOR_SEGUINTE ='N' AND  VINCULO <> '0009' AND REGISTRO_PONTO_SEGUINTE IN ('0110','0160','0120','0150','0200')AND TIPO_USUARIO_SEGUINTE='USA_AMBOS'THEN '13'--Servidor Isento

----------------------------------------------------------------------------------------USA NAVEGADOR E ALTERACAO_DIVERSAS E    GESTOR---------------------------------------------------------------------------------------------------------------------------------------
  WHEN TIPO_VW_DADOS_SERVIDOR NOT IN ('DIARIA_NOVOS','READMISSAO','DESLIGAMENTO')AND (ALTEROU_E_GESTOR = 'E_GESTOR_MUDOU' OR ALTEROU_REGISTRO_PONTO = 'REGISTRO_PONTO_MUDOU' OR ALTEROU_TIPO_USUARIO='TIPO_USUARIO_MUDOU') AND E_GESTOR_SEGUINTE ='S' AND  VINCULO <> '0009' AND REGISTRO_PONTO_SEGUINTE IN ('0010','0020', '0030','0140','0170','0100')AND TIPO_USUARIO_SEGUINTE='USA_NAVEGADOR' THEN '340'--Gestor- registro desktop
  WHEN TIPO_VW_DADOS_SERVIDOR NOT IN ('DIARIA_NOVOS','READMISSAO','DESLIGAMENTO')AND (ALTEROU_E_GESTOR = 'E_GESTOR_MUDOU' OR ALTEROU_REGISTRO_PONTO = 'REGISTRO_PONTO_MUDOU' OR ALTEROU_TIPO_USUARIO='TIPO_USUARIO_MUDOU') AND E_GESTOR_SEGUINTE ='S' AND  VINCULO <> '0009' AND REGISTRO_PONTO_SEGUINTE IN ('0130','0180')AND TIPO_USUARIO_SEGUINTE='USA_NAVEGADOR' THEN '341'--Gestor 1 marcacao- registro desktop
  WHEN TIPO_VW_DADOS_SERVIDOR NOT IN ('DIARIA_NOVOS','READMISSAO','DESLIGAMENTO')AND (ALTEROU_E_GESTOR = 'E_GESTOR_MUDOU' OR ALTEROU_REGISTRO_PONTO = 'REGISTRO_PONTO_MUDOU' OR ALTEROU_TIPO_USUARIO='TIPO_USUARIO_MUDOU') AND E_GESTOR_SEGUINTE ='S' AND  VINCULO <> '0009' AND REGISTRO_PONTO_SEGUINTE IN ('0110','0160','0120','0150','0200')AND TIPO_USUARIO_SEGUINTE='USA_NAVEGADOR' AND CODIGO_EMPRESA <> '0002' THEN '12'--Gestor Isento
  WHEN TIPO_VW_DADOS_SERVIDOR NOT IN ('DIARIA_NOVOS','READMISSAO','DESLIGAMENTO')AND (ALTEROU_E_GESTOR = 'E_GESTOR_MUDOU' OR ALTEROU_REGISTRO_PONTO = 'REGISTRO_PONTO_MUDOU' OR ALTEROU_TIPO_USUARIO='TIPO_USUARIO_MUDOU') AND E_GESTOR_SEGUINTE ='S' AND  VINCULO <> '0009' AND REGISTRO_PONTO_SEGUINTE IN ('0110','0160','0120','0150','0200')AND TIPO_USUARIO_SEGUINTE='USA_NAVEGADOR' AND CODIGO_EMPRESA = '0002' THEN '359' --Prodabel Gestor isento
----------------------------------------------------------------------------------------USA NAVEGADOR E APP E ALTERACAO_DIVERSAS E  GESTOR---------------------------------------------------------------------------------------------------------------------------------------
  WHEN TIPO_VW_DADOS_SERVIDOR NOT IN ('DIARIA_NOVOS','READMISSAO','DESLIGAMENTO')AND (ALTEROU_E_GESTOR = 'E_GESTOR_MUDOU' OR ALTEROU_REGISTRO_PONTO = 'REGISTRO_PONTO_MUDOU' OR ALTEROU_TIPO_USUARIO='TIPO_USUARIO_MUDOU') AND E_GESTOR_SEGUINTE ='S' AND  VINCULO <> '0009' AND REGISTRO_PONTO_SEGUINTE IN ('0010','0020', '0030','0140','0170','0100')AND TIPO_USUARIO_SEGUINTE='USA_AMBOS' AND CODIGO_EMPRESA <> '0002' THEN '348'--Gestor- registro APP e desktop
  WHEN TIPO_VW_DADOS_SERVIDOR NOT IN ('DIARIA_NOVOS','READMISSAO','DESLIGAMENTO')AND (ALTEROU_E_GESTOR = 'E_GESTOR_MUDOU' OR ALTEROU_REGISTRO_PONTO = 'REGISTRO_PONTO_MUDOU' OR ALTEROU_TIPO_USUARIO='TIPO_USUARIO_MUDOU') AND E_GESTOR_SEGUINTE ='S' AND  VINCULO <> '0009' AND REGISTRO_PONTO_SEGUINTE IN ('0010','0020', '0030','0140','0170','0100')AND TIPO_USUARIO_SEGUINTE='USA_AMBOS' AND CODIGO_EMPRESA = '0002' THEN '360' --Prodabel Gestor - registro APP e desktop
  WHEN TIPO_VW_DADOS_SERVIDOR NOT IN ('DIARIA_NOVOS','READMISSAO','DESLIGAMENTO')AND (ALTEROU_E_GESTOR = 'E_GESTOR_MUDOU' OR ALTEROU_REGISTRO_PONTO = 'REGISTRO_PONTO_MUDOU' OR ALTEROU_TIPO_USUARIO='TIPO_USUARIO_MUDOU') AND E_GESTOR_SEGUINTE ='S' AND  VINCULO <> '0009' AND REGISTRO_PONTO_SEGUINTE IN ('0130','0180')AND TIPO_USUARIO_SEGUINTE='USA_AMBOS' THEN '349'--Gestor 1 marcacao- registro APP e desktop
  WHEN TIPO_VW_DADOS_SERVIDOR NOT IN ('DIARIA_NOVOS','READMISSAO','DESLIGAMENTO')AND (ALTEROU_E_GESTOR = 'E_GESTOR_MUDOU' OR ALTEROU_REGISTRO_PONTO = 'REGISTRO_PONTO_MUDOU' OR ALTEROU_TIPO_USUARIO='TIPO_USUARIO_MUDOU') AND E_GESTOR_SEGUINTE ='S' AND  VINCULO <> '0009' AND REGISTRO_PONTO_SEGUINTE IN ('0110','0160','0120','0150','0200')AND TIPO_USUARIO_SEGUINTE='USA_AMBOS' AND CODIGO_EMPRESA <> '0002' THEN '12'--Gestor Isento
  WHEN TIPO_VW_DADOS_SERVIDOR NOT IN ('DIARIA_NOVOS','READMISSAO','DESLIGAMENTO')AND (ALTEROU_E_GESTOR = 'E_GESTOR_MUDOU' OR ALTEROU_REGISTRO_PONTO = 'REGISTRO_PONTO_MUDOU' OR ALTEROU_TIPO_USUARIO='TIPO_USUARIO_MUDOU') AND E_GESTOR_SEGUINTE ='S' AND  VINCULO <> '0009' AND REGISTRO_PONTO_SEGUINTE IN ('0110','0160','0120','0150','0200')AND TIPO_USUARIO_SEGUINTE='USA_AMBOS' AND CODIGO_EMPRESA = '0002' THEN '359' --Prodabel Gestor isento


  ELSE NULL END AS COD_TIPO_PESSOA,
--------------------------------------------------REGISTRO PONTO DOS SERVIDORES 01/08/2019 DEIXEI DE USAR EM 20/08/2019---------------------------------------------------
 CASE WHEN TIPO_VW_DADOS_SERVIDOR IN  ('DIARIA_NOVOS') AND REGISTRO_PONTO IN ('0010','0020', '0030','0140','0170') THEN '0100'
  WHEN TIPO_VW_DADOS_SERVIDOR IN ('DIARIA_NOVOS') AND REGISTRO_PONTO NOT IN ('0010','0020', '0030','0140','0170') THEN REGISTRO_PONTO
  WHEN TIPO_VW_DADOS_SERVIDOR IN ('READMISSAO') AND REGISTRO_PONTO_SEGUINTE IN ('0010','0020', '0030','0140','0170') THEN '0100'
  WHEN TIPO_VW_DADOS_SERVIDOR IN ('READMISSAO') AND REGISTRO_PONTO_SEGUINTE  NOT IN ('0010','0020', '0030','0140','0170') THEN REGISTRO_PONTO_SEGUINTE
  WHEN TIPO_VW_DADOS_SERVIDOR NOT IN  ('DIARIA_NOVOS', 'READMISSAO','DESLIGAMENTO') AND (ALTEROU_E_GESTOR = 'E_GESTOR_MUDOU' OR ALTEROU_REGISTRO_PONTO = 'REGISTRO_PONTO_MUDOU') AND REGISTRO_PONTO_SEGUINTE IN ('0010','0020', '0030','0140','0170') THEN '0100'
  WHEN TIPO_VW_DADOS_SERVIDOR NOT IN  ('DIARIA_NOVOS', 'READMISSAO','DESLIGAMENTO') AND (ALTEROU_E_GESTOR = 'E_GESTOR_MUDOU' OR ALTEROU_REGISTRO_PONTO = 'REGISTRO_PONTO_MUDOU') AND REGISTRO_PONTO_SEGUINTE NOT IN ('0010','0020', '0030','0140','0170') THEN REGISTRO_PONTO_SEGUINTE
  ELSE NULL END AS REGISTRO_PONTO,
  --------------------------------------------- empresa DO RESPONSAVAL QUANDO HIERARQUIA FOR POR PESSOA 01/08/2019-------------------
CASE WHEN TIPO_VW_DADOS_SERVIDOR IN ('DIARIA_NOVOS') AND TIPO = 'HIERARQUIA POR PESSOA' THEN CODIGO_EMPRESA_GESTOR
 WHEN TIPO_VW_DADOS_SERVIDOR IN ('DIARIA_NOVOS') AND (ALTEROU_CPF_GESTOR = 'CPF_GESTOR_MUDOU' OR ALTEROU_CPF_GESTOR = 'CPF_GESTOR_IGUAL' )AND E_GESTOR='S' AND SITUACAO_FUNCIONAL NOT IN ('1017') AND TIPO = 'HIERARQUIA POR LOCAL'THEN CODIGO_EMPRESA_GESTOR
  WHEN TIPO_VW_DADOS_SERVIDOR IN ('READMISSAO') AND  TIPO_SEGUINTE = 'HIERARQUIA POR PESSOA'THEN CODIGO_EMPRESA_GESTOR_SEGUINTE
  WHEN TIPO_VW_DADOS_SERVIDOR IN ('READMISSAO') AND (ALTEROU_CPF_GESTOR = 'CPF_GESTOR_MUDOU' OR ALTEROU_CPF_GESTOR = 'CPF_GESTOR_IGUAL' )AND E_GESTOR_SEGUINTE='S' AND SITUACAO_FUNCIONAL_SEGUINTE NOT IN ('1017') AND TIPO_SEGUINTE = 'HIERARQUIA POR LOCAL'THEN CODIGO_EMPRESA_GESTOR_SEGUINTE
  WHEN TIPO_VW_DADOS_SERVIDOR NOT IN  ('DIARIA_NOVOS', 'READMISSAO','DESLIGAMENTO') AND TIPO_SEGUINTE = 'HIERARQUIA POR PESSOA' AND ALTEROU_CPF_GESTOR = 'CPF_GESTOR_MUDOU' THEN CODIGO_EMPRESA_GESTOR_SEGUINTE
  WHEN TIPO_VW_DADOS_SERVIDOR NOT IN  ('DIARIA_NOVOS', 'READMISSAO','DESLIGAMENTO') AND TIPO_SEGUINTE = 'HIERARQUIA POR PESSOA' AND ALTEROU_CPF_GESTOR = 'CPF_GESTOR_IGUAL' THEN CODIGO_EMPRESA_GESTOR
-------------------GABRIEL AQUI EM 02/10/2019 PARA RESOLVER O PROBLEMA DE QUANDO O GESTOR E RESPONSAVEL PELO LOCAL QUE ELE ESTA SENDO MOVIMENTADO E FICA FORA DA HIERARQUIA
  WHEN TIPO_VW_DADOS_SERVIDOR NOT IN  ('DIARIA_NOVOS', 'READMISSAO','DESLIGAMENTO') AND TIPO_SEGUINTE = 'HIERARQUIA POR LOCAL'  AND (ALTEROU_CPF_GESTOR = 'CPF_GESTOR_MUDOU' OR ALTEROU_CPF_GESTOR = 'CPF_GESTOR_IGUAL' )AND E_GESTOR_SEGUINTE='S' AND SITUACAO_FUNCIONAL_SEGUINTE NOT IN ('1017')THEN CODIGO_EMPRESA_GESTOR_SEGUINTE
  ELSE NULL END AS CODIGO_EMPRESA_GESTOR,

  --------------------------------------------- TIPO CONTRATO DO RESPONSAVAL QUANDO HIERARQUIA FOR POR PESSOA 01/08/2019-------------------
CASE WHEN TIPO_VW_DADOS_SERVIDOR IN ('DIARIA_NOVOS') AND TIPO = 'HIERARQUIA POR PESSOA' THEN TIPO_CONTRATO_GESTOR
 WHEN TIPO_VW_DADOS_SERVIDOR IN ('DIARIA_NOVOS') AND (ALTEROU_CPF_GESTOR = 'CPF_GESTOR_MUDOU' OR ALTEROU_CPF_GESTOR = 'CPF_GESTOR_IGUAL' )AND E_GESTOR='S' AND SITUACAO_FUNCIONAL NOT IN ('1017') AND TIPO = 'HIERARQUIA POR LOCAL'THEN TIPO_CONTRATO_GESTOR
  WHEN TIPO_VW_DADOS_SERVIDOR IN ('READMISSAO') AND  TIPO_SEGUINTE = 'HIERARQUIA POR PESSOA'THEN TIPO_CONTRATO_GESTOR_SEGUINTE
  WHEN TIPO_VW_DADOS_SERVIDOR IN ('READMISSAO') AND (ALTEROU_CPF_GESTOR = 'CPF_GESTOR_MUDOU' OR ALTEROU_CPF_GESTOR = 'CPF_GESTOR_IGUAL' )AND E_GESTOR_SEGUINTE='S' AND SITUACAO_FUNCIONAL_SEGUINTE NOT IN ('1017') AND TIPO_SEGUINTE = 'HIERARQUIA POR LOCAL'THEN TIPO_CONTRATO_GESTOR_SEGUINTE
  WHEN TIPO_VW_DADOS_SERVIDOR NOT IN  ('DIARIA_NOVOS', 'READMISSAO','DESLIGAMENTO') AND TIPO_SEGUINTE = 'HIERARQUIA POR PESSOA' AND ALTEROU_CPF_GESTOR = 'CPF_GESTOR_MUDOU' THEN TIPO_CONTRATO_GESTOR_SEGUINTE
  WHEN TIPO_VW_DADOS_SERVIDOR NOT IN  ('DIARIA_NOVOS', 'READMISSAO','DESLIGAMENTO') AND TIPO_SEGUINTE = 'HIERARQUIA POR PESSOA' AND ALTEROU_CPF_GESTOR = 'CPF_GESTOR_IGUAL' THEN TIPO_CONTRATO_GESTOR
-------------------GABRIEL AQUI EM 02/10/2019 PARA RESOLVER O PROBLEMA DE QUANDO O GESTOR E RESPONSAVEL PELO LOCAL QUE ELE ESTA SENDO MOVIMENTADO E FICA FORA DA HIERARQUIA
  WHEN TIPO_VW_DADOS_SERVIDOR NOT IN  ('DIARIA_NOVOS', 'READMISSAO','DESLIGAMENTO') AND TIPO_SEGUINTE = 'HIERARQUIA POR LOCAL'  AND (ALTEROU_CPF_GESTOR = 'CPF_GESTOR_MUDOU' OR ALTEROU_CPF_GESTOR = 'CPF_GESTOR_IGUAL' )AND E_GESTOR_SEGUINTE='S' AND SITUACAO_FUNCIONAL_SEGUINTE NOT IN ('1017')THEN TIPO_CONTRATO_GESTOR_SEGUINTE
  ELSE NULL END AS TIPO_CONTRATO_GESTOR,
--------------------------------------------- CONTRATO DO RESPONSAVAL QUANDO HIERARQUIA FOR POR PESSOA 01/08/2019-------------------
CASE WHEN TIPO_VW_DADOS_SERVIDOR IN ('DIARIA_NOVOS') AND TIPO = 'HIERARQUIA POR PESSOA' THEN CONTRATO_GESTOR
 WHEN TIPO_VW_DADOS_SERVIDOR IN ('DIARIA_NOVOS') AND (ALTEROU_CPF_GESTOR = 'CPF_GESTOR_MUDOU' OR ALTEROU_CPF_GESTOR = 'CPF_GESTOR_IGUAL' )AND E_GESTOR='S' AND SITUACAO_FUNCIONAL NOT IN ('1017') AND TIPO = 'HIERARQUIA POR LOCAL'THEN CONTRATO_GESTOR
  WHEN TIPO_VW_DADOS_SERVIDOR IN ('READMISSAO') AND  TIPO_SEGUINTE = 'HIERARQUIA POR PESSOA'THEN CONTRATO_GESTOR_SEGUINTE
  WHEN TIPO_VW_DADOS_SERVIDOR IN ('READMISSAO') AND (ALTEROU_CPF_GESTOR = 'CPF_GESTOR_MUDOU' OR ALTEROU_CPF_GESTOR = 'CPF_GESTOR_IGUAL' )AND E_GESTOR_SEGUINTE='S' AND SITUACAO_FUNCIONAL_SEGUINTE NOT IN ('1017') AND TIPO_SEGUINTE = 'HIERARQUIA POR LOCAL'THEN CONTRATO_GESTOR_SEGUINTE
  WHEN TIPO_VW_DADOS_SERVIDOR NOT IN  ('DIARIA_NOVOS', 'READMISSAO','DESLIGAMENTO') AND TIPO_SEGUINTE = 'HIERARQUIA POR PESSOA' AND ALTEROU_CPF_GESTOR = 'CPF_GESTOR_MUDOU' THEN CONTRATO_GESTOR_SEGUINTE
  WHEN TIPO_VW_DADOS_SERVIDOR NOT IN  ('DIARIA_NOVOS', 'READMISSAO','DESLIGAMENTO') AND TIPO_SEGUINTE = 'HIERARQUIA POR PESSOA' AND ALTEROU_CPF_GESTOR = 'CPF_GESTOR_IGUAL' THEN CONTRATO_GESTOR
-------------------GABRIEL AQUI EM 02/10/2019 PARA RESOLVER O PROBLEMA DE QUANDO O GESTOR E RESPONSAVEL PELO LOCAL QUE ELE ESTA SENDO MOVIMENTADO E FICA FORA DA HIERARQUIA
  WHEN TIPO_VW_DADOS_SERVIDOR NOT IN  ('DIARIA_NOVOS', 'READMISSAO','DESLIGAMENTO') AND TIPO_SEGUINTE = 'HIERARQUIA POR LOCAL'  AND (ALTEROU_CPF_GESTOR = 'CPF_GESTOR_MUDOU' OR ALTEROU_CPF_GESTOR = 'CPF_GESTOR_IGUAL' )AND E_GESTOR_SEGUINTE='S' AND SITUACAO_FUNCIONAL_SEGUINTE NOT IN ('1017')THEN CONTRATO_GESTOR_SEGUINTE
  ELSE NULL END AS CODIGO_RESPONSAVEL,
----------------------------------------------------------------------------------QUANDO MUDAR A CERCA DO FUNCIONARIO---------------------------------------------------------
  CASE WHEN TIPO_VW_DADOS_SERVIDOR IN ('DIARIA_NOVOS') THEN CODIGO_LEGADO
       WHEN TIPO_VW_DADOS_SERVIDOR IN ('READMISSAO') THEN CODIGO_LEGADO_SEGUINTE
       WHEN TIPO_VW_DADOS_SERVIDOR NOT IN  ('DIARIA_NOVOS', 'READMISSAO','DESLIGAMENTO') AND ALTEROU_CERCA='CERCA_MUDOU' THEN CODIGO_LEGADO_SEGUINTE
       WHEN TIPO_VW_DADOS_SERVIDOR NOT IN  ('DIARIA_NOVOS', 'READMISSAO','DESLIGAMENTO') AND CODIGO_LEGADO IS NULL AND CODIGO_LEGADO_SEGUINTE IS NOT NULL THEN CODIGO_LEGADO_SEGUINTE
       ELSE NULL
       END AS CODIGO_LEGADO,


----------------------------------------------------------------------------------FIM DA LOGICA-------------------------------------------------------------------------
  TIPO_VW_DADOS_SERVIDOR AS TIPO_VW_DADOS_SERVIDOR,
  SYSDATE AS DT_SAIU_ARTE,
  NULL AS DT_ENVIADO_IFPONTO_SURICATO,
 ALTEROU_IDENTIDADE||', '||ALTEROU_NOME||', '||ALTEROU_LOCAL||', '||ALTEROU_REGISTRO_PONTO||', '||ALTEROU_CHAVE_INTEGRACAO||', '||ALTEROU_CODIGO_ESCALA||', '||ALTEROU_COD_CARGO_EFETIVO||', '||ALTEROU_COD_CARGO_COMISS||', '||ALTEROU_CODIGO_FUNCAO||', '||ALTEROU_CPF_GESTOR||', '||ALTEROU_E_GESTOR||','||ALTEROU_TIPO_USUARIO||','||ALTEROU_CERCA||','||ALTEROU_DIA_CICLO_ESCALA AS LOCAL_GESTOR
,EXCECAO_FUNCIONAL--NOVO EM 16/8/22 EMAIL (Customização - Cadastro de justificativa)
,
fim_base_foto.E_GESTOR,
fim_base_foto.NOME_SEGUINTE,
FIM_BASE_FOTO.DIA_SEGUINTE,
FIM_BASE_FOTO.TIPO_SEGUINTE,
FIM_BASE_FOTO.INTEGRADO_SEGUINTE,
FIM_BASE_FOTO.PIS_PASEP_SEGUINTE,
FIM_BASE_FOTO.CPF_SEGUINTE,
FIM_BASE_FOTO.CNPJ_SEGUINTE,
FIM_BASE_FOTO.IDENTIDADE_SEGUINTE,
FIM_BASE_FOTO.COD_UNIDADE1_SEGUINTE,
FIM_BASE_FOTO.COD_UNIDADE2_SEGUINTE,
FIM_BASE_FOTO.COD_UNIDADE3_SEGUINTE,
FIM_BASE_FOTO.COD_UNIDADE4_SEGUINTE,
FIM_BASE_FOTO.COD_UNIDADE5_SEGUINTE,
FIM_BASE_FOTO.COD_UNIDADE6_SEGUINTE,
FIM_BASE_FOTO.DESCRICAO_UNIDADE_SEGUINTE,
FIM_BASE_FOTO.REGISTRO_PONTO_SEGUINTE,
FIM_BASE_FOTO.SITUACAO_FUNCIONAL_SEGUINTE,
FIM_BASE_FOTO.NOME_SIT_FUNC_SEGUINTE,
FIM_BASE_FOTO.CONTROLE_FOLHA_SEGUINTE,
FIM_BASE_FOTO.DATA_RESCISAO_SEGUINTE,
FIM_BASE_FOTO.CODIGO_ESCALA_SEGUINTE,
FIM_BASE_FOTO.DT_ULT_ESCALA_SEGUINTE,
FIM_BASE_FOTO.DIA_COMECO_CICLO_SEGUINTE,
FIM_BASE_FOTO.COD_CARGO_EFETIVO_SEGUINTE,
FIM_BASE_FOTO.CARGO_EFETIVO_SEGUINTE,
FIM_BASE_FOTO.COD_CARGO_COMISS_SEGUINTE,
FIM_BASE_FOTO.CARGO_COMISSIONADO_SEGUINTE,
FIM_BASE_FOTO.CODIGO_FUNCAO_SEGUINTE,
FIM_BASE_FOTO.FUNCAO_PUBLICA_SEGUINTE,
FIM_BASE_FOTO.CODIGO_EMPRESA_GESTOR_SEGUINTE,
FIM_BASE_FOTO.TIPO_CONTRATO_GESTOR_SEGUINTE,
FIM_BASE_FOTO.CONTRATO_GESTOR_SEGUINTE,
FIM_BASE_FOTO.CPF_GESTOR_SEGUINTE,
FIM_BASE_FOTO.E_GESTOR_SEGUINTE,
FIM_BASE_FOTO.TIPO_USUARIO_SEGUINTE,
FIM_BASE_FOTO.CODIGO_LEGADO_SEGUINTE,
FIM_BASE_FOTO.CHAVE_INTEGRACAO_SEGUINTE,
FIM_BASE_FOTO.ALTEROU_CODIGO_ESCALA,
FIM_BASE_FOTO.ALTEROU_COD_CARGO_EFETIVO,
FIM_BASE_FOTO.ALTEROU_COD_CARGO_COMISS,
FIM_BASE_FOTO.ALTEROU_CODIGO_FUNCAO,
FIM_BASE_FOTO.ALTEROU_LOCAL,
FIM_BASE_FOTO.ALTEROU_REGISTRO_PONTO,
FIM_BASE_FOTO.ALTEROU_CHAVE_INTEGRACAO,
FIM_BASE_FOTO.ALTEROU_CPF_GESTOR,
FIM_BASE_FOTO.ALTEROU_E_GESTOR,
FIM_BASE_FOTO.ALTEROU_NOME,
FIM_BASE_FOTO.ALTEROU_CNPJ,
FIM_BASE_FOTO.ALTEROU_TIPO_USUARIO,
FIM_BASE_FOTO.ALTEROU_CERCA,
FIM_BASE_FOTO.ALTEROU_INI_ESCALA,
FIM_BASE_FOTO.ALTEROU_TIPO_HIERARQUIA,
FIM_BASE_FOTO.ALTEROU_DIA_CICLO_ESCALA,
FIM_BASE_FOTO.ALTEROU_DATA_ADMISSAO,
FIM_BASE_FOTO.CODIGO_PESSOA,
FIM_BASE_FOTO.PESSOA_GESTOR,
CASE WHEN TIPO_VW_DADOS_SERVIDOR IN ('DIARIA_NOVOS', 'READMISSAO') THEN GERA_MARCACAO_INTERVALO_AUTO ELSE NULL END AS  MARCACAO_INTERVALO_AUTO,
CASE WHEN TIPO_VW_DADOS_SERVIDOR IN ('DIARIA_NOVOS', 'READMISSAO') THEN VINCULO ELSE NULL END AS CODIGO_VINCULO,
CASE WHEN TIPO_VW_DADOS_SERVIDOR IN ('DIARIA_NOVOS', 'READMISSAO') THEN (SELECT CASE 
WHEN V.CODIGO = '0009' THEN '3' 
WHEN V.TP_REGIME_TRAB_ESOCIAL IN ('1','2') AND V.CODIGO <> '0009' 
THEN V.TP_REGIME_TRAB_ESOCIAL 
WHEN V.TP_REGIME_TRAB_ESOCIAL IS NULL OR V.TP_REGIME_TRAB_ESOCIAL ='' OR V.TP_REGIME_TRAB_ESOCIAL = ' ' 
THEN '4' END||V.CODIGO||'-'||V.DESCRICAO AS DESCRICAO_VINCULO
FROM RHTABS_VINCULO_EMP V 
LEFT OUTER JOIN 
(select * from rhtabs_itds_sist WHERE CODIGO_DOMINIO = (select CODIGO_DOMINIO from RHTABS_COLS_SIST  where codigo_tabela = 'RHTABS_VINCULO_EMP' and codigo_coluna = 'TP_REGIME_TRAB_ESOCIAL'))REG_TRAB
ON REG_TRAB.CONTEUDO_INICIAL =  V.TP_REGIME_TRAB_ESOCIAL
WHERE V.CODIGO=VINCULO)
ELSE NULL END AS DESCRICAO_VINCULO,
FIM_BASE_FOTO.COD_UNIDADE1 AS COD_UNIDADE_ANTERIOR1,
FIM_BASE_FOTO.COD_UNIDADE2 AS COD_UNIDADE_ANTERIOR2,
FIM_BASE_FOTO.COD_UNIDADE3 AS COD_UNIDADE_ANTERIOR3,
FIM_BASE_FOTO.COD_UNIDADE4 AS COD_UNIDADE_ANTERIOR4,
FIM_BASE_FOTO.COD_UNIDADE5 AS COD_UNIDADE_ANTERIOR5,
FIM_BASE_FOTO.COD_UNIDADE6 AS COD_UNIDADE_ANTERIOR6


FROM (SELECT 
--------REGRA IFPONTO PARA DESLIGAMENTOS ---------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------DIARIA_NOVOS---------------------------------------------------------------------------------------------
    CASE WHEN XXX.E_CADASTRO_NOVO = 'SIM'AND XXX.INTEGRADO='N' THEN 'DIARIA_NOVOS'
--------------------------------------------------------------------------------------------DESLIGAMENTO----------------------------------------------------------------------------------------------
    WHEN XXX.DATA_RESCISAO IS NULL AND XXX.DATA_RESCISAO_SEGUINTE IS NOT NULL THEN 'DESLIGAMENTO'
   WHEN XXX.DATA_RESCISAO IS NULL AND xxx.VINCULO='0009' AND XXX.SITUACAO_FUNCIONAL_SEGUINTE='1851' THEN VALIDAR_DATE(XXX.CODIGO_EMPRESA,XXX.TIPO_CONTRATO,XXX.CODIGO_CONTRATO,XXX.SITUACAO_FUNCIONAL_SEGUINTE)
    WHEN XXX.DATA_RESCISAO IS NULL AND XXX.CHAVE_INTEGRACAO='ATIVO' AND XXX.CHAVE_INTEGRACAO_SEGUINTE='INATIVO' THEN'DESLIGAMENTO'

----------------------------------------------------------------------------------READMISSAO---------------------------------------------------------------------------------------------------
    WHEN XXX.DATA_RESCISAO IS NOT NULL AND XXX.DATA_RESCISAO_SEGUINTE IS NULL THEN 'READMISSAO'
    WHEN XXX.DATA_RESCISAO IS NULL AND  XXX.CHAVE_INTEGRACAO='INATIVO' AND XXX.CHAVE_INTEGRACAO_SEGUINTE='ATIVO' THEN'READMISSAO'

-------------------------------------------------------------------------------------------FORA DISSO ALTERACAO_DIVERSAS
    ELSE 'ALTERACOES_DIVERSAS' END TIPO_VW_DADOS_SERVIDOR,
-----------------------------------------------------------------------------------FIM REGRA IFPONTO--------------------------------------------------------------------------------------------------
    XXX.* FROM 
(SELECT -----------------------------------------------------------------------------------------CADASTROS NOVOS---------------------------------------------------------------------------------------
        CASE WHEN (XX.CONTROLE_FOLHA NOT IN ('D','S') AND XX.DATA_RESCISAO IS NULL) AND XX.DIA = 'ULTIMO'THEN 'SIM' ELSE 'NAO'END E_CADASTRO_NOVO ,
---------------------------------------------------------------------------------TIPO_HIERARQUIA---------------------------------------------------------------------------------------------
        CASE WHEN (XX.CONTROLE_FOLHA_SEGUINTE NOT IN ('D','S')AND XX.DATA_RESCISAO_SEGUINTE IS NULL AND XX.CHAVE_INTEGRACAO_SEGUINTE='ATIVO') AND XX.TIPO= 'HIERARQUIA POR LOCAL'AND XX.TIPO_SEGUINTE= 'PESSOA SEM HIERARQUIA'THEN 'POSSIVEL_DESLIGAMENTO'
        WHEN (XX.CONTROLE_FOLHA_SEGUINTE NOT IN ('D','S')AND XX.DATA_RESCISAO_SEGUINTE IS NULL AND XX.CHAVE_INTEGRACAO_SEGUINTE='ATIVO') AND XX.TIPO= 'HIERARQUIA POR LOCAL'AND XX.TIPO_SEGUINTE = 'HIERARQUIA POR PESSOA'THEN 'CRIOU_DELEGACAO'
        WHEN(XX.CONTROLE_FOLHA_SEGUINTE NOT IN ('D','S')AND XX.DATA_RESCISAO_SEGUINTE IS NULL AND XX.CHAVE_INTEGRACAO_SEGUINTE='ATIVO') AND XX.TIPO= 'PESSOA SEM HIERARQUIA'AND XX.TIPO_SEGUINTE= 'HIERARQUIA POR PESSOA'THEN 'POSSIVEL_CRIOU_DELEGACAO'
        WHEN(XX.CONTROLE_FOLHA_SEGUINTE NOT IN ('D','S')AND XX.DATA_RESCISAO_SEGUINTE IS NULL AND XX.CHAVE_INTEGRACAO_SEGUINTE='ATIVO') AND XX.TIPO= 'HIERARQUIA POR PESSOA'AND XX.TIPO_SEGUINTE= 'PESSOA SEM HIERARQUIA'THEN 'LIMPAR_DELEGACAO'
        WHEN(XX.CONTROLE_FOLHA_SEGUINTE NOT IN ('D','S')AND XX.DATA_RESCISAO_SEGUINTE IS NULL AND XX.CHAVE_INTEGRACAO_SEGUINTE='ATIVO') AND XX.TIPO= 'HIERARQUIA POR PESSOA'AND XX.TIPO_SEGUINTE= 'HIERARQUIA POR LOCAL'THEN 'LIMPAR_DELEGACAO'
        WHEN(XX.CONTROLE_FOLHA_SEGUINTE NOT IN ('D','S')AND XX.DATA_RESCISAO_SEGUINTE IS NULL AND XX.CHAVE_INTEGRACAO_SEGUINTE='ATIVO') AND XX.TIPO= 'PESSOA SEM HIERARQUIA'AND XX.TIPO_SEGUINTE= 'HIERARQUIA POR LOCAL'THEN 'POSSIVEL_READMISSAO'
        WHEN(XX.CONTROLE_FOLHA_SEGUINTE NOT IN ('D','S')AND XX.DATA_RESCISAO_SEGUINTE IS NULL AND XX.CHAVE_INTEGRACAO_SEGUINTE='ATIVO' ) AND XX.TIPO_SEGUINTE IS NULL THEN 'POSSIVEL_ADMISSAO'
        WHEN XX.TIPO = XX.TIPO_SEGUINTE THEN 'CAMPO_NAO_ALTEROU'
        ELSE 'NAO_MAPEOU'END TIPO_HIERARQUIA,
------------------------------------------------------------------------LOCAL_FORA DA ADM DIRETA--------------------------------------------------------------------------------------------
        CASE WHEN (XX.CONTROLE_FOLHA_SEGUINTE NOT IN ('D','S')AND XX.DATA_RESCISAO_SEGUINTE IS NULL AND XX.CHAVE_INTEGRACAO_SEGUINTE='ATIVO') AND XX.CNPJ<> XX.CNPJ_SEGUINTE THEN 'MUDOU_EMPRESA'ELSE 'EMPRESA_IGUAL'END ALTEROU_CNPJ,
--------------------------------------------------------------------------------PIS_PASEP----------------------------------------------------------------------------------------------------
        CASE WHEN (XX.CONTROLE_FOLHA_SEGUINTE NOT IN ('D','S')AND XX.DATA_RESCISAO_SEGUINTE IS NULL AND XX.CHAVE_INTEGRACAO_SEGUINTE='ATIVO') AND XX.PIS_PASEP<> XX.PIS_PASEP_SEGUINTE THEN 'PIS_MUDOU'ELSE 'PIS_IGUAL'END ALTEROU_PIS,
--------------------------------------------------------------------------------ALTEROU CPF-------------------------------------------------------------------------------------------------
        CASE WHEN (XX.CONTROLE_FOLHA_SEGUINTE NOT IN ('D','S')AND XX.DATA_RESCISAO_SEGUINTE IS NULL AND XX.CHAVE_INTEGRACAO_SEGUINTE='ATIVO') AND XX.CPF <> XX.CPF_SEGUINTE THEN 'CPF_MUDOU'ELSE 'CPF_IGUAL'END ALTEROU_CPF ,
--------------------------------------------------------------------------------IDENTIDADE--------------------------------------------------------------------------------------------------
        CASE WHEN (XX.CONTROLE_FOLHA_SEGUINTE NOT IN ('D','S')AND XX.DATA_RESCISAO_SEGUINTE IS NULL AND XX.CHAVE_INTEGRACAO_SEGUINTE='ATIVO') AND XX.IDENTIDADE <> XX.IDENTIDADE_SEGUINTE THEN 'IDENTIDADE_MUDOU'ELSE 'IDENTIDADE_IGUAL'END ALTEROU_IDENTIDADE,
--------------------------------------------------------------------------------LOCAL_MUDOU----------------------------------------------------------------------------------------------
        CASE WHEN (XX.CONTROLE_FOLHA_SEGUINTE NOT IN ('D','S')AND XX.DATA_RESCISAO_SEGUINTE IS NULL AND XX.CHAVE_INTEGRACAO_SEGUINTE='ATIVO')
          AND(XX.COD_UNIDADE1 <> XX.COD_UNIDADE1_SEGUINTE
          OR XX.COD_UNIDADE2 <> XX.COD_UNIDADE2_SEGUINTE
          OR XX.COD_UNIDADE3 <> XX.COD_UNIDADE3_SEGUINTE
          OR XX.COD_UNIDADE4 <> XX.COD_UNIDADE4_SEGUINTE
          OR XX.COD_UNIDADE5 <> XX.COD_UNIDADE5_SEGUINTE
          OR XX.COD_UNIDADE6 <> XX.COD_UNIDADE6_SEGUINTE)
          THEN 'LOCAL_MUDOU'
          ELSE 'LOCAL_IGUAL'
          END ALTEROU_LOCAL,
--------------------------------------------------------------------------------REGISTRO PONTO------------------------------------------------------------------------------------------------
        CASE WHEN (XX.CONTROLE_FOLHA_SEGUINTE NOT IN ('D','S')AND XX.DATA_RESCISAO_SEGUINTE IS NULL AND XX.CHAVE_INTEGRACAO_SEGUINTE='ATIVO')
        AND XX.REGISTRO_PONTO<> XX.REGISTRO_PONTO_SEGUINTE THEN 'REGISTRO_PONTO_MUDOU'ELSE 'REGISTRO_PONTO_IGUAL'
        END ALTEROU_REGISTRO_PONTO,
------------------------------------------------------------------------------------NOME----------------------------------------------------------------------------------------------------
        CASE WHEN (XX.CONTROLE_FOLHA_SEGUINTE NOT IN ('D','S')AND XX.DATA_RESCISAO_SEGUINTE IS NULL AND XX.CHAVE_INTEGRACAO_SEGUINTE='ATIVO') AND XX.NOME <> XX.NOME_SEGUINTE THEN 'NOME_MUDOU'ELSE 'NOME_IGUAL'END ALTEROU_NOME,
---------------------------------------------------------------------------------CONTROLE_FOLHA-----------------------------------------------------------------------------------------------
        CASE WHEN (
        (XX.CHAVE_INTEGRACAO <> XX.CHAVE_INTEGRACAO_SEGUINTE)
        or (xx.VINCULO='0009' AND XX.SITUACAO_FUNCIONAL_SEGUINTE='1851' 
        and  VALIDAR_DATE(XX.CODIGO_EMPRESA,XX.TIPO_CONTRATO,XX.CODIGO_CONTRATO,XX.SITUACAO_FUNCIONAL_SEGUINTE)='DESLIGAMENTO')
        )  THEN 'CHAVE_MUDOU'ELSE 'CHAVE_IGUAL'END ALTEROU_CHAVE_INTEGRACAO,
--------------------------------------------------------------------------------CODIGO_ESCALA-----------------------------------------------------------------------------------------------
        CASE WHEN (XX.CONTROLE_FOLHA_SEGUINTE NOT IN ('D','S')AND XX.DATA_RESCISAO_SEGUINTE IS NULL AND  XX.CHAVE_INTEGRACAO_SEGUINTE='ATIVO') AND ((XX.CODIGO_ESCALA <> XX.CODIGO_ESCALA_SEGUINTE)OR(XX.CODIGO_ESCALA IS NULL AND XX.CODIGO_ESCALA_SEGUINTE IS NOT NULL)OR(XX.CODIGO_ESCALA IS NOT NULL AND XX.CODIGO_ESCALA_SEGUINTE IS NULL))  THEN 'CODIGO_ESCALA_MUDOU'ELSE 'CODIGO_ESCALA_IGUAL'END ALTEROU_CODIGO_ESCALA,
--------------------------------------------------------------------------------CARGO_EFETIVO-----------------------------------------------------------------------------------------------
        CASE WHEN (XX.CONTROLE_FOLHA_SEGUINTE NOT IN ('D','S')AND XX.DATA_RESCISAO_SEGUINTE IS NULL AND XX.CHAVE_INTEGRACAO_SEGUINTE='ATIVO') AND ((XX.COD_CARGO_EFETIVO <> XX.COD_CARGO_EFETIVO_SEGUINTE) OR (XX.COD_CARGO_EFETIVO IS NULL AND XX.COD_CARGO_EFETIVO_SEGUINTE IS NOT NULL)OR (XX.COD_CARGO_EFETIVO IS NOT  NULL AND XX.COD_CARGO_EFETIVO_SEGUINTE IS  NULL)) THEN 'COD_CARGO_EFETIVO_MUDOU'ELSE 'COD_CARGO_EFETIVO_IGUAL'
        END ALTEROU_COD_CARGO_EFETIVO,
--------------------------------------------------------------------------------CARGO_COMISS------------------------------------------------------------------------------------------------
        CASE WHEN (XX.CONTROLE_FOLHA_SEGUINTE NOT IN ('D','S')AND XX.DATA_RESCISAO_SEGUINTE IS NULL AND XX.CHAVE_INTEGRACAO_SEGUINTE='ATIVO') AND ((XX.COD_CARGO_COMISS <> XX.COD_CARGO_COMISS_SEGUINTE) OR (XX.COD_CARGO_COMISS IS NULL  AND  XX.COD_CARGO_COMISS_SEGUINTE IS NOT NULL) OR (XX.COD_CARGO_COMISS IS NOT  NULL  AND  XX.COD_CARGO_COMISS_SEGUINTE IS  NULL)) THEN 'COD_CARGO_COMISS_MUDOU'ELSE 'COD_CARGO_COMISS_IGUAL'
        END ALTEROU_COD_CARGO_COMISS,
--------------------------------------------------------------------------FUNCAO------------------------------------------------------------------------------------------------------------------------
        CASE WHEN (XX.CONTROLE_FOLHA_SEGUINTE NOT IN ('D','S')AND XX.DATA_RESCISAO_SEGUINTE IS NULL AND XX.CHAVE_INTEGRACAO_SEGUINTE='ATIVO') AND ((XX.CODIGO_FUNCAO <> XX.CODIGO_FUNCAO_SEGUINTE)OR(XX.CODIGO_FUNCAO IS NULL AND  XX.CODIGO_FUNCAO_SEGUINTE IS NOT NULL)OR(XX.CODIGO_FUNCAO IS NOT  NULL AND  XX.CODIGO_FUNCAO_SEGUINTE IS NULL)) THEN 'CODIGO_FUNCAO_MUDOU'ELSE 'CODIGO_FUNCAO_IGUAL'
        END ALTEROU_CODIGO_FUNCAO,
--------------------------------------------------------------------------------CPF_GESTOR-------------------------------------------------------------------------------------------------
        CASE WHEN (XX.CONTROLE_FOLHA_SEGUINTE NOT IN ('D','S')AND XX.DATA_RESCISAO_SEGUINTE IS NULL AND XX.CHAVE_INTEGRACAO_SEGUINTE='ATIVO') AND XX.CPF_GESTOR <> XX.CPF_GESTOR_SEGUINTE THEN 'CPF_GESTOR_MUDOU'ELSE 'CPF_GESTOR_IGUAL'END ALTEROU_CPF_GESTOR,
----------------------------------------------------------------------------------E_GESTOR-------------------------------------------------------------------------------------------------
        CASE WHEN (XX.CONTROLE_FOLHA_SEGUINTE NOT IN ('D','S')AND XX.DATA_RESCISAO_SEGUINTE IS NULL AND XX.CHAVE_INTEGRACAO_SEGUINTE='ATIVO') AND XX.E_GESTOR <> XX.E_GESTOR_SEGUINTE THEN 'E_GESTOR_MUDOU'ELSE 'E_GESTOR_IGUAL'END ALTEROU_E_GESTOR,
---------------------------------------------------------------------------------------TIPO_USUARIO-------------------------------------------------------------------------------------
        CASE WHEN(XX.CONTROLE_FOLHA_SEGUINTE NOT IN ('D','S')AND XX.DATA_RESCISAO_SEGUINTE IS NULL AND XX.CHAVE_INTEGRACAO_SEGUINTE='ATIVO')AND XX.TIPO_USUARIO <> XX.TIPO_USUARIO_SEGUINTE THEN 'TIPO_USUARIO_MUDOU'ELSE 'TIPO_USUARIO_IGUAL'END ALTEROU_TIPO_USUARIO,
-----------------------------------------------------------------------------------CODIGO DA CERCA MUDOU -------------------------------------------------------------------------------------
        CASE WHEN (XX.CONTROLE_FOLHA_SEGUINTE NOT IN ('D','S')AND XX.DATA_RESCISAO_SEGUINTE IS NULL AND XX.CHAVE_INTEGRACAO_SEGUINTE='ATIVO') AND ((XX.CODIGO_LEGADO <> XX.CODIGO_LEGADO_SEGUINTE)OR (XX.CODIGO_LEGADO IS NULL AND  XX.CODIGO_LEGADO_SEGUINTE IS NOT NULL)) THEN 'CERCA_MUDOU'ELSE 'CERCA_IGUAL'END ALTEROU_CERCA,
------------------------------------------------------------------------------------------GABRIEL AQUI EM 27/11/19 ATENDENDO SOLICITACAO DA TATILA PRA QUE O PONTO PASSA  A TROCAR SEMPRE A DATA DE INICO DA ESCALA
        CASE WHEN (XX.CONTROLE_FOLHA_SEGUINTE NOT IN ('D','S')AND XX.DATA_RESCISAO_SEGUINTE IS NULL AND XX.CHAVE_INTEGRACAO_SEGUINTE='ATIVO') AND ((XX.DT_ULT_ESCALA <>XX.DT_ULT_ESCALA_SEGUINTE) OR (XX.DT_ULT_ESCALA IS NULL AND XX.DT_ULT_ESCALA_SEGUINTE IS NOT NULL)) THEN 'DATA_ESCALA_MUDOU' ELSE 'DATA_IGUAL' END ALTEROU_INI_ESCALA,
------------------------------------------------------------------------------------------GABRIEL AQUI EM 28/07/20 ATENDENDO SOLICITACAO DO PROJETO PONTO PARA OLHAR DIA DO CICLO DA ESCALA
        CASE WHEN (XX.CONTROLE_FOLHA_SEGUINTE NOT IN ('D','S')AND XX.DATA_RESCISAO_SEGUINTE IS NULL AND XX.CHAVE_INTEGRACAO_SEGUINTE='ATIVO') AND ((XX.DIA_COMECO_CICLO <>XX.DIA_COMECO_CICLO_SEGUINTE) OR (XX.DIA_COMECO_CICLO IS NULL AND XX.DIA_COMECO_CICLO_SEGUINTE IS NOT NULL)) THEN 'DIA_CICLO_MUDOU' ELSE 'DIA_CICLO_IGUAL' END ALTEROU_DIA_CICLO_ESCALA,

--------------------------------GABRIEL AQUI EM 27/11/19 OLHAR A MUDANCA DE HIERAQUIA DE LOCAL PARA PESSOA OU DE PESSOA PARA LOCAL---------------------------
         CASE WHEN (XX.CONTROLE_FOLHA_SEGUINTE NOT IN ('D','S')AND XX.DATA_RESCISAO_SEGUINTE IS NULL AND XX.CHAVE_INTEGRACAO_SEGUINTE='ATIVO') AND TIPO<>TIPO_SEGUINTE AND TIPO_SEGUINTE NOT IN ('PESSOA SEM HIERARQUIA') THEN'ALTEROU_TIPO'  ELSE 'TIPO_IGUAL' END AS ALTEROU_TIPO_HIERARQUIA,

         --------------------------------- MUDOU DATA ADMISSAO-----------------------------------------------------------------------------------------------------------
         CASE WHEN (XX.CONTROLE_FOLHA_SEGUINTE NOT IN ('D','S')AND XX.DATA_RESCISAO_SEGUINTE IS NULL AND XX.CHAVE_INTEGRACAO_SEGUINTE='ATIVO') AND XX.data_admissao<>XX.data_admissao_SEGUINTE OR XX.data_admissao IS NULL AND XX.data_admissao_SEGUINTE IS NOT NULL THEN'ALTEROU_DATA_ADMISSAO'  ELSE 'DATA_ADMISSAO_IGUAL' END AS ALTEROU_DATA_ADMISSAO,
--------------------------------------------------------------------------------------------------FIM MUDANDACA-------------------------------------------------------------------------------------------------------------------------------
       PC.CODIGO_PESSOA AS PESSOA_GESTOR ,XX.* 
       FROM (
SELECT X.TIPO_PESSOA ,X.APELIDO, X.CODIGO_EMPRESA, X.TIPO_CONTRATO, X.CODIGO_CONTRATO, X.VINCULO ,X.EMPRESA_HIERARQUIA,X.CODIGO_PESSOA,
          Row_Number () Over (Partition BY X.CODIGO_EMPRESA, X.CODIGO_CONTRATO, X.TIPO_CONTRATO Order By X.CODIGO_EMPRESA, X.CODIGO_CONTRATO, X.TIPO_CONTRATO,X.DIA)ORDEM_BM,
          X.NOME,
          LEAD(X.NOME, 1, NULL) OVER(PARTITION BY X.CODIGO_EMPRESA, X.CODIGO_CONTRATO, X.TIPO_CONTRATO ORDER BY X.CODIGO_EMPRESA, X.CODIGO_CONTRATO, X.TIPO_CONTRATO,X.DIA) NOME_SEGUINTE,
          X.DIA,
          LEAD(X.DIA, 1, NULL) OVER(PARTITION BY X.CODIGO_EMPRESA, X.CODIGO_CONTRATO, X.TIPO_CONTRATO ORDER BY X.CODIGO_EMPRESA, X.CODIGO_CONTRATO, X.TIPO_CONTRATO,X.DIA) DIA_SEGUINTE,
          X.TIPO ,
          LEAD(X.TIPO, 1, NULL) OVER(PARTITION BY X.CODIGO_EMPRESA, X.CODIGO_CONTRATO, X.TIPO_CONTRATO ORDER BY X.CODIGO_EMPRESA, X.CODIGO_CONTRATO, X.TIPO_CONTRATO,X.DIA) TIPO_SEGUINTE,
          X.INTEGRADO ,
          LEAD(X.INTEGRADO, 1, NULL) OVER(PARTITION BY X.CODIGO_EMPRESA, X.CODIGO_CONTRATO, X.TIPO_CONTRATO ORDER BY X.CODIGO_EMPRESA, X.CODIGO_CONTRATO, X.TIPO_CONTRATO,X.DIA) INTEGRADO_SEGUINTE,
          X.PIS_PASEP,
          LEAD(X.PIS_PASEP, 1, NULL) OVER(PARTITION BY X.CODIGO_EMPRESA, X.CODIGO_CONTRATO, X.TIPO_CONTRATO ORDER BY X.CODIGO_EMPRESA, X.CODIGO_CONTRATO, X.TIPO_CONTRATO,X.DIA) PIS_PASEP_SEGUINTE,
          X.CPF,
          LEAD(X.CPF, 1, NULL) OVER(PARTITION BY X.CODIGO_EMPRESA, X.CODIGO_CONTRATO, X.TIPO_CONTRATO ORDER BY X.CODIGO_EMPRESA, X.CODIGO_CONTRATO, X.TIPO_CONTRATO,X.DIA) CPF_SEGUINTE,
          X.CNPJ,
          LEAD(X.CNPJ,1,NULL)OVER(PARTITION BY X.CODIGO_EMPRESA, X.CODIGO_CONTRATO, X.TIPO_CONTRATO ORDER BY X.CODIGO_EMPRESA, X.CODIGO_CONTRATO, X.TIPO_CONTRATO,X.DIA)CNPJ_SEGUINTE,
          X.IDENTIDADE,
          LEAD(X.IDENTIDADE, 1, NULL) OVER(PARTITION BY X.CODIGO_EMPRESA, X.CODIGO_CONTRATO, X.TIPO_CONTRATO ORDER BY X.CODIGO_EMPRESA, X.CODIGO_CONTRATO, X.TIPO_CONTRATO,X.DIA) IDENTIDADE_SEGUINTE ,
          X.COD_UNIDADE1 ,
          LEAD(X.COD_UNIDADE1, 1, NULL) OVER(PARTITION BY X.CODIGO_EMPRESA, X.CODIGO_CONTRATO, X.TIPO_CONTRATO ORDER BY X.CODIGO_EMPRESA, X.CODIGO_CONTRATO, X.TIPO_CONTRATO, X.TIPO_CONTRATO,X.DIA) COD_UNIDADE1_SEGUINTE ,
          X.COD_UNIDADE2 ,
          LEAD(X.COD_UNIDADE2, 1, NULL) OVER(PARTITION BY X.CODIGO_EMPRESA, X.CODIGO_CONTRATO, X.TIPO_CONTRATO ORDER BY X.CODIGO_EMPRESA, X.CODIGO_CONTRATO, X.TIPO_CONTRATO, X.TIPO_CONTRATO,X.DIA) COD_UNIDADE2_SEGUINTE ,
          X.COD_UNIDADE3 ,
          LEAD(X.COD_UNIDADE3, 1, NULL) OVER(PARTITION BY X.CODIGO_EMPRESA, X.CODIGO_CONTRATO, X.TIPO_CONTRATO ORDER BY X.CODIGO_EMPRESA, X.CODIGO_CONTRATO, X.TIPO_CONTRATO,X.DIA) COD_UNIDADE3_SEGUINTE ,
          X.COD_UNIDADE4 ,
          LEAD(X.COD_UNIDADE4, 1, NULL) OVER(PARTITION BY X.CODIGO_EMPRESA, X.CODIGO_CONTRATO, X.TIPO_CONTRATO ORDER BY X.CODIGO_EMPRESA, X.CODIGO_CONTRATO, X.TIPO_CONTRATO,X.DIA) COD_UNIDADE4_SEGUINTE ,
          X.COD_UNIDADE5 ,
          LEAD(X.COD_UNIDADE5, 1, NULL) OVER(PARTITION BY X.CODIGO_EMPRESA, X.CODIGO_CONTRATO, X.TIPO_CONTRATO ORDER BY X.CODIGO_EMPRESA, X.CODIGO_CONTRATO, X.TIPO_CONTRATO,X.DIA) COD_UNIDADE5_SEGUINTE ,
          X.COD_UNIDADE6 ,
          LEAD(X.COD_UNIDADE6, 1, NULL) OVER(PARTITION BY X.CODIGO_EMPRESA, X.CODIGO_CONTRATO, X.TIPO_CONTRATO ORDER BY X.CODIGO_EMPRESA, X.CODIGO_CONTRATO, X.TIPO_CONTRATO,X.DIA) COD_UNIDADE6_SEGUINTE ,
          X.DESCRICAO_UNIDADE ,
          LEAD(X.DESCRICAO_UNIDADE, 1, NULL) OVER(PARTITION BY X.CODIGO_EMPRESA, X.CODIGO_CONTRATO, X.TIPO_CONTRATO ORDER BY X.CODIGO_EMPRESA, X.CODIGO_CONTRATO, X.TIPO_CONTRATO,X.DIA) DESCRICAO_UNIDADE_SEGUINTE ,
          X.REGISTRO_PONTO ,
          LEAD(X.REGISTRO_PONTO, 1, NULL) OVER(PARTITION BY X.CODIGO_EMPRESA, X.CODIGO_CONTRATO, X.TIPO_CONTRATO ORDER BY X.CODIGO_EMPRESA, X.CODIGO_CONTRATO, X.TIPO_CONTRATO,X.DIA) REGISTRO_PONTO_SEGUINTE ,
          X.SITUACAO_FUNCIONAL ,
          LEAD(X.SITUACAO_FUNCIONAL, 1, NULL) OVER(PARTITION BY X.CODIGO_EMPRESA, X.CODIGO_CONTRATO, X.TIPO_CONTRATO ORDER BY X.CODIGO_EMPRESA, X.CODIGO_CONTRATO, X.TIPO_CONTRATO,X.DIA) SITUACAO_FUNCIONAL_SEGUINTE ,
          X.NOME_SIT_FUNC ,
          LEAD(X.NOME_SIT_FUNC, 1, NULL) OVER(PARTITION BY X.CODIGO_EMPRESA, X.CODIGO_CONTRATO, X.TIPO_CONTRATO ORDER BY X.CODIGO_EMPRESA, X.CODIGO_CONTRATO, X.TIPO_CONTRATO,X.DIA) NOME_SIT_FUNC_SEGUINTE ,
          X.CONTROLE_FOLHA ,
          LEAD(X.CONTROLE_FOLHA, 1, NULL) OVER(PARTITION BY X.CODIGO_EMPRESA, X.CODIGO_CONTRATO, X.TIPO_CONTRATO ORDER BY X.CODIGO_EMPRESA, X.CODIGO_CONTRATO, X.TIPO_CONTRATO,X.DIA) CONTROLE_FOLHA_SEGUINTE ,
          X.DATA_RESCISAO ,
          LEAD(X.DATA_RESCISAO, 1, NULL) OVER(PARTITION BY X.CODIGO_EMPRESA, X.CODIGO_CONTRATO, X.TIPO_CONTRATO ORDER BY X.CODIGO_EMPRESA, X.CODIGO_CONTRATO, X.TIPO_CONTRATO,X.DIA) DATA_RESCISAO_SEGUINTE ,
          X.CODIGO_ESCALA ,
          LEAD(X.CODIGO_ESCALA, 1, NULL) OVER(PARTITION BY X.CODIGO_EMPRESA, X.CODIGO_CONTRATO, X.TIPO_CONTRATO ORDER BY X.CODIGO_EMPRESA, X.CODIGO_CONTRATO, X.TIPO_CONTRATO,X.DIA) CODIGO_ESCALA_SEGUINTE ,
          X.DT_ULT_ESCALA ,
          LEAD(X.DT_ULT_ESCALA, 1, NULL) OVER(PARTITION BY X.CODIGO_EMPRESA, X.CODIGO_CONTRATO, X.TIPO_CONTRATO ORDER BY X.CODIGO_EMPRESA, X.CODIGO_CONTRATO, X.TIPO_CONTRATO,X.DIA) DT_ULT_ESCALA_SEGUINTE ,
          X.DIA_COMECO_CICLO,
          LEAD(X.DIA_COMECO_CICLO, 1, NULL) OVER(PARTITION BY X.CODIGO_EMPRESA, X.CODIGO_CONTRATO, X.TIPO_CONTRATO ORDER BY X.CODIGO_EMPRESA, X.CODIGO_CONTRATO, X.TIPO_CONTRATO,X.DIA) DIA_COMECO_CICLO_SEGUINTE ,
          X.COD_CARGO_EFETIVO ,
          LEAD(X.COD_CARGO_EFETIVO, 1, NULL) OVER(PARTITION BY X.CODIGO_EMPRESA, X.CODIGO_CONTRATO, X.TIPO_CONTRATO ORDER BY X.CODIGO_EMPRESA, X.CODIGO_CONTRATO, X.TIPO_CONTRATO,X.DIA) COD_CARGO_EFETIVO_SEGUINTE ,
          X.CARGO_EFETIVO ,
          LEAD(X.CARGO_EFETIVO, 1, NULL) OVER(PARTITION BY X.CODIGO_EMPRESA, X.CODIGO_CONTRATO, X.TIPO_CONTRATO ORDER BY X.CODIGO_EMPRESA, X.CODIGO_CONTRATO, X.TIPO_CONTRATO,X.DIA) CARGO_EFETIVO_SEGUINTE ,
          X.COD_CARGO_COMISS ,
          LEAD(X.COD_CARGO_COMISS, 1, NULL) OVER(PARTITION BY X.CODIGO_EMPRESA, X.CODIGO_CONTRATO, X.TIPO_CONTRATO ORDER BY X.CODIGO_EMPRESA, X.CODIGO_CONTRATO, X.TIPO_CONTRATO,X.DIA) COD_CARGO_COMISS_SEGUINTE ,
          X.CARGO_COMISSIONADO ,
          LEAD(X.CARGO_COMISSIONADO, 1, NULL) OVER(PARTITION BY X.CODIGO_EMPRESA, X.CODIGO_CONTRATO, X.TIPO_CONTRATO ORDER BY X.CODIGO_EMPRESA, X.CODIGO_CONTRATO, X.TIPO_CONTRATO,X.DIA) CARGO_COMISSIONADO_SEGUINTE ,
          X.CODIGO_FUNCAO ,
          LEAD(X.CODIGO_FUNCAO, 1, NULL) OVER(PARTITION BY X.CODIGO_EMPRESA, X.CODIGO_CONTRATO, X.TIPO_CONTRATO ORDER BY X.CODIGO_EMPRESA, X.CODIGO_CONTRATO, X.TIPO_CONTRATO,X.DIA) CODIGO_FUNCAO_SEGUINTE ,
          X.FUNCAO_PUBLICA ,
          LEAD(X.FUNCAO_PUBLICA, 1, NULL) OVER(PARTITION BY X.CODIGO_EMPRESA, X.CODIGO_CONTRATO, X.TIPO_CONTRATO ORDER BY X.CODIGO_EMPRESA, X.CODIGO_CONTRATO, X.TIPO_CONTRATO,X.DIA) FUNCAO_PUBLICA_SEGUINTE ,
          X.CODIGO_EMPRESA_GESTOR ,
          LEAD(X.CODIGO_EMPRESA_GESTOR, 1, NULL) OVER(PARTITION BY X.CODIGO_EMPRESA, X.CODIGO_CONTRATO, X.TIPO_CONTRATO ORDER BY X.CODIGO_EMPRESA, X.CODIGO_CONTRATO, X.TIPO_CONTRATO,X.DIA) CODIGO_EMPRESA_GESTOR_SEGUINTE ,
          X.TIPO_CONTRATO_GESTOR ,
          LEAD(X.TIPO_CONTRATO_GESTOR, 1, NULL) OVER(PARTITION BY X.CODIGO_EMPRESA, X.CODIGO_CONTRATO, X.TIPO_CONTRATO ORDER BY X.CODIGO_EMPRESA, X.CODIGO_CONTRATO, X.TIPO_CONTRATO,X.DIA) TIPO_CONTRATO_GESTOR_SEGUINTE ,
          X.CONTRATO_GESTOR ,
          LEAD(X.CONTRATO_GESTOR, 1, NULL) OVER(PARTITION BY X.CODIGO_EMPRESA, X.CODIGO_CONTRATO, X.TIPO_CONTRATO ORDER BY X.CODIGO_EMPRESA, X.CODIGO_CONTRATO, X.TIPO_CONTRATO,X.DIA) CONTRATO_GESTOR_SEGUINTE ,
          X.CPF_GESTOR ,
          LEAD(X.CPF_GESTOR, 1, NULL) OVER(PARTITION BY X.CODIGO_EMPRESA, X.CODIGO_CONTRATO, X.TIPO_CONTRATO ORDER BY X.CODIGO_EMPRESA, X.CODIGO_CONTRATO, X.TIPO_CONTRATO,X.DIA) CPF_GESTOR_SEGUINTE ,
          X.E_GESTOR ,
          LEAD(X.E_GESTOR, 1, NULL) OVER(PARTITION BY X.CODIGO_EMPRESA, X.CODIGO_CONTRATO, X.TIPO_CONTRATO ORDER BY X.CODIGO_EMPRESA, X.CODIGO_CONTRATO, X.TIPO_CONTRATO,X.DIA) E_GESTOR_SEGUINTE ,
          X.TIPO_USUARIO ,
          LEAD(X.TIPO_USUARIO, 1, NULL) OVER(PARTITION BY X.CODIGO_EMPRESA, X.CODIGO_CONTRATO, X.TIPO_CONTRATO ORDER BY X.CODIGO_EMPRESA, X.CODIGO_CONTRATO, X.TIPO_CONTRATO,X.DIA) TIPO_USUARIO_SEGUINTE ,
          X.DT_SAIU_ARTE,
          X.CODIGO_LEGADO,
          LEAD(X.CODIGO_LEGADO, 1, NULL) OVER(PARTITION BY X.CODIGO_EMPRESA, X.CODIGO_CONTRATO, X.TIPO_CONTRATO ORDER BY X.CODIGO_EMPRESA, X.CODIGO_CONTRATO, X.TIPO_CONTRATO,X.DIA) CODIGO_LEGADO_SEGUINTE,
          X.TEM_CARGO_EFETIVO,
          X.CHAVE_INTEGRACAO,
          LEAD(X.CHAVE_INTEGRACAO, 1, NULL) OVER(PARTITION BY X.CODIGO_EMPRESA, X.CODIGO_CONTRATO, X.TIPO_CONTRATO ORDER BY X.CODIGO_EMPRESA, X.CODIGO_CONTRATO, X.TIPO_CONTRATO,X.DIA) CHAVE_INTEGRACAO_SEGUINTE,
          X.EXCECAO_FUNCIONAL,--NOVO EM 16/8/22 EMAIL (Customização - Cadastro de justificativa),
          X.data_admissao,
        LEAD(X.data_admissao, 1, NULL) OVER(PARTITION BY X.CODIGO_EMPRESA, X.CODIGO_CONTRATO, X.TIPO_CONTRATO ORDER BY X.CODIGO_EMPRESA, X.CODIGO_CONTRATO, X.TIPO_CONTRATO,X.DIA) data_admissao_SEGUINTE,
        x.GERA_MARCACAO_INTERVALO_AUTO

        FROM
          (SELECT 'ULTIMO' AS DIA,U.*,GN.CGC AS CNPJ
          FROM PONTO_ELETRONICO.SUGESP_BI_1CONTRAT_INTIF_ARTE U
          LEFT OUTER JOIN ARTERH.RHORGA_CUSTO_GEREN GN
          ON U.CODIGO_EMPRESA  =GN.CODIGO_EMPRESA
          AND U.COD_UNIDADE1   =GN.cod_cgerenc1
          AND U.COD_UNIDADE2   =GN.cod_cgerenc2
          AND U.COD_UNIDADE3   =GN.cod_cgerenc3
          AND U.COD_UNIDADE4   =GN.cod_cgerenc4
          AND U.COD_UNIDADE5   =GN.cod_cgerenc5
          AND U.COD_UNIDADE6   =GN.cod_cgerenc6
          WHERE trunc(U.dt_saiu_arte)= (SELECT TRUNC(MAX(dt_saiu_arte))FROM PONTO_ELETRONICO.SUGESP_BI_1CONTRAT_INTIF_ARTE )
          UNION ALL
          --PENULTIMO DIA
          SELECT 'PENULTIMO' AS DIA,P.*,GN.CGC AS CNPJ
          FROM PONTO_ELETRONICO.SUGESP_BI_1CONTRAT_INTIF_ARTE P
          LEFT OUTER JOIN ARTERH.RHORGA_CUSTO_GEREN GN
          ON P.CODIGO_EMPRESA  =GN.CODIGO_EMPRESA
          AND P.COD_UNIDADE1   =GN.cod_cgerenc1
          AND P.COD_UNIDADE2   =GN.cod_cgerenc2
          AND P.COD_UNIDADE3   =GN.cod_cgerenc3
          AND P.COD_UNIDADE4   =GN.cod_cgerenc4
          AND P.COD_UNIDADE5   =GN.cod_cgerenc5
          AND P.COD_UNIDADE6   =GN.cod_cgerenc6
         WHERE trunc(P.dt_saiu_arte) =  (SELECT TRUNC(X.dt_saiu_arte) FROM(SELECT TRUNC(k.dt_saiu_arte)dt_saiu_arte ,ROWNUM ORDEM_DATA FROM (SELECT Z.*FROM(SELECT TRUNC(X.dt_saiu_arte)dt_saiu_arte FROM PONTO_ELETRONICO.SUGESP_BI_1CONTRAT_INTIF_ARTE x  GROUP BY TRUNC(X.dt_saiu_arte) ORDER BY TRUNC(X.dt_saiu_arte) DESC)Z)K)X WHERE X.ORDEM_DATA = 2)

         )X
        ORDER BY X.CODIGO_EMPRESA,X.CODIGO_CONTRATO, X.DIA
        ---FIM PRIMEIRO X SELECT BASE
        )XX
        LEFT OUTER JOIN ARTERH.RHPESS_CONTRATO PC----- PEGAR CODIGO PESSOA GESTOR
        ON XX.CODIGO_EMPRESA_GESTOR = PC.CODIGO_EMPRESA
        AND XX.CONTRATO_GESTOR      =PC.CODIGO
        AND XX.TIPO_CONTRATO_GESTOR =PC.TIPO_CONTRATO
            WHERE(XX.ORDEM_BM = 1)
            AND PC.ANO_MES_REFERENCIA   =
          (SELECT MAX(AUX.ANO_MES_REFERENCIA)
          FROM ARTERH.RHPESS_CONTRATO AUX
          WHERE PC.CODIGO_EMPRESA     =AUX.CODIGO_EMPRESA
          AND PC.TIPO_CONTRATO        =AUX.TIPO_CONTRATO
          AND PC.CODIGO               = AUX.CODIGO
          AND AUX.ANO_MES_REFERENCIA <=
            (SELECT data_do_sistema FROM rhparm_p_sist
            )
          )
        --FIM XX

  )XXX  
  WHERE ( (XXX.E_CADASTRO_NOVO = 'SIM'AND XXX.INTEGRADO = 'N')----- um cadastro novo
    OR (XXX.ALTEROU_CODIGO_ESCALA     = 'CODIGO_ESCALA_MUDOU'AND XXX.INTEGRADO_SEGUINTE= 'S') --Kellysson 3/12/18-- quando altera a ESCALA no contrato da pessoa
    OR (XXX.ALTEROU_COD_CARGO_EFETIVO = 'COD_CARGO_EFETIVO_MUDOU'AND XXX.INTEGRADO_SEGUINTE= 'S')--Kellysson 3/12/18-- quando altera o CARGO EFETIVO no contrato da pessoa
    OR (XXX.ALTEROU_COD_CARGO_COMISS  = 'COD_CARGO_COMISS_MUDOU'AND XXX.INTEGRADO_SEGUINTE= 'S')--Kellysson 3/12/18-- quando altera o CARGO COMISSIONADO no contrato da pessoa
    OR (XXX.ALTEROU_CODIGO_FUNCAO     = 'CODIGO_FUNCAO_MUDOU'AND XXX.INTEGRADO_SEGUINTE= 'S')--Kellysson 3/12/18-- quando altera a no contrato da pessoa
    OR (XXX.ALTEROU_LOCAL             = 'LOCAL_MUDOU'AND XXX.INTEGRADO_SEGUINTE = 'S')--Kellysson 3/12/18-- Quando altera o CUSTO GERENCIAL no contrato da pessoa
    OR (XXX.ALTEROU_REGISTRO_PONTO    = 'REGISTRO_PONTO_MUDOU'AND XXX.INTEGRADO_SEGUINTE = 'S')--Kellysson 3/12/18-- Quando altera o REGISTRO PONTO no contrato da pessoa
    OR (XXX.ALTEROU_CHAVE_INTEGRACAO = 'CHAVE_MUDOU'AND XXX.INTEGRADO_SEGUINTE = 'S')--Kellysson 20/12/18 -- Quando a pessoa desligou ou readmitiu
    OR (XXX.ALTEROU_CPF_GESTOR = 'CPF_GESTOR_MUDOU'AND XXX.INTEGRADO_SEGUINTE= 'S')
    OR (XXX.ALTEROU_E_GESTOR = 'E_GESTOR_MUDOU'AND XXX.INTEGRADO_SEGUINTE = 'S')--Kellysson 3/12/18-- significa que a pessoa ERA ou PASSOU A SER gestora
    OR (XXX.ALTEROU_NOME     ='NOME_MUDOU'AND XXX.INTEGRADO_SEGUINTE= 'S')
    OR(XXX.ALTEROU_CNPJ='MUDOU_EMPRESA'AND XXX.INTEGRADO_SEGUINTE = 'S')
    OR (XXX.ALTEROU_TIPO_USUARIO='TIPO_USUARIO_MUDOU' AND XXX.INTEGRADO_SEGUINTE= 'S' )
    OR(XXX.ALTEROU_CERCA='CERCA_MUDOU' AND XXX.INTEGRADO_SEGUINTE='S')
    OR (XXX.ALTEROU_INI_ESCALA='DATA_ESCALA_MUDOU' AND XXX.INTEGRADO_SEGUINTE='S' )
    OR (XXX.ALTEROU_TIPO_HIERARQUIA='ALTEROU_TIPO' AND XXX.INTEGRADO_SEGUINTE='S')
    OR (XXX.ALTEROU_DIA_CICLO_ESCALA='DIA_CICLO_MUDOU' AND XXX.INTEGRADO_SEGUINTE='S')
    OR(XXX.ALTEROU_DATA_ADMISSAO='ALTEROU_DATA_ADMISSAO' AND XXX.INTEGRADO_SEGUINTE='S')
    )
    )fim_base_foto
    )fim_case_gerar_dados_foto