
  CREATE OR REPLACE EDITIONABLE TRIGGER "ARTERH"."TR_RHPLCS_ALT_ESPEC_AUDIT" 
AFTER UPDATE OR DELETE OR INSERT ON "ARTERH"."RHPLCS_ALT_ESPEC" 
FOR EACH ROW
 DECLARE
v_DML RHPBH_RHPLCS_ALT_ESPEC_AUDIT.TIPO_DML%TYPE;
BEGIN
IF DELETING THEN
v_DML := 'D';
INSERT INTO RHPBH_RHPLCS_ALT_ESPEC_AUDIT
(
TIPO_DML,
CODIGO_EMPRESA,
TIPO_CONTRATO,
CODIGO_CONTRATO,
DATA_INICIO_ESPEC,
CODIGO_ESPEC,
DT_FIM_TEMP,
CODIGO_HIST_ESPEC,
DOCUMENTO_PUBLIC,
ASSINATURA_01,
ASSINATURA_02,
ASSINATURA_03,
TEXTO_ASSOCIADO,
LOGIN_USUARIO,
DT_ULT_ALTER_USUA,
ID_ALT
)
VALUES
(
v_DML,
:OLD.CODIGO_EMPRESA,
:OLD.TIPO_CONTRATO,
:OLD.CODIGO_CONTRATO,
:OLD.DATA_INICIO_ESPEC,
:OLD.CODIGO_ESPEC,
:OLD.DT_FIM_TEMP,
:OLD.CODIGO_HIST_ESPEC,
:OLD.DOCUMENTO_PUBLIC,
:OLD.ASSINATURA_01,
:OLD.ASSINATURA_02,
:OLD.ASSINATURA_03,
:OLD.TEXTO_ASSOCIADO,
USER,
SYSDATE,
NULL
);
GRAVA_MODULO_APOSENT(:OLD.CODIGO_CONTRATO,'RHPLCS_ALT_ESPEC',:OLD.TIPO_CONTRATO, :OLD.CODIGO_EMPRESA,NULL, NULL, NULL,NULL,NULL,NULL, NULL, NULL, NULL, NULL, :OLD.DATA_INICIO_ESPEC,NULL );

END IF;

IF UPDATING THEN
v_DML := 'U';
INSERT INTO RHPBH_RHPLCS_ALT_ESPEC_AUDIT
(
TIPO_DML,
CODIGO_EMPRESA,
TIPO_CONTRATO,
CODIGO_CONTRATO,
DATA_INICIO_ESPEC,
CODIGO_ESPEC,
DT_FIM_TEMP,
CODIGO_HIST_ESPEC,
DOCUMENTO_PUBLIC,
ASSINATURA_01,
ASSINATURA_02,
ASSINATURA_03,
TEXTO_ASSOCIADO,
LOGIN_USUARIO,
DT_ULT_ALTER_USUA,
ID_ALT
)
VALUES
(
v_DML,
:OLD.CODIGO_EMPRESA,
:OLD.TIPO_CONTRATO,
:OLD.CODIGO_CONTRATO,
:OLD.DATA_INICIO_ESPEC,
:OLD.CODIGO_ESPEC,
:OLD.DT_FIM_TEMP,
:OLD.CODIGO_HIST_ESPEC,
:OLD.DOCUMENTO_PUBLIC,
:OLD.ASSINATURA_01,
:OLD.ASSINATURA_02,
:OLD.ASSINATURA_03,
:OLD.TEXTO_ASSOCIADO,
:NEW.LOGIN_USUARIO,
:NEW.DT_ULT_ALTER_USUA,
NULL
);
GRAVA_MODULO_APOSENT(:OLD.CODIGO_CONTRATO,'RHPLCS_ALT_ESPEC',:OLD.TIPO_CONTRATO, :OLD.CODIGO_EMPRESA,NULL, NULL, NULL,NULL,NULL,NULL, NULL, NULL, NULL, NULL, :OLD.DATA_INICIO_ESPEC,NULL );
END IF;

IF  INSERTING THEN 
v_DML := 'I';
INSERT INTO RHPBH_RHPLCS_ALT_ESPEC_AUDIT
(
TIPO_DML,
CODIGO_EMPRESA,
TIPO_CONTRATO,
CODIGO_CONTRATO,
DATA_INICIO_ESPEC,
CODIGO_ESPEC,
DT_FIM_TEMP,
CODIGO_HIST_ESPEC,
DOCUMENTO_PUBLIC,
ASSINATURA_01,
ASSINATURA_02,
ASSINATURA_03,
TEXTO_ASSOCIADO,
LOGIN_USUARIO,
DT_ULT_ALTER_USUA,
ID_ALT
)
VALUES
(
v_DML,
:NEW.CODIGO_EMPRESA,
:NEW.TIPO_CONTRATO,
:NEW.CODIGO_CONTRATO,
:NEW.DATA_INICIO_ESPEC,
:NEW.CODIGO_ESPEC,
:NEW.DT_FIM_TEMP,
:NEW.CODIGO_HIST_ESPEC,
:NEW.DOCUMENTO_PUBLIC,
:NEW.ASSINATURA_01,
:NEW.ASSINATURA_02,
:NEW.ASSINATURA_03,
:NEW.TEXTO_ASSOCIADO,
:NEW.LOGIN_USUARIO,
:NEW.DT_ULT_ALTER_USUA,
NULL
);
END IF;
GRAVA_MODULO_APOSENT(:NEW.CODIGO_CONTRATO,'RHPLCS_ALT_ESPEC',:NEW.TIPO_CONTRATO, :NEW.CODIGO_EMPRESA,NULL, NULL, NULL,NULL,NULL,NULL, NULL, NULL, NULL, NULL, :NEW.DATA_INICIO_ESPEC,NULL );
END;




ALTER TRIGGER "ARTERH"."TR_RHPLCS_ALT_ESPEC_AUDIT" ENABLE