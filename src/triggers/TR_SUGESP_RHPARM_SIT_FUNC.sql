
  CREATE OR REPLACE EDITIONABLE TRIGGER "ARTERH"."TR_SUGESP_RHPARM_SIT_FUNC" 
BEFORE INSERT OR UPDATE OR DELETE ON "ARTERH"."RHPARM_SIT_FUNC"
FOR EACH ROW

-- WHEN (NEW.CODIGO_EMPRESA not in ('0003','0013','0014') or OLD.CODIGO_EMPRESA NOT IN ('0003','0013','0014')) 
-- WHEN (NEW.CODIGO_EMPRESA not in ('0002','0007','0009','0010') or OLD.CODIGO_EMPRESA NOT IN ('0002','0007','0009','0010')) --adicionado em 22/7/20 previsao de desativar em 7/8/20 empresas 0002 PRODABEL, 0007 SLU, 0009 BELOTUR E 0010 URBEL 

 DECLARE
v_DML SUGESP_RHPARM_SIT_FUNC.TIPO_DML%TYPE;


BEGIN




--------------------------------------------------------------------------INSERT-------------------------------------------------------------------------------------------------------------------------------------------
IF INSERTING THEN 
v_DML := 'I';


INSERT INTO SUGESP_RHPARM_SIT_FUNC
(
ID,
TIPO_DML,
CODIGO,
NEW_DESCRICAO,
NEW_ABREVIACAO,
NEW_CODIGO_RAIS,
NEW_CONTROLE_FOLHA,
NEW_SITUACAO_PONTO,
NEW_E_AFASTAMENTO,
NEW_ABATE_TEMPO_FERIAS,
NEW_ABATE_TEMPO_13_SAL,
NEW_RESTRICAO_DESLIG,
NEW_VERBA_1_PARA_FOLHA,
NEW_VERBA_2_PARA_FOLHA,
NEW_VERBA_3_PARA_FOLHA,
NEW_VERBA_4_PARA_FOLHA,
NEW_C_LIVRE_SELEC01,
NEW_C_LIVRE_SELEC02,
NEW_C_LIVRE_VALOR03,
NEW_C_LIVRE_VALOR04,
NEW_C_LIVRE_DATA05,
NEW_C_LIVRE_DATA06,
NEW_LOGIN_USUARIO,
NEW_DT_ULT_ALTER_USUA,
NEW_MEDIDA_ESTABILID,
NEW_QTDE_ESTAB_POSTER,
NEW_SUSPENDE_REMUNERA,
NEW_QTDE_DIAS_PROXIMO,
NEW_PROXIMA_SIT_FUNC,
NEW_MOTIVO_AFAST,
NEW_GERA_SAL_BENEFICIO,
NEW_TEXTO_ASSOCIADO,
NEW_C_LIVRE_DESCR07,
NEW_C_LIVRE_DESCR08,
NEW_SUSPENDE_VALE,
NEW_GERA_REG_ACOMP,
NEW_QTDE_DETERMINADA,
NEW_CATEG_TRAB_FGTS,
NEW_CONSID_DIAS_INSS,
NEW_GRUPO_SEL_PESSOA,
NEW_COD_SEL_PESSOA,
NEW_GRUPO_SEL_CONTRATO,
NEW_COD_SEL_CONTRATO,
NEW_GERA_SIT_PTO_AUTO,
NEW_TIPO_APURACAO,
NEW_SEXO,
NEW_CODIGO_RETENCAO,
NEW_PERMITE_CONCOMIT,
NEW_ID_LEI,
NEW_DATA_INI_VIGENCIA,
NEW_DATA_FIM_VIGENCIA,
NEW_DIAS_PRORROG_ORI,
NEW_DIAS_PRORROG_DES,
NEW_DIAS_INI_PRORROG,
NEW_COD_CATEG_ESOCIAL,
NEW_C_LIVRE_OPCAO01,
NEW_C_LIVRE_OPCAO02,
NEW_C_LIVRE_OPCAO03,
NEW_COD_TP_ESTABILIDAD
)
VALUES
(
(SELECT MAX(ID)+1 FROM SUGESP_RHPARM_SIT_FUNC),
v_DML,
:NEW.CODIGO,
:NEW.DESCRICAO,
:NEW.ABREVIACAO,
:NEW.CODIGO_RAIS,
:NEW.CONTROLE_FOLHA,
:NEW.SITUACAO_PONTO,
:NEW.E_AFASTAMENTO,
:NEW.ABATE_TEMPO_FERIAS,
:NEW.ABATE_TEMPO_13_SAL,
:NEW.RESTRICAO_DESLIG,
:NEW.VERBA_1_PARA_FOLHA,
:NEW.VERBA_2_PARA_FOLHA,
:NEW.VERBA_3_PARA_FOLHA,
:NEW.VERBA_4_PARA_FOLHA,
:NEW.C_LIVRE_SELEC01,
:NEW.C_LIVRE_SELEC02,
:NEW.C_LIVRE_VALOR03,
:NEW.C_LIVRE_VALOR04,
:NEW.C_LIVRE_DATA05,
:NEW.C_LIVRE_DATA06,
SYS_CONTEXT ('USERENV', 'OS_USER'),
SYSDATE,
:NEW.MEDIDA_ESTABILID,
:NEW.QTDE_ESTAB_POSTER,
:NEW.SUSPENDE_REMUNERA,
:NEW.QTDE_DIAS_PROXIMO,
:NEW.PROXIMA_SIT_FUNC,
:NEW.MOTIVO_AFAST,
:NEW.GERA_SAL_BENEFICIO,
:NEW.TEXTO_ASSOCIADO,
:NEW.C_LIVRE_DESCR07,
:NEW.C_LIVRE_DESCR08,
:NEW.SUSPENDE_VALE,
:NEW.GERA_REG_ACOMP,
:NEW.QTDE_DETERMINADA,
:NEW.CATEG_TRAB_FGTS,
:NEW.CONSID_DIAS_INSS,
:NEW.GRUPO_SEL_PESSOA,
:NEW.COD_SEL_PESSOA,
:NEW.GRUPO_SEL_CONTRATO,
:NEW.COD_SEL_CONTRATO,
:NEW.GERA_SIT_PTO_AUTO,
:NEW.TIPO_APURACAO,
:NEW.SEXO,
:NEW.CODIGO_RETENCAO,
:NEW.PERMITE_CONCOMIT,
:NEW.ID_LEI,
:NEW.DATA_INI_VIGENCIA,
:NEW.DATA_FIM_VIGENCIA,
:NEW.DIAS_PRORROG_ORI,
:NEW.DIAS_PRORROG_DES,
:NEW.DIAS_INI_PRORROG,
:NEW.COD_CATEG_ESOCIAL,
:NEW.C_LIVRE_OPCAO01,
:NEW.C_LIVRE_OPCAO02,
:NEW.C_LIVRE_OPCAO03,
:NEW.COD_TP_ESTABILIDAD
);


--------------------------------------------------------------------------UPDATE-------------------------------------------------------------------------------------------------------------------------------------------
ELSIF UPDATING THEN
v_DML := 'U';



INSERT INTO SUGESP_RHPARM_SIT_FUNC
(
ID,
TIPO_DML,
CODIGO,
NEW_DESCRICAO,
NEW_ABREVIACAO,
NEW_CODIGO_RAIS,
NEW_CONTROLE_FOLHA,
NEW_SITUACAO_PONTO,
NEW_E_AFASTAMENTO,
NEW_ABATE_TEMPO_FERIAS,
NEW_ABATE_TEMPO_13_SAL,
NEW_RESTRICAO_DESLIG,
NEW_VERBA_1_PARA_FOLHA,
NEW_VERBA_2_PARA_FOLHA,
NEW_VERBA_3_PARA_FOLHA,
NEW_VERBA_4_PARA_FOLHA,
NEW_C_LIVRE_SELEC01,
NEW_C_LIVRE_SELEC02,
NEW_C_LIVRE_VALOR03,
NEW_C_LIVRE_VALOR04,
NEW_C_LIVRE_DATA05,
NEW_C_LIVRE_DATA06,
NEW_LOGIN_USUARIO,
NEW_DT_ULT_ALTER_USUA,
NEW_MEDIDA_ESTABILID,
NEW_QTDE_ESTAB_POSTER,
NEW_SUSPENDE_REMUNERA,
NEW_QTDE_DIAS_PROXIMO,
NEW_PROXIMA_SIT_FUNC,
NEW_MOTIVO_AFAST,
NEW_GERA_SAL_BENEFICIO,
NEW_TEXTO_ASSOCIADO,
NEW_C_LIVRE_DESCR07,
NEW_C_LIVRE_DESCR08,
NEW_SUSPENDE_VALE,
NEW_GERA_REG_ACOMP,
NEW_QTDE_DETERMINADA,
NEW_CATEG_TRAB_FGTS,
NEW_CONSID_DIAS_INSS,
NEW_GRUPO_SEL_PESSOA,
NEW_COD_SEL_PESSOA,
NEW_GRUPO_SEL_CONTRATO,
NEW_COD_SEL_CONTRATO,
NEW_GERA_SIT_PTO_AUTO,
NEW_TIPO_APURACAO,
NEW_SEXO,
NEW_CODIGO_RETENCAO,
NEW_PERMITE_CONCOMIT,
NEW_ID_LEI,
NEW_DATA_INI_VIGENCIA,
NEW_DATA_FIM_VIGENCIA,
NEW_DIAS_PRORROG_ORI,
NEW_DIAS_PRORROG_DES,
NEW_DIAS_INI_PRORROG,
NEW_COD_CATEG_ESOCIAL,
NEW_C_LIVRE_OPCAO01,
NEW_C_LIVRE_OPCAO02,
NEW_C_LIVRE_OPCAO03,
NEW_COD_TP_ESTABILIDAD,
OLD_DESCRICAO,
OLD_ABREVIACAO,
OLD_CODIGO_RAIS,
OLD_CONTROLE_FOLHA,
OLD_SITUACAO_PONTO,
OLD_E_AFASTAMENTO,
OLD_ABATE_TEMPO_FERIAS,
OLD_ABATE_TEMPO_13_SAL,
OLD_RESTRICAO_DESLIG,
OLD_VERBA_1_PARA_FOLHA,
OLD_VERBA_2_PARA_FOLHA,
OLD_VERBA_3_PARA_FOLHA,
OLD_VERBA_4_PARA_FOLHA,
OLD_C_LIVRE_SELEC01,
OLD_C_LIVRE_SELEC02,
OLD_C_LIVRE_VALOR03,
OLD_C_LIVRE_VALOR04,
OLD_C_LIVRE_DATA05,
OLD_C_LIVRE_DATA06,
OLD_LOGIN_USUARIO,
OLD_DT_ULT_ALTER_USUA,
OLD_MEDIDA_ESTABILID,
OLD_QTDE_ESTAB_POSTER,
OLD_SUSPENDE_REMUNERA,
OLD_QTDE_DIAS_PROXIMO,
OLD_PROXIMA_SIT_FUNC,
OLD_MOTIVO_AFAST,
OLD_GERA_SAL_BENEFICIO,
OLD_TEXTO_ASSOCIADO,
OLD_C_LIVRE_DESCR07,
OLD_C_LIVRE_DESCR08,
OLD_SUSPENDE_VALE,
OLD_GERA_REG_ACOMP,
OLD_QTDE_DETERMINADA,
OLD_CATEG_TRAB_FGTS,
OLD_CONSID_DIAS_INSS,
OLD_GRUPO_SEL_PESSOA,
OLD_COD_SEL_PESSOA,
OLD_GRUPO_SEL_CONTRATO,
OLD_COD_SEL_CONTRATO,
OLD_GERA_SIT_PTO_AUTO,
OLD_TIPO_APURACAO,
OLD_SEXO,
OLD_CODIGO_RETENCAO,
OLD_PERMITE_CONCOMIT,
OLD_ID_LEI,
OLD_DATA_INI_VIGENCIA,
OLD_DATA_FIM_VIGENCIA,
OLD_DIAS_PRORROG_ORI,
OLD_DIAS_PRORROG_DES,
OLD_DIAS_INI_PRORROG,
OLD_COD_CATEG_ESOCIAL,
OLD_C_LIVRE_OPCAO01,
OLD_C_LIVRE_OPCAO02,
OLD_C_LIVRE_OPCAO03,
OLD_COD_TP_ESTABILIDAD
)
VALUES
(
(SELECT MAX(ID)+1 FROM SUGESP_RHPARM_SIT_FUNC),
v_DML,
:NEW.CODIGO,
:NEW.DESCRICAO,
:NEW.ABREVIACAO,
:NEW.CODIGO_RAIS,
:NEW.CONTROLE_FOLHA,
:NEW.SITUACAO_PONTO,
:NEW.E_AFASTAMENTO,
:NEW.ABATE_TEMPO_FERIAS,
:NEW.ABATE_TEMPO_13_SAL,
:NEW.RESTRICAO_DESLIG,
:NEW.VERBA_1_PARA_FOLHA,
:NEW.VERBA_2_PARA_FOLHA,
:NEW.VERBA_3_PARA_FOLHA,
:NEW.VERBA_4_PARA_FOLHA,
:NEW.C_LIVRE_SELEC01,
:NEW.C_LIVRE_SELEC02,
:NEW.C_LIVRE_VALOR03,
:NEW.C_LIVRE_VALOR04,
:NEW.C_LIVRE_DATA05,
:NEW.C_LIVRE_DATA06,
SYS_CONTEXT ('USERENV', 'OS_USER'),
SYSDATE,
:NEW.MEDIDA_ESTABILID,
:NEW.QTDE_ESTAB_POSTER,
:NEW.SUSPENDE_REMUNERA,
:NEW.QTDE_DIAS_PROXIMO,
:NEW.PROXIMA_SIT_FUNC,
:NEW.MOTIVO_AFAST,
:NEW.GERA_SAL_BENEFICIO,
:NEW.TEXTO_ASSOCIADO,
:NEW.C_LIVRE_DESCR07,
:NEW.C_LIVRE_DESCR08,
:NEW.SUSPENDE_VALE,
:NEW.GERA_REG_ACOMP,
:NEW.QTDE_DETERMINADA,
:NEW.CATEG_TRAB_FGTS,
:NEW.CONSID_DIAS_INSS,
:NEW.GRUPO_SEL_PESSOA,
:NEW.COD_SEL_PESSOA,
:NEW.GRUPO_SEL_CONTRATO,
:NEW.COD_SEL_CONTRATO,
:NEW.GERA_SIT_PTO_AUTO,
:NEW.TIPO_APURACAO,
:NEW.SEXO,
:NEW.CODIGO_RETENCAO,
:NEW.PERMITE_CONCOMIT,
:NEW.ID_LEI,
:NEW.DATA_INI_VIGENCIA,
:NEW.DATA_FIM_VIGENCIA,
:NEW.DIAS_PRORROG_ORI,
:NEW.DIAS_PRORROG_DES,
:NEW.DIAS_INI_PRORROG,
:NEW.COD_CATEG_ESOCIAL,
:NEW.C_LIVRE_OPCAO01,
:NEW.C_LIVRE_OPCAO02,
:NEW.C_LIVRE_OPCAO03,
:NEW.COD_TP_ESTABILIDAD,
:OLD.DESCRICAO,
:OLD.ABREVIACAO,
:OLD.CODIGO_RAIS,
:OLD.CONTROLE_FOLHA,
:OLD.SITUACAO_PONTO,
:OLD.E_AFASTAMENTO,
:OLD.ABATE_TEMPO_FERIAS,
:OLD.ABATE_TEMPO_13_SAL,
:OLD.RESTRICAO_DESLIG,
:OLD.VERBA_1_PARA_FOLHA,
:OLD.VERBA_2_PARA_FOLHA,
:OLD.VERBA_3_PARA_FOLHA,
:OLD.VERBA_4_PARA_FOLHA,
:OLD.C_LIVRE_SELEC01,
:OLD.C_LIVRE_SELEC02,
:OLD.C_LIVRE_VALOR03,
:OLD.C_LIVRE_VALOR04,
:OLD.C_LIVRE_DATA05,
:OLD.C_LIVRE_DATA06,
SYS_CONTEXT ('USERENV', 'OS_USER'),
SYSDATE,
:OLD.MEDIDA_ESTABILID,
:OLD.QTDE_ESTAB_POSTER,
:OLD.SUSPENDE_REMUNERA,
:OLD.QTDE_DIAS_PROXIMO,
:OLD.PROXIMA_SIT_FUNC,
:OLD.MOTIVO_AFAST,
:OLD.GERA_SAL_BENEFICIO,
:OLD.TEXTO_ASSOCIADO,
:OLD.C_LIVRE_DESCR07,
:OLD.C_LIVRE_DESCR08,
:OLD.SUSPENDE_VALE,
:OLD.GERA_REG_ACOMP,
:OLD.QTDE_DETERMINADA,
:OLD.CATEG_TRAB_FGTS,
:OLD.CONSID_DIAS_INSS,
:OLD.GRUPO_SEL_PESSOA,
:OLD.COD_SEL_PESSOA,
:OLD.GRUPO_SEL_CONTRATO,
:OLD.COD_SEL_CONTRATO,
:OLD.GERA_SIT_PTO_AUTO,
:OLD.TIPO_APURACAO,
:OLD.SEXO,
:OLD.CODIGO_RETENCAO,
:OLD.PERMITE_CONCOMIT,
:OLD.ID_LEI,
:OLD.DATA_INI_VIGENCIA,
:OLD.DATA_FIM_VIGENCIA,
:OLD.DIAS_PRORROG_ORI,
:OLD.DIAS_PRORROG_DES,
:OLD.DIAS_INI_PRORROG,
:OLD.COD_CATEG_ESOCIAL,
:OLD.C_LIVRE_OPCAO01,
:OLD.C_LIVRE_OPCAO02,
:OLD.C_LIVRE_OPCAO03,
:OLD.COD_TP_ESTABILIDAD
);


--------------------------------------------------------------------------DELETE-------------------------------------------------------------------------------------------------------------------------------------------
ELSIF DELETING THEN
v_DML := 'D';


INSERT INTO SUGESP_RHPARM_SIT_FUNC
(
ID,
TIPO_DML,
CODIGO,
OLD_DESCRICAO,
OLD_ABREVIACAO,
OLD_CODIGO_RAIS,
OLD_CONTROLE_FOLHA,
OLD_SITUACAO_PONTO,
OLD_E_AFASTAMENTO,
OLD_ABATE_TEMPO_FERIAS,
OLD_ABATE_TEMPO_13_SAL,
OLD_RESTRICAO_DESLIG,
OLD_VERBA_1_PARA_FOLHA,
OLD_VERBA_2_PARA_FOLHA,
OLD_VERBA_3_PARA_FOLHA,
OLD_VERBA_4_PARA_FOLHA,
OLD_C_LIVRE_SELEC01,
OLD_C_LIVRE_SELEC02,
OLD_C_LIVRE_VALOR03,
OLD_C_LIVRE_VALOR04,
OLD_C_LIVRE_DATA05,
OLD_C_LIVRE_DATA06,
OLD_LOGIN_USUARIO,
OLD_DT_ULT_ALTER_USUA,
OLD_MEDIDA_ESTABILID,
OLD_QTDE_ESTAB_POSTER,
OLD_SUSPENDE_REMUNERA,
OLD_QTDE_DIAS_PROXIMO,
OLD_PROXIMA_SIT_FUNC,
OLD_MOTIVO_AFAST,
OLD_GERA_SAL_BENEFICIO,
OLD_TEXTO_ASSOCIADO,
OLD_C_LIVRE_DESCR07,
OLD_C_LIVRE_DESCR08,
OLD_SUSPENDE_VALE,
OLD_GERA_REG_ACOMP,
OLD_QTDE_DETERMINADA,
OLD_CATEG_TRAB_FGTS,
OLD_CONSID_DIAS_INSS,
OLD_GRUPO_SEL_PESSOA,
OLD_COD_SEL_PESSOA,
OLD_GRUPO_SEL_CONTRATO,
OLD_COD_SEL_CONTRATO,
OLD_GERA_SIT_PTO_AUTO,
OLD_TIPO_APURACAO,
OLD_SEXO,
OLD_CODIGO_RETENCAO,
OLD_PERMITE_CONCOMIT,
OLD_ID_LEI,
OLD_DATA_INI_VIGENCIA,
OLD_DATA_FIM_VIGENCIA,
OLD_DIAS_PRORROG_ORI,
OLD_DIAS_PRORROG_DES,
OLD_DIAS_INI_PRORROG,
OLD_COD_CATEG_ESOCIAL,
OLD_C_LIVRE_OPCAO01,
OLD_C_LIVRE_OPCAO02,
OLD_C_LIVRE_OPCAO03,
OLD_COD_TP_ESTABILIDAD
)
VALUES
(
(SELECT MAX(ID)+1 FROM SUGESP_RHPARM_SIT_FUNC),
v_DML,
:OLD.CODIGO,
:OLD.DESCRICAO,
:OLD.ABREVIACAO,
:OLD.CODIGO_RAIS,
:OLD.CONTROLE_FOLHA,
:OLD.SITUACAO_PONTO,
:OLD.E_AFASTAMENTO,
:OLD.ABATE_TEMPO_FERIAS,
:OLD.ABATE_TEMPO_13_SAL,
:OLD.RESTRICAO_DESLIG,
:OLD.VERBA_1_PARA_FOLHA,
:OLD.VERBA_2_PARA_FOLHA,
:OLD.VERBA_3_PARA_FOLHA,
:OLD.VERBA_4_PARA_FOLHA,
:OLD.C_LIVRE_SELEC01,
:OLD.C_LIVRE_SELEC02,
:OLD.C_LIVRE_VALOR03,
:OLD.C_LIVRE_VALOR04,
:OLD.C_LIVRE_DATA05,
:OLD.C_LIVRE_DATA06,
SYS_CONTEXT ('USERENV', 'OS_USER'),
SYSDATE,
:OLD.MEDIDA_ESTABILID,
:OLD.QTDE_ESTAB_POSTER,
:OLD.SUSPENDE_REMUNERA,
:OLD.QTDE_DIAS_PROXIMO,
:OLD.PROXIMA_SIT_FUNC,
:OLD.MOTIVO_AFAST,
:OLD.GERA_SAL_BENEFICIO,
:OLD.TEXTO_ASSOCIADO,
:OLD.C_LIVRE_DESCR07,
:OLD.C_LIVRE_DESCR08,
:OLD.SUSPENDE_VALE,
:OLD.GERA_REG_ACOMP,
:OLD.QTDE_DETERMINADA,
:OLD.CATEG_TRAB_FGTS,
:OLD.CONSID_DIAS_INSS,
:OLD.GRUPO_SEL_PESSOA,
:OLD.COD_SEL_PESSOA,
:OLD.GRUPO_SEL_CONTRATO,
:OLD.COD_SEL_CONTRATO,
:OLD.GERA_SIT_PTO_AUTO,
:OLD.TIPO_APURACAO,
:OLD.SEXO,
:OLD.CODIGO_RETENCAO,
:OLD.PERMITE_CONCOMIT,
:OLD.ID_LEI,
:OLD.DATA_INI_VIGENCIA,
:OLD.DATA_FIM_VIGENCIA,
:OLD.DIAS_PRORROG_ORI,
:OLD.DIAS_PRORROG_DES,
:OLD.DIAS_INI_PRORROG,
:OLD.COD_CATEG_ESOCIAL,
:OLD.C_LIVRE_OPCAO01,
:OLD.C_LIVRE_OPCAO02,
:OLD.C_LIVRE_OPCAO03,
:OLD.COD_TP_ESTABILIDAD
);

END IF; --FIM IF PARA SABER SE É INSERT, UPDATE ou DELETE


END; --FIM TRIGGER




ALTER TRIGGER "ARTERH"."TR_SUGESP_RHPARM_SIT_FUNC" ENABLE