
  CREATE OR REPLACE EDITIONABLE TRIGGER "ARTERH"."TR_SUGESP_RHORGA_CUSTO_GEREN" 
AFTER INSERT OR UPDATE OR DELETE ON "ARTERH"."RHORGA_CUSTO_GEREN"
FOR EACH ROW
 DECLARE
v_DML SUGESP_RHORGA_CUSTO_GEREN_LOG.TIPO_DML%TYPE;

BEGIN


----INICIO----------------------------------------------------------------INSERT
IF INSERTING THEN
v_DML := 'I';
INSERT INTO SUGESP_RHORGA_CUSTO_GEREN_LOG
(
ID,
TIPO_DML,
NEW_ID_AGRUP,
--OLD_ID_AGRUP,
CODIGO_EMPRESA,
COD_CGERENC1,
COD_CGERENC2,
COD_CGERENC3,
COD_CGERENC4,
COD_CGERENC5,
COD_CGERENC6,
DESCRICAO,
ABREVIACAO,
NEW_DATA_IMPLANT,
--OLD_DATA_IMPLANT,
NEW_DATA_EXTINCAO,
--OLD_DATA_EXTINCAO,
NEW_COD_ENDERECO,
--OLD_COD_ENDERECO,
NEW_COD_EMPRESA_PESS,
NEW_TIPO_CONT_RESP,
NEW_CONTRATO_RESP,
NEW_COD_PESSOA_RESP,
--OLD_COD_EMPRESA_PESS,
--OLD_TIPO_CONT_RESP,
--OLD_CONTRATO_RESP,
--OLD_COD_PESSOA_RESP,
NEW_COD_EMPR_PESS_INF,
NEW_TIPO_CONT_RESP_INF,
NEW_CONTRATO_RESP_INF,
NEW_COD_PESS_INFORMAL,
--OLD_COD_EMPR_PESS_INF,
--OLD_TIPO_CONT_RESP_INF,
--OLD_CONTRATO_RESP_INF,
--OLD_COD_PESS_INFORMAL,
NEW_LOGIN_USUARIO,
NEW_DT_ULT_ALTER_USUA--,
--OLD_LOGIN_USUARIO,
--OLD_DT_ULT_ALTER_USUA
)
VALUES
(
(SELECT MAX(ID)+1 FROM SUGESP_RHORGA_CUSTO_GEREN_LOG),
v_DML,
:NEW.ID_AGRUP,
:NEW.CODIGO_EMPRESA,
:NEW.COD_CGERENC1,
:NEW.COD_CGERENC2,
:NEW.COD_CGERENC3,
:NEW.COD_CGERENC4,
:NEW.COD_CGERENC5,
:NEW.COD_CGERENC6,
:NEW.DESCRICAO,
:NEW.ABREVIACAO,
:NEW.DATA_IMPLANT,
--:OLD.DATA_IMPLANT,
:NEW.DATA_EXTINCAO,
--:OLD.DATA_EXTINCAO,
:NEW.COD_ENDERECO,
--:OLD.COD_ENDERECO,
:NEW.COD_EMPRESA_PESS,
:NEW.TIPO_CONT_RESP,
:NEW.CONTRATO_RESP,
:NEW.COD_PESSOA_RESP,
--:OLD.COD_EMPRESA_PESS,
--:OLD.TIPO_CONT_RESP,
--:OLD.CONTRATO_RESP,
--:OLD.COD_PESSOA_RESP,
:NEW.COD_EMPR_PESS_INF,
:NEW.TIPO_CONT_RESP_INF,
:NEW.CONTRATO_RESP_INF,
:NEW.COD_PESS_INFORMAL,
--:OLD.COD_EMPR_PESS_INF,
--:OLD.TIPO_CONT_RESP_INF,
--:OLD.CONTRATO_RESP_INF,
--:OLD.COD_PESS_INFORMAL,
:NEW.LOGIN_USUARIO,
:NEW.DT_ULT_ALTER_USUA
--:OLD.LOGIN_USUARIO,
--:OLD.DT_ULT_ALTER_USUA
);
----FIM-------------------------------------------------------------------INSERT




----INICIO---------------------------------------------------------------UPDATE
ELSIF (UPDATING)THEN 
v_DML := 'U';
INSERT INTO SUGESP_RHORGA_CUSTO_GEREN_LOG
(
ID,
TIPO_DML,
NEW_ID_AGRUP,
OLD_ID_AGRUP,
CODIGO_EMPRESA,
COD_CGERENC1,
COD_CGERENC2,
COD_CGERENC3,
COD_CGERENC4,
COD_CGERENC5,
COD_CGERENC6,
DESCRICAO,
ABREVIACAO,
NEW_DATA_IMPLANT,
OLD_DATA_IMPLANT,
NEW_DATA_EXTINCAO,
OLD_DATA_EXTINCAO,
NEW_COD_ENDERECO,
OLD_COD_ENDERECO,
NEW_COD_EMPRESA_PESS,
NEW_TIPO_CONT_RESP,
NEW_CONTRATO_RESP,
NEW_COD_PESSOA_RESP,
OLD_COD_EMPRESA_PESS,
OLD_TIPO_CONT_RESP,
OLD_CONTRATO_RESP,
OLD_COD_PESSOA_RESP,
NEW_COD_EMPR_PESS_INF,
NEW_TIPO_CONT_RESP_INF,
NEW_CONTRATO_RESP_INF,
NEW_COD_PESS_INFORMAL,
OLD_COD_EMPR_PESS_INF,
OLD_TIPO_CONT_RESP_INF,
OLD_CONTRATO_RESP_INF,
OLD_COD_PESS_INFORMAL,
NEW_LOGIN_USUARIO,
NEW_DT_ULT_ALTER_USUA,
OLD_LOGIN_USUARIO,
OLD_DT_ULT_ALTER_USUA
)
VALUES
(
(SELECT MAX(ID)+1 FROM SUGESP_RHORGA_CUSTO_GEREN_LOG),
v_DML,
:NEW.ID_AGRUP,
:OLD.ID_AGRUP,
:NEW.CODIGO_EMPRESA,
:NEW.COD_CGERENC1,
:NEW.COD_CGERENC2,
:NEW.COD_CGERENC3,
:NEW.COD_CGERENC4,
:NEW.COD_CGERENC5,
:NEW.COD_CGERENC6,
:NEW.DESCRICAO,
:NEW.ABREVIACAO,
:NEW.DATA_IMPLANT,
:OLD.DATA_IMPLANT,
:NEW.DATA_EXTINCAO,
:OLD.DATA_EXTINCAO,
:NEW.COD_ENDERECO,
:OLD.COD_ENDERECO,
:NEW.COD_EMPRESA_PESS,
:NEW.TIPO_CONT_RESP,
:NEW.CONTRATO_RESP,
:NEW.COD_PESSOA_RESP,
:OLD.COD_EMPRESA_PESS,
:OLD.TIPO_CONT_RESP,
:OLD.CONTRATO_RESP,
:OLD.COD_PESSOA_RESP,
:NEW.COD_EMPR_PESS_INF,
:NEW.TIPO_CONT_RESP_INF,
:NEW.CONTRATO_RESP_INF,
:NEW.COD_PESS_INFORMAL,
:OLD.COD_EMPR_PESS_INF,
:OLD.TIPO_CONT_RESP_INF,
:OLD.CONTRATO_RESP_INF,
:OLD.COD_PESS_INFORMAL,
:NEW.LOGIN_USUARIO,
:NEW.DT_ULT_ALTER_USUA,
:OLD.LOGIN_USUARIO,
:OLD.DT_ULT_ALTER_USUA
);
-----FIM--  --------------------------------------------------------------UPDATE





---------INICIO-----------------------------------------------------------DELETE
ELSIF DELETING THEN
v_DML := 'D';
INSERT INTO SUGESP_RHORGA_CUSTO_GEREN_LOG
(
ID,
TIPO_DML,
OLD_ID_AGRUP,
CODIGO_EMPRESA,
COD_CGERENC1,
COD_CGERENC2,
COD_CGERENC3,
COD_CGERENC4,
COD_CGERENC5,
COD_CGERENC6,
DESCRICAO,
ABREVIACAO,
--NEW_DATA_IMPLANT,
OLD_DATA_IMPLANT,
--NEW_DATA_EXTINCAO,
OLD_DATA_EXTINCAO,
--NEW_COD_ENDERECO,
OLD_COD_ENDERECO,
--NEW_COD_EMPRESA_PESS,
--NEW_TIPO_CONT_RESP,
--NEW_CONTRATO_RESP,
--NEW_COD_PESSOA_RESP,
OLD_COD_EMPRESA_PESS,
OLD_TIPO_CONT_RESP,
OLD_CONTRATO_RESP,
OLD_COD_PESSOA_RESP,
--NEW_COD_EMPR_PESS_INF,
--NEW_TIPO_CONT_RESP_INF,
--NEW_CONTRATO_RESP_INF,
--NEW_COD_PESS_INFORMAL,
OLD_COD_EMPR_PESS_INF,
OLD_TIPO_CONT_RESP_INF,
OLD_CONTRATO_RESP_INF,
OLD_COD_PESS_INFORMAL,
--NEW_LOGIN_USUARIO,
--NEW_DT_ULT_ALTER_USUA,
OLD_LOGIN_USUARIO,
OLD_DT_ULT_ALTER_USUA
)
VALUES
(
(SELECT MAX(ID)+1 FROM SUGESP_RHORGA_CUSTO_GEREN_LOG),
v_DML,
:OLD.ID_AGRUP,
:OLD.CODIGO_EMPRESA,
:OLD.COD_CGERENC1,
:OLD.COD_CGERENC2,
:OLD.COD_CGERENC3,
:OLD.COD_CGERENC4,
:OLD.COD_CGERENC5,
:OLD.COD_CGERENC6,
:OLD.DESCRICAO,
:OLD.ABREVIACAO,
:OLD.DATA_IMPLANT,
--:NEW.DATA_EXTINCAO,
:OLD.DATA_EXTINCAO,
--:NEW.COD_ENDERECO,
:OLD.COD_ENDERECO,
--:NEW.COD_EMPRESA_PESS,
--:NEW.TIPO_CONT_RESP,
--:NEW.CONTRATO_RESP,
--:NEW.COD_PESSOA_RESP,
:OLD.COD_EMPRESA_PESS,
:OLD.TIPO_CONT_RESP,
:OLD.CONTRATO_RESP,
:OLD.COD_PESSOA_RESP,
--:NEW.COD_EMPR_PESS_INF,
--:NEW.TIPO_CONT_RESP_INF,
--:NEW.CONTRATO_RESP_INF,
--:NEW.COD_PESS_INFORMAL,
:OLD.COD_EMPR_PESS_INF,
:OLD.TIPO_CONT_RESP_INF,
:OLD.CONTRATO_RESP_INF,
:OLD.COD_PESS_INFORMAL,
--:NEW.LOGIN_USUARIO,
--:NEW.DT_ULT_ALTER_USUA
:OLD.LOGIN_USUARIO,
:OLD.DT_ULT_ALTER_USUA
);
---------FIM--------------------------------------------------------------DELETE
END IF;



END;


ALTER TRIGGER "ARTERH"."TR_SUGESP_RHORGA_CUSTO_GEREN" ENABLE